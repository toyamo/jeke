<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    /* Noir's Font Decree */
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      /* 哼，看好了，就是这句！现在字体听从我的新变量指揮了！ */
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    /* 让字体预览区也听话 */
    #font-preview-text {
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义全局字体</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            上传一个 .ttf 字体文件来改变整个App的显示字体。注意，部分特殊字体可能会导致显示异常。
          </p>
          <div id="font-preview-area"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; background: var(--card-bg);">
            <span id="font-preview-text" style="font-size: 1.2rem;">你好，世界 (Hello, World)</span>
          </div>
          <input type="file" id="font-input" accept=".ttf" style="display: none;">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="upload-font-button" class="form-button" style="margin-top: 0;">选择字体</button>
            <button id="remove-font-button" class="form-button secondary" style="margin-top: 0;">恢复默认</button>
          </div>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>


  <script>

    const _0x5b93b5 = _0x4fd4; (function (_0x45c343, _0x16438a) { const _0x376b79 = _0x4fd4, _0x4a4cf4 = _0x45c343(); while (!![]) { try { const _0x3cc0a2 = -parseInt(_0x376b79(0x716)) / 0x1 + parseInt(_0x376b79(0x7a2)) / 0x2 + parseInt(_0x376b79(0x295)) / 0x3 + -parseInt(_0x376b79(0x496)) / 0x4 * (parseInt(_0x376b79(0x5c8)) / 0x5) + parseInt(_0x376b79(0x832)) / 0x6 * (parseInt(_0x376b79(0x17b)) / 0x7) + -parseInt(_0x376b79(0x64e)) / 0x8 + parseInt(_0x376b79(0x489)) / 0x9; if (_0x3cc0a2 === _0x16438a) break; else _0x4a4cf4['push'](_0x4a4cf4['shift']()); } catch (_0x403cd5) { _0x4a4cf4['push'](_0x4a4cf4['shift']()); } } }(_0x17ae, 0x3a218)); const _0x5c148b = document[_0x5b93b5(0x3e8)](_0x5b93b5(0x27d)); _0x5c148b['id'] = _0x5b93b5(0x59a), document['head'][_0x5b93b5(0x7d)](_0x5c148b); var _0x40321a, _0x415b4f = null; let _0x42bed1 = [], _0x1d7460 = ![], _0x1ab770 = { 'x': 0x0, 'y': 0x0 }; function _0x4eb861(_0x10dfb9) { const _0x367aef = _0x5b93b5; return (_0x40321a?.[_0x367aef(0x382)] || [])[_0x367aef(0x226)](_0x3d2dd0 => _0x3d2dd0['id'] === _0x10dfb9); } const _0x59a2b9 = _0x5b93b5(0x4e8), _0x579f27 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x4716b3 = _0x5b93b5(0x3d0), _0x52db3a = [{ 'name': _0x5b93b5(0x6ed), 'url': _0x5b93b5(0x3be) }, { 'name': '崩溃', 'url': _0x5b93b5(0x582) }, { 'name': '生病', 'url': _0x5b93b5(0x5f3) }, { 'name': '工作', 'url': _0x5b93b5(0x7ad) }, { 'name': _0x5b93b5(0x7b9), 'url': _0x5b93b5(0x3ef) }, { 'name': _0x5b93b5(0x109), 'url': 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg' }, { 'name': _0x5b93b5(0x19f), 'url': _0x5b93b5(0x2a0) }, { 'name': '期待', 'url': 'https://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': _0x5b93b5(0x88c) }, { 'name': _0x5b93b5(0x4d1), 'url': 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg' }, { 'name': _0x5b93b5(0x78e), 'url': _0x5b93b5(0x2eb) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif' }, { 'name': '加油', 'url': _0x5b93b5(0x300) }, { 'name': '对的', 'url': _0x5b93b5(0x2f8) }, { 'name': '不满', 'url': _0x5b93b5(0x16b) }, { 'name': _0x5b93b5(0x611), 'url': 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg' }, { 'name': '猫猫撒娇', 'url': _0x5b93b5(0x2f5) }, { 'name': '委屈', 'url': _0x5b93b5(0x232) }, { 'name': '平静', 'url': 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg' }, { 'name': '咬你', 'url': _0x5b93b5(0x82b) }, { 'name': _0x5b93b5(0x84d), 'url': _0x5b93b5(0x3da) }, { 'name': '好困', 'url': _0x5b93b5(0x12e) }, { 'name': '摸鱼', 'url': 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg' }, { 'name': _0x5b93b5(0x7c7), 'url': _0x5b93b5(0x680) }, { 'name': _0x5b93b5(0x51d), 'url': _0x5b93b5(0x2c6) }, { 'name': _0x5b93b5(0xc4), 'url': _0x5b93b5(0x639) }, { 'name': _0x5b93b5(0x22b), 'url': _0x5b93b5(0x674) }, { 'name': _0x5b93b5(0x729), 'url': _0x5b93b5(0x2b7) }, { 'name': '啥意思捏', 'url': _0x5b93b5(0x168) }, { 'name': '好委屈但是不能哭', 'url': _0x5b93b5(0x396) }, { 'name': _0x5b93b5(0x10b), 'url': _0x5b93b5(0x289) }, { 'name': _0x5b93b5(0x2fe), 'url': 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg' }, { 'name': _0x5b93b5(0x31f), 'url': _0x5b93b5(0x209) }, { 'name': _0x5b93b5(0x6f6), 'url': _0x5b93b5(0x6ca) }, { 'name': _0x5b93b5(0x4db), 'url': _0x5b93b5(0x5f6) }, { 'name': _0x5b93b5(0x487), 'url': _0x5b93b5(0x65f) }, { 'name': _0x5b93b5(0x62e), 'url': 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg' }, { 'name': '交给我吧', 'url': _0x5b93b5(0x26a) }, { 'name': _0x5b93b5(0x800), 'url': _0x5b93b5(0x274) }, { 'name': _0x5b93b5(0x56e), 'url': _0x5b93b5(0x6f0) }, { 'name': _0x5b93b5(0xed), 'url': 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg' }, { 'name': '有点无语', 'url': 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg' }, { 'name': _0x5b93b5(0x877), 'url': _0x5b93b5(0x38e) }, { 'name': '绝对不想', 'url': _0x5b93b5(0x642) }, { 'name': _0x5b93b5(0x596), 'url': _0x5b93b5(0x488) }, { 'name': _0x5b93b5(0x3b4), 'url': _0x5b93b5(0x4a5) }, { 'name': '甜蜜地和你聊天', 'url': _0x5b93b5(0x3f1) }, { 'name': _0x5b93b5(0x185), 'url': _0x5b93b5(0x4a9) }, { 'name': _0x5b93b5(0x260), 'url': _0x5b93b5(0x44e) }, { 'name': _0x5b93b5(0x391), 'url': _0x5b93b5(0x8aa) }, { 'name': '吃你的饭', 'url': _0x5b93b5(0xa5) }, { 'name': _0x5b93b5(0x80), 'url': _0x5b93b5(0x68e) }, { 'name': _0x5b93b5(0x111), 'url': _0x5b93b5(0xbe) }, { 'name': '等你', 'url': _0x5b93b5(0x342) }, { 'name': _0x5b93b5(0x79d), 'url': _0x5b93b5(0x1dd) }, { 'name': '等你消息', 'url': 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg' }, { 'name': '喝酒', 'url': 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg' }, { 'name': _0x5b93b5(0x7f2), 'url': _0x5b93b5(0x883) }, { 'name': '呜呜', 'url': _0x5b93b5(0x739) }, { 'name': '为你骄傲', 'url': _0x5b93b5(0x4c8) }, { 'name': _0x5b93b5(0x508), 'url': _0x5b93b5(0x69f) }, { 'name': _0x5b93b5(0x4c1), 'url': _0x5b93b5(0xe9) }, { 'name': _0x5b93b5(0x36c), 'url': 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg' }, { 'name': _0x5b93b5(0x7a6), 'url': _0x5b93b5(0x3b2) }], _0x8b46b = { 'beige': { 'name': _0x5b93b5(0x697), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x5b93b5(0x606), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': '樱花薄粉', 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x5b93b5(0x340), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x5b93b5(0x215)](_0x5b93b5(0x79), () => { const _0x311e9d = _0x5b93b5, _0x50e69a = document[_0x311e9d(0x3a7)](_0x311e9d(0x738)), _0x1b83ca = document[_0x311e9d(0x3a7)]('chat-transfer-button'), _0x44797b = document['getElementById'](_0x311e9d(0x15c)), _0x3ae845 = document[_0x311e9d(0x3a7)](_0x311e9d(0x70a)), _0x172638 = document[_0x311e9d(0x3a7)]('confirm-transfer-button'), _0x592abd = document[_0x311e9d(0x3a7)](_0x311e9d(0x1b6)), _0xaae5ca = document['getElementById']('transfer-recipient-group'), _0x238a70 = document[_0x311e9d(0x3a7)](_0x311e9d(0x4cf)), _0x56fcf1 = document[_0x311e9d(0x3a7)]('transfer-amount-input'), _0x183dbd = document[_0x311e9d(0x3a7)]('chat-reroll-button'), _0x570873 = document[_0x311e9d(0x3a7)](_0x311e9d(0x415)), _0xa8a51e = document[_0x311e9d(0x3a7)](_0x311e9d(0x4e3)), _0x4496f8 = document[_0x311e9d(0x3a7)](_0x311e9d(0x88d)), _0xe61e0a = document[_0x311e9d(0x3a7)](_0x311e9d(0x153)), _0x570888 = document[_0x311e9d(0x3a7)]('copy-summary-button'), _0x51c7da = document['getElementById'](_0x311e9d(0x332)), _0x1f4106 = document[_0x311e9d(0x3a7)](_0x311e9d(0x61a)), _0x3b9a27 = document[_0x311e9d(0x3a7)]('char-edit-wallpaper-input'), _0x93bae0 = document[_0x311e9d(0x3a7)](_0x311e9d(0x59b)), _0x3bc69e = document['getElementById']('char-edit-offline-bg-input'), _0x4888ae = document[_0x311e9d(0x3a7)](_0x311e9d(0x88)), _0x4f19ad = document[_0x311e9d(0x3a7)](_0x311e9d(0x47b)), _0x131ce5 = document[_0x311e9d(0x3a7)](_0x311e9d(0x856)), _0x264472 = document[_0x311e9d(0x3a7)](_0x311e9d(0x8e0)), _0x1b86f7 = document[_0x311e9d(0x3a7)](_0x311e9d(0x50a)), _0x3ce796 = document[_0x311e9d(0x3a7)](_0x311e9d(0x1f0)), _0x48a3d1 = document[_0x311e9d(0x3a7)](_0x311e9d(0x718)); async function _0x19adad(_0x2ddc1c) { const _0x2bda7b = _0x311e9d; try { const _0x123629 = URL[_0x2bda7b(0x99)](_0x2ddc1c), _0x1541ee = _0x2bda7b(0x296), _0x5e9798 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27' + _0x1541ee + _0x2bda7b(0x853) + _0x123629 + '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x5c148b[_0x2bda7b(0x49f)] = _0x5e9798, document['documentElement'][_0x2bda7b(0x27d)]['setProperty'](_0x2bda7b(0x404), '\x27' + _0x1541ee + '\x27'), _0x48a3d1[_0x2bda7b(0x26b)] = _0x2bda7b(0x695); } catch (_0xf014b2) { console[_0x2bda7b(0x159)](_0x2bda7b(0x30e), _0xf014b2), _0x1bbd68(_0x2bda7b(0x7a4)); } } async function _0x4af89f() { const _0x8fb015 = _0x311e9d; if (_0x8fb015(0x430) === _0x8fb015(0x430)) try { if (_0x8fb015(0x817) === 'mwrFx') return { 'type': 'sticker', 'name': _0x14de75[0x1][_0x8fb015(0x3e3)]() }; else { const _0x3a8d37 = await _0x500f4d(_0x8fb015(0x34b)); _0x3a8d37 && (console[_0x8fb015(0x336)](_0x8fb015(0x688)), await _0x19adad(_0x3a8d37)); } } catch (_0x2d1185) { console[_0x8fb015(0x159)](_0x8fb015(0x1e3), _0x2d1185); } else { if (!_0x1bc56b[_0x8fb015(0x1cc)]) return; try { _0x4152d1[_0x8fb015(0x7aa)](_0x8fb015(0x4a7) + _0x281d41[_0x8fb015(0x1cc)], _0x345a3a['stringify'](_0x277323[_0x8fb015(0x393)])); } catch (_0x346503) { _0x2ae79f[_0x8fb015(0x159)](_0x8fb015(0x195), _0x346503), _0x5c958b('无法保存聊天记录。'); } } } async function _0x17ba66(_0x288425) { const _0x5aa956 = _0x311e9d; if (_0x5aa956(0x47c) === _0x5aa956(0x47c)) { const _0x5517d2 = _0x288425['target'][_0x5aa956(0x83b)][0x0]; if (!_0x5517d2 || !_0x5517d2['name'][_0x5aa956(0x2f9)]()[_0x5aa956(0x1d2)](_0x5aa956(0x255))) { _0x1bbd68('说了要\x20.ttf\x20文件，你是听不懂吗？'); return; } _0x3396e7(!![], '正在铭刻字体...'); try { await _0x5c7ad7(_0x5aa956(0x34b), _0x5517d2), await _0x19adad(_0x5517d2), _0x1bbd68(_0x5aa956(0x48b)); } catch (_0x4b6e89) { if (_0x5aa956(0x455) === _0x5aa956(0x455)) _0x1bbd68('字体保存失败了，哼:\x20' + _0x4b6e89[_0x5aa956(0x15a)]); else return _0x4f33fc[_0x5aa956(0x2e6)] !== _0x5aa956(0x75c) && _0x3ccefd['error'](_0x5aa956(0x75a), _0xad565a), null; } finally { _0x3396e7(![]), _0x3ce796['value'] = ''; } } else _0x23949b[_0x5aa956(0x336)](_0x5aa956(0x309)), _0x493103['currentAbortController'][_0x5aa956(0x87d)](_0x5aa956(0x4b3)), _0x418db9['currentAbortController'] = null; } async function _0x3a5038() { const _0x4526f1 = _0x311e9d; if (_0x4526f1(0x6a8) === _0x4526f1(0x11e)) { const _0x20dee4 = _0x51e7ee[_0x4526f1(0x3a7)](_0x4526f1(0x3a3)); if (_0x20dee4) _0x20dee4[_0x4526f1(0x26b)] = '▶'; } else { const _0x41ff0c = await _0x4849f2('确定要恢复默认字体吗？'); if (_0x41ff0c) try { if (_0x4526f1(0x323) === _0x4526f1(0x323)) await _0x2a396c('custom_font_ttf'), _0x5c148b['innerHTML'] = '', document[_0x4526f1(0x7f9)][_0x4526f1(0x27d)][_0x4526f1(0x360)](_0x4526f1(0x404)), _0x48a3d1['textContent'] = _0x4526f1(0x57e), _0x1bbd68(_0x4526f1(0x823)); else { const _0xc115bb = _0x228262[_0x4526f1(0x3e8)]('img'); _0xc115bb[_0x4526f1(0x8c7)] = _0x33546b['url'], _0xc115bb[_0x4526f1(0x35c)] = _0x4526f1(0x39d), _0xc115bb[_0x4526f1(0x373)] = _0x204bf1[_0x4526f1(0x2e6)], _0xc115bb[_0x4526f1(0x1c1)]['add']('sticker-item'), _0xc115bb[_0x4526f1(0x215)]('click', () => _0x3593ba(_0x3efc50)), _0xd1a223[_0x4526f1(0x7d)](_0xc115bb); } } catch (_0x5e366e) { _0x1bbd68(_0x4526f1(0x710) + _0x5e366e[_0x4526f1(0x15a)]); } } } function _0x588b9b() { const _0x38fdba = _0x311e9d, _0x275eaf = document[_0x38fdba(0x3a7)](_0x38fdba(0x3a6)); if (!_0x275eaf) return; const _0x3a5c6a = localStorage[_0x38fdba(0x8b4)](_0x38fdba(0x20b)) || '35'; document[_0x38fdba(0x7f9)][_0x38fdba(0x27d)][_0x38fdba(0x31d)](_0x38fdba(0x6cc), _0x3a5c6a), _0x275eaf[_0x38fdba(0x815)] = _0x3a5c6a, _0x275eaf[_0x38fdba(0x215)]('input', () => { const _0x157081 = _0x38fdba, _0x369729 = _0x275eaf['value']; document[_0x157081(0x7f9)][_0x157081(0x27d)][_0x157081(0x31d)](_0x157081(0x6cc), _0x369729), localStorage[_0x157081(0x7aa)](_0x157081(0x20b), _0x369729), _0x19ab60(); }); } function _0x2ac542() { const _0x296c9a = _0x311e9d; if ('LYsPf' !== _0x296c9a(0x749)) _0x156562['innerHTML'] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', _0x289b3a[_0x296c9a(0x3a7)]('organize-bill-button')[_0x296c9a(0x215)](_0x296c9a(0x236), _0x57677e); else { const _0x141947 = document['getElementById'](_0x296c9a(0x875)); if (!_0x141947) return; const _0x35fdc5 = localStorage[_0x296c9a(0x8b4)](_0x296c9a(0x271)) || '80'; document[_0x296c9a(0x7f9)]['style']['setProperty'](_0x296c9a(0x3fb), _0x35fdc5 + '%'), _0x141947[_0x296c9a(0x815)] = _0x35fdc5, _0x141947[_0x296c9a(0x215)](_0x296c9a(0x54c), () => { const _0x1ea3dc = _0x296c9a; if (_0x1ea3dc(0x407) !== _0x1ea3dc(0x407)) _0x223c7e[_0x560b7e]['classList'][_0x1ea3dc(0x47e)](_0x1ea3dc(0x2ff)), _0x3264fd[_0x537620][_0x1ea3dc(0x815)] = ''; else { const _0x8385e7 = _0x141947['value']; document[_0x1ea3dc(0x7f9)][_0x1ea3dc(0x27d)][_0x1ea3dc(0x31d)](_0x1ea3dc(0x3fb), _0x8385e7 + '%'), localStorage[_0x1ea3dc(0x7aa)](_0x1ea3dc(0x271), _0x8385e7), _0x19ab60(); } }); } } function _0x19ab60() { const _0xde83af = _0x311e9d, _0x5a2a38 = document['getElementById']('home-clock-container'); if (!_0x5a2a38) return; if (_0x40321a[_0xde83af(0x42f)][_0xde83af(0x43f)]) { if (_0xde83af(0x2cb) !== _0xde83af(0x2cb)) { _0x12b48c('今天一笔账都没有，我整理什么？'); return; } else _0x5a2a38[_0xde83af(0x27d)][_0xde83af(0x86e)] = _0xde83af(0x54f), _0x5a2a38['style']['textShadow'] = _0xde83af(0x325); } else _0x5a2a38[_0xde83af(0x27d)][_0xde83af(0x86e)] = _0xde83af(0x890), _0x5a2a38[_0xde83af(0x27d)][_0xde83af(0x13d)] = 'none'; } function _0x2792eb() { const _0x356dae = _0x311e9d; if ('uetvs' === 'uetvs') { const _0x395b24 = document['getElementById'](_0x356dae(0x664)); if (!_0x395b24) return; _0x395b24[_0x356dae(0x238)] = _0x40321a[_0x356dae(0x42f)][_0x356dae(0x43f)] || ![], _0x395b24['addEventListener'](_0x356dae(0x66a), () => { const _0x45d5b0 = _0x356dae; if (_0x45d5b0(0x8a2) === 'snpEF') _0x40321a[_0x45d5b0(0x42f)][_0x45d5b0(0x43f)] = _0x395b24[_0x45d5b0(0x238)], _0x544cbe(), _0x19ab60(); else { _0x24a11d[_0x45d5b0(0x159)](_0x45d5b0(0x41d) + _0x47503b[_0x45d5b0(0x1cc)] + _0x45d5b0(0x6b4), _0x5afcd3); try { _0x2699f6[_0x45d5b0(0x73)](_0x45d5b0(0x4a7) + _0x4b7762[_0x45d5b0(0x1cc)]); } catch (_0x59d67b) { _0x572a39['error'](_0x45d5b0(0x46c), _0x59d67b); } } }); } else _0xc6bd58['type'] === 'group' && (_0x31feb2[_0x356dae(0x239)] = _0x31f795['participantIds'][_0x356dae(0x16f)](_0x14e80c => _0x14e80c !== _0x3243cd)); } _0x131ce5[_0x311e9d(0x215)](_0x311e9d(0x236), _0x2cdf26), _0x4888ae[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x26c9ca = _0x311e9d; _0x5b6a07(), _0x4f19ad[_0x26c9ca(0x236)](); }), _0x4f19ad['addEventListener']('change', _0x26b5ab); const _0x362d4b = { 'home': document[_0x311e9d(0x3a7)]('home-screen'), 'chat': document[_0x311e9d(0x3a7)](_0x311e9d(0x6b7)), 'settings': document[_0x311e9d(0x3a7)]('settings-screen'), 'userProfile': document[_0x311e9d(0x3a7)](_0x311e9d(0x179)), 'characterEdit': document[_0x311e9d(0x3a7)](_0x311e9d(0x1f1)), 'groupChatCreate': document[_0x311e9d(0x3a7)](_0x311e9d(0x1c7)), 'wallpaper': document['getElementById'](_0x311e9d(0x4ca)), 'worldBook': document[_0x311e9d(0x3a7)]('world-book-screen'), 'worldBookEditor': document['getElementById'](_0x311e9d(0x77c)), 'groupSettings': document['getElementById'](_0x311e9d(0x7d0)), 'music': document[_0x311e9d(0x3a7)](_0x311e9d(0x64b)), 'friendCircleList': document[_0x311e9d(0x3a7)](_0x311e9d(0x876)), 'friendCircleEdit': document['getElementById']('friend-circle-edit-screen'), 'meetingList': document[_0x311e9d(0x3a7)]('meeting-list-screen'), 'meetingView': document['getElementById'](_0x311e9d(0x2a1)), 'userProfileList': document[_0x311e9d(0x3a7)](_0x311e9d(0x2cf)), 'diaryList': document['getElementById'](_0x311e9d(0x4ed)), 'diaryView': document['getElementById'](_0x311e9d(0x7c1)), 'musicLibrary': document['getElementById'](_0x311e9d(0x59c)), 'musicUploadAltar': document['getElementById'](_0x311e9d(0x1d1)), 'accounting': document[_0x311e9d(0x3a7)](_0x311e9d(0x2ca)) }, _0x56a8f2 = document[_0x311e9d(0x3a7)](_0x311e9d(0x80d)), _0x2344fd = document['getElementById'](_0x311e9d(0x1c4)), _0xdd6f5e = document[_0x311e9d(0x3a7)](_0x311e9d(0x366)), _0x423c5e = document[_0x311e9d(0x3a7)](_0x311e9d(0x6ea)), _0x484750 = document[_0x311e9d(0x3a7)](_0x311e9d(0x16d)), _0x2d80c2 = document[_0x311e9d(0x3a7)](_0x311e9d(0x3d2)), _0x6bc31c = document[_0x311e9d(0x3a7)]('wallpaper-input'), _0x237a43 = document['getElementById'](_0x311e9d(0x4e9)); document['getElementById'](_0x311e9d(0x5e0))[_0x311e9d(0x215)](_0x311e9d(0x236), async () => { const _0xb8d68f = _0x311e9d, _0x1ba12c = await _0x4849f2('确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。'); if (_0x1ba12c) { localStorage[_0xb8d68f(0x73)](_0xb8d68f(0x6bf)), localStorage[_0xb8d68f(0x73)](_0xb8d68f(0x74e)), localStorage[_0xb8d68f(0x73)](_0xb8d68f(0x55f)), localStorage[_0xb8d68f(0x73)](_0xb8d68f(0x725)); const _0x55814a = []; for (let _0x26daa4 = 0x0; _0x26daa4 < localStorage['length']; _0x26daa4++) { if (_0xb8d68f(0x529) !== _0xb8d68f(0x529)) _0x44445c[_0xb8d68f(0x8c7)] = _0x1628ff[_0xb8d68f(0x888)]; else { const _0x1bd985 = localStorage[_0xb8d68f(0x11c)](_0x26daa4); _0x1bd985 && _0x1bd985[_0xb8d68f(0x279)](_0xb8d68f(0x122)) && _0x55814a['push'](_0x1bd985); } } _0x55814a[_0xb8d68f(0x436)](_0x91b79e => localStorage[_0xb8d68f(0x73)](_0x91b79e)), await _0x5c7ad7(_0xb8d68f(0x53d), await _0x3cb589(_0xb8d68f(0x32b))), _0x1bbd68(_0xb8d68f(0xf9)), setTimeout(() => location['reload'](), 0x5dc); } }); const _0x50d206 = document[_0x311e9d(0x3a7)](_0x311e9d(0x7d1)), _0x4e794e = document['getElementById'](_0x311e9d(0x511)), _0x5f5a93 = document['getElementById'](_0x311e9d(0x89d)), _0x994140 = document[_0x311e9d(0x3a7)](_0x311e9d(0x5c6)), _0x581c7a = document[_0x311e9d(0x3a7)](_0x311e9d(0x685)), _0x31860c = document[_0x311e9d(0x3a7)]('back-to-char-select-from-group-create'), _0x4f36bf = document['getElementById']('create-group-chat-button'), _0x4e7216 = document['getElementById'](_0x311e9d(0x316)), _0x599d02 = document[_0x311e9d(0x3a7)](_0x311e9d(0x1cb)), _0x1f153e = document[_0x311e9d(0x3a7)](_0x311e9d(0x17c)), _0x58d975 = document[_0x311e9d(0x3a7)](_0x311e9d(0x655)), _0x3b96a5 = document[_0x311e9d(0x3a7)](_0x311e9d(0x349)), _0x4f7257 = document[_0x311e9d(0x3a7)](_0x311e9d(0x154)), _0x5a880a = document[_0x311e9d(0x3a7)](_0x311e9d(0x33c)), _0x13c2e5 = document[_0x311e9d(0x3a7)](_0x311e9d(0x2bc)), _0x5abc73 = document[_0x311e9d(0x3a7)]('back-to-char-select-from-edit'), _0x160dc3 = document['getElementById'](_0x311e9d(0x8ce)), _0x2fdf43 = document[_0x311e9d(0x3a7)]('add-chat-button'), _0x3d0fe2 = document[_0x311e9d(0x3a7)](_0x311e9d(0x6b7)), _0x5a2162 = document[_0x311e9d(0x3a7)](_0x311e9d(0x72a)), _0x3a20f5 = document['getElementById'](_0x311e9d(0x654)), _0x407cfd = document[_0x311e9d(0x3a7)](_0x311e9d(0x57a)), _0x1fa2c8 = document[_0x311e9d(0x3a7)](_0x311e9d(0xfd)), _0x1b9fb8 = document[_0x311e9d(0x3a7)]('quote-preview-area'), _0x561089 = document[_0x311e9d(0x3a7)](_0x311e9d(0x694)), _0x339e27 = document['getElementById'](_0x311e9d(0x5e5)), _0x4d46b6 = document['getElementById']('cancel-quote-button'), _0x4d1206 = document[_0x311e9d(0x3a7)](_0x311e9d(0x11b)), _0x24fb32 = document[_0x311e9d(0x3a7)](_0x311e9d(0x70e)), _0x333188 = document['getElementById'](_0x311e9d(0xd5)), _0x55fe13 = document['getElementById']('chat-image-button'), _0x1aed37 = document[_0x311e9d(0x3a7)](_0x311e9d(0x6a5)), _0x46cd3b = document['getElementById'](_0x311e9d(0x1b7)), _0x9d1a69 = document['getElementById'](_0x311e9d(0x505)), _0xb7dfd6 = document[_0x311e9d(0x3a7)](_0x311e9d(0x254)), _0x2008c6 = document[_0x311e9d(0x3a7)](_0x311e9d(0x689)), _0x5cc388 = document[_0x311e9d(0x3a7)](_0x311e9d(0x6b6)), _0x5d84ab = document[_0x311e9d(0x3a7)]('save-api-settings-button'), _0x34450d = document[_0x311e9d(0x3a7)](_0x311e9d(0x432)), _0x15938e = document[_0x311e9d(0x3a7)]('model-dropdown'), _0x1b6a81 = document['getElementById']('context-lines-per-chat'), _0x4314a9 = document[_0x311e9d(0x3a7)](_0x311e9d(0x52c)), _0x2a99e4 = document[_0x311e9d(0x3a7)](_0x311e9d(0x211)), _0x4b8d4d = document['getElementById'](_0x311e9d(0xe3)), _0x37ea6e = document[_0x311e9d(0x3a7)](_0x311e9d(0x6ac)), _0x4f0835 = document['getElementById'](_0x311e9d(0x636)), _0x35cc5b = document['getElementById'](_0x311e9d(0x787)), _0x2f12dc = document[_0x311e9d(0x3a7)](_0x311e9d(0x794)), _0x21e8b2 = document[_0x311e9d(0x3a7)](_0x311e9d(0x21a)), _0x241bc7 = document[_0x311e9d(0x3a7)]('char-edit-remark'), _0x216a74 = document[_0x311e9d(0x3a7)](_0x311e9d(0x881)), _0x55562a = document[_0x311e9d(0x3a7)](_0x311e9d(0x7f1)), _0x82a905 = document['getElementById'](_0x311e9d(0x773)), _0xaba894 = document[_0x311e9d(0x3a7)](_0x311e9d(0x3ac)), _0x5023b3 = document[_0x311e9d(0x3a7)]('edit-clear-history-button'), _0x23d2e6 = document[_0x311e9d(0x3a7)]('edit-delete-char-button'); let _0x23145c = null; const _0x3ce627 = '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', _0x62d7d2 = _0x311e9d(0x152); _0x40321a = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x311e9d(0x1c0), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x544cbe() { const _0x5d9097 = _0x311e9d; try { const _0x31fbdb = { 'characters': _0x40321a[_0x5d9097(0x382)], 'worldBooks': _0x40321a[_0x5d9097(0x5e7)], 'chats': _0x40321a['chats'], 'userProfile': _0x40321a[_0x5d9097(0x92)], 'apiSettings': _0x40321a['apiSettings'], 'preferences': _0x40321a[_0x5d9097(0x42f)], 'activeChatId': _0x40321a[_0x5d9097(0x1cc)], 'diaries': _0x40321a['diaries'], 'friendCircles': _0x40321a[_0x5d9097(0x7ab)], 'activeFriendCircleId': _0x40321a[_0x5d9097(0x57c)], 'userProfiles': _0x40321a[_0x5d9097(0x7c0)], 'activeUserProfileId': _0x40321a[_0x5d9097(0x17e)], 'accountingData': _0x40321a[_0x5d9097(0x14c)], 'accountingLedger': _0x40321a[_0x5d9097(0x41b)] }; localStorage[_0x5d9097(0x7aa)](_0x5d9097(0x764), JSON[_0x5d9097(0x504)](_0x31fbdb)); } catch (_0x1a451a) { _0x5d9097(0x121) === 'eRTOy' ? _0x29464c(_0x5d9097(0x687)) : (console['error'](_0x5d9097(0xbf), _0x1a451a), _0x1bbd68(_0x5d9097(0x5f0))); } } function _0x4cad55() { const _0x204197 = _0x311e9d; let _0x59c180 = null; try { 'tPSQI' === _0x204197(0x4ba) ? (_0x293f92['entries']['splice'](_0x9be16a, 0x1), _0x2581b5(), _0x201756(), _0x568a7c(_0x204197(0x1d6))) : _0x59c180 = localStorage[_0x204197(0x8b4)](_0x204197(0x764)); } catch (_0x2f065e) { console[_0x204197(0x159)](_0x204197(0x1aa), _0x2f065e), _0x1bbd68(_0x204197(0x422)); } if (_0x59c180) try { if ('FCUvV' === _0x204197(0x7d6)) _0x49a86f[_0x204197(0x425)](), _0x18b774(); else { const _0xb1bb11 = JSON['parse'](_0x59c180); if (!_0xb1bb11 || typeof _0xb1bb11 !== 'object') throw new Error(_0x204197(0x7be)); Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x382)]) && (_0x204197(0x35e) === _0x204197(0x378) ? _0x2bd384 = _0x5ac383['image'] : _0x40321a[_0x204197(0x382)] = _0xb1bb11[_0x204197(0x382)][_0x204197(0x7cc)](_0xa82343 => ({ 'offlineBackground': '', ..._0xa82343 }))['filter'](_0x11b7f6 => _0x11b7f6 && typeof _0x11b7f6 === _0x204197(0x645) && _0x11b7f6['id'])); _0xb1bb11[_0x204197(0x14c)] && (_0x204197(0x139) !== 'UrRQp' ? _0x39a5be(_0x204197(0x218) + _0x185602['message']) : _0x40321a[_0x204197(0x14c)] = _0xb1bb11[_0x204197(0x14c)]); if (_0xb1bb11[_0x204197(0x41b)]) { if (_0x204197(0x5af) !== _0x204197(0x2ad)) _0x40321a[_0x204197(0x41b)] = _0xb1bb11[_0x204197(0x41b)]; else { _0x3dadef[_0x204197(0x49f)] = _0x204197(0x197), _0xc534f3[_0x204197(0x49f)] = _0x204197(0x3d7), _0x1adeb2[_0x204197(0x3a7)](_0x204197(0x182))[_0x204197(0x215)](_0x204197(0x236), _0x420f44), _0x28f560['getElementById']('diary-get-reply-button')[_0x204197(0x215)](_0x204197(0x236), _0x4851ce); return; } } Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x5e7)]) && (_0x40321a[_0x204197(0x5e7)] = _0xb1bb11[_0x204197(0x5e7)]); if (Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x7e5)])) { if ('oZLRx' === _0x204197(0x65c)) _0x40321a[_0x204197(0x7e5)] = _0xb1bb11['diaries']; else { const _0x2716ae = _0x587f18['getElementById']('theme-hue-slider'); if (!_0x2716ae) return; const _0x2aba72 = _0x70a1cb[_0x204197(0x8b4)](_0x204197(0x20b)) || '35'; _0x2daee6[_0x204197(0x7f9)]['style'][_0x204197(0x31d)](_0x204197(0x6cc), _0x2aba72), _0x2716ae[_0x204197(0x815)] = _0x2aba72, _0x2716ae['addEventListener'](_0x204197(0x54c), () => { const _0x18672b = _0x204197, _0x1a70e1 = _0x2716ae['value']; _0x39754b[_0x18672b(0x7f9)][_0x18672b(0x27d)][_0x18672b(0x31d)](_0x18672b(0x6cc), _0x1a70e1), _0x6e72f3[_0x18672b(0x7aa)]('themeHue', _0x1a70e1), _0x3949f3(); }); } } if (Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x7ab)])) _0x40321a[_0x204197(0x7ab)] = _0xb1bb11[_0x204197(0x7ab)], _0x40321a[_0x204197(0x57c)] = _0xb1bb11[_0x204197(0x57c)]; else { if (Array[_0x204197(0x1d4)](_0xb1bb11['musicFeed']) && _0xb1bb11[_0x204197(0x1c8)][_0x204197(0x286)] > 0x0) { console[_0x204197(0x336)](_0x204197(0xf6)); const _0x3645d6 = { 'id': 'circle_' + Date[_0x204197(0x6bb)](), 'name': '我的动态', 'boundUserProfileId': _0xb1bb11[_0x204197(0x17e)], 'memberCharacterIds': _0xb1bb11[_0x204197(0x382)][_0x204197(0x7cc)](_0x14ab9f => _0x14ab9f['id']), 'posts': _0xb1bb11[_0x204197(0x1c8)] }; _0x40321a[_0x204197(0x7ab)] = [_0x3645d6], _0x40321a[_0x204197(0x57c)] = _0x3645d6['id']; } } if (Array['isArray'](_0xb1bb11[_0x204197(0x7c0)])) _0x204197(0x345) !== 'BTyUU' ? (_0x40321a['userProfiles'] = _0xb1bb11[_0x204197(0x7c0)], _0x40321a[_0x204197(0x17e)] = _0xb1bb11['activeUserProfileId']) : _0xfb3352[_0x204197(0x815)] = ''; else { if (_0xb1bb11['userProfile']) { if (_0x204197(0x435) === _0x204197(0x435)) { console['log'](_0x204197(0x3c2)); const _0xa465f2 = { 'id': 'user_' + Date[_0x204197(0x6bb)](), 'name': _0xb1bb11[_0x204197(0x92)][_0x204197(0x2e6)] || '我', 'avatar': _0xb1bb11[_0x204197(0x92)][_0x204197(0xe7)] || _0x579f27, 'persona': _0xb1bb11[_0x204197(0x92)]['persona'] || '' }; _0x40321a[_0x204197(0x7c0)] = [_0xa465f2], _0x40321a[_0x204197(0x17e)] = _0xa465f2['id']; } else _0x4f32e6[_0x204197(0x1c1)][_0x204197(0x47e)](_0x204197(0xa9), _0x204197(0x60d)), _0x414d18[_0x204197(0x1c1)][_0x204197(0x47e)]('is-entering-from-left'), _0x3eb840['diaryCurrentPage'] = _0x542f1b, _0x280edd(), _0x4e1073[_0x204197(0x8ca)] = ![]; } } _0xb1bb11[_0x204197(0x5ee)] && typeof _0xb1bb11[_0x204197(0x5ee)] === _0x204197(0x645) && (_0x204197(0x127) === 'aRPFS' ? _0x40321a[_0x204197(0x5ee)] = { ..._0x40321a['apiSettings'], ..._0xb1bb11['apiSettings'] } : _0x5e3f4a[_0x204197(0x7aa)](_0x21413d, _0x360f9a[_0x204197(0x504)](_0x587e53))); _0xb1bb11[_0x204197(0x42f)] && typeof _0xb1bb11[_0x204197(0x42f)] === 'object' ? _0x40321a['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0xb1bb11[_0x204197(0x42f)] } : _0x40321a[_0x204197(0x42f)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x478)])) _0x40321a[_0x204197(0x478)] = _0xb1bb11['chats'], _0x40321a[_0x204197(0x1cc)] = _0xb1bb11['activeChatId'] || null; else Array[_0x204197(0x1d4)](_0xb1bb11[_0x204197(0x382)]) && (console[_0x204197(0x336)](_0x204197(0x714)), _0x40321a[_0x204197(0x478)] = _0xb1bb11[_0x204197(0x382)][_0x204197(0x7cc)](_0x2ffe48 => ({ 'id': _0x204197(0x1bd) + _0x2ffe48['id'], 'type': _0x204197(0x64f), 'participantIds': [_0x2ffe48['id']] })), _0xb1bb11[_0x204197(0x65a)] && (_0x40321a[_0x204197(0x1cc)] = _0x204197(0x1bd) + _0xb1bb11[_0x204197(0x65a)]), _0xb1bb11['characters']['forEach'](_0xf56a83 => { const _0x2763a9 = _0x204197, _0x4ba217 = 'chatHistory_' + _0xf56a83['id'], _0x160fda = 'chatHistory_chat_' + _0xf56a83['id'], _0xdd145a = localStorage['getItem'](_0x4ba217); if (_0xdd145a) { if (_0x2763a9(0x863) === 'TMQxQ') localStorage[_0x2763a9(0x7aa)](_0x160fda, _0xdd145a), localStorage[_0x2763a9(0x73)](_0x4ba217); else return { 'type': _0x2763a9(0x44f), 'content': _0x252d01 }; } })); } } catch (_0x472b7a) { console[_0x204197(0x159)](_0x204197(0x835), _0x472b7a), _0x40321a[_0x204197(0x382)] = [], _0x40321a[_0x204197(0x478)] = [], _0x40321a['activeChatId'] = null; try { localStorage[_0x204197(0x73)](_0x204197(0x764)); } catch (_0x5699ab) { console[_0x204197(0x159)]('Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', _0x5699ab); } } let _0x5d3e0c = ![]; if (_0x40321a[_0x204197(0x382)][_0x204197(0x286)] === 0x0) _0x5d3e0c = !![], _0x40321a['activeChatId'] = null; else !_0x40321a[_0x204197(0x478)][_0x204197(0x226)](_0x3c322c => _0x3c322c['id'] === _0x40321a[_0x204197(0x1cc)]) && (_0x204197(0x1e7) !== 'lCvKf' ? _0x29da28[_0x204197(0x27d)][_0x204197(0xb3)] = _0x204197(0x87b) : _0x40321a[_0x204197(0x1cc)] = _0x40321a['chats'][0x0]?.['id'] || null); return _0x544cbe(), _0x5d3e0c; } function _0x174e50() { const _0x3f3b27 = _0x311e9d; if (!_0x40321a[_0x3f3b27(0x1cc)]) return; try { localStorage[_0x3f3b27(0x7aa)]('chatHistory_' + _0x40321a[_0x3f3b27(0x1cc)], JSON[_0x3f3b27(0x504)](_0x40321a[_0x3f3b27(0x393)])); } catch (_0x55d3ca) { console[_0x3f3b27(0x159)](_0x3f3b27(0x195), _0x55d3ca), _0x1bbd68(_0x3f3b27(0x81e)); } } function _0x5f2acc() { const _0x2e94b0 = _0x311e9d; if (_0x2e94b0(0x6d1) !== _0x2e94b0(0x454)) { if (!_0x40321a[_0x2e94b0(0x1cc)]) { if ('ciyHW' !== _0x2e94b0(0x79c)) { _0x40321a[_0x2e94b0(0x393)] = [], _0x259a7d(); return; } else _0x4bb22c[_0x2e94b0(0x159)](_0x2e94b0(0x151) + _0x26a03a, _0x49a770); } let _0x58a4c4 = null; try { _0x2e94b0(0x5ed) === 'XhckW' ? _0x58a4c4 = localStorage[_0x2e94b0(0x8b4)]('chatHistory_' + _0x40321a[_0x2e94b0(0x1cc)]) : _0x3ce2d6 = _0x2e94b0(0x8d) + _0x41fcd8[_0x2e94b0(0xe7)] + _0x2e94b0(0x7fd) + _0x3f9e65[_0x2e94b0(0x2e6)] + _0x2e94b0(0x6b9) + _0x56e427[_0x2e94b0(0x58f)]['text'] + '</div></div></div>'; } catch (_0x4a1325) { console[_0x2e94b0(0x159)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x40321a[_0x2e94b0(0x1cc)], _0x4a1325); } let _0x5182ec = []; if (_0x58a4c4) try { const _0x174bfc = JSON['parse'](_0x58a4c4); Array[_0x2e94b0(0x1d4)](_0x174bfc) && (_0x5182ec = _0x174bfc[_0x2e94b0(0x16f)](_0x28bde1 => _0x28bde1 && typeof _0x28bde1 === _0x2e94b0(0x645) && typeof _0x28bde1[_0x2e94b0(0x837)] === _0x2e94b0(0xac) && typeof _0x28bde1[_0x2e94b0(0x812)] !== _0x2e94b0(0x570))); } catch (_0x826ddb) { console['error'](_0x2e94b0(0x41d) + _0x40321a['activeChatId'] + _0x2e94b0(0x6b4), _0x826ddb); try { _0x2e94b0(0x8c1) === _0x2e94b0(0x8c1) ? localStorage[_0x2e94b0(0x73)]('chatHistory_' + _0x40321a[_0x2e94b0(0x1cc)]) : _0x499679[_0x2e94b0(0x1fb)](_0x310909['id']); } catch (_0x1f795f) { _0x2e94b0(0x245) !== _0x2e94b0(0x4d7) ? console['error'](_0x2e94b0(0x46c), _0x1f795f) : (_0xfbe57e[_0x2e94b0(0x8c7)] = _0x2dceaa['createObjectURL'](_0x4b3741), _0x4bd947[_0x2e94b0(0x27d)][_0x2e94b0(0x3ab)] = 0x1); } } _0x40321a[_0x2e94b0(0x393)] = _0x5182ec, _0x5a2162[_0x2e94b0(0x49f)] = '', _0x40321a[_0x2e94b0(0x393)] && _0x40321a[_0x2e94b0(0x393)][_0x2e94b0(0x436)]((_0x56f600, _0x40f573) => _0xe4f38d(_0x56f600, _0x40f573)), setTimeout(() => { const _0x1d7e36 = _0x2e94b0; _0x1d7e36(0x6d5) !== _0x1d7e36(0x6d5) ? (_0x4e0678(), _0xf31f86(![])) : _0x5a2162[_0x1d7e36(0x19c)] = _0x5a2162['scrollHeight']; }, 0x0); } else _0x3d8317[_0x2e94b0(0x27d)][_0x2e94b0(0xb3)] = ''; } async function _0x584808() { const _0x3ebede = _0x311e9d, _0x744f86 = document[_0x3ebede(0x3a7)](_0x3ebede(0x190)); try { let _0x5c0adf = await _0x500f4d(_0x3ebede(0x53d)); if (!_0x5c0adf) { if (_0x3ebede(0x539) !== _0x3ebede(0x539)) _0xc5f329(), _0x1d30c4('musicLibrary', _0x3ebede(0x519)); else { const _0x6fe6e1 = localStorage[_0x3ebede(0x8b4)](_0x3ebede(0x682)); _0x6fe6e1 && (console[_0x3ebede(0x336)](_0x3ebede(0x5ae)), _0x5c0adf = await _0x3cb589(_0x6fe6e1), await _0x5c7ad7(_0x3ebede(0x53d), _0x5c0adf), localStorage[_0x3ebede(0x73)](_0x3ebede(0x682))); } } _0x5c0adf ? (_0x744f86['style'][_0x3ebede(0xb3)] = _0x3ebede(0x462) + URL[_0x3ebede(0x99)](_0x5c0adf) + ')', _0x744f86['style'][_0x3ebede(0x4b0)] = _0x3ebede(0x59e), _0x744f86[_0x3ebede(0x27d)][_0x3ebede(0x424)] = _0x3ebede(0x50d)) : _0x744f86[_0x3ebede(0x27d)][_0x3ebede(0xb3)] = ''; } catch (_0x3397ff) { if (_0x3ebede(0x29e) === 'ljZDd') { const _0x44c264 = new _0x135b8d(_0xfe2424[_0x3ebede(0x375)]), _0x443605 = _0x44c264[_0x3ebede(0x1b2)]() + '-' + _0x207ac9(_0x44c264['getMonth']() + 0x1)['padStart'](0x2, '0') + '-' + _0x460cef(_0x44c264[_0x3ebede(0xec)]())[_0x3ebede(0x26e)](0x2, '0'), _0xa0216d = _0x2079c5(_0x44c264[_0x3ebede(0x499)]())[_0x3ebede(0x26e)](0x2, '0') + ':' + _0x3a8f5d(_0x44c264['getMinutes']())[_0x3ebede(0x26e)](0x2, '0'); let _0x1cfcf9 = '未知'; _0x57070c['role'] === _0x3ebede(0x447) ? _0x1cfcf9 = _0x5dfaca[_0x3ebede(0x2e6)] : _0x1cfcf9 = _0x2324dc[_0x3ebede(0x2e6)]; let _0x17302f = _0x4b9d6e[_0x3ebede(0x812)]; if (_0x2b439c[_0x3ebede(0x220)]) _0x17302f = _0x3ebede(0x73c); if (_0x3a0024[_0x3ebede(0x3a0)]) _0x17302f = '[发送了图片]'; return '[' + _0x443605 + '\x20' + _0xa0216d + ']\x20[' + _0x1cfcf9 + _0x3ebede(0x7ef) + _0x17302f; } else console['error'](_0x3ebede(0x624), _0x3397ff), phoneContainer[_0x3ebede(0x27d)][_0x3ebede(0xb3)] = ''; } } function _0x3d6fe9() { const _0x1bde69 = _0x311e9d; if (_0x1bde69(0x5ca) !== 'ygFVv') { const _0x1ce815 = _0x321d29[_0x1bde69(0x7c0)]['find'](_0x114daa => _0x114daa['id'] === _0x303d9b); if (!_0x1ce815) return; _0x1ba50e['getElementById'](_0x1bde69(0x11d))[_0x1bde69(0x815)] = _0x1ce815['id'], _0x423958['getElementById'](_0x1bde69(0x5bf))[_0x1bde69(0x26b)] = _0x1bde69(0x3e6), _0x494d60[_0x1bde69(0x3a7)](_0x1bde69(0x52c))[_0x1bde69(0x815)] = _0x1ce815[_0x1bde69(0x2e6)], _0x2c0f28[_0x1bde69(0x3a7)](_0x1bde69(0x211))[_0x1bde69(0x8c7)] = _0x1ce815[_0x1bde69(0xe7)], _0x19606c['getElementById'](_0x1bde69(0x6ac))['value'] = _0x1ce815[_0x1bde69(0x838)], _0x2bc2d4[_0x1bde69(0x27d)][_0x1bde69(0x5a4)] = _0x1ce815['id'] === _0xf325ac[_0x1bde69(0x17e)] ? 'none' : _0x1bde69(0x7dc); } else { const _0x1bd692 = localStorage['getItem']('customFeedWallpaper'); if (_0x1bd692) { if (_0x1bde69(0x7af) !== _0x1bde69(0x7af)) { if (_0x2e156b) _0x202ab6['click'](); } else document[_0x1bde69(0x3a7)](_0x1bde69(0x64b))['style'][_0x1bde69(0x31d)](_0x1bde69(0x438), _0x1bde69(0x462) + _0x1bd692 + ')'); } else document['getElementById']('music-screen')[_0x1bde69(0x27d)][_0x1bde69(0x31d)](_0x1bde69(0x438), _0x1bde69(0x87b)); } } async function _0x211cc7(_0x4b4414) { const _0x479f5e = _0x311e9d; try { if (_0x479f5e(0x814) !== _0x479f5e(0x77b)) await _0x5c7ad7(_0x479f5e(0x53d), _0x4b4414), await _0x584808(), _0x1bbd68(_0x479f5e(0x2e4)); else { if (_0x16813b[_0x479f5e(0x78c)] === _0x479f5e(0x3bc)) return _0x479f5e(0x513) + (_0x25db2b[_0x479f5e(0x2e6)] || _0x479f5e(0x810)) + '」'; const _0x53f9b9 = _0x1663c2(_0x534ba5[_0x479f5e(0x239)][0x0]); return '与\x20' + (_0x53f9b9?.[_0x479f5e(0x2e6)] || '未知角色') + _0x479f5e(0x29a); } } catch (_0x406bf1) { console['error'](_0x479f5e(0x753), _0x406bf1), _0x1bbd68(_0x479f5e(0x2c3) + _0x406bf1['message']); } } function _0x498576(_0x1bcafe) { const _0xf2939 = _0x311e9d; if (_0xf2939(0x22f) === _0xf2939(0x651)) _0xbca215[_0xf2939(0xbb)](_0x20bfe0, _0x213f18[_0xf2939(0x84a)]); else { const _0x3f87f9 = { 'quotedMessage': null, 'content': _0x1bcafe }, _0x318a68 = _0x1bcafe[_0xf2939(0x33f)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x318a68 && (_0x3f87f9[_0xf2939(0x581)] = { 'sender': _0x318a68[0x1][_0xf2939(0x3e3)](), 'content': _0x318a68[0x2][_0xf2939(0x3e3)]() }, _0x3f87f9[_0xf2939(0x812)] = _0x1bcafe[_0xf2939(0x23c)](_0x318a68[0x0][_0xf2939(0x286)])['trim']()), _0x3f87f9; } } const _0x45d608 = document[_0x311e9d(0x3a7)](_0x311e9d(0x8a)), _0x3846bc = document[_0x311e9d(0x3a7)]('message-action-backdrop'), _0x150b02 = document[_0x311e9d(0x3a7)](_0x311e9d(0x6c1)), _0x280ca0 = document[_0x311e9d(0x3a7)](_0x311e9d(0x53a)), _0x4a4502 = document[_0x311e9d(0x3a7)]('cancel-action-button'), _0x4769e8 = document[_0x311e9d(0x3a7)](_0x311e9d(0x2db)), _0x488795 = document[_0x311e9d(0x3a7)]('edit-message-modal'), _0x2accac = document[_0x311e9d(0x3a7)](_0x311e9d(0x69a)), _0x2e36cb = document[_0x311e9d(0x3a7)](_0x311e9d(0x56c)), _0x47e265 = document[_0x311e9d(0x3a7)]('save-edit-button'), _0x37e979 = document[_0x311e9d(0x3a7)](_0x311e9d(0x88a)); let _0x940a94 = null; function _0x235508(_0x41d3d8) { const _0x4ec182 = _0x311e9d; _0x940a94 = _0x41d3d8, _0x45d608['classList']['add'](_0x4ec182(0x7de)); } function _0x492ed7() { const _0x17ca31 = _0x311e9d; _0x45d608[_0x17ca31(0x1c1)][_0x17ca31(0x47e)]('show'); } function _0x5b7efc() { _0x492ed7(), _0x940a94 = null; } function _0x3c409c() { const _0x45de26 = _0x311e9d; if ('gSpqR' !== _0x45de26(0x841)) { if (_0x940a94 === null) return; _0x40321a['conversationHistory'][_0x45de26(0x855)](_0x940a94, 0x1), _0x174e50(), _0x1f2014(), _0x5b7efc(); } else _0x544c50[_0x45de26(0x27d)][_0x45de26(0x5a4)] = _0x45de26(0x7dc); } function _0x864a6e() { const _0x584674 = _0x311e9d; if (_0x940a94 === null) return; const _0x2781a0 = _0x40321a[_0x584674(0x393)][_0x940a94]; if (!_0x2781a0) return; _0x2e36cb[_0x584674(0x815)] = _0x2781a0[_0x584674(0x812)], _0x492ed7(), _0x488795['classList']['add']('show'), _0x2e36cb[_0x584674(0x7c9)](); } function _0x4170da() { const _0x21e2ed = _0x311e9d; if (_0x940a94 === null) return; const _0x639ee6 = _0x2e36cb[_0x21e2ed(0x815)][_0x21e2ed(0x3e3)](); if (_0x639ee6 === '') { _0x35be1a(); return; } const _0x532396 = _0x40321a['conversationHistory'][_0x940a94]; _0x532396 && (_0x532396[_0x21e2ed(0x812)] = _0x639ee6, _0x174e50(), _0x1f2014()), _0x488795[_0x21e2ed(0x1c1)]['remove']('show'), _0x940a94 = null; } function _0x35be1a() { const _0x134792 = _0x311e9d; _0x488795[_0x134792(0x1c1)][_0x134792(0x47e)](_0x134792(0x7de)), _0x940a94 = null; } _0x3846bc['addEventListener'](_0x311e9d(0x236), _0x5b7efc), _0x4a4502['addEventListener'](_0x311e9d(0x236), _0x5b7efc), _0x280ca0[_0x311e9d(0x215)](_0x311e9d(0x236), _0x3c409c), _0x150b02[_0x311e9d(0x215)]('click', _0x864a6e), _0x4769e8[_0x311e9d(0x215)](_0x311e9d(0x236), _0x293c41), _0x4d46b6[_0x311e9d(0x215)]('click', _0x3fb3b2), _0x47e265['addEventListener'](_0x311e9d(0x236), _0x4170da), _0x37e979[_0x311e9d(0x215)](_0x311e9d(0x236), _0x35be1a), _0x2accac[_0x311e9d(0x215)](_0x311e9d(0x236), _0x35be1a); function _0x293c41() { const _0x144ef6 = _0x311e9d; if (_0x940a94 === null) return; const _0x5172e8 = _0x40321a[_0x144ef6(0x393)][_0x940a94]; if (!_0x5172e8) return; const _0x4f6019 = _0x4db4a7(); let _0x56b319 = '未知'; if (_0x5172e8[_0x144ef6(0x837)] === _0x144ef6(0x447)) _0x56b319 = _0x40321a[_0x144ef6(0x92)][_0x144ef6(0x2e6)] || '我'; else { const _0x4fe5f8 = _0x5172e8[_0x144ef6(0x2b9)] || _0x4f6019?.[_0x144ef6(0x239)][0x0], _0x42a584 = _0x3f1cb7(_0x4fe5f8); _0x56b319 = _0x42a584 ? _0x42a584[_0x144ef6(0x2e6)] : '角色'; } let _0x173855 = _0x5172e8[_0x144ef6(0x812)] || ''; if (_0x5172e8[_0x144ef6(0x220)]) _0x173855 = _0x144ef6(0x6de); if (_0x5172e8['image']) _0x173855 = _0x144ef6(0x49a); if (_0x173855['length'] > 0x32) _0x173855 = _0x173855['substring'](0x0, 0x32) + '...'; _0x40321a[_0x144ef6(0x8bc)] = { 'sender': _0x56b319, 'content': _0x173855 }, _0x355a4a(), _0x5b7efc(), _0x3a20f5[_0x144ef6(0x7c9)](); } function _0x355a4a() { const _0x6ea3fe = _0x311e9d; if (!_0x40321a[_0x6ea3fe(0x8bc)]) return; _0x561089[_0x6ea3fe(0x26b)] = _0x6ea3fe(0x357) + _0x40321a['activeQuote'][_0x6ea3fe(0x353)], _0x339e27[_0x6ea3fe(0x26b)] = _0x40321a[_0x6ea3fe(0x8bc)][_0x6ea3fe(0x812)], _0x1b9fb8[_0x6ea3fe(0x27d)][_0x6ea3fe(0x5a4)] = _0x6ea3fe(0x7dc); } function _0x3fb3b2() { const _0x6851b9 = _0x311e9d; _0x6851b9(0x8b8) !== _0x6851b9(0x8b8) ? (_0x33a115[_0x6851b9(0x42f)][_0x6851b9(0x113)] = null, _0x7a5cca(), _0x34e3f5(), _0x30068f(_0x6851b9(0x7a7))) : (_0x40321a[_0x6851b9(0x8bc)] = null, _0x1b9fb8[_0x6851b9(0x27d)][_0x6851b9(0x5a4)] = _0x6851b9(0x87b)); } function _0x6564ff(_0x269f7c, _0x290c04) { const _0x28e6cb = _0x311e9d, _0x5663bc = document['getElementById'](_0x28e6cb(0x6f3)); _0x5663bc && (_0x269f7c === 'home' ? _0x28e6cb(0x416) === 'rRsYI' ? _0x5663bc[_0x28e6cb(0x27d)][_0x28e6cb(0x5a4)] = _0x28e6cb(0x73a) : _0x17ba0f(_0x28e6cb(0x647)) : _0x5663bc[_0x28e6cb(0x27d)][_0x28e6cb(0x5a4)] = _0x28e6cb(0x87b)), _0x23145c = _0x290c04 || null, Object['values'](_0x362d4b)[_0x28e6cb(0x436)](_0x9b6ede => _0x9b6ede[_0x28e6cb(0x1c1)][_0x28e6cb(0x47e)](_0x28e6cb(0x21b))), _0x362d4b[_0x269f7c] && _0x362d4b[_0x269f7c][_0x28e6cb(0x1c1)][_0x28e6cb(0x65b)]('active'), _0x269f7c !== _0x28e6cb(0x8da) && _0x3d0fe2[_0x28e6cb(0x1c1)][_0x28e6cb(0x47e)](_0x28e6cb(0x6d4)); } function _0x22cc08(_0x6b3c80) { const _0x2c58f4 = _0x311e9d; if ('CbwmW' === _0x2c58f4(0x112)) _0x6b3c80 ? 'cSwRY' !== _0x2c58f4(0x87e) ? _0x3d0fe2[_0x2c58f4(0x1c1)]['add'](_0x2c58f4(0x6d4)) : _0x6ce1d[_0x2c58f4(0x159)](_0x2c58f4(0x133), _0x3d6845) : _0x3d0fe2[_0x2c58f4(0x1c1)][_0x2c58f4(0x47e)](_0x2c58f4(0x6d4)); else { const _0x1036a3 = _0x4617da[_0x2c58f4(0x3a7)]('theme-lightness-slider'); if (!_0x1036a3) return; const _0x5f1ab9 = _0x582317[_0x2c58f4(0x8b4)]('themeLightness') || '80'; _0x7606ad[_0x2c58f4(0x7f9)][_0x2c58f4(0x27d)][_0x2c58f4(0x31d)](_0x2c58f4(0x3fb), _0x5f1ab9 + '%'), _0x1036a3[_0x2c58f4(0x815)] = _0x5f1ab9, _0x1036a3[_0x2c58f4(0x215)](_0x2c58f4(0x54c), () => { const _0x28bdbb = _0x2c58f4, _0x1ee193 = _0x1036a3[_0x28bdbb(0x815)]; _0x1accc3[_0x28bdbb(0x7f9)][_0x28bdbb(0x27d)][_0x28bdbb(0x31d)](_0x28bdbb(0x3fb), _0x1ee193 + '%'), _0x412997[_0x28bdbb(0x7aa)](_0x28bdbb(0x271), _0x1ee193), _0x5824c3(); }); } } async function _0x5af13e() { const _0x57a057 = _0x311e9d; if ('ZHjXs' === 'ZHjXs') { _0x160dc3['innerHTML'] = ''; for (const _0x216709 of _0x40321a['chats']) { const _0xec9f6e = document['createElement']('li'); _0xec9f6e[_0x57a057(0x8d8)] = 'character-item', _0xec9f6e[_0x57a057(0x58e)]['id'] = _0x216709['id']; let _0x3f1a61 = _0x4716b3, _0x507a25 = '群聊', _0x56cd1d = ''; if (_0x216709[_0x57a057(0x78c)] === _0x57a057(0x64f)) { const _0x403bcb = _0x3f1cb7(_0x216709[_0x57a057(0x239)][0x0]); _0x403bcb ? (_0x3f1a61 = _0x403bcb[_0x57a057(0xe7)] || _0x4716b3, _0x507a25 = _0x403bcb['name'] || '未命名角色', _0x56cd1d = _0x403bcb['remark'] || '私聊') : (_0x507a25 = _0x57a057(0x864), _0x56cd1d = _0x57a057(0x4f4)); } else { if (_0x57a057(0x595) === _0x57a057(0x532)) _0x497512[_0x57a057(0x159)](_0x57a057(0x2b3), _0x1e3759, _0x57a057(0x1ca), _0x3d6d4b), _0x263a27[_0x57a057(0x393)][_0x57a057(0x1fb)]({ 'role': 'assistant', 'senderId': _0x564ff3['id'], 'timestamp': _0x1e83cf['now'](), 'isOffline': !![], 'content': _0x57a057(0x33b) + _0x5ce480 + ']' }); else { _0x507a25 = _0x216709['name'] || '未命名群聊', _0x56cd1d = _0x216709[_0x57a057(0x239)]['length'] + _0x57a057(0x522); const _0x5c6881 = await _0x500f4d('group_avatar_' + _0x216709['id']); if (_0x5c6881) _0x3f1a61 = URL[_0x57a057(0x99)](_0x5c6881); } } _0xec9f6e[_0x57a057(0x49f)] = _0x57a057(0xe5) + _0x3f1a61 + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x507a25 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + _0x56cd1d + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0xec9f6e[_0x57a057(0x889)](_0x57a057(0x7da))[_0x57a057(0x215)](_0x57a057(0x236), () => { const _0x33e4e7 = _0x57a057; if (_0x33e4e7(0x60f) !== _0x33e4e7(0x60f)) return { 'role': _0x33e4e7(0x447), 'content': [{ 'type': 'text', 'text': _0x355d62[_0x33e4e7(0x812)] || '\x20' }, { 'type': _0x33e4e7(0x38d), 'image_url': { 'url': _0x5811c2[_0x33e4e7(0x888)], 'detail': _0x33e4e7(0x6e1) } }] }; else _0x3bb312(_0x216709['id']), _0x22cc08(!![]); }), _0x160dc3[_0x57a057(0x7d)](_0xec9f6e); } } else { const _0x4ee9ee = _0x4386e5['getElementById'](_0x57a057(0x521)); _0x4ee9ee['innerHTML'] = ''; if (_0x27bcc6[_0x57a057(0x5e7)][_0x57a057(0x286)] === 0x0) { _0x4ee9ee[_0x57a057(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } _0x1e936f[_0x57a057(0x5e7)]['forEach'](_0x2daee0 => { const _0x246794 = _0x57a057, _0x5ef5d5 = _0x32b443[_0x246794(0x3e8)]('div'); _0x5ef5d5[_0x246794(0x8d8)] = _0x246794(0x341), _0x5ef5d5[_0x246794(0x58e)]['id'] = _0x2daee0['id'], _0x5ef5d5[_0x246794(0x49f)] = _0x246794(0x578) + _0x2daee0[_0x246794(0x2e6)] + _0x246794(0x745) + _0x2daee0[_0x246794(0x812)][_0x246794(0x23c)](0x0, 0x64) + _0x246794(0x278), _0x5ef5d5[_0x246794(0x215)](_0x246794(0x236), () => _0x49235f(_0x2daee0['id'])), _0x4ee9ee[_0x246794(0x7d)](_0x5ef5d5); }); } } function _0x3a2f59() { const _0x51ad2f = _0x311e9d, _0xdd225c = document[_0x51ad2f(0x3a7)](_0x51ad2f(0x156)); _0xdd225c[_0x51ad2f(0x49f)] = ''; const _0x348550 = _0x40321a[_0x51ad2f(0x382)][_0x51ad2f(0x16f)](_0x2adb3f => _0x40321a[_0x51ad2f(0x478)][_0x51ad2f(0x204)](_0x3eb3c2 => _0x3eb3c2[_0x51ad2f(0x78c)] === _0x51ad2f(0x64f) && _0x3eb3c2[_0x51ad2f(0x239)][_0x51ad2f(0x4fe)](_0x2adb3f['id']))); if (_0x348550[_0x51ad2f(0x286)] === 0x0) { _0xdd225c[_0x51ad2f(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } _0x348550['forEach'](_0x2c3fbf => { const _0x4067a5 = _0x51ad2f, _0x3386ce = document[_0x4067a5(0x3e8)]('li'); _0x3386ce[_0x4067a5(0x8d8)] = _0x4067a5(0x55a), _0x3386ce[_0x4067a5(0x58e)][_0x4067a5(0x742)] = _0x2c3fbf['id'], _0x3386ce[_0x4067a5(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2c3fbf[_0x4067a5(0xe7)] || _0x4716b3) + _0x4067a5(0x643) + _0x2c3fbf[_0x4067a5(0x2e6)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x2c3fbf[_0x4067a5(0x36b)] || '私聊') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x3386ce[_0x4067a5(0x215)](_0x4067a5(0x236), () => { const _0x2e3b2c = _0x4067a5; _0x2e3b2c(0x276) === _0x2e3b2c(0x276) ? _0x22aafa(_0x2c3fbf['id']) : (_0x2fb2ab[_0x2e3b2c(0x8bc)] = null, _0x49988e[_0x2e3b2c(0x27d)]['display'] = _0x2e3b2c(0x87b)); }), _0xdd225c[_0x4067a5(0x7d)](_0x3386ce); }); } async function _0x22aafa(_0x14ef87) { const _0x470d11 = _0x311e9d, _0x24043b = _0x3f1cb7(_0x14ef87); if (!_0x24043b) return; document[_0x470d11(0x3a7)](_0x470d11(0x363))[_0x470d11(0x8c7)] = '', _0x40321a[_0x470d11(0x574)] = _0x14ef87; const _0x3e1e89 = _0x40321a[_0x470d11(0x478)][_0x470d11(0x226)](_0x1aea41 => _0x1aea41['type'] === _0x470d11(0x64f) && _0x1aea41['participantIds'][_0x470d11(0x4fe)](_0x14ef87)); _0x3e1e89 ? 'OmFOs' === 'nJAvP' ? (_0x58dd82(), _0x48f368(![])) : (_0x40321a['activeChatId'] = _0x3e1e89['id'], _0x544cbe(), _0x5f2acc(), _0x1eb237(_0x14ef87)) : _0x40321a[_0x470d11(0x393)] = []; document[_0x470d11(0x3a7)](_0x470d11(0x796))[_0x470d11(0x26b)] = _0x24043b['name']; const _0x39bb33 = document[_0x470d11(0x3a7)](_0x470d11(0x8b6)); try { if ('yySkl' === _0x470d11(0x230)) { const _0x37005b = _0x13a87b['parse'](_0x28ddf4); _0x2151c1[_0x470d11(0x1d4)](_0x37005b) && (_0x587586[_0x470d11(0x815)] = _0x37005b[_0x470d11(0x7cc)](_0x2e90ca => _0x2e90ca['name'] + '--' + _0x2e90ca[_0x470d11(0x5cb)])[_0x470d11(0x2c1)]('\x0a')); } else { const _0x32a35d = await _0x500f4d(_0x470d11(0x4dd) + _0x14ef87); _0x32a35d ? 'deGaD' === _0x470d11(0x1ef) ? (_0x306881 = _0x14b14d[_0x470d11(0xe7)] || _0x432b61, _0x554346 = _0x1c4a2c[_0x470d11(0x2e6)] || _0x470d11(0x34d), _0x2bfbb0 = _0x4caefb['remark'] || '私聊') : (_0x39bb33[_0x470d11(0x27d)][_0x470d11(0xb3)] = _0x470d11(0x3dd) + URL[_0x470d11(0x99)](_0x32a35d) + '\x27)', _0x39bb33[_0x470d11(0x27d)]['backgroundSize'] = _0x470d11(0x59e), _0x39bb33[_0x470d11(0x27d)][_0x470d11(0x424)] = 'center') : _0x39bb33[_0x470d11(0x27d)][_0x470d11(0xb3)] = _0x470d11(0x87b); } } catch (_0x2d0de0) { console[_0x470d11(0x159)](_0x470d11(0x138) + _0x14ef87 + ':', _0x2d0de0), _0x39bb33[_0x470d11(0x27d)][_0x470d11(0xb3)] = _0x470d11(0x87b); } _0x46828b(), _0xac5dfa(); if (_0x47adb1) clearInterval(_0x47adb1); _0x3a6fd9(), _0x47adb1 = setInterval(_0x3a6fd9, 0x2710), document[_0x470d11(0x3a7)](_0x470d11(0xf8))[_0x470d11(0x27d)]['display'] = _0x470d11(0x7dc), _0x6564ff(_0x470d11(0x17f), _0x470d11(0x318)); } function _0xac5dfa() { const _0x30cb01 = _0x311e9d; if (_0x30cb01(0x86a) === 'fUJSH') try { const _0x319870 = _0x259535[_0x30cb01(0x5b1)](_0xce4a0c); _0x1833c4[_0x30cb01(0x1d4)](_0x319870) && (_0x2424f4['value'] = _0x319870['map'](_0x727c5c => _0x727c5c[_0x30cb01(0x2e6)] + '--' + _0x727c5c['url'])[_0x30cb01(0x2c1)]('\x0a')); } catch (_0xe01138) { } else { const _0x1278c2 = document[_0x30cb01(0x3a7)](_0x30cb01(0x7b3)); _0x1278c2[_0x30cb01(0x49f)] = ''; const _0x4afa89 = _0x1278c2['querySelector']('#message-anchor'); if (_0x4afa89) _0x4afa89['remove'](); if (_0x40321a[_0x30cb01(0x393)]) { if (_0x30cb01(0x129) !== _0x30cb01(0x2c5)) _0x40321a[_0x30cb01(0x393)][_0x30cb01(0x436)]((_0xd9c21f, _0x1a3001) => { const _0x52f36d = _0x30cb01; if (_0x52f36d(0x78) === 'TJtks') _0xbc29d9 = _0x37796a['id']; else { if (!_0xd9c21f[_0x52f36d(0x7ec)] || _0xd9c21f[_0x52f36d(0x837)] === _0x52f36d(0x70d)) return; const _0x39407a = document[_0x52f36d(0x3e8)]('p'); _0x39407a[_0x52f36d(0x58e)][_0x52f36d(0x736)] = _0x1a3001; const _0x2ae3fb = _0xd9c21f[_0x52f36d(0x812)][_0x52f36d(0x3d9)](/\n/g, '<br>'); let _0xe559fc = '', _0x2c037d = ''; const _0x4283ec = _0x9333e5(_0x40321a[_0x52f36d(0x1cc)]); if (_0xd9c21f[_0x52f36d(0x837)] === _0x52f36d(0x447)) _0x52f36d(0xeb) === _0x52f36d(0xeb) ? (_0xe559fc = _0x4283ec['name'] || '我', _0x2c037d = _0x52f36d(0x66e)) : _0x132b26(_0x4e6721['id']); else { if (_0xd9c21f[_0x52f36d(0x837)] === _0x52f36d(0x18d)) { const _0x59bc2c = _0x3f1cb7(_0xd9c21f[_0x52f36d(0x2b9)] || _0x40321a['activeMeetingCharId']); _0xe559fc = _0x59bc2c?.[_0x52f36d(0x2e6)] || '角色', _0x2c037d = _0x52f36d(0x71); } } _0x39407a[_0x52f36d(0x27d)][_0x52f36d(0x1b0)] = 'rgba(0,\x200,\x200,\x200.4)', _0x39407a[_0x52f36d(0x27d)]['padding'] = _0x52f36d(0x6b2), _0x39407a[_0x52f36d(0x27d)]['borderRadius'] = _0x52f36d(0x861), _0x39407a['style'][_0x52f36d(0x307)] = '1em'; if (_0xe559fc) { if (_0x52f36d(0x429) !== _0x52f36d(0x429)) return new _0x495b89((_0x2f28a4, _0x46ac39) => { const _0x2e3e04 = _0x52f36d, _0x3e853f = new _0x33a3db(); _0x3e853f[_0x2e3e04(0x4e6)] = () => _0x2f28a4(_0x3e853f[_0x2e3e04(0x7ba)]), _0x3e853f[_0x2e3e04(0x3bd)] = _0x46ac39, _0x3e853f[_0x2e3e04(0x35d)](_0x4588a9); }); else _0x39407a['innerHTML'] = _0x52f36d(0x610) + _0x2c037d + _0x52f36d(0x630) + (_0x2c037d === _0x52f36d(0x66e) ? _0x52f36d(0x75e) : _0x52f36d(0xff)) + _0x52f36d(0x6c) + _0xe559fc + ':</span>\x20' + _0x2ae3fb; } else _0x39407a['className'] = _0x52f36d(0x37f), _0x39407a[_0x52f36d(0x27d)]['fontStyle'] = _0x52f36d(0x284), _0x39407a[_0x52f36d(0x27d)][_0x52f36d(0x86e)] = '#d1d5db', _0x39407a['innerHTML'] = _0x2ae3fb; _0x1278c2[_0x52f36d(0x7d)](_0x39407a); } }); else { const _0xf21334 = _0x325611[_0x30cb01(0x815)][_0x30cb01(0x3e3)]()[_0x30cb01(0x4fe)](_0x4ef0cd); _0x37f572['disabled'] = _0xf21334; } } if (_0x40321a[_0x30cb01(0x160)]) { let _0x5c9eec = _0x1278c2['querySelector'](_0x30cb01(0x7e9)); !_0x5c9eec && (_0x5c9eec = document[_0x30cb01(0x3e8)]('div'), _0x5c9eec[_0x30cb01(0x8d8)] = _0x30cb01(0xfc), _0x5c9eec[_0x30cb01(0x26b)] = '对方正在行动中...', _0x5c9eec[_0x30cb01(0x27d)][_0x30cb01(0x1b0)] = _0x30cb01(0x6c7), _0x5c9eec[_0x30cb01(0x27d)][_0x30cb01(0x5d1)] = '15px\x2020px', _0x5c9eec['style'][_0x30cb01(0x6d2)] = _0x30cb01(0x861), _0x1278c2[_0x30cb01(0x7d)](_0x5c9eec)); } const _0x4fff71 = document[_0x30cb01(0x3e8)]('div'); _0x4fff71['id'] = 'message-anchor', _0x1278c2['appendChild'](_0x4fff71), setTimeout(() => { const _0x773827 = _0x30cb01; _0x773827(0x201) !== 'QmJCN' ? _0x5605e9[_0x773827(0x159)](_0x773827(0x8d4), _0x373f6c) : _0x4fff71[_0x773827(0xfb)]({ 'behavior': _0x773827(0x54e), 'block': _0x773827(0x2c9) }); }, 0x32); } } function _0x1f2014() { const _0x2f19ee = _0x311e9d, _0x280a61 = document[_0x2f19ee(0x889)](_0x2f19ee(0x4a6)); if (!_0x280a61) return; _0x280a61['id'] === _0x2f19ee(0x2a1) ? _0xac5dfa() : _0x259a7d(); } function _0x259a7d() { const _0x34a950 = _0x311e9d, _0x56953f = _0x40321a[_0x34a950(0x393)]['filter'](_0x1e4ea0 => !_0x1e4ea0[_0x34a950(0x7ec)] && _0x1e4ea0['role'] !== _0x34a950(0x70d)); if (_0x56953f[_0x34a950(0x286)] > _0x40321a[_0x34a950(0x301)]) { let _0x5b4a29 = _0x5a2162['querySelector'](_0x34a950(0x2b6)); !_0x5b4a29 && (_0x34a950(0x6e) !== _0x34a950(0x580) ? (_0x5b4a29 = document[_0x34a950(0x3e8)](_0x34a950(0x895)), _0x5b4a29[_0x34a950(0x26b)] = _0x34a950(0x458), _0x5b4a29[_0x34a950(0x8d8)] = 'form-button\x20load-more-btn', _0x5b4a29['style'][_0x34a950(0x3bb)] = 'auto', _0x5b4a29[_0x34a950(0x27d)][_0x34a950(0x74f)] = '10px\x20auto', _0x5b4a29[_0x34a950(0x27d)][_0x34a950(0x5d1)] = '8px\x2016px', _0x5b4a29[_0x34a950(0x6fe)] = () => { const _0x3799e0 = _0x34a950, _0x2f2e0b = _0x5a2162, _0x4e6a2b = _0x2f2e0b[_0x3799e0(0x602)], _0xe07117 = _0x2f2e0b['scrollTop']; _0x40321a[_0x3799e0(0x301)] += 0x64, _0x259a7d(), requestAnimationFrame(() => { const _0x1f6823 = _0x3799e0, _0x4f641f = _0x2f2e0b[_0x1f6823(0x602)]; _0x2f2e0b[_0x1f6823(0x19c)] = _0xe07117 + (_0x4f641f - _0x4e6a2b); }); }, _0x5a2162['firstChild'] ? _0x5a2162[_0x34a950(0xbb)](_0x5b4a29, _0x5a2162['firstChild']) : _0x5a2162['appendChild'](_0x5b4a29)) : (_0x335c9d = _0x535186[_0x34a950(0x2e6)], _0x5e47a4 = _0x18f330['avatar'])); } else { if (_0x34a950(0x4c3) === _0x34a950(0x4c3)) { const _0x323dbc = _0x5a2162[_0x34a950(0x889)](_0x34a950(0x2b6)); if (_0x323dbc) _0x323dbc[_0x34a950(0x47e)](); } else _0x32dce9[_0x34a950(0x3a7)](_0x34a950(0x4dc))[_0x34a950(0x236)](); } Array[_0x34a950(0x2d7)](_0x5a2162[_0x34a950(0x1c5)])[_0x34a950(0x436)](_0x9a0238 => { const _0x157222 = _0x34a950; _0x157222(0x89f) !== 'JfAbA' ? !_0x9a0238[_0x157222(0x1c1)][_0x157222(0xa1)](_0x157222(0x25f)) && _0x9a0238[_0x157222(0x47e)]() : _0x5be18c[_0x157222(0x29d)](_0x1024f2, { 'keyPath': 'id' }); }); const _0xd9435f = _0x56953f[_0x34a950(0xb5)](-_0x40321a[_0x34a950(0x301)]); _0xd9435f[_0x34a950(0x436)](_0x4b939d => { const _0x441971 = _0x34a950; if (_0x441971(0x23a) === _0x441971(0x23a)) { const _0x94cd62 = _0x40321a['conversationHistory']['indexOf'](_0x4b939d); _0x94cd62 > -0x1 && (_0x441971(0x7b2) === 'AQDpw' ? _0xe4f38d(_0x4b939d, _0x94cd62) : _0x30cc49[_0x441971(0x1fb)](_0x2f01ef)); } else _0x3ac12b && _0x25f8e1(_0x50c6e3); }); if (_0x40321a[_0x34a950(0x160)]) { let _0x30fd2d = _0x5a2162[_0x34a950(0x889)]('.typing-indicator'); !_0x30fd2d && (_0x30fd2d = document[_0x34a950(0x3e8)](_0x34a950(0x8cf)), _0x30fd2d[_0x34a950(0x8d8)] = _0x34a950(0xfc), _0x30fd2d[_0x34a950(0x26b)] = _0x34a950(0x304), _0x5a2162[_0x34a950(0x7d)](_0x30fd2d)); } _0xd9435f[_0x34a950(0x286)] <= _0x40321a[_0x34a950(0x301)] && setTimeout(() => { const _0x2ccbc6 = _0x34a950; _0x5a2162[_0x2ccbc6(0x19c)] = _0x5a2162[_0x2ccbc6(0x602)]; }, 0x0); } function _0xe4f38d(_0x9c48fa, _0x45c32b) { const _0x4c7b23 = _0x311e9d, { role: _0x3f5cbb, content: _0x5708bd, displayUrl: _0x40e0d3, image: _0x2e71fc, senderId: _0x580549 } = _0x9c48fa, _0x2b14a5 = _0x3f5cbb === 'assistant' ? 'ai' : _0x3f5cbb, _0x559890 = _0x4db4a7(), _0x401e71 = document['createElement'](_0x4c7b23(0x8cf)); _0x401e71[_0x4c7b23(0x1c1)]['add'](_0x4c7b23(0x1a9), _0x2b14a5), _0x401e71['dataset'][_0x4c7b23(0x736)] = _0x45c32b; const _0x237f67 = document[_0x4c7b23(0x3e8)](_0x4c7b23(0x8cf)); _0x237f67[_0x4c7b23(0x8d8)] = 'message-bubble-row'; const _0x269bcb = document['createElement']('img'); _0x269bcb[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)]('avatar', _0x3f5cbb + '-avatar'); let _0x19b3e0 = ''; if (_0x3f5cbb === _0x4c7b23(0x447)) { const _0x27a66e = _0x9333e5(_0x40321a[_0x4c7b23(0x1cc)]); _0x19b3e0 = _0x27a66e[_0x4c7b23(0xe7)] || _0x579f27; } else { if (_0x4c7b23(0x886) === 'wDkFU') _0x23641d[_0x4c7b23(0x7aa)](_0x4b9967, _0x224147[_0x4c7b23(0x504)](_0x535748)); else { _0x19b3e0 = _0x4716b3; let _0x13353a = null; if (_0x559890?.[_0x4c7b23(0x78c)] === 'private') _0x13353a = _0x3f1cb7(_0x559890[_0x4c7b23(0x239)][0x0]); else _0x559890?.[_0x4c7b23(0x78c)] === _0x4c7b23(0x3bc) && _0x580549 && (_0x13353a = _0x3f1cb7(_0x580549)); _0x13353a?.[_0x4c7b23(0xe7)] && (_0x19b3e0 = _0x13353a['avatar']); } } _0x269bcb[_0x4c7b23(0x8c7)] = _0x19b3e0, _0x269bcb[_0x4c7b23(0x2af)] = _0x3f5cbb + _0x4c7b23(0x117); const _0x26104a = _0x5708bd && _0x5708bd['trim']()[_0x4c7b23(0x279)]('<div') && _0x5708bd[_0x4c7b23(0x3e3)]()['endsWith']('</div>'); if (_0x26104a) { const _0x2bbd04 = document['createElement'](_0x4c7b23(0x8cf)); _0x2bbd04[_0x4c7b23(0x8d8)] = _0x4c7b23(0x78d), _0x2bbd04[_0x4c7b23(0x49f)] = _0x5708bd; if (_0x2b14a5 === _0x4c7b23(0x447)) { if (_0x4c7b23(0x628) !== _0x4c7b23(0x48d)) _0x237f67[_0x4c7b23(0x7d)](_0x2bbd04), _0x237f67['appendChild'](_0x269bcb); else { _0x2d8127['innerHTML'] = _0x4c7b23(0x329); return; } } else _0x237f67[_0x4c7b23(0x7d)](_0x269bcb), _0x237f67[_0x4c7b23(0x7d)](_0x2bbd04); } else { const _0x32664c = document['createElement'](_0x4c7b23(0x8cf)); _0x32664c[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)](_0x4c7b23(0x15a), _0x2b14a5); if (_0x559890?.[_0x4c7b23(0x78c)] === 'private') { const _0x2983b6 = _0x559890[_0x4c7b23(0x239)][0x0]; _0x32664c[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)]('bubble-' + _0x2983b6); } if (_0x9c48fa[_0x4c7b23(0x581)]) { const _0x1a1923 = document[_0x4c7b23(0x3e8)](_0x4c7b23(0x8cf)); _0x1a1923[_0x4c7b23(0x8d8)] = _0x4c7b23(0x101); const _0x1282dd = document[_0x4c7b23(0x3e8)]('div'); _0x1282dd[_0x4c7b23(0x8d8)] = _0x4c7b23(0x379), _0x1282dd[_0x4c7b23(0x26b)] = _0x9c48fa['quotedMessage'][_0x4c7b23(0x353)]; const _0x39a3a9 = document['createElement'](_0x4c7b23(0x8cf)); _0x39a3a9[_0x4c7b23(0x8d8)] = _0x4c7b23(0x6fd), _0x39a3a9['textContent'] = _0x9c48fa[_0x4c7b23(0x581)]['content'], _0x1a1923[_0x4c7b23(0x7d)](_0x1282dd), _0x1a1923[_0x4c7b23(0x7d)](_0x39a3a9), _0x32664c[_0x4c7b23(0x7d)](_0x1a1923); } if (_0x40e0d3) { _0x32664c[_0x4c7b23(0x1c1)]['add']('sticker'); const _0x1155f2 = document[_0x4c7b23(0x3e8)](_0x4c7b23(0x585)); _0x1155f2['src'] = _0x40e0d3, _0x1155f2[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)](_0x4c7b23(0x5ad)), _0x32664c[_0x4c7b23(0x7d)](_0x1155f2); } else { if (_0x9c48fa[_0x4c7b23(0x888)] || _0x9c48fa[_0x4c7b23(0x3a0)]) { _0x32664c[_0x4c7b23(0x1c1)]['add'](_0x4c7b23(0x888)); const _0x2e68aa = document[_0x4c7b23(0x3e8)]('img'); _0x2e68aa['classList']['add'](_0x4c7b23(0xa4)), _0x32664c[_0x4c7b23(0x7d)](_0x2e68aa); _0x9c48fa[_0x4c7b23(0x888)] ? _0x4c7b23(0x26c) !== _0x4c7b23(0x26c) ? (_0x5bd7f6[_0x4c7b23(0x7aa)](_0x4c7b23(0x590), _0x2a61a1[_0x4c7b23(0x504)](_0x8593b5)), _0x4b9f01('表情包已保存！正在刷新应用...'), _0xbf9a9(() => _0x49c693[_0x4c7b23(0x15f)](), 0x5dc)) : _0x2e68aa[_0x4c7b23(0x8c7)] = _0x9c48fa[_0x4c7b23(0x888)] : (_0x2e68aa['src'] = _0x4c7b23(0x84e), _0x500f4d(_0x9c48fa[_0x4c7b23(0x3a0)])[_0x4c7b23(0x3fa)](_0x16eb28 => { const _0x39da9f = _0x4c7b23; if ('qDUmX' === _0x39da9f(0x605)) { if (_0x16eb28) { if (_0x39da9f(0x6b0) === _0x39da9f(0x140)) { _0x2a0eab[_0x39da9f(0x49f)] = _0x39da9f(0x52d); return; } else { const _0x306e61 = URL['createObjectURL'](_0x16eb28); _0x2e68aa[_0x39da9f(0x8c7)] = _0x306e61, _0x2e68aa[_0x39da9f(0x5bc)] = () => { const _0x38893f = _0x39da9f; URL[_0x38893f(0x165)](_0x306e61); }; } } else _0x2e68aa[_0x39da9f(0x2af)] = '图片加载失败'; } else { const _0xe422c0 = _0x597a3f(_0x4078cc[_0x39da9f(0x574)]); if (!_0xe422c0) return; const _0xd3c2a2 = _0x3e45cc(_0x59a32e[_0x39da9f(0x3a7)]('sprite-slider-x')[_0x39da9f(0x815)]), _0x3e65c5 = _0x245067(_0x3a9580[_0x39da9f(0x3a7)](_0x39da9f(0x526))[_0x39da9f(0x815)]), _0x250eea = _0x39d9cf(_0x227d81[_0x39da9f(0x3a7)](_0x39da9f(0x43a))['value']) / 0x64; _0xe422c0[_0x39da9f(0x24e)] = { 'x': _0xd3c2a2, 'y': _0x3e65c5, 'scale': _0x250eea }, _0x56183b(), _0x2a8a88(_0x39da9f(0x53b)), _0x35f7e9(!![]); } })[_0x4c7b23(0x412)](_0x4a42f4 => { const _0x3ef74a = _0x4c7b23; 'HCVZc' !== _0x3ef74a(0x2d4) ? (console[_0x3ef74a(0x159)](_0x3ef74a(0x5c1), _0x4a42f4), _0x2e68aa[_0x3ef74a(0x2af)] = '图片加载失败') : (_0x172c4d(_0x3ef74a(0x8da), _0x3ef74a(0x4ee)), _0x6bfdb6(![])); })); if (_0x5708bd) { if ('vpNsZ' === _0x4c7b23(0x331)) { const _0x2f6a4f = document[_0x4c7b23(0x3e8)]('p'); _0x2f6a4f[_0x4c7b23(0x27d)]['marginTop'] = '5px', _0x2f6a4f['textContent'] = _0x5708bd, _0x32664c[_0x4c7b23(0x7d)](_0x2f6a4f); } else _0x2ac89c(_0x39d29d[_0x4c7b23(0x57c)]); } } else { if (_0x9c48fa[_0x4c7b23(0x78c)] === _0x4c7b23(0x7d7)) { if (_0x4c7b23(0x670) === _0x4c7b23(0x1f7)) _0x198d53 = _0x2e97fe['parse'](_0xb5c1e4); else { _0x32664c[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)](_0x4c7b23(0x7d7)); const _0x35ddf6 = _0x9c48fa[_0x4c7b23(0x837)] === _0x4c7b23(0x447) ? _0x9333e5(_0x40321a['activeChatId']) : _0x3f1cb7(_0x9c48fa['senderId']), _0x27e193 = _0x9c48fa['recipientId'] === _0x9333e5(_0x40321a[_0x4c7b23(0x1cc)])['id'] ? _0x9333e5(_0x40321a[_0x4c7b23(0x1cc)]) : _0x3f1cb7(_0x9c48fa[_0x4c7b23(0x5b8)]), _0x58a939 = _0x35ddf6?.[_0x4c7b23(0x2e6)] ? _0x35ddf6[_0x4c7b23(0x2e6)] + _0x4c7b23(0x3f5) : '转账', _0x2b837a = _0x27e193?.['name'] ? _0x4c7b23(0x389) + _0x27e193[_0x4c7b23(0x2e6)] : '转账', _0xf09547 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20' + _0x58a939 + _0x4c7b23(0x1ce) + _0x9c48fa['amount'][_0x4c7b23(0x524)](0x2) + _0x4c7b23(0x419) + _0x2b837a + _0x4c7b23(0x8c8); _0x32664c['innerHTML'] = _0xf09547; } } else { if (_0x9c48fa['type'] === _0x4c7b23(0x368)) { _0x32664c[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)](_0x4c7b23(0x242)); const _0x4509f4 = document[_0x4c7b23(0x3e8)](_0x4c7b23(0x8cf)); _0x4509f4['className'] = _0x4c7b23(0x2e5), _0x4509f4[_0x4c7b23(0x1c1)][_0x4c7b23(0x65b)](_0x4c7b23(0x80c)); const _0x191266 = _0x9c48fa[_0x4c7b23(0x837)] === _0x4c7b23(0x447) ? _0x9333e5(_0x40321a[_0x4c7b23(0x1cc)])[_0x4c7b23(0x2e6)] || '你' : _0x3f1cb7(_0x9c48fa[_0x4c7b23(0x2b9)])?.[_0x4c7b23(0x2e6)] || 'TA', _0x1ab5e3 = _0x4c7b23(0x847) + _0x9c48fa[_0x4c7b23(0x375)], _0x5bcf38 = _0x4c7b23(0x677) + _0x1ab5e3 + '\x22\x20src=\x22' + _0x4716b3 + '\x22>'; _0x9c48fa[_0x4c7b23(0x3c0)] && _0x500f4d(_0x9c48fa[_0x4c7b23(0x3c0)])[_0x4c7b23(0x3fa)](_0x48daf4 => { const _0x2d815a = _0x4c7b23, _0x2dc1d8 = document[_0x2d815a(0x3a7)](_0x1ab5e3); if (_0x2dc1d8 && _0x48daf4) _0x2dc1d8[_0x2d815a(0x8c7)] = URL[_0x2d815a(0x99)](_0x48daf4); }); if (_0x9c48fa['accepted']) _0x4509f4['innerHTML'] = _0x4c7b23(0x77) + _0x5bcf38 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x9c48fa['songName'] + _0x4c7b23(0x4c7) + _0x9c48fa[_0x4c7b23(0x45d)] + _0x4c7b23(0x7fa); else { if ('gBmJG' === _0x4c7b23(0x1a3)) _0x4509f4['innerHTML'] = _0x4c7b23(0x5b4) + _0x191266 + '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x5bcf38 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x9c48fa['songName'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x9c48fa[_0x4c7b23(0x45d)] + _0x4c7b23(0x1dc) + _0x9c48fa[_0x4c7b23(0x428)] + _0x4c7b23(0x23d); else { const _0x243cbe = _0x38ef1d['value']; let _0x31a45c = _0x243cbe[_0x4c7b23(0x3d9)](/\.bubble\.sent/g, '#bubble-preview-user')[_0x4c7b23(0x3d9)](/\.bubble\.received/g, _0x4c7b23(0x5db)); _0x2d76b1[_0x4c7b23(0x49f)] = _0x31a45c; } } _0x32664c['appendChild'](_0x4509f4); } else { if (_0x9c48fa[_0x4c7b23(0x78c)] === _0x4c7b23(0x242) && _0x9c48fa[_0x4c7b23(0x4de)]) { _0x32664c['classList']['add'](_0x4c7b23(0x242)); const _0x311bfe = document[_0x4c7b23(0x3e8)]('div'); _0x311bfe[_0x4c7b23(0x8d8)] = 'music-share-card', _0x311bfe[_0x4c7b23(0x58e)][_0x4c7b23(0x3e7)] = _0x4c7b23(0x857) + _0x9c48fa['timestamp']; const _0x55f935 = 'cover_placeholder_' + _0x9c48fa[_0x4c7b23(0x375)], _0x174542 = '<img\x20src=\x22' + _0x4716b3 + _0x4c7b23(0x633) + _0x55f935 + _0x4c7b23(0x827); if (_0x9c48fa[_0x4c7b23(0x3c0)]) 'mUthr' !== _0x4c7b23(0x7cf) ? _0x500f4d(_0x9c48fa[_0x4c7b23(0x3c0)])['then'](_0x13a7d4 => { const _0x16ebf4 = _0x4c7b23, _0x2388c7 = document[_0x16ebf4(0x3a7)](_0x55f935); if (_0x2388c7 && _0x13a7d4) _0x2388c7[_0x16ebf4(0x8c7)] = URL['createObjectURL'](_0x13a7d4); }) : _0x597909[_0x4c7b23(0x215)](_0x4c7b23(0x236), function () { const _0xb031de = { 'id': _0x1bdbea['id'], 'url': _0x589d92['playableUrl'] }; _0x3be467(this, _0xb031de); }); else _0x9c48fa[_0x4c7b23(0x102)] && ('edjWt' !== 'xBXYI' ? setTimeout(() => { const _0x1b89db = _0x4c7b23, _0x4af4fd = document[_0x1b89db(0x3a7)](_0x55f935); if (_0x4af4fd) _0x4af4fd['src'] = _0x9c48fa['coverUrl']; }, 0x0) : (_0x3a9e92(_0x359fc9['id']), _0x59d4c6(_0x4c7b23(0x678) + _0x1fa09c[_0x4c7b23(0x2e6)] + '\x22\x20已删除。'), _0x2e46eb(![]))); _0x311bfe[_0x4c7b23(0x49f)] = _0x4c7b23(0x791) + _0x174542 + _0x4c7b23(0x4ea) + _0x9c48fa[_0x4c7b23(0x4de)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x9c48fa[_0x4c7b23(0x45d)] + _0x4c7b23(0x61e) + (_0x9c48fa[_0x4c7b23(0x89c)] ? '▶' : '⚠') + '</div>'; if (_0x9c48fa['playableUrl']) { if ('zdilh' !== _0x4c7b23(0x27a)) { let _0x4616b8 = _0x24b7d5[_0x4c7b23(0x5e7)][_0x4c7b23(0x226)](_0x1337d0 => _0x1337d0[_0x4c7b23(0x2e6)] === _0x447ded[_0x4c7b23(0x2e6)]); if (_0x4616b8) _0x435c72[_0x4c7b23(0x1fb)](_0x4616b8['id']); else { const _0x1712de = { 'id': _0x4c7b23(0x186) + _0xcde503[_0x4c7b23(0x6bb)]() + '_' + _0x5a3c6c[_0x4c7b23(0x775)](), 'name': _0x191eaa[_0x4c7b23(0x2e6)], 'content': _0x4c6287[_0x4c7b23(0x812)] }; _0x90675[_0x4c7b23(0x5e7)][_0x4c7b23(0x1fb)](_0x1712de), _0xc133dd['push'](_0x1712de['id']); } } else _0x311bfe[_0x4c7b23(0x215)]('click', function () { const _0x82be94 = _0x4c7b23, _0x2fdf12 = { 'id': _0x82be94(0x857) + _0x9c48fa[_0x82be94(0x375)], 'url': _0x9c48fa[_0x82be94(0x89c)] }; _0x492919(this, _0x2fdf12); }); } _0x32664c[_0x4c7b23(0x7d)](_0x311bfe); } else { if (_0x5708bd) { if ('Cbsja' !== _0x4c7b23(0x460)) _0x3ac2c8[_0x4c7b23(0x23e)] = null, _0x513769('diaryList', _0x4c7b23(0x16a)); else { const _0x5d9e30 = document['createElement']('p'); _0x5d9e30[_0x4c7b23(0x49f)] = _0x5708bd, _0x5d9e30[_0x4c7b23(0x27d)][_0x4c7b23(0x74f)] = '0', _0x32664c['appendChild'](_0x5d9e30); } } } } } } } _0x3f5cbb === _0x4c7b23(0x447) ? (_0x237f67[_0x4c7b23(0x7d)](_0x32664c), _0x237f67[_0x4c7b23(0x7d)](_0x269bcb)) : (_0x237f67[_0x4c7b23(0x7d)](_0x269bcb), _0x237f67['appendChild'](_0x32664c)); } _0x401e71[_0x4c7b23(0x7d)](_0x237f67); const _0x3a19c8 = document[_0x4c7b23(0x3e8)](_0x4c7b23(0x8cf)); return _0x3a19c8[_0x4c7b23(0x8d8)] = _0x4c7b23(0x375), _0x3a19c8[_0x4c7b23(0x26b)] = _0xc1a9db(_0x9c48fa[_0x4c7b23(0x375)]), _0x401e71[_0x4c7b23(0x7d)](_0x3a19c8), _0x5a2162['appendChild'](_0x401e71), _0x401e71; } document[_0x311e9d(0x3a7)](_0x311e9d(0x72a))[_0x311e9d(0x215)]('click', _0x53ffb7); let _0x12ce6c = null, _0x47adb1 = null; function _0x53ffb7(_0x221e7f) { const _0x218aee = _0x311e9d; if (window['getSelection']()[_0x218aee(0x8e4)]()) return; const _0x508590 = _0x221e7f[_0x218aee(0x94)][_0x218aee(0x64c)](_0x218aee(0x798)), _0x2046f3 = _0x221e7f['target']['closest']('.no-action-modal'); if (!_0x508590 || _0x2046f3) return; const _0x199a42 = parseInt(_0x508590[_0x218aee(0x58e)][_0x218aee(0x736)], 0xa); if (isNaN(_0x199a42)) return; _0x235508(_0x199a42); } function _0x53a615() { const _0x1c07b4 = _0x311e9d, _0x5b5add = _0x4db4a7(); if (!_0x5b5add) { _0x4d1206[_0x1c07b4(0x26b)] = _0x1c07b4(0x257); return; } if (_0x5b5add['type'] === _0x1c07b4(0x64f)) { if (_0x1c07b4(0x32a) === _0x1c07b4(0x3c8)) _0x962493[_0x1c07b4(0x815)] = _0x3f9239[_0x1c07b4(0x92)][_0x1c07b4(0x2e6)] || '', _0x25747b[_0x1c07b4(0x8c7)] = _0x7be9fc[_0x1c07b4(0x92)]['avatar'] || _0x4ef1b8, _0x49963f[_0x1c07b4(0x815)] = _0x6cbaa1[_0x1c07b4(0x92)]['persona'] || ''; else { const _0x494e33 = _0x3f1cb7(_0x5b5add['participantIds'][0x0]); _0x4d1206[_0x1c07b4(0x26b)] = _0x494e33 ? _0x494e33[_0x1c07b4(0x2e6)] : _0x1c07b4(0x864); } } else _0x4d1206[_0x1c07b4(0x26b)] = _0x5b5add[_0x1c07b4(0x2e6)] || _0x1c07b4(0x571) + _0x5b5add[_0x1c07b4(0x239)][_0x1c07b4(0x286)] + ')'; } function _0x212f2a(_0x259272) { const _0xf149e5 = _0x311e9d; if (_0xf149e5(0x6ec) !== _0xf149e5(0x804)) { const _0x4f0a33 = document[_0xf149e5(0x889)]('.screen.active'); if (_0x4f0a33 && (_0x4f0a33['id'] === _0xf149e5(0x2a1) || _0x4f0a33['id'] === _0xf149e5(0x6b7))) _0x1f2014(); else { const _0x4f0201 = document[_0xf149e5(0x21e)](_0xf149e5(0x7e9)); _0x4f0201[_0xf149e5(0x436)](_0x1557cf => _0x1557cf[_0xf149e5(0x47e)]()); } } else _0x1b4330 *= _0x467344 / _0x512901, _0x8a8c62 = _0x3f7166; } function _0x4b7297() { const _0x5b1db0 = _0x311e9d; _0x5b1db0(0x89e) !== _0x5b1db0(0x89a) ? (_0x40321a[_0x5b1db0(0x160)] && _0x40321a[_0x5b1db0(0x535)] && (console[_0x5b1db0(0x336)](_0x5b1db0(0x309)), _0x40321a[_0x5b1db0(0x535)][_0x5b1db0(0x87d)](_0x5b1db0(0x4b3)), _0x40321a['currentAbortController'] = null), _0x40321a[_0x5b1db0(0x160)] = ![], _0x212f2a(![])) : (delete _0x49c5b5[_0x5b1db0(0x41b)][_0x540307], _0x35d1ae(), _0x38a9ef()); } function _0x4db4a7() { const _0x556dad = _0x311e9d; return _0x40321a[_0x556dad(0x478)]['find'](_0x4d2cc0 => _0x4d2cc0['id'] === _0x40321a[_0x556dad(0x1cc)]); } function _0x3f1cb7(_0x14bc3c) { const _0x2e2aa0 = _0x311e9d; return _0x40321a[_0x2e2aa0(0x382)][_0x2e2aa0(0x226)](_0xd90fc6 => _0xd90fc6['id'] === _0x14bc3c); } function _0x312b87(_0xbb6fb1) { const _0x12656e = _0x311e9d; _0x40321a[_0x12656e(0x382)] = _0x40321a['characters'][_0x12656e(0x16f)](_0x2fd56 => _0x2fd56['id'] !== _0xbb6fb1), _0x40321a['chats'][_0x12656e(0x436)](_0x806166 => { const _0xd9839d = _0x12656e; _0x806166['type'] === _0xd9839d(0x3bc) && (_0x806166[_0xd9839d(0x239)] = _0x806166[_0xd9839d(0x239)][_0xd9839d(0x16f)](_0x478fff => _0x478fff !== _0xbb6fb1)); }); const _0x2a7460 = _0x40321a['chats'][_0x12656e(0x226)](_0x130a53 => _0x130a53[_0x12656e(0x78c)] === _0x12656e(0x64f) && _0x130a53[_0x12656e(0x239)][_0x12656e(0x4fe)](_0xbb6fb1)); _0x2a7460 && _0x2cb7e4(_0x2a7460['id']), _0x40321a[_0x12656e(0x478)] = _0x40321a[_0x12656e(0x478)]['filter'](_0x40f163 => _0x40f163['type'] !== _0x12656e(0x3bc) || _0x40f163[_0x12656e(0x239)][_0x12656e(0x286)] > 0x1), _0x544cbe(), _0x5af13e(); } function _0x2cb7e4(_0x5fa0f3) { const _0x300087 = _0x311e9d; _0x40321a[_0x300087(0x478)] = _0x40321a[_0x300087(0x478)][_0x300087(0x16f)](_0x4094a0 => _0x4094a0['id'] !== _0x5fa0f3); try { localStorage[_0x300087(0x73)](_0x300087(0x4a7) + _0x5fa0f3); } catch (_0x34efd6) { console[_0x300087(0x159)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x5fa0f3, _0x34efd6); } if (_0x40321a['activeChatId'] === _0x5fa0f3) { if (_0x300087(0x4cc) === 'rLiEZ') { const _0x507618 = _0x49bd59['getElementById']('friend-circle-list-container'); _0x507618['innerHTML'] = ''; if (_0x24d1a9[_0x300087(0x7ab)]['length'] === 0x0) { _0x507618[_0x300087(0x49f)] = _0x300087(0x3aa); return; } _0x3508b6[_0x300087(0x7ab)][_0x300087(0x436)](_0x4acdf2 => { const _0xa48e8a = _0x300087, _0x1cc201 = _0x3c67a6[_0xa48e8a(0x7c0)][_0xa48e8a(0x226)](_0x16071e => _0x16071e['id'] === _0x4acdf2[_0xa48e8a(0x87f)]) || { 'name': _0xa48e8a(0x7f0) }, _0x2af543 = _0x5a8571[_0xa48e8a(0x3e8)]('div'); _0x2af543['className'] = _0xa48e8a(0x341), _0x2af543[_0xa48e8a(0x58e)]['id'] = _0x4acdf2['id'], _0x2af543[_0xa48e8a(0x49f)] = _0xa48e8a(0x578) + _0x4acdf2[_0xa48e8a(0x2e6)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x1cc201['name'] + _0xa48e8a(0x82a) + _0x4acdf2[_0xa48e8a(0x726)][_0xa48e8a(0x286)] + _0xa48e8a(0x683), _0x2af543[_0xa48e8a(0x215)]('click', () => _0x6f7cb8(_0x4acdf2['id'])), _0x507618[_0xa48e8a(0x7d)](_0x2af543); }); } else _0x40321a[_0x300087(0x1cc)] = _0x40321a[_0x300087(0x478)][0x0]?.['id'] || null, _0x3bb312(_0x40321a['activeChatId']); } _0x544cbe(), _0x5af13e(); } async function _0x3bb312(_0x4a8c93) { const _0x43baef = _0x311e9d; if (_0x40321a[_0x43baef(0x1cc)] !== _0x4a8c93) { if ('QlsTc' === _0x43baef(0x5fa)) return _0x1a9af9[_0x43baef(0x336)](_0x43baef(0x85e)), 0x0; else _0x4b7297(), _0x40321a[_0x43baef(0x301)] = 0x64; } if (!_0x4a8c93) { _0x40321a[_0x43baef(0x1cc)] = null, _0x544cbe(), _0x22cc08(![]), document[_0x43baef(0x3a7)](_0x43baef(0x72))[_0x43baef(0x27d)][_0x43baef(0xb3)] = ''; return; } _0x40321a[_0x43baef(0x1cc)] = _0x4a8c93, _0x544cbe(), _0x53a615(), _0x5a2162[_0x43baef(0x49f)] = '', _0x3396e7(!![], _0x43baef(0x71f)), setTimeout(async () => { const _0x7297e0 = _0x43baef; try { _0x5f2acc(); const _0x24eb4c = _0x4db4a7(), _0x22cb53 = document['getElementById'](_0x7297e0(0x72)); let _0x1ef0e5 = null; if (_0x24eb4c) { if ('ugZwO' !== 'oesWE') { if (_0x24eb4c[_0x7297e0(0x78c)] === _0x7297e0(0x64f)) { const _0x171e5f = _0x24eb4c[_0x7297e0(0x239)][0x0]; _0x208b7d(_0x171e5f), _0x1ef0e5 = await _0x500f4d(_0x7297e0(0x865) + _0x171e5f); } else { if (_0x7297e0(0x899) === _0x7297e0(0x899)) _0x1ef0e5 = await _0x500f4d(_0x7297e0(0x527) + _0x24eb4c['id']); else { const _0x27c1bf = _0x3665a6[_0x7297e0(0x1bc)](_0x546e7d, 0x2); _0x27c1bf['onerror'] = () => _0x2f96d3(_0x7297e0(0x22c)), _0x27c1bf[_0x7297e0(0x61f)] = () => _0x366037(_0x27c1bf['result']), _0x27c1bf[_0x7297e0(0x557)] = _0x4aec0a => { const _0x4e7915 = _0x7297e0, _0x232bc0 = _0x4aec0a['target'][_0x4e7915(0x7ba)]; !_0x232bc0['objectStoreNames'][_0x4e7915(0xa1)](_0x59d8fc) && _0x232bc0[_0x4e7915(0x29d)](_0x6fb66e, { 'keyPath': 'id' }); const _0x973870 = 'music_library'; !_0x232bc0['objectStoreNames'][_0x4e7915(0xa1)](_0x973870) && _0x232bc0[_0x4e7915(0x29d)](_0x973870, { 'keyPath': 'id' }); }; } } _0x1ef0e5 ? (_0x22cb53['style']['backgroundImage'] = _0x7297e0(0x3dd) + URL[_0x7297e0(0x99)](_0x1ef0e5) + '\x27)', _0x22cb53[_0x7297e0(0x27d)][_0x7297e0(0x4b0)] = _0x7297e0(0x59e), _0x22cb53[_0x7297e0(0x27d)]['backgroundPosition'] = _0x7297e0(0x50d)) : _0x22cb53[_0x7297e0(0x27d)][_0x7297e0(0xb3)] = ''; } else _0x479a4c = _0x3e7304[_0x7297e0(0x2e6)]; } _0x259a7d(); } catch (_0x1d1e9a) { console['error'](_0x7297e0(0x13f), _0x1d1e9a), _0x1bbd68(_0x7297e0(0x7c4) + _0x1d1e9a[_0x7297e0(0x15a)]); } finally { _0x3396e7(![]); } }, 0x32); } async function _0x492740() { const _0x2ed76b = _0x311e9d; if (_0x40321a[_0x2ed76b(0x160)]) { _0x1bbd68(_0x2ed76b(0x1c3)); return; } const _0x47ecba = _0x40321a[_0x2ed76b(0x393)]; if (_0x47ecba[_0x2ed76b(0x286)] === 0x0) return; let _0x169d84 = -0x1; for (let _0x59fb80 = _0x47ecba[_0x2ed76b(0x286)] - 0x1; _0x59fb80 >= 0x0; _0x59fb80--) { if (_0x2ed76b(0x3d8) === _0x2ed76b(0x3d8)) { if (_0x47ecba[_0x59fb80][_0x2ed76b(0x837)] === _0x2ed76b(0x447)) { if ('ZtVLF' === 'sgaIN') _0x5da24b(_0x12281d); else { _0x169d84 = _0x59fb80; break; } } } else { const _0x3c6c4f = _0x4c73bc['createElement'](_0x2ed76b(0x8cf)); _0x3c6c4f['className'] = _0x2ed76b(0x4af); const _0x204a97 = _0x3d4f42[_0x2ed76b(0x59e)] ? _0x23efa0['createObjectURL'](_0x7ccdf9['cover']) : _0x5970a3; _0x3c6c4f[_0x2ed76b(0x49f)] = _0x2ed76b(0x24b) + _0x204a97 + _0x2ed76b(0x15e) + (_0x9fbb76['info'][_0x2ed76b(0x722)] || _0x2ed76b(0x1b1)) + _0x2ed76b(0x306) + (_0x1fee8c[_0x2ed76b(0x8df)]['歌手'] || _0x2ed76b(0x41c)) + _0x2ed76b(0x79b), _0x3c6c4f['addEventListener'](_0x2ed76b(0x236), () => { _0x590e45(_0xabf186); }), _0x4a50a1['appendChild'](_0x3c6c4f); } } if (_0x169d84 === -0x1 || _0x169d84 === _0x47ecba[_0x2ed76b(0x286)] - 0x1) { if (_0x2ed76b(0x6c2) === _0x2ed76b(0x721)) { const _0x4e22f8 = _0x51f46c['getElementById']('world-book-checkboxes-container'), _0x529cc9 = _0x4e22f8[_0x2ed76b(0x21e)]('input:checked'), _0xe2fe6e = _0x3b9e39[_0x2ed76b(0x889)](_0x2ed76b(0x423)); if (_0x529cc9[_0x2ed76b(0x286)] === 0x0) _0xe2fe6e[_0x2ed76b(0x26b)] = _0x2ed76b(0x6ff); else _0x529cc9['length'] > 0x2 ? _0xe2fe6e[_0x2ed76b(0x26b)] = _0x2ed76b(0x797) + _0x529cc9[_0x2ed76b(0x286)] + '\x20项' : _0xe2fe6e[_0x2ed76b(0x26b)] = _0x28d327[_0x2ed76b(0x2d7)](_0x529cc9)[_0x2ed76b(0x7cc)](_0x51f436 => _0x51f436[_0x2ed76b(0x7ea)]['textContent'][_0x2ed76b(0x3e3)]())[_0x2ed76b(0x2c1)]('、'); } else { _0x1bbd68(_0x2ed76b(0x500)); return; } } _0x47ecba[_0x2ed76b(0x855)](_0x169d84 + 0x1), _0x174e50(), _0x1f2014(), setTimeout(() => { const _0x47361b = _0x2ed76b; 'isqtO' === _0x47361b(0xaa) ? _0x5c5350() : _0x2c07e2 += _0x47361b(0x251) + _0x30fc3a[_0x47361b(0x4de)] + _0x47361b(0x604) + _0x4ccd23[_0x47361b(0x45d)] + ')'; }, 0x64); } function _0x3f1262(_0x2ddabf = null) { const _0xdc8f26 = _0x311e9d, _0x13643d = _0x2ddabf ?? _0x3a20f5[_0xdc8f26(0x815)][_0xdc8f26(0x3e3)](); if (_0x13643d === '' || !_0x40321a[_0xdc8f26(0x1cc)]) return; const _0xb9091a = document['querySelector'](_0xdc8f26(0x4a6)), _0xa8252c = _0xb9091a['id'] === 'meeting-view-screen', _0x37234a = { 'role': _0xdc8f26(0x447), 'content': _0x13643d, 'timestamp': Date['now'](), 'isOffline': _0xa8252c }; _0x40321a[_0xdc8f26(0x8bc)] && ('zHsXB' !== 'zHsXB' ? (_0x281ee3['getElementById']('char-edit-sprite-' + _0x1ae5fc + '-preview')[_0xdc8f26(0x8c7)] = '', _0xbefa4c[_0xdc8f26(0x3a7)](_0xdc8f26(0x5bd) + _0x36d2e0 + _0xdc8f26(0x528))['value'] = '') : _0x37234a[_0xdc8f26(0x581)] = { ..._0x40321a[_0xdc8f26(0x8bc)] }), _0x40321a[_0xdc8f26(0x393)][_0xdc8f26(0x1fb)](_0x37234a), _0x174e50(), _0x1f2014(), !_0x2ddabf && (_0x3a20f5['value'] = ''), _0x3fb3b2(); } function _0x38346d(_0x18d322) { const _0x4ca8cf = _0x311e9d; if (!_0x18d322 || !_0x40321a[_0x4ca8cf(0x1cc)]) return; const _0x2c2ba3 = { 'role': _0x4ca8cf(0x447), 'content': _0x4ca8cf(0x280) + _0x18d322[_0x4ca8cf(0x2e6)] + ']', 'displayUrl': _0x18d322[_0x4ca8cf(0x5cb)], 'timestamp': Date[_0x4ca8cf(0x6bb)]() }; _0x40321a[_0x4ca8cf(0x393)][_0x4ca8cf(0x1fb)](_0x2c2ba3), _0xe4f38d(_0x2c2ba3, _0x40321a[_0x4ca8cf(0x393)][_0x4ca8cf(0x286)] - 0x1), _0x174e50(), _0x333188[_0x4ca8cf(0x1c1)][_0x4ca8cf(0x47e)](_0x4ca8cf(0x7de)); } async function _0x283d7c(_0x2ff642) { const _0x5c66bd = _0x311e9d, _0x28f244 = _0x2ff642[_0x5c66bd(0x94)][_0x5c66bd(0x83b)][0x0]; if (!_0x28f244 || !_0x40321a[_0x5c66bd(0x1cc)]) return; _0x3396e7(!![], _0x5c66bd(0x8b)); try { const _0x426cad = await _0x774f7f(_0x28f244, 0x320, 0.8, !![]), _0x2fdb3b = _0x5c66bd(0x2a4) + Date[_0x5c66bd(0x6bb)](); await _0x5c7ad7(_0x2fdb3b, _0x426cad); const _0x2d06c8 = _0x3a20f5['value'][_0x5c66bd(0x3e3)](); _0x3a20f5[_0x5c66bd(0x815)] = ''; const _0x208d60 = { 'role': 'user', 'content': _0x2d06c8, 'imageId': _0x2fdb3b, 'timestamp': Date[_0x5c66bd(0x6bb)]() }; _0x40321a[_0x5c66bd(0x393)]['push'](_0x208d60), _0xe4f38d(_0x208d60, _0x40321a[_0x5c66bd(0x393)]['length'] - 0x1), _0x174e50(); } catch (_0x3e1e52) { _0x1bbd68(_0x5c66bd(0x612) + _0x3e1e52[_0x5c66bd(0x15a)]); } finally { _0x3396e7(![]), _0x2ff642['target'][_0x5c66bd(0x815)] = ''; } } async function _0x44794f() { const _0x3abc10 = _0x311e9d; if (_0x3abc10(0x6a7) !== _0x3abc10(0x466)) { if (!_0x40321a[_0x3abc10(0x1cc)]) return; const _0x327b42 = await _0x123f8a(); if (!_0x327b42) return; _0x1bbd68(_0x3abc10(0x786)); try { const _0x1138a7 = await _0x117420(_0x327b42[_0x3abc10(0x4de)], _0x327b42[_0x3abc10(0x45d)]); let _0x1313c7 = _0x1138a7[_0x3abc10(0x59e)]; if (_0x1138a7[_0x3abc10(0x59e)] && _0x1138a7[_0x3abc10(0x59e)][_0x3abc10(0x279)](_0x3abc10(0x68f))) try { if ('xkfJc' === _0x3abc10(0x63b)) _0x2d18ca = { 'speaker': _0x363922[_0x3abc10(0x2e6)], 'line': _0x2015e0[_0x3abc10(0x812)], 'emotion': _0x3abc10(0x4d6) }; else { const _0x4225f8 = await fetch(_0x1138a7[_0x3abc10(0x59e)]), _0x40d66e = await _0x4225f8['blob'](); _0x1313c7 = await _0x5cb5e3(_0x40d66e); } } catch (_0x5ad557) { console[_0x3abc10(0x159)](_0x3abc10(0x4a1), _0x5ad557), _0x1313c7 = _0x4716b3; } const _0x4eab98 = { 'role': _0x3abc10(0x447), 'type': _0x3abc10(0x242), 'content': '[用户分享了音乐：' + _0x327b42['songName'] + _0x3abc10(0x604) + _0x327b42[_0x3abc10(0x45d)] + ']', 'songName': _0x327b42[_0x3abc10(0x4de)], 'artist': _0x327b42[_0x3abc10(0x45d)], 'coverUrl': _0x1313c7, 'playableUrl': _0x1138a7[_0x3abc10(0x5cb)], 'timestamp': Date[_0x3abc10(0x6bb)]() }; _0x40321a['conversationHistory'][_0x3abc10(0x1fb)](_0x4eab98), _0xe4f38d(_0x4eab98, _0x40321a[_0x3abc10(0x393)][_0x3abc10(0x286)] - 0x1), _0x174e50(); } catch (_0x4dd5f0) { console[_0x3abc10(0x159)](_0x3abc10(0x2bd), _0x4dd5f0), _0x1bbd68('搜索失败:\x20' + _0x4dd5f0['message']); } } else _0x2d15c8[_0x3abc10(0x7c0)] = _0x4bc89e['userProfiles'], _0x32cc4b[_0x3abc10(0x17e)] = _0x4564b8[_0x3abc10(0x17e)]; } function _0x5a6325(_0x3d4cfb, _0x380308 = 0x78) { const _0x121438 = _0x311e9d; if (_0x121438(0x768) === _0x121438(0x7a1)) { if (_0x1fbfe8) _0x2d3ff6(_0x35d9a8); } else { const _0x8ca0ec = _0x391e25 => { const _0x56f9f6 = _0x121438; if (_0x56f9f6(0xde) !== _0x56f9f6(0xde)) for (const _0x501ca2 in _0x2816a1) { _0x120624[_0x56f9f6(0x27d)][_0x501ca2] = _0x2b5523[_0x501ca2]; } else { if (_0x391e25[_0x56f9f6(0x837)] === _0x56f9f6(0x447)) return _0x40321a[_0x56f9f6(0x92)]?.[_0x56f9f6(0x2e6)] || _0x56f9f6(0x766); if (_0x391e25[_0x56f9f6(0x2b9)]) { const _0x557b18 = _0x3f1cb7(_0x391e25[_0x56f9f6(0x2b9)]); return _0x557b18?.[_0x56f9f6(0x2e6)] || 'Unknown'; } if (_0x3d4cfb?.[_0x56f9f6(0x78c)] === 'private') { const _0x431976 = _0x3f1cb7(_0x3d4cfb[_0x56f9f6(0x239)][0x0]); return _0x431976?.[_0x56f9f6(0x2e6)] || 'AI'; } return _0x56f9f6(0x37e); } }, _0x4d7445 = _0x40321a[_0x121438(0x393)]['slice'](-_0x380308), _0x54d00c = []; for (const _0x224dc9 of _0x4d7445) { if (_0x224dc9[_0x121438(0x220)]) _0x54d00c['push']('[' + _0x8ca0ec(_0x224dc9) + _0x121438(0x6e0) + (_0x224dc9[_0x121438(0x812)]?.[_0x121438(0x33f)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x224dc9[_0x121438(0x888)]) { if (_0x121438(0x892) === _0x121438(0x892)) { const _0x10189e = _0x224dc9[_0x121438(0x812)] ? '\x20' + _0x224dc9['content'] : ''; _0x54d00c[_0x121438(0x1fb)]('[' + _0x8ca0ec(_0x224dc9) + _0x121438(0x5cd) + _0x10189e); } else _0x3c91ff(), _0x1a1a35(![]), _0x181f9a[_0x121438(0x160)] = ![]; } else _0x224dc9[_0x121438(0x812)] && (_0x121438(0x23b) !== 'UterP' ? _0x346905['getElementById'](_0x121438(0x64b))['style'][_0x121438(0x31d)]('--feed-bg-image', 'none') : _0x54d00c[_0x121438(0x1fb)]('[' + _0x8ca0ec(_0x224dc9) + ']\x20' + _0x224dc9[_0x121438(0x812)])); } } return _0x54d00c[_0x121438(0x2c1)]('\x0a'); } } function _0x3a6450(_0x36f0ec, _0x552b0d) { const _0x2ac89a = _0x311e9d; if ('pKoUZ' === _0x2ac89a(0x390)) { const _0xa6d24 = _0x3a002c['getElementById'](_0x2ac89a(0x644)); _0xdca80[_0x2ac89a(0x48c)] && _0x27337e['info'] ? _0xa6d24[_0x2ac89a(0x313)] = ![] : _0xa6d24[_0x2ac89a(0x313)] = !![]; } else { if (!_0x36f0ec || !_0x552b0d) return null; const _0x146bc6 = _0x552b0d['match'](/@([^\s:：,，。!?]+)/); if (!_0x146bc6) return null; const _0x40f354 = _0x146bc6[0x1][_0x2ac89a(0x2f9)](); for (const _0x404958 of _0x36f0ec[_0x2ac89a(0x239)]) { const _0x192cc7 = _0x3f1cb7(_0x404958); if (!_0x192cc7?.[_0x2ac89a(0x2e6)]) continue; if (_0x192cc7[_0x2ac89a(0x2e6)][_0x2ac89a(0x2f9)]() === _0x40f354) return _0x192cc7; if (_0x192cc7['name'][_0x2ac89a(0x2f9)]()[_0x2ac89a(0x279)](_0x40f354)) return _0x192cc7; } return null; } } function _0x307743(_0xbf7c66) { const _0xf37180 = _0x311e9d; if (_0xf37180(0x225) === _0xf37180(0x225)) { const _0x30f331 = _0xbf7c66[_0xf37180(0x2f4)]('{'), _0x447a7d = _0xbf7c66[_0xf37180(0x607)]('}'); if (_0x30f331 >= 0x0 && _0x447a7d > _0x30f331) return _0xbf7c66[_0xf37180(0xb5)](_0x30f331, _0x447a7d + 0x1); return _0xbf7c66; } else _0x43a1e1[_0xf37180(0x393)][_0x535596][_0xf37180(0x754)] = !![], _0x381061(); } function _0x414788(_0x2baec0, _0x24fca2, _0x28af2c) { const _0x295156 = _0x311e9d; if ('KVqVx' !== 'rGJLj') { const _0x45de9a = new Map(_0x24fca2[_0x295156(0x7cc)](_0x271b67 => [String(_0x271b67['id']), _0x271b67])), _0x43e5b5 = _0x441a3b => String(_0x441a3b || '')[_0x295156(0x2f9)]()[_0x295156(0x3d9)](/\s+/g, ''), _0x19e8ee = new Map(_0x24fca2['map'](_0x55dccf => [_0x43e5b5(_0x55dccf[_0x295156(0x2e6)]), _0x55dccf])), _0x49a185 = new Set(_0x28af2c), _0x1640de = { 'events': [] }; for (const _0x10a7c5 of _0x2baec0?.[_0x295156(0x471)] || []) { const _0x4cd5ee = _0x10a7c5[_0x295156(0x2b9)] ?? _0x10a7c5[_0x295156(0x353)] ?? _0x10a7c5[_0x295156(0x8d1)] ?? _0x10a7c5['speaker'] ?? _0x10a7c5[_0x295156(0x837)] ?? _0x10a7c5[_0x295156(0x2e6)]; if (!_0x4cd5ee) continue; let _0x17f499 = _0x45de9a[_0x295156(0xab)](String(_0x4cd5ee)) || _0x19e8ee['get'](_0x43e5b5(_0x4cd5ee)); if (!_0x17f499) continue; const _0x308447 = (_0x10a7c5[_0x295156(0x566)] || _0x10a7c5[_0x295156(0x78c)] || _0x295156(0x44f))[_0x295156(0x2f9)](); if (_0x308447 === _0x295156(0x272)) { const _0x4a0b4f = (_0x10a7c5[_0x295156(0x272)] ?? _0x10a7c5[_0x295156(0x249)] ?? _0x10a7c5[_0x295156(0x52f)] ?? _0x10a7c5[_0x295156(0x212)])?.['trim'](); if (_0x4a0b4f && _0x49a185[_0x295156(0x14d)](_0x4a0b4f)) _0x1640de[_0x295156(0x471)][_0x295156(0x1fb)]({ 'senderId': _0x17f499['id'], 'kind': _0x295156(0x272), 'sticker': _0x4a0b4f }); else { const _0x611e01 = String(_0x10a7c5['content'] ?? _0x10a7c5[_0x295156(0x44f)] ?? '')[_0x295156(0x3e3)]() || _0x295156(0x22d) + (_0x4a0b4f || _0x295156(0x106)) + ']'; if (_0x611e01) _0x1640de[_0x295156(0x471)][_0x295156(0x1fb)]({ 'senderId': _0x17f499['id'], 'kind': _0x295156(0x44f), 'content': _0x611e01 }); } } else { const _0x4c5931 = String(_0x10a7c5[_0x295156(0x812)] ?? _0x10a7c5[_0x295156(0x44f)] ?? _0x10a7c5[_0x295156(0x15a)] ?? '')[_0x295156(0x3e3)](); if (_0x4c5931) _0x1640de['events'][_0x295156(0x1fb)]({ 'senderId': _0x17f499['id'], 'kind': 'text', 'content': _0x4c5931 }); } } return _0x1640de; } else _0x280f8f[_0x295156(0x1fb)]('[' + _0x211de0 + _0x295156(0xb9) + _0x23be23(_0x403714) + ']\x20' + _0x4d2483(_0x119d07[_0x295156(0x812)])[_0x295156(0x3e3)]()); } async function _0x119f87(_0x2805ec) { const _0x382d5d = _0x311e9d; if (!_0x2805ec || !Array[_0x382d5d(0x1d4)](_0x2805ec[_0x382d5d(0x471)]) || _0x2805ec[_0x382d5d(0x471)]['length'] === 0x0) return; const _0x1d667a = _0x510292 => _0x510292 + Math[_0x382d5d(0xf2)](Math[_0x382d5d(0x775)]() * 0x190); let _0x50d1e4 = 0x1f4; for (const _0x223574 of _0x2805ec[_0x382d5d(0x471)]) { if (_0x382d5d(0x7b5) === 'xYdWS') { await new Promise(_0x287aae => setTimeout(_0x287aae, _0x1d667a(_0x50d1e4))), _0x50d1e4 += 0x2bc; const _0x4b8dfd = _0x40321a[_0x382d5d(0x393)]['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x223574[_0x382d5d(0x566)] === 'sticker') { if (_0x382d5d(0x5b9) !== 'oizUT') { const _0x2c47a1 = _0x42bed1[_0x382d5d(0x226)](_0x29ea86 => _0x29ea86[_0x382d5d(0x2e6)] === _0x223574['sticker']); if (_0x2c47a1) { if ('JivJv' !== _0x382d5d(0x484)) _0x5a6ea9[_0x382d5d(0x5e7)] = _0x407816[_0x382d5d(0x5e7)][_0x382d5d(0x16f)](_0x4e2852 => _0x4e2852['id'] !== _0x3792b6), _0x8d0d76[_0x382d5d(0x382)]['forEach'](_0x385f20 => { const _0xb1bcb2 = _0x382d5d; _0x385f20['linkedWorldBookIds'] && (_0x385f20[_0xb1bcb2(0x3d5)] = _0x385f20[_0xb1bcb2(0x3d5)][_0xb1bcb2(0x16f)](_0x208b1b => _0x208b1b !== _0x157d6d)); }), _0xb2a1ff(), _0x32717c('条目已删除。'), _0x41171c(), _0x51109c(_0x382d5d(0x8cc), _0x382d5d(0x551)); else { const _0x260ed7 = { 'role': 'assistant', 'content': _0x382d5d(0x79a) + _0x2c47a1[_0x382d5d(0x2e6)] + ']', 'displayUrl': _0x2c47a1['url'], 'senderId': _0x223574['senderId'], 'timestamp': Date[_0x382d5d(0x6bb)](), 'isOffline': _0x4b8dfd }; _0x40321a[_0x382d5d(0x393)][_0x382d5d(0x1fb)](_0x260ed7); } } } else _0x4ea988(), _0x46d7e4['conversationHistory'] = [], _0x115d6f(); } else { if (_0x223574[_0x382d5d(0x566)] === _0x382d5d(0x242) && _0x223574[_0x382d5d(0x4de)] && _0x223574['artist']) { if (_0x382d5d(0x41e) === 'knwjU') _0x36827d > _0x4afb32 && (_0x2c3085 *= _0x204c61 / _0x7bcf7, _0x4b3d7a = _0x2f1e13); else { const { songName: _0x1242f4, artist: _0x142209 } = _0x223574, _0x48aa15 = { 'role': _0x382d5d(0x18d), 'type': 'music', 'content': _0x382d5d(0x1db) + _0x1242f4 + '\x20-\x20' + _0x142209 + ']', 'songName': _0x1242f4, 'artist': _0x142209, 'senderId': _0x223574[_0x382d5d(0x2b9)], 'timestamp': Date['now'](), 'isOffline': _0x4b8dfd }; try { const _0x1c8ec4 = await _0x117420(_0x1242f4, _0x142209); _0x48aa15[_0x382d5d(0x102)] = _0x1c8ec4['cover'], _0x48aa15['playableUrl'] = _0x1c8ec4[_0x382d5d(0x5cb)]; } catch (_0x51f9e3) { console[_0x382d5d(0x159)]('群聊音乐搜索失败\x20(' + _0x1242f4 + '\x20-\x20' + _0x142209 + '):', _0x51f9e3), _0x48aa15[_0x382d5d(0x102)] = null, _0x48aa15[_0x382d5d(0x89c)] = null; } _0x40321a[_0x382d5d(0x393)][_0x382d5d(0x1fb)](_0x48aa15); } } else { if (_0x223574['kind'] === 'text') { const _0x171a69 = _0x3ce0fa(_0x223574[_0x382d5d(0x812)])[_0x382d5d(0xb5)](0x0, 0x3); for (let _0x34862e = 0x0; _0x34862e < _0x171a69['length']; _0x34862e++) { if (_0x382d5d(0x774) !== _0x382d5d(0xdc)) { if (_0x34862e > 0x0) await new Promise(_0x5cb5e7 => setTimeout(_0x5cb5e7, _0x1d667a(0x190))); const _0x82d463 = { 'role': _0x382d5d(0x18d), 'content': _0x171a69[_0x34862e], 'senderId': _0x223574[_0x382d5d(0x2b9)], 'timestamp': Date[_0x382d5d(0x6bb)](), 'isOffline': _0x4b8dfd }; _0x40321a['conversationHistory'][_0x382d5d(0x1fb)](_0x82d463); } else !_0x2435c1[_0x382d5d(0x889)](_0x382d5d(0x6d0))[_0x382d5d(0xa1)](_0x1b0148[_0x382d5d(0x94)]) && (_0x3dffb7[_0x382d5d(0x1c1)]['remove'](_0x382d5d(0x702)), _0x4b0edd[_0x382d5d(0x1c1)]['remove'](_0x382d5d(0x3e9))); } } } } } else _0x523386[_0x382d5d(0x5ee)] = { ..._0x2a8a71[_0x382d5d(0x5ee)], ..._0x46d377[_0x382d5d(0x5ee)] }; } _0x174e50(), _0x1f2014(); } async function _0x56b7f2(_0x10b171, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x2a57ac = _0x311e9d; if (_0x2a57ac(0x394) === _0x2a57ac(0x394)) { await new Promise(_0x25281b => setTimeout(_0x25281b, 0xa)); if (!_0x40321a[_0x2a57ac(0x5ee)]['endpoint'] || !_0x40321a[_0x2a57ac(0x5ee)]['key'] || !_0x40321a['apiSettings'][_0x2a57ac(0x4e7)]) { if (_0x2a57ac(0x144) !== _0x2a57ac(0x167)) return _0x1bbd68(_0x2a57ac(0x740)), ![]; else _0x595877(_0x1a8626), _0x285c52[_0x2a57ac(0x34a)]('canplaythrough', _0x292a3a), _0x2f8946[_0x2a57ac(0x34a)]('error', _0x2f641c), _0x4b07f7[_0x2a57ac(0x8c7)] = '', _0x3c6408[_0x2a57ac(0x47e)](); } const _0x217fdf = _0x4db4a7(); if (!_0x217fdf || !_0x10b171) return ![]; const _0x13e8ee = _0x9333e5(_0x217fdf['id']), _0x50347e = _0x40321a[_0x2a57ac(0x393)]['at'](-0x1)?.[_0x2a57ac(0x837)] === 'user'; if (!force && !_0x50347e) return ![]; const _0x15c137 = _0x40321a[_0x2a57ac(0x393)]['at'](-0x1)?.[_0x2a57ac(0x7ec)] ?? ![]; if (delayMs) await new Promise(_0x2c088b => setTimeout(_0x2c088b, delayMs)); if (_0x15c137) { if (_0x2a57ac(0x2dc) !== _0x2a57ac(0x2dc)) { const _0x5645e4 = _0x5dfdb0[_0x2a57ac(0x3a7)](_0x2a57ac(0x5cc)), _0x1722fc = _0x1edbb4[_0x2a57ac(0x3a7)](_0x2a57ac(0x118)), _0x40f252 = _0x5399e6[_0x2a57ac(0x3a7)]('widget-artist'), _0x32fc0b = _0x48d145[_0x2a57ac(0x3a7)](_0x2a57ac(0x80e)), _0x502ae7 = _0x422881; _0x502ae7 && _0x502ae7[_0x2a57ac(0x737)] ? (_0x1722fc[_0x2a57ac(0x26b)] = _0x502ae7[_0x2a57ac(0x373)], _0x40f252[_0x2a57ac(0x26b)] = _0x502ae7[_0x2a57ac(0x45d)], _0x5645e4[_0x2a57ac(0x1c1)][_0x2a57ac(0x65b)](_0x2a57ac(0x9d)), _0x5645e4[_0x2a57ac(0x27d)][_0x2a57ac(0x31d)](_0x2a57ac(0x65e), _0x2a57ac(0x462) + _0x502ae7[_0x2a57ac(0x59e)] + ')')) : (_0x1722fc[_0x2a57ac(0x26b)] = _0x2a57ac(0x593), _0x40f252[_0x2a57ac(0x26b)] = _0x2a57ac(0x3df), _0x5645e4[_0x2a57ac(0x1c1)][_0x2a57ac(0x47e)](_0x2a57ac(0x9d)), _0x32fc0b['style'][_0x2a57ac(0x31d)](_0x2a57ac(0x65e), _0x2a57ac(0x87b))); } else document['getElementById'](_0x2a57ac(0x76e))['textContent'] = _0x2a57ac(0x86f); } else _0x212f2a(!![]); let _0x2c5296 = ''; const _0x1e7c24 = _0x4db4a7(); if (_0x1e7c24?.[_0x2a57ac(0x4c5)]?.['isActive']) { const _0x378271 = _0x1e7c24['activeListenSession'], _0x1665b0 = await _0x344a0a(_0x378271[_0x2a57ac(0x428)]); if (_0x1665b0 && _0x1665b0['lyrics']) { const _0x199eaf = _0x5f46c6(_0x1665b0[_0x2a57ac(0x3a5)]); if (_0x199eaf[_0x2a57ac(0x286)] > 0x0) { if (_0x2a57ac(0x6fb) !== _0x2a57ac(0x777)) { const _0x2b4feb = _0x77bdcd[_0x2a57ac(0x431)]; let _0x500dc2 = -0x1; for (let _0x43be7b = 0x0; _0x43be7b < _0x199eaf['length']; _0x43be7b++) { if (_0x2a57ac(0x2ae) === _0x2a57ac(0x448)) _0x13f232[_0x2a57ac(0x42f)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; else { if (_0x2b4feb >= _0x199eaf[_0x43be7b][_0x2a57ac(0x601)]) _0x500dc2 = _0x43be7b; else break; } } const _0x998dfe = _0x199eaf[_0x2a57ac(0x7cc)]((_0x34affe, _0x46e957) => { const _0x11d746 = _0x2a57ac, _0x40ecea = _0x46e957 === _0x500dc2 ? '>>\x20' : ''; return '' + _0x40ecea + _0x34affe[_0x11d746(0x44f)]; })[_0x2a57ac(0x2c1)]('\x0a'); _0x2c5296 = (_0x2a57ac(0x467) + _0x378271[_0x2a57ac(0x45d)] + _0x2a57ac(0x4f3) + _0x378271[_0x2a57ac(0x4de)] + '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a' + _0x998dfe + _0x2a57ac(0x359))[_0x2a57ac(0x3e3)](); } else { const _0x3ca45d = new _0x131e98(); _0x3ca45d['onloadend'] = () => _0x3da971(_0x3ca45d[_0x2a57ac(0x7ba)]), _0x3ca45d['onerror'] = _0x577898, _0x3ca45d['readAsDataURL'](_0x24bd22); } } } } let _0x4188c4 = '', _0xd1f305 = ''; const _0xc85175 = _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0x286)]; if (_0xc85175 > 0x1) { const _0x30b16c = _0x40321a[_0x2a57ac(0x393)][_0xc85175 - 0x2], _0x4e649a = _0x40321a[_0x2a57ac(0x393)][_0xc85175 - 0x1]; if (_0x30b16c[_0x2a57ac(0x7ec)] === ![] && _0x4e649a[_0x2a57ac(0x7ec)] === !![]) { if (_0x2a57ac(0x74) !== 'slEFY') _0xd1f305 = _0x2a57ac(0x6fa) + _0x13e8ee[_0x2a57ac(0x2e6)] + _0x2a57ac(0xdf); else { const _0x4d5743 = _0xf885b4[_0x2a57ac(0x99)](_0x2332ba); _0x5ad446['src'] = _0x4d5743, _0x4651d8['onload'] = () => _0x508c75['revokeObjectURL'](_0x4d5743); } } else { if (_0x30b16c[_0x2a57ac(0x7ec)] === !![] && _0x4e649a[_0x2a57ac(0x7ec)] === ![]) { if (_0x2a57ac(0x750) === _0x2a57ac(0x811)) { const _0x82c3ff = _0x49bf7(_0x401e54[0x1]), _0x3ff525 = _0x3074bb[0x2][_0x2a57ac(0x3e3)](), _0x271270 = _0x40f6fe(_0x2a4fa5[_0x2a57ac(0x1cc)]); let _0x498f02 = null; if (_0x3ff525 === _0x271270[_0x2a57ac(0x2e6)]) _0x498f02 = _0x271270['id']; else { const _0x8f18a2 = _0x27948c(); if (_0x8f18a2[_0x2a57ac(0x78c)] === 'group') { const _0x592e37 = _0x46a4f5[_0x2a57ac(0x382)][_0x2a57ac(0x226)](_0x553169 => _0x8f18a2[_0x2a57ac(0x239)]['includes'](_0x553169['id']) && _0x553169[_0x2a57ac(0x2e6)] === _0x3ff525); if (_0x592e37) _0x498f02 = _0x592e37['id']; } } if (_0x498f02) return { 'type': _0x2a57ac(0x7d7), 'amount': _0x82c3ff, 'recipientId': _0x498f02, 'senderId': _0x2048e5['id'] }; else return { 'type': _0x2a57ac(0x44f), 'content': _0x2a57ac(0x250) + _0x3ff525 + _0x2a57ac(0x39f) }; } else _0xd1f305 = _0x2a57ac(0x5fd) + _0x13e8ee['name'] + _0x2a57ac(0x30d); } } } if (_0x15c137) { if (_0x2a57ac(0x84c) === _0x2a57ac(0x84c)) { const _0x12a4a1 = _0x2a57ac(0x4c9); _0x4188c4 = _0x2a57ac(0x706) + _0x13e8ee[_0x2a57ac(0x2e6)] + _0x2a57ac(0x414) + _0x12a4a1 + _0x2a57ac(0x5df) + _0x10b171[_0x2a57ac(0x2e6)] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x12a4a1 + _0x2a57ac(0x143) + _0x12a4a1 + _0x2a57ac(0x372); } else { const _0x9b40f1 = _0x15600e(_0x528087['id']); if (_0x9b40f1 && _0x9b40f1[_0x2a57ac(0x286)] > 0x0) { const _0x291840 = _0x9b40f1[_0x9b40f1[_0x2a57ac(0x286)] - 0x1]; (!_0x3c9c62 || _0x291840[_0x2a57ac(0x375)] > _0x2327d4[_0x2a57ac(0x375)]) && (_0x42213f = _0x291840); } } } else '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a'; const { omniText: _0x2a7647 } = _0x4fa46e(_0x10b171['id'], _0x217fdf['id']), _0x341e66 = _0x5bc7c6(), _0x301959 = _0x38da7e(_0x10b171['id']), _0x4f0146 = typeof _0x3ce627 === _0x2a57ac(0xac) ? _0x3ce627['replaceAll'](_0x2a57ac(0x7c), _0x10b171['name'])[_0x2a57ac(0x10f)]('{userName}', _0x13e8ee['name'] || '用户') : '', _0x2f701a = _0x42bed1[_0x2a57ac(0x7cc)](_0x4650ea => _0x4650ea[_0x2a57ac(0x2e6)])[_0x2a57ac(0x2c1)](',\x20'); let _0x2b5652 = ''; if (_0x10b171[_0x2a57ac(0x3d5)] && _0x10b171[_0x2a57ac(0x3d5)][_0x2a57ac(0x286)] > 0x0) { if (_0x2a57ac(0x28b) === _0x2a57ac(0x28b)) { const _0x1823b7 = _0x10b171[_0x2a57ac(0x3d5)][_0x2a57ac(0x7cc)](_0x5e77ac => _0x40321a[_0x2a57ac(0x5e7)][_0x2a57ac(0x226)](_0x5a7bcc => _0x5a7bcc['id'] === _0x5e77ac))[_0x2a57ac(0x16f)](Boolean)[_0x2a57ac(0x7cc)](_0x645fcb => _0x2a57ac(0x746) + _0x645fcb['name'] + '\x0a' + _0x645fcb[_0x2a57ac(0x812)])[_0x2a57ac(0x2c1)](''); if (_0x1823b7) _0x2b5652 = _0x2a57ac(0x343) + _0x1823b7; } else { if (!_0x3216c2 || !_0x3ac45b[_0x2a57ac(0x1cc)]) return; const _0x4f5ef9 = { 'role': 'user', 'content': _0x2a57ac(0x280) + _0x2d7be8[_0x2a57ac(0x2e6)] + ']', 'displayUrl': _0x1dd4f9[_0x2a57ac(0x5cb)], 'timestamp': _0x13f8f1[_0x2a57ac(0x6bb)]() }; _0x364f92[_0x2a57ac(0x393)][_0x2a57ac(0x1fb)](_0x4f5ef9), _0x198af8(_0x4f5ef9, _0x5c3038[_0x2a57ac(0x393)]['length'] - 0x1), _0x50c6ba(), _0x39cb62[_0x2a57ac(0x1c1)][_0x2a57ac(0x47e)](_0x2a57ac(0x7de)); } } const _0x4f4359 = _0x13e8ee[_0x2a57ac(0x838)] ? '\x0a\x0a#\x20关于对话者“' + _0x13e8ee[_0x2a57ac(0x2e6)] + '”的补充信息\x0a' + _0x13e8ee[_0x2a57ac(0x838)] : ''; let _0x20312d = ''; const _0x39c170 = new Date(), _0x19587a = _0x112c3b(_0x10b171['id']); _0x20312d = _0x2a57ac(0x356), _0x20312d += _0x2a57ac(0x6e3) + _0x39c170[_0x2a57ac(0x5b6)](_0x2a57ac(0x7a0), { 'dateStyle': 'full', 'timeStyle': 'short' }) + '\x0a'; if (_0x19587a) { const _0x1f7ca8 = new Date(_0x19587a[_0x2a57ac(0x375)]), _0x393de1 = _0x5ea1f0(_0x1f7ca8); _0x20312d += _0x2a57ac(0x50e) + _0x393de1 + '\x0a'; const _0x4eff2a = _0x39c170['toDateString'](), _0x2d6e9a = _0x1f7ca8[_0x2a57ac(0x2d3)](), _0x11cf79 = new Date(); _0x11cf79[_0x2a57ac(0x19a)](_0x39c170[_0x2a57ac(0xec)]() - 0x1); const _0xc77458 = _0x11cf79[_0x2a57ac(0x2d3)](); if (_0x4eff2a === _0x2d6e9a) { if ('CfRyZ' === _0x2a57ac(0x479)) { const _0x43a1fc = _0x25c535[_0x2a57ac(0x822)](_0x74be32, _0x2a57ac(0x4ad)), _0x2367fd = _0x43a1fc[_0x2a57ac(0x16c)](_0x45c02f), _0x51f4a9 = _0x2367fd[_0x2a57ac(0x9f)]({ 'id': _0x6ea383, 'blob': _0x120517 }); _0x51f4a9['onsuccess'] = () => _0x5e36e1(_0x51f4a9[_0x2a57ac(0x7ba)]), _0x51f4a9['onerror'] = () => _0x34ea4e(_0x51f4a9[_0x2a57ac(0x159)]); } else { const _0x126836 = (_0x39c170 - _0x1f7ca8) / (0x3e8 * 0x3c); if (_0x126836 < 0x3c) _0x20312d += _0x2a57ac(0x66d); else { if (_0x2a57ac(0xaf) !== _0x2a57ac(0xaf)) { _0x10a379[_0x2a57ac(0x815)] = _0x2a57ac(0x69c); return; } else _0x20312d += '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概' + Math[_0x2a57ac(0x824)](_0x126836 / 0x3c) + _0x2a57ac(0x540); } } } else { if (_0xc77458 === _0x2d6e9a) 'mGcKf' === _0x2a57ac(0x39c) ? _0x1bf226 ? _0x1dedf2['classList']['add'](_0x2a57ac(0x6d4)) : _0x4c59a5[_0x2a57ac(0x1c1)][_0x2a57ac(0x47e)](_0x2a57ac(0x6d4)) : _0x20312d += _0x2a57ac(0x5ce); else { const _0x47f39c = Math[_0x2a57ac(0x824)]((_0x39c170 - _0x1f7ca8) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x20312d += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x47f39c + _0x2a57ac(0x5a9); } } } else { if (_0x2a57ac(0x1ea) === _0x2a57ac(0x1ea)) _0x20312d += _0x2a57ac(0x86b); else { const _0x4667e8 = _0x197d4f ?? _0x60b7b2[_0x2a57ac(0x815)][_0x2a57ac(0x3e3)](); if (_0x4667e8 === '' || !_0x5ad55e[_0x2a57ac(0x1cc)]) return; const _0x59c6fa = _0x2c5221[_0x2a57ac(0x889)](_0x2a57ac(0x4a6)), _0xc59c44 = _0x59c6fa['id'] === _0x2a57ac(0x2a1), _0x212f41 = { 'role': 'user', 'content': _0x4667e8, 'timestamp': _0x158536['now'](), 'isOffline': _0xc59c44 }; _0x177815[_0x2a57ac(0x8bc)] && (_0x212f41[_0x2a57ac(0x581)] = { ..._0x46051c[_0x2a57ac(0x8bc)] }), _0xee19cf[_0x2a57ac(0x393)]['push'](_0x212f41), _0x4de2f7(), _0x219885(), !_0x4947ea && (_0x448113[_0x2a57ac(0x815)] = ''), _0x4ace08(); } } const _0x4fb4e0 = ('\x0a' + _0x4188c4 + _0x2a57ac(0x2ec) + _0x10b171[_0x2a57ac(0x2e6)] + _0x2a57ac(0x38a) + _0x10b171[_0x2a57ac(0x2e6)] + _0x2a57ac(0xea) + _0x10b171['name'] + _0x2a57ac(0x7e7) + _0x2f701a + _0x2a57ac(0x809) + _0x4f0146 + '\x0a')[_0x2a57ac(0x3e3)](), _0x16d0a2 = [{ 'role': 'system', 'content': _0x4fb4e0 }], _0xf8d481 = (_0x2a57ac(0x871) + (_0x10b171[_0x2a57ac(0x838)] || _0x2a57ac(0x1b8)) + '\x0a' + _0x4f4359 + '\x20\x0a' + _0x2a7647 + '\x0a' + _0x341e66 + '\x0a' + _0x301959 + _0x2a57ac(0x53c) + _0x2c5296 + '\x0a' + _0x20312d + '\x0a' + _0x2b5652 + '\x0a')[_0x2a57ac(0x3e3)](); _0xf8d481[_0x2a57ac(0x3d9)](/#.*|\s/g, '') && (_0x16d0a2[_0x2a57ac(0x1fb)]({ 'role': 'user', 'content': _0xf8d481 }), _0x16d0a2[_0x2a57ac(0x1fb)]({ 'role': 'assistant', 'content': _0x2a57ac(0x20e) })); const _0x13f191 = _0x40321a[_0x2a57ac(0x42f)]?.[_0x2a57ac(0x543)] ?? 0x64, _0x2ea772 = _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0xb5)](-_0x13f191); for (const _0x21f7ff of _0x2ea772) { const _0x9d72af = _0x21f7ff[_0x2a57ac(0x837)] === 'ai' || _0x21f7ff[_0x2a57ac(0x837)] === _0x2a57ac(0x18d) ? _0x2a57ac(0x18d) : _0x2a57ac(0x447); let _0x3c7e4a = { 'role': _0x9d72af, 'content': _0x21f7ff[_0x2a57ac(0x812)] }, _0x315f5b = !!_0x21f7ff['content']; if (_0x21f7ff[_0x2a57ac(0x220)] && _0x21f7ff['content'][_0x2a57ac(0x4fe)]('表情')) { if (_0x2a57ac(0x25a) !== _0x2a57ac(0x1ee)) { const _0x2d24c7 = _0x21f7ff['content'][_0x2a57ac(0x33f)](/：(.*?)]$/); _0x3c7e4a[_0x2a57ac(0x812)] = _0x2a57ac(0x22d) + (_0x2d24c7 ? _0x2d24c7[0x1] : '未知表情') + ']', _0x16d0a2[_0x2a57ac(0x1fb)](_0x3c7e4a); } else _0x413464[_0x2a57ac(0x27d)][_0x2a57ac(0x5a4)] = _0x2a57ac(0x87b), _0x2cd7f3[_0x2a57ac(0x27d)][_0x2a57ac(0x5a4)] = _0x2a57ac(0x7dc); } else { let _0x2b6fc4 = null; if (_0x21f7ff[_0x2a57ac(0x888)]) _0x2b6fc4 = _0x21f7ff[_0x2a57ac(0x888)]; else { if (_0x21f7ff[_0x2a57ac(0x3a0)]) try { if (_0x2a57ac(0x194) !== 'qVgew') { const _0x327ca2 = await _0x500f4d(_0x21f7ff[_0x2a57ac(0x3a0)]); _0x327ca2 && (_0x2b6fc4 = await _0x5cb5e3(_0x327ca2)); } else _0x29d824 += '\x20[并分享了歌曲:\x20' + _0x196faa[_0x2a57ac(0x4de)] + '\x20-\x20' + _0xbfe6d3[_0x2a57ac(0x45d)] + ']'; } catch (_0x2f4fd2) { console[_0x2a57ac(0x159)]('在准备API数据时，从IndexedDB读取图片失败:', _0x2f4fd2); } } _0x2b6fc4 && (_0x3c7e4a[_0x2a57ac(0x888)] = _0x2b6fc4, _0x315f5b = !![]), _0x315f5b && _0x16d0a2[_0x2a57ac(0x1fb)](_0x3c7e4a); } } try { const _0x28ae3f = await _0x56cc62(_0x16d0a2); if (!_0x28ae3f) return ![]; if (_0x15c137) try { if (_0x2a57ac(0x2f6) !== _0x2a57ac(0x7df)) { let _0x249f82 = _0x28ae3f[_0x2a57ac(0x3e3)](); const _0x109f0a = _0x249f82['match'](/(\[[\s\S]*\])/); _0x109f0a && (_0x249f82 = _0x109f0a[0x1]); const _0xc2359e = JSON[_0x2a57ac(0x5b1)](_0x249f82); if (Array['isArray'](_0xc2359e)) { if (_0x2a57ac(0x120) !== _0x2a57ac(0x618)) { _0x40321a[_0x2a57ac(0x38b)] = _0xc2359e, _0x40321a[_0x2a57ac(0x779)][_0x10b171['id']] = [..._0xc2359e], _0x104d57(); const _0x2dfdc5 = _0xc2359e[_0x2a57ac(0x7cc)](_0x48ca81 => _0x48ca81[_0x2a57ac(0x244)] === _0x2a57ac(0x37f) ? _0x48ca81[_0x2a57ac(0x175)] : _0x48ca81[_0x2a57ac(0x244)] + ':\x20' + _0x48ca81[_0x2a57ac(0x175)])[_0x2a57ac(0x2c1)]('\x0a\x0a'); _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0x1fb)]({ 'role': _0x2a57ac(0x18d), 'senderId': _0x10b171['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x2dfdc5 }); } else _0xb31116[_0x2a57ac(0x7d)](_0x1c29ed); } } else { const _0xf632ac = _0x3cb6d1(_0x140359[_0x2a57ac(0x7d9)]); _0xf632ac && (_0x12c54e = _0xf632ac[_0x2a57ac(0x2e6)], _0x1ebc97 = _0xf632ac['avatar']); } } catch (_0x5c31ea) { console[_0x2a57ac(0x159)](_0x2a57ac(0x2b3), _0x5c31ea, '原始文本:', _0x28ae3f), _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0x1fb)]({ 'role': _0x2a57ac(0x18d), 'senderId': _0x10b171['id'], 'timestamp': Date[_0x2a57ac(0x6bb)](), 'isOffline': !![], 'content': _0x2a57ac(0x33b) + _0x28ae3f + ']' }); } else { const _0x17c1fe = _0x536f38(_0x28ae3f), _0x5ae15d = _0x17c1fe['map'](_0xbf4dac => { const _0x330744 = _0x2a57ac, _0x308f62 = _0xbf4dac[_0x330744(0x3e3)](), _0xa8555f = _0x308f62[_0x330744(0x33f)](/^\[sticker:(.*?)\]$/), _0x12c629 = _0x308f62[_0x330744(0x33f)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x1bc686 = _0x308f62[_0x330744(0x33f)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x1bc686) return { 'type': 'music', 'songName': _0x1bc686[0x1]['trim'](), 'artist': _0x1bc686[0x2][_0x330744(0x3e3)]() }; else { if (_0xa8555f) return { 'type': _0x330744(0x272), 'name': _0xa8555f[0x1][_0x330744(0x3e3)]() }; else { if (_0x12c629) { const _0xd648d = parseFloat(_0x12c629[0x1]), _0x186188 = _0x12c629[0x2][_0x330744(0x3e3)](), _0x974d4c = _0x9333e5(_0x40321a[_0x330744(0x1cc)]); let _0x3b2895 = null; if (_0x186188 === _0x974d4c[_0x330744(0x2e6)]) _0x330744(0x2f2) !== _0x330744(0x2f2) ? (_0x4c9863[_0x330744(0x1fb)]({ 'role': _0x330744(0x447), 'content': _0x18c243 }), _0x2bef86[_0x330744(0x1fb)]({ 'role': _0x330744(0x18d), 'content': _0x330744(0x20e) })) : _0x3b2895 = _0x974d4c['id']; else { const _0x2d0956 = _0x4db4a7(); if (_0x2d0956[_0x330744(0x78c)] === _0x330744(0x3bc)) { if (_0x330744(0x6b5) === _0x330744(0x661)) { const _0x519a7b = _0x401dbb(_0x227095[_0x330744(0x7d9)])?.[_0x330744(0x2e6)] || '未知'; return _0x330744(0x72e) + _0x519a7b + _0x330744(0x1e2) + _0x2089db['content'] + _0x330744(0x4d9); } else { const _0x2d198b = _0x40321a[_0x330744(0x382)]['find'](_0x3d5e64 => _0x2d0956[_0x330744(0x239)]['includes'](_0x3d5e64['id']) && _0x3d5e64['name'] === _0x186188); if (_0x2d198b) _0x3b2895 = _0x2d198b['id']; } } } if (_0x3b2895) return { 'type': 'transfer', 'amount': _0xd648d, 'recipientId': _0x3b2895, 'senderId': _0x10b171['id'] }; else return { 'type': _0x330744(0x44f), 'content': '(想转账给“' + _0x186188 + _0x330744(0x39f) }; } else { if (_0x308f62) return { 'type': _0x330744(0x44f), 'content': _0x308f62 }; } } } return null; })[_0x2a57ac(0x16f)](Boolean), _0x32362c = async _0x334bb8 => { const _0x1758f6 = _0x2a57ac, _0x1e83a3 = { 'role': _0x1758f6(0x18d), 'senderId': _0x10b171['id'], 'timestamp': Date[_0x1758f6(0x6bb)](), 'isOffline': _0x15c137 }; if (_0x334bb8[_0x1758f6(0x78c)] === 'music') { if (_0x1758f6(0x2ce) !== 'cjXsZ') { const _0x529212 = _0x2ee8d2(); _0x529212 && _0x529212[_0x1758f6(0x4c5)] && _0x529212['activeListenSession'][_0x1758f6(0x219)] && (_0x53f4fb[_0x1758f6(0x27d)][_0x1758f6(0x5a4)] = _0x1758f6(0x564), _0x46025a(() => _0x5cf35b[_0x1758f6(0x1c1)]['add'](_0x1758f6(0x7de)), 0xa)); } else { const { songName: _0x456c80, artist: _0x2071f5 } = _0x334bb8; _0x1e83a3[_0x1758f6(0x78c)] = _0x1758f6(0x242), _0x1e83a3[_0x1758f6(0x812)] = _0x1758f6(0x1db) + _0x456c80 + _0x1758f6(0x604) + _0x2071f5 + ']'; try { const _0x326422 = await _0x117420(_0x456c80, _0x2071f5); let _0x513fa2 = null; if (_0x326422[_0x1758f6(0x59e)]) { if (_0x1758f6(0x731) === 'muzEK') { const _0x4cd32a = await _0x3cb589(_0x326422['cover']); _0x513fa2 = _0x1758f6(0x62d) + Date[_0x1758f6(0x6bb)]() + '_' + Math['random'](), await _0x5c7ad7(_0x513fa2, _0x4cd32a); } else return new _0x5af25f((_0x54297b, _0x59d003) => { const _0x9652e = _0x1758f6, _0x2ff2d4 = new _0x3ec59a(); _0x2ff2d4['onloadend'] = () => _0x54297b(_0x2ff2d4['result']), _0x2ff2d4[_0x9652e(0x3bd)] = _0x59d003, _0x2ff2d4['readAsDataURL'](_0x5f4116); }); } Object[_0x1758f6(0x616)](_0x1e83a3, { 'songName': _0x456c80, 'artist': _0x2071f5, 'coverId': _0x513fa2, 'playableUrl': _0x326422['url'] }); } catch (_0x5a77a8) { Object[_0x1758f6(0x616)](_0x1e83a3, { 'songName': _0x456c80, 'artist': _0x2071f5, 'coverId': null, 'playableUrl': null }); } } } else { if (_0x334bb8[_0x1758f6(0x78c)] === _0x1758f6(0x272)) { const _0x4140fe = _0x42bed1['find'](_0x9eb394 => _0x9eb394[_0x1758f6(0x2e6)] === _0x334bb8[_0x1758f6(0x2e6)]); if (_0x4140fe) Object[_0x1758f6(0x616)](_0x1e83a3, { 'content': _0x1758f6(0x79a) + _0x4140fe[_0x1758f6(0x2e6)] + ']', 'displayUrl': _0x4140fe['url'] }); else _0x1e83a3[_0x1758f6(0x812)] = _0x1758f6(0x22d) + _0x334bb8[_0x1758f6(0x2e6)] + ']'; } else { if (_0x334bb8[_0x1758f6(0x78c)] === 'transfer') { const _0x2c0485 = _0x334bb8['recipientId'] === _0x9333e5(_0x40321a[_0x1758f6(0x1cc)])['id'] ? _0x9333e5(_0x40321a[_0x1758f6(0x1cc)]) : _0x3f1cb7(_0x334bb8[_0x1758f6(0x5b8)]); Object[_0x1758f6(0x616)](_0x1e83a3, { 'type': _0x1758f6(0x7d7), 'amount': _0x334bb8[_0x1758f6(0x376)], 'recipientId': _0x334bb8[_0x1758f6(0x5b8)], 'content': _0x1758f6(0x492) + (_0x2c0485?.['name'] || '未知') + _0x1758f6(0x442) + _0x334bb8['amount'] + ']' }); } else { const _0x1aa9c9 = _0x498576(_0x334bb8[_0x1758f6(0x812)]); Object['assign'](_0x1e83a3, { 'content': _0x1aa9c9[_0x1758f6(0x812)], 'quotedMessage': _0x1aa9c9[_0x1758f6(0x581)] }); } } } return _0x1e83a3; }, _0xf1e5df = await Promise['all'](_0x5ae15d[_0x2a57ac(0x7cc)](_0x32362c)); for (const _0x35c1f1 of _0xf1e5df) { (_0x35c1f1[_0x2a57ac(0x812)] || _0x35c1f1[_0x2a57ac(0x220)] || _0x35c1f1[_0x2a57ac(0x78c)] === 'music') && (await new Promise(_0x18cb3e => setTimeout(_0x18cb3e, 0x12c + Math[_0x2a57ac(0x775)]() * 0x190)), _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0x1fb)](_0x35c1f1), _0x1f2014()); } } return _0x174e50(), _0x1f2014(), !![]; } catch (_0x28ac3c) { if (_0x2a57ac(0x32d) !== _0x2a57ac(0x1d0)) { if (_0x28ac3c[_0x2a57ac(0x2e6)] !== 'AbortError') { if ('umvbo' === _0x2a57ac(0x7f7)) { const _0x1be697 = _0x5c7fb1['id'], _0xfa3fea = _0x2a57ac(0x3bf) + _0x1be697, _0xc14da7 = _0x25c159['getItem'](_0xfa3fea), _0x257cbc = _0x5027f6[_0x2a57ac(0x889)](_0x2a57ac(0x408)); if (_0xc14da7) _0x257cbc[_0x2a57ac(0x49f)] = _0x2a57ac(0x8de) + _0xc14da7 + _0x2a57ac(0x464); else { const _0x36efdc = _0x1d0a29['querySelector'](_0x2a57ac(0x264) + _0x1be697 + _0x2a57ac(0x4f7) + _0x1be697 + _0x2a57ac(0x758))?.[_0x2a57ac(0x49f)]; _0x36efdc && (_0x257cbc[_0x2a57ac(0x49f)] = _0x36efdc); } } else { console[_0x2a57ac(0x159)](_0x2a57ac(0x8ae), _0x28ac3c); const _0x1501db = { 'role': _0x2a57ac(0x18d), 'content': '错误:\x20' + _0x28ac3c[_0x2a57ac(0x15a)], 'senderId': _0x10b171['id'], 'isOffline': _0x15c137 }; _0x40321a[_0x2a57ac(0x393)][_0x2a57ac(0x1fb)](_0x1501db), _0x1f2014(); } } return ![]; } else _0x1b6d72 += _0x2a57ac(0x825) + _0x5bc737[_0x2a57ac(0x824)](_0x1933b4 / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'; } finally { _0x212f2a(![]); } } else _0x34fb44 = _0x3fb653[_0x2a57ac(0x8b4)](_0x2a57ac(0x764)); } async function _0x21849f() { const _0x2d3770 = _0x311e9d; if ('yjqPG' === _0x2d3770(0x1d8)) { _0x357434(_0x2d3770(0x3ad)); return; } else { const _0x2deaf8 = _0x4db4a7(); if (!_0x2deaf8 || _0x2deaf8['type'] !== _0x2d3770(0x64f)) { _0x1bbd68(_0x2d3770(0x844)); return; } if (_0x40321a[_0x2d3770(0x160)]) { if (_0x2d3770(0x75f) === _0x2d3770(0x75f)) { _0x1bbd68('我正在说话呢，别打岔！'); return; } else _0x34aec2(), _0x2143bc(_0x2d3770(0x7ce)); } const _0x488ff6 = await _0x4849f2(_0x2d3770(0x85c)); if (!_0x488ff6) return; _0x3396e7(!![], _0x2d3770(0x4cd)), _0xe61e0a[_0x2d3770(0x815)] = '', _0xa8a51e[_0x2d3770(0x1c1)][_0x2d3770(0x65b)]('show'), _0x40321a[_0x2d3770(0x160)] = !![]; try { const _0x176004 = _0x3f1cb7(_0x2deaf8[_0x2d3770(0x239)][0x0]), _0x22ed3c = _0x9333e5(_0x2deaf8['id']), _0x4bebfd = _0x4f7cd6(_0x2deaf8['id']); if (_0x4bebfd[_0x2d3770(0x286)] === 0x0) { _0xe61e0a[_0x2d3770(0x815)] = _0x2d3770(0x69c); return; } const _0xa00e74 = _0x4bebfd['map'](_0x279e4f => { const _0x31bc9c = _0x2d3770; if (_0x31bc9c(0x44b) !== _0x31bc9c(0x44b)) { if (_0x1dd7cc) _0x353027(_0x3e0823); const _0x5b877f = _0x111bc6['target']['closest'](_0x31bc9c(0x40a)); if (!_0x5b877f) return; const _0x1b0933 = _0x52a659(_0x5b877f['dataset']['historyIndex'], 0xa); if (_0x366a44(_0x1b0933)) return; const _0x597736 = () => { _0x2d3da2 = _0x3ecc56(() => { const _0x18dad9 = _0x4fd4; if (_0x54f36['type'] === _0x18dad9(0xd0)) _0x65e75e['preventDefault'](); _0x9d5039(_0x1b0933); }, 0x320); }, _0x153393 = () => { if (_0x49b209) _0xce3ee8(_0x5266ef); }; _0x3b361e[_0x31bc9c(0x215)](_0x31bc9c(0xa3), _0x153393, { 'once': !![] }), _0x262b15[_0x31bc9c(0x215)](_0x31bc9c(0x7e2), _0x153393, { 'once': !![] }), _0x183723[_0x31bc9c(0x215)](_0x31bc9c(0x494), _0x153393, { 'once': !![] }), _0x150d9b[_0x31bc9c(0x215)](_0x31bc9c(0x690), _0x153393, { 'once': !![] }), _0x597736(); } else { const _0x3afc68 = new Date(_0x279e4f[_0x31bc9c(0x375)]), _0x5989d8 = _0x3afc68[_0x31bc9c(0x1b2)]() + '-' + String(_0x3afc68['getMonth']() + 0x1)[_0x31bc9c(0x26e)](0x2, '0') + '-' + String(_0x3afc68[_0x31bc9c(0xec)]())['padStart'](0x2, '0'), _0x27ac99 = String(_0x3afc68['getHours']())[_0x31bc9c(0x26e)](0x2, '0') + ':' + String(_0x3afc68[_0x31bc9c(0x46a)]())[_0x31bc9c(0x26e)](0x2, '0'); let _0x503631 = '未知'; _0x279e4f[_0x31bc9c(0x837)] === _0x31bc9c(0x447) ? _0x503631 = _0x22ed3c['name'] : _0x503631 = _0x176004[_0x31bc9c(0x2e6)]; let _0x252a71 = _0x279e4f[_0x31bc9c(0x812)]; if (_0x279e4f[_0x31bc9c(0x220)]) _0x252a71 = _0x31bc9c(0x73c); if (_0x279e4f[_0x31bc9c(0x3a0)]) _0x252a71 = _0x31bc9c(0x70b); return '[' + _0x5989d8 + '\x20' + _0x27ac99 + _0x31bc9c(0xb9) + _0x503631 + _0x31bc9c(0x7ef) + _0x252a71; } })[_0x2d3770(0x2c1)]('\x0a'), _0xfec67d = _0x62d7d2[_0x2d3770(0x3d9)](/{charName}/g, _0x176004['name'])['replace'](/{userName}/g, _0x22ed3c[_0x2d3770(0x2e6)]), _0x39fcb1 = [{ 'role': _0x2d3770(0x70d), 'content': _0xfec67d }, { 'role': _0x2d3770(0x447), 'content': _0xa00e74 }], _0x17355e = await _0x56cc62(_0x39fcb1); _0xe61e0a[_0x2d3770(0x815)] = _0x17355e || '#\x20总结失败了，可能是记录太长或太复杂。', _0xe61e0a[_0x2d3770(0x19c)] = 0x0; } catch (_0x38d3c8) { console['error'](_0x2d3770(0x198), _0x38d3c8), _0xe61e0a[_0x2d3770(0x815)] = '#\x20发生错误：\x0a' + _0x38d3c8[_0x2d3770(0x15a)]; } finally { _0x3396e7(![]), _0x40321a[_0x2d3770(0x160)] = ![]; } } } async function _0x5c5350() { const _0x1d3f1b = _0x311e9d; console[_0x1d3f1b(0x336)](_0x1d3f1b(0x44c)); if (!_0x40321a['apiSettings'][_0x1d3f1b(0x7e6)] || !_0x40321a['apiSettings'][_0x1d3f1b(0x11c)] || !_0x40321a['apiSettings']['model']) { _0x1bbd68(_0x1d3f1b(0x740)); return; } const _0x435068 = _0x40321a[_0x1d3f1b(0x393)]['at'](-0x1)?.[_0x1d3f1b(0x837)] === _0x1d3f1b(0x447); if (!_0x435068 || _0x40321a['isGenerating']) return; const _0x5d3839 = _0x4db4a7(); if (!_0x5d3839) return; _0x40321a[_0x1d3f1b(0x160)] = !![], _0x212f2a(!![]); try { if (_0x1d3f1b(0x5d9) !== 'TzmmQ') { if (_0x5d3839['type'] === _0x1d3f1b(0x64f)) { if (_0x1d3f1b(0x772) === _0x1d3f1b(0x8a6)) _0x1f770e['push'](_0x5cb9a9['id']); else { const _0x26cdee = _0x3f1cb7(_0x5d3839[_0x1d3f1b(0x239)][0x0]); console[_0x1d3f1b(0x336)](_0x1d3f1b(0x4f6)); if (_0x26cdee) await _0x56b7f2(_0x26cdee, { 'force': !![] }); } } else { if (_0x1d3f1b(0x217) !== _0x1d3f1b(0x217)) _0x3caf06 = _0x57570f[_0x1d3f1b(0x7c0)]['find'](_0x2f30df => _0x2f30df['id'] === _0x3f5803[_0x1d3f1b(0x17e)]) || _0x5691a9[_0x1d3f1b(0x7c0)][0x0]; else { const _0x1cceea = await _0x584b26(); if (_0x1cceea && _0x1cceea[_0x1d3f1b(0x471)]?.['length']) await _0x119f87(_0x1cceea); else { if (_0x1d3f1b(0x6f) !== _0x1d3f1b(0x6f)) { const _0x2325d4 = _0x222207[_0x1d3f1b(0x3a7)](_0xc4a9bd); if (_0x2325d4) _0x2325d4['src'] = _0x2a296c[_0x1d3f1b(0x102)]; } else { console['warn']('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x866a9e = _0x5d3839[_0x1d3f1b(0x239)][_0x1d3f1b(0x7cc)](_0x3f1cb7)[_0x1d3f1b(0x16f)](Boolean); if (!_0x866a9e[_0x1d3f1b(0x286)]) return; let _0x322b56 = 0x0; for (const _0xce66b1 of _0x866a9e) { if (_0x1d3f1b(0x221) !== _0x1d3f1b(0x7b4)) _0x56b7f2(_0xce66b1, { 'force': !![], 'delayMs': _0x322b56 }), _0x322b56 += 0x1f4; else { if (_0x16faf5 === null) return; const _0x285824 = _0x35f8c4[_0x1d3f1b(0x393)][_0x3c6f65]; if (!_0x285824) return; _0x552549['value'] = _0x285824[_0x1d3f1b(0x812)], _0x21aafc(), _0x57c6f8['classList'][_0x1d3f1b(0x65b)](_0x1d3f1b(0x7de)), _0x4fdade[_0x1d3f1b(0x7c9)](); } } } } } } } else _0x4c3b01[_0x1d3f1b(0x1fb)](..._0x3c8567(_0x5713ae)); } catch (_0x39e02d) { if (_0x1d3f1b(0x619) === 'Wymeu') { _0x27eed5[_0x1d3f1b(0x393)] = [], _0x5c597d(); return; } else _0x39e02d['name'] !== _0x1d3f1b(0x75c) && ('FOGZV' !== _0x1d3f1b(0x13b) ? (console[_0x1d3f1b(0x159)]('获取AI响应失败:', _0x39e02d), _0xe4f38d({ 'role': 'assistant', 'content': _0x1d3f1b(0x218) + _0x39e02d[_0x1d3f1b(0x15a)] }, _0x40321a[_0x1d3f1b(0x393)][_0x1d3f1b(0x286)] - 0x1)) : (_0x14d9c9 = { 'characterId': _0x459031, 'entries': [] }, _0x368edd[_0x1d3f1b(0x7e5)]['push'](_0x3de329))); } finally { _0x40321a['isGenerating'] = ![], _0x212f2a(![]); } } function _0x12d849(_0x2162a9, _0x180b59) { const _0x1a5f98 = _0x311e9d, _0x10b91a = _0x180b59['toLowerCase'](), _0x271fd2 = _0x2162a9['toLowerCase'](); if (_0x10b91a[_0x1a5f98(0x279)](_0x1a5f98(0x61d))) return _0x1a5f98(0x85d); if (_0x271fd2['includes'](_0x1a5f98(0x262))) return _0x1a5f98(0x85d); if (_0x271fd2[_0x1a5f98(0x4fe)]('googleapis.com')) return _0x1a5f98(0x469); if (_0x10b91a[_0x1a5f98(0x279)]('gemini')) return _0x1a5f98(0x469); return 'openai'; } async function _0x56cc62(_0x51c737, _0x5049e7 = {}) { const _0x35f4ae = _0x311e9d; _0x40321a['currentAbortController'] && _0x40321a['currentAbortController'][_0x35f4ae(0x87d)](_0x35f4ae(0x181)); _0x40321a[_0x35f4ae(0x535)] = new AbortController(); const _0x491661 = _0x40321a[_0x35f4ae(0x535)][_0x35f4ae(0x55c)], { endpoint: _0x23a978, key: _0x6302d3, model: _0x2a519a } = _0x40321a[_0x35f4ae(0x5ee)], _0x2d8529 = !!_0x5049e7[_0x35f4ae(0x4ff)], _0x57a358 = _0x12d849(_0x23a978, _0x2a519a); console[_0x35f4ae(0x336)]('Detected\x20API\x20provider:\x20' + _0x57a358); let _0x2c4069 = ''; try { if (_0x35f4ae(0x3fc) === _0x35f4ae(0x246)) _0x1d1306[_0x35f4ae(0x47e)](); else { switch (_0x57a358) { case _0x35f4ae(0x85d): { const _0x3bb443 = _0x57f5b7(_0x6302d3), _0x28724b = _0x51c737[_0x35f4ae(0x226)](_0x119d75 => _0x119d75['role'] === _0x35f4ae(0x70d))?.[_0x35f4ae(0x812)] || '', _0x4886e0 = _0x51c737[_0x35f4ae(0x16f)](_0x13c932 => _0x13c932[_0x35f4ae(0x837)] !== _0x35f4ae(0x70d)), _0x4b0b6e = { 'model': _0x2a519a, 'system': _0x28724b, 'messages': _0x4886e0[_0x35f4ae(0x7cc)](_0x3fcd63 => ({ 'role': _0x3fcd63[_0x35f4ae(0x837)], 'content': [{ 'type': _0x35f4ae(0x44f), 'text': _0x3fcd63[_0x35f4ae(0x812)] }] })), 'max_tokens': 0x1000 }, _0x561b20 = await fetch(_0x23a978, { 'method': 'POST', 'headers': { 'Content-Type': _0x35f4ae(0xb4), 'x-api-key': _0x3bb443, 'anthropic-version': _0x35f4ae(0x833) }, 'body': JSON[_0x35f4ae(0x504)](_0x4b0b6e), 'signal': _0x491661 }); if (!_0x561b20['ok']) { const _0x2d7b2d = await _0x561b20[_0x35f4ae(0x4ff)]()['catch'](() => ({})); throw new Error(_0x35f4ae(0x5d2) + _0x561b20['status'] + _0x35f4ae(0x604) + (_0x2d7b2d[_0x35f4ae(0x159)]?.[_0x35f4ae(0x15a)] || _0x561b20['statusText'])); } const _0x579c41 = await _0x561b20['json'](); _0x2c4069 = _0x579c41[_0x35f4ae(0x812)]?.[0x0]?.[_0x35f4ae(0x44f)] || ''; break; } case _0x35f4ae(0x469): { const _0x191917 = _0x57f5b7(_0x6302d3), _0x5266cc = _0x23a978['includes'](_0x35f4ae(0x13c)), _0x4535fd = _0x4052d5 => { const _0x30c788 = _0x35f4ae, _0x1bcd46 = []; if (_0x4052d5[_0x30c788(0x812)]) _0x1bcd46['push']({ 'text': _0x4052d5[_0x30c788(0x812)] }); if (_0x4052d5['image']) { const _0xc1a3d9 = _0x4052d5[_0x30c788(0x888)][_0x30c788(0x480)](',')[0x1], _0x6d6455 = _0x4052d5[_0x30c788(0x888)][_0x30c788(0x23c)](_0x4052d5[_0x30c788(0x888)][_0x30c788(0x2f4)](':') + 0x1, _0x4052d5[_0x30c788(0x888)]['indexOf'](';')) || _0x30c788(0x4fb); _0x1bcd46[_0x30c788(0x1fb)]({ 'inline_data': { 'mime_type': _0x6d6455, 'data': _0xc1a3d9 } }); } return _0x1bcd46; }, _0x25dedd = _0x51c737[_0x35f4ae(0x7cc)](_0x520324 => ({ 'role': _0x520324[_0x35f4ae(0x837)] === _0x35f4ae(0x18d) ? 'model' : _0x520324[_0x35f4ae(0x837)] === _0x35f4ae(0x70d) ? _0x35f4ae(0x447) : _0x520324['role'], 'parts': _0x4535fd(_0x520324) }))[_0x35f4ae(0x16f)](_0x20de81 => _0x20de81['parts']['length'] > 0x0), _0x54496c = { 'contents': _0x25dedd }; _0x2d8529 && _0x5266cc && (_0x54496c['generationConfig'] = { 'response_mime_type': 'application/json' }); const _0x1466e1 = _0x23a978 + _0x35f4ae(0x78a) + _0x2a519a + _0x35f4ae(0x662) + _0x191917 + '&alt=sse', _0x3b9d8d = await fetch(_0x1466e1, { 'method': _0x35f4ae(0x4a3), 'headers': { 'Content-Type': 'application/json' }, 'body': JSON[_0x35f4ae(0x504)](_0x54496c), 'signal': _0x491661 }); if (!_0x3b9d8d['ok']) throw new Error('Gemini\x20API\x20Error:\x20' + _0x3b9d8d[_0x35f4ae(0x852)]); const _0x5efc6c = _0x3b9d8d['body'][_0x35f4ae(0x235)](), _0x598163 = new TextDecoder(); let _0x4982f6 = ''; while (!![]) { if (_0x35f4ae(0x402) === 'bVWoz') return ''; else { if (_0x491661['aborted']) { if (_0x35f4ae(0x445) !== _0x35f4ae(0x3f0)) { console[_0x35f4ae(0x336)](_0x35f4ae(0x80a)), _0x5efc6c[_0x35f4ae(0x256)](); break; } else _0x138b52[_0x35f4ae(0x159)]('群聊音乐搜索失败\x20(' + _0x3c486c + _0x35f4ae(0x604) + _0x5f09d3 + '):', _0x382ffc), _0x27b369[_0x35f4ae(0x102)] = null, _0x163c6f[_0x35f4ae(0x89c)] = null; } const { done: _0x5c2aa2, value: _0x1a1353 } = await _0x5efc6c[_0x35f4ae(0x765)](); if (_0x5c2aa2) break; const _0x27128c = _0x598163[_0x35f4ae(0x7f)](_0x1a1353, { 'stream': !![] }), _0x56bb9b = _0x27128c[_0x35f4ae(0x480)]('\x0a')['filter'](_0x4c26bd => _0x4c26bd[_0x35f4ae(0x3e3)]()[_0x35f4ae(0x279)]('data:')); for (const _0x17fee3 of _0x56bb9b) { if (_0x35f4ae(0x130) === 'SRkjJ') { const _0x410f23 = _0x17fee3[_0x35f4ae(0x3d9)](_0x35f4ae(0x5ff), ''); if (_0x410f23 === _0x35f4ae(0x79f)) break; try { _0x4982f6 += JSON[_0x35f4ae(0x5b1)](_0x410f23)['candidates'][0x0][_0x35f4ae(0x812)]['parts'][0x0][_0x35f4ae(0x44f)]; } catch { } } else _0x290b0d[_0x35f4ae(0x159)]('保存壁纸失败:', _0x592657), _0x287825(_0x35f4ae(0x2c3) + _0xcbf4db[_0x35f4ae(0x15a)]); } } } _0x2c4069 = _0x4982f6; break; } case _0x35f4ae(0x4fa): default: { if (_0x35f4ae(0x2da) === _0x35f4ae(0x2da)) { const _0x279cb6 = _0x57f5b7(_0x6302d3), _0x3c919e = _0x23a978[_0x35f4ae(0x3d9)](/\/+$/, '') + _0x35f4ae(0x18b), _0x442e97 = _0x51c737[_0x35f4ae(0x7cc)](_0x7eaf93 => { const _0x22225b = _0x35f4ae; if (_0x7eaf93[_0x22225b(0x837)] === _0x22225b(0x447) && _0x7eaf93[_0x22225b(0x888)]) return { 'role': _0x22225b(0x447), 'content': [{ 'type': _0x22225b(0x44f), 'text': _0x7eaf93[_0x22225b(0x812)] || '\x20' }, { 'type': _0x22225b(0x38d), 'image_url': { 'url': _0x7eaf93[_0x22225b(0x888)], 'detail': _0x22225b(0x6e1) } }] }; return { 'role': _0x7eaf93[_0x22225b(0x837)], 'content': _0x7eaf93['content'] }; })['filter'](_0x171f87 => _0x171f87[_0x35f4ae(0x812)]), _0x1d971b = { 'model': _0x2a519a, 'messages': _0x442e97, 'max_tokens': 0x1000, ..._0x2d8529 ? { 'response_format': { 'type': 'json_object' } } : {} }, _0x4844f4 = await fetch(_0x3c919e, { 'method': _0x35f4ae(0x4a3), 'headers': { 'Content-Type': _0x35f4ae(0xb4), 'Authorization': _0x35f4ae(0x3f3) + _0x279cb6 }, 'body': JSON[_0x35f4ae(0x504)](_0x1d971b), 'signal': _0x491661 }); if (!_0x4844f4['ok']) { const _0x13882f = await _0x4844f4[_0x35f4ae(0x4ff)]()[_0x35f4ae(0x412)](() => ({})); throw new Error('OpenAI\x20API\x20错误:\x20' + _0x4844f4['status'] + _0x35f4ae(0x604) + (_0x13882f['error']?.[_0x35f4ae(0x15a)] || _0x4844f4['statusText'])); } const _0x57b8c4 = await _0x4844f4[_0x35f4ae(0x4ff)](); _0x2c4069 = _0x57b8c4[_0x35f4ae(0x68a)]?.[0x0]?.['message']?.[_0x35f4ae(0x812)] || ''; break; } else _0x44b8f1[_0x35f4ae(0x159)](_0x35f4ae(0xdd), _0xb5dba5), _0x590a7e['error']('收到的原始、有问题的文本:', _0x715c84); } }return _0x2c4069; } } catch (_0x4ae8e4) { if (_0x4ae8e4['name'] === _0x35f4ae(0x75c)) return console['log'](_0x35f4ae(0x222)), ''; throw _0x4ae8e4; } finally { _0x40321a['currentAbortController'] && _0x40321a[_0x35f4ae(0x535)][_0x35f4ae(0x55c)] === _0x491661 && (_0x35f4ae(0x6bc) === _0x35f4ae(0x6bc) ? _0x40321a[_0x35f4ae(0x535)] = null : (_0x3f8fc0[_0x35f4ae(0x27d)][_0x35f4ae(0xb3)] = 'url(\x27' + _0x36dc9a[_0x35f4ae(0x99)](_0x19800c) + '\x27)', _0x56db0e[_0x35f4ae(0x27d)]['backgroundSize'] = _0x35f4ae(0x59e), _0x137164[_0x35f4ae(0x27d)][_0x35f4ae(0x424)] = 'center')); } } async function _0x322153() { const _0x1f7e76 = _0x311e9d, _0x5cfbab = _0x362d4b[_0x1f7e76(0x4bb)][_0x1f7e76(0x1c1)][_0x1f7e76(0xa1)](_0x1f7e76(0x21b)), _0x2db0ed = _0x5cfbab ? _0x35cc5b[_0x1f7e76(0x815)] : null; let _0x43f0d7 = null, _0x1a7285 = ''; if (_0x5cfbab && _0x2db0ed) { _0x43f0d7 = _0x40321a[_0x1f7e76(0x478)][_0x1f7e76(0x226)](_0x16b499 => _0x16b499['type'] === _0x1f7e76(0x64f) && _0x16b499[_0x1f7e76(0x239)]['includes'](_0x2db0ed)); const _0x52a841 = _0x3f1cb7(_0x2db0ed); _0x1a7285 = _0x52a841 ? _0x52a841['name'] : _0x1f7e76(0x795); } else { if (_0x40321a[_0x1f7e76(0x1cc)]) { if ('iLlLq' === 'pukrg') { _0x31a700(![]), _0x5c4aa4(_0x1f7e76(0x2e8)); return; } else { _0x43f0d7 = _0x4db4a7(); const _0x4a0c92 = document['getElementById'](_0x1f7e76(0x11b))['textContent']; _0x1a7285 = _0x4a0c92 || _0x1f7e76(0x591); } } } if (!_0x43f0d7) { if (_0x1f7e76(0x43b) === _0x1f7e76(0x3fe)) _0xe1d9a8[_0x1f7e76(0x42f)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x811927[_0x1f7e76(0x42f)] }; else { _0x1bbd68(_0x1f7e76(0x600)); return; } } const _0x260d04 = await _0x4849f2('确定要清空\x22' + _0x1a7285 + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0x260d04) return; _0x43f0d7['id'] === _0x40321a[_0x1f7e76(0x1cc)] && ('cMySg' !== 'XyQyP' ? (_0x4b7297(), _0x40321a['conversationHistory'] = [], _0x259a7d()) : _0x72ca1c(![])); try { if (_0x1f7e76(0x3b7) === _0x1f7e76(0xba)) return _0x5175c3[_0x1f7e76(0x478)][_0x1f7e76(0x226)](_0x5529a5 => _0x5529a5['id'] === _0x18a6e4[_0x1f7e76(0x1cc)]); else localStorage['removeItem'](_0x1f7e76(0x4a7) + _0x43f0d7['id']); } catch (_0x476de1) { console['error'](_0x1f7e76(0x151) + _0x43f0d7['id'], _0x476de1); } _0x1bbd68('\x22' + _0x1a7285 + '\x22\x20的聊天记录已清空。'); } const _0xd3ad39 = document[_0x311e9d(0x3a7)](_0x311e9d(0x1f8)), _0x5ca7cb = document[_0x311e9d(0x3a7)]('import-all-data-button'), _0x337efb = document['getElementById'](_0x311e9d(0x339)); _0xd3ad39[_0x311e9d(0x215)]('click', async () => { const _0x2aa595 = _0x311e9d; _0x3396e7(!![], _0x2aa595(0x421)); const _0x3a3d8a = []; try { if ('lRUjQ' === 'DVAgr') _0x144872[_0x2aa595(0x26b)] = _0x5d315e[_0x2aa595(0x2e6)], _0x4e150f[_0x2aa595(0x26b)] = _0x2aa595(0x2c4), _0x4a6c5b(_0x28fe14, 'normal'); else { const _0x2172c6 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x336a8a = 0x0; _0x336a8a < localStorage[_0x2aa595(0x286)]; _0x336a8a++) { const _0x1e8628 = localStorage[_0x2aa595(0x11c)](_0x336a8a); if (_0x1e8628) _0x2172c6['localStorageData'][_0x1e8628] = localStorage[_0x2aa595(0x8b4)](_0x1e8628); } const _0x2f2a17 = await _0x4aa0e5, _0x405515 = _0x2f2a17['transaction'](_0x24051d, _0x2aa595(0x228)), _0x4e9137 = _0x405515[_0x2aa595(0x16c)](_0x24051d), _0x229b9d = await new Promise((_0xedc45f, _0x5d0256) => { const _0x2675e4 = _0x2aa595, _0x269aa8 = _0x4e9137[_0x2675e4(0x36f)](); _0x269aa8[_0x2675e4(0x61f)] = () => _0xedc45f(_0x269aa8[_0x2675e4(0x7ba)]), _0x269aa8[_0x2675e4(0x3bd)] = () => _0x5d0256(_0x269aa8[_0x2675e4(0x159)]); }); for (const _0x51c6f9 of _0x229b9d) { if (_0x2aa595(0x350) === _0x2aa595(0x350)) { if (_0x51c6f9[_0x2aa595(0x5c0)] instanceof Blob) { if (_0x2aa595(0x859) !== _0x2aa595(0x164)) try { _0x2172c6[_0x2aa595(0x30a)][_0x51c6f9['id']] = await _0x5cb5e3(_0x51c6f9[_0x2aa595(0x5c0)]); } catch (_0x1cc187) { if ('rGOwZ' === 'FbMQW') { const _0x57819f = (_0x34c9da[_0x2aa595(0x272)] ?? _0x57152a[_0x2aa595(0x249)] ?? _0x17f5d1[_0x2aa595(0x52f)] ?? _0x4b5a68[_0x2aa595(0x212)])?.[_0x2aa595(0x3e3)](); if (_0x57819f && _0x7610fc[_0x2aa595(0x14d)](_0x57819f)) _0x2ecceb[_0x2aa595(0x471)][_0x2aa595(0x1fb)]({ 'senderId': _0xecc426['id'], 'kind': _0x2aa595(0x272), 'sticker': _0x57819f }); else { const _0xdb5c65 = _0x50340b(_0x37ef43[_0x2aa595(0x812)] ?? _0xe6b4f8[_0x2aa595(0x44f)] ?? '')[_0x2aa595(0x3e3)]() || _0x2aa595(0x22d) + (_0x57819f || '未知表情') + ']'; if (_0xdb5c65) _0x69fe8b['events'][_0x2aa595(0x1fb)]({ 'senderId': _0x53f653['id'], 'kind': 'text', 'content': _0xdb5c65 }); } } else _0x3a3d8a[_0x2aa595(0x1fb)](_0x51c6f9['id']); } else _0x377457 = _0x5e6585(() => { const _0x3ea86c = _0x2aa595; if (_0x31e7bc['type'] === _0x3ea86c(0xd0)) _0x3238bd[_0x3ea86c(0x425)](); _0x1353ef(_0x42c39a); }, 0x320); } } else _0x32fe67(_0x17c578['id']); } const _0x1cde9c = _0x2f2a17['transaction'](_0x27f8d9, 'readonly'), _0x38cb27 = _0x1cde9c[_0x2aa595(0x16c)](_0x27f8d9), _0x46b762 = await new Promise((_0xddf329, _0x371efc) => { const _0x41d70f = _0x2aa595; if (_0x41d70f(0x1af) !== _0x41d70f(0x20f)) { const _0x13864c = _0x38cb27['getAll'](); _0x13864c['onsuccess'] = () => _0xddf329(_0x13864c[_0x41d70f(0x7ba)]), _0x13864c[_0x41d70f(0x3bd)] = () => _0x371efc(_0x13864c['error']); } else { const _0xc54da3 = _0x3849a7(_0x47c719[_0x41d70f(0x239)][0x0]); return _0xc54da3?.[_0x41d70f(0x2e6)] || 'AI'; } }); for (const _0x2260b3 of _0x46b762) { const _0x9140b4 = { ..._0x2260b3 }; _0x2260b3[_0x2aa595(0x48c)] instanceof Blob && (_0x9140b4[_0x2aa595(0x48c)] = await _0x5cb5e3(_0x2260b3[_0x2aa595(0x48c)])), _0x2260b3[_0x2aa595(0x59e)] instanceof Blob && (_0x2aa595(0x73b) !== _0x2aa595(0x73b) ? _0x58ffa7 = _0x582977[_0x2aa595(0x8b4)](_0x2aa595(0x4a7) + _0x1604bc[_0x2aa595(0x1cc)]) : _0x9140b4[_0x2aa595(0x59e)] = await _0x5cb5e3(_0x2260b3[_0x2aa595(0x59e)])), _0x2172c6['indexedDBMusicData'][_0x2aa595(0x1fb)](_0x9140b4); } const _0x4c454b = new Blob([JSON['stringify'](_0x2172c6, null, 0x2)], { 'type': 'application/json' }), _0x431b77 = URL[_0x2aa595(0x99)](_0x4c454b), _0x216328 = document[_0x2aa595(0x3e8)]('a'), _0x3c298b = new Date(), _0xde83a3 = _0x3c298b[_0x2aa595(0x1b2)]() + '-' + String(_0x3c298b[_0x2aa595(0x1a1)]() + 0x1)[_0x2aa595(0x26e)](0x2, '0') + '-' + String(_0x3c298b['getDate']())[_0x2aa595(0x26e)](0x2, '0'); _0x216328[_0x2aa595(0x59d)] = _0x431b77, _0x216328[_0x2aa595(0xe0)] = 'Noir_Backup_' + _0xde83a3 + '.json', document['body'][_0x2aa595(0x7d)](_0x216328), _0x216328[_0x2aa595(0x236)](), document['body'][_0x2aa595(0x18e)](_0x216328), URL[_0x2aa595(0x165)](_0x431b77), _0x3396e7(![]), _0x3a3d8a[_0x2aa595(0x286)] > 0x0 ? _0x1bbd68(_0x2aa595(0x7d2) + _0x3a3d8a['join']('\x0a')) : _0x2aa595(0x172) === _0x2aa595(0x516) ? (_0x579808(![]), _0x539b21[_0x2aa595(0x159)](_0x2aa595(0x546), _0x3a6923), _0x572352(_0x2aa595(0x7c2) + _0x3fad3d[_0x2aa595(0x15a)])) : _0x1bbd68(_0x2aa595(0x687)); } } catch (_0x2ece5f) { _0x3396e7(![]), console[_0x2aa595(0x159)](_0x2aa595(0x417), _0x2ece5f), _0x1bbd68(_0x2aa595(0x743) + _0x2ece5f[_0x2aa595(0x15a)]); } }), _0x5ca7cb['addEventListener'](_0x311e9d(0x236), () => { const _0x1cf5a4 = _0x311e9d; _0x337efb[_0x1cf5a4(0x236)](); }), _0x183dbd[_0x311e9d(0x215)]('click', _0x492740), _0x337efb[_0x311e9d(0x215)](_0x311e9d(0x66a), _0x15c215 => { const _0x38d7fa = _0x311e9d; if (_0x38d7fa(0x525) === 'AkLpe') { const _0x443490 = _0x15c215[_0x38d7fa(0x94)]['files'][0x0]; if (!_0x443490) return; _0x4849f2(_0x38d7fa(0x125))[_0x38d7fa(0x3fa)](_0x2f29c1 => { const _0xd76f5c = _0x38d7fa; if (!_0x2f29c1) { _0x337efb['value'] = ''; return; } _0x3396e7(!![], _0xd76f5c(0x2e9)); const _0x1f57eb = new FileReader(); _0x1f57eb[_0xd76f5c(0x5bc)] = async _0x2a6d4d => { const _0x39001a = _0xd76f5c; if ('EbFQA' !== _0x39001a(0x646)) try { const _0x2bff84 = JSON[_0x39001a(0x5b1)](_0x2a6d4d[_0x39001a(0x94)][_0x39001a(0x7ba)]); if (!_0x2bff84['localStorageData'] || !_0x2bff84['indexedDBData']) throw new Error('文件格式不正确，不是一个有效的备份文件。'); _0x3396e7(!![], _0x39001a(0x561)); const _0x1e43f3 = await Promise[_0x39001a(0x5dd)](Object[_0x39001a(0x649)](_0x2bff84[_0x39001a(0x30a)])[_0x39001a(0x7cc)](async _0xb860fa => { const _0x37ad0e = _0x39001a, _0x26d9b8 = _0x2bff84[_0x37ad0e(0x30a)][_0xb860fa]; if (typeof _0x26d9b8 === _0x37ad0e(0xac) && _0x26d9b8[_0x37ad0e(0x279)](_0x37ad0e(0x1e9))) { if (_0x37ad0e(0x8cb) === _0x37ad0e(0x8cb)) { const _0x47993c = await _0x3cb589(_0x26d9b8); return { 'id': _0xb860fa, 'blob': _0x47993c }; } else _0x2788b1[_0x37ad0e(0x815)] = _0x43748d[_0x37ad0e(0x7cc)](_0x3056b9 => _0x3056b9['name'] + '--' + _0x3056b9[_0x37ad0e(0x5cb)])[_0x37ad0e(0x2c1)]('\x0a'); } return null; }))[_0x39001a(0x3fa)](_0x4005cf => _0x4005cf['filter'](Boolean)), _0x3f0da7 = []; if (_0x2bff84[_0x39001a(0x5d7)]) { if (_0x39001a(0x780) === _0x39001a(0x45e)) { const _0x20e021 = _0x193227[_0x39001a(0x889)](_0x39001a(0x4a6)); if (_0x20e021 && (_0x20e021['id'] === 'meeting-view-screen' || _0x20e021['id'] === _0x39001a(0x6b7))) _0x981ad(); else { const _0x51fc0a = _0x553d88[_0x39001a(0x21e)](_0x39001a(0x7e9)); _0x51fc0a[_0x39001a(0x436)](_0xffcf92 => _0xffcf92[_0x39001a(0x47e)]()); } } else { _0x3396e7(!![], '正在准备音乐数据...'); const _0x5c9966 = _0x2bff84[_0x39001a(0x5d7)][_0x39001a(0x7cc)](async _0x48decc => { const _0x54e986 = _0x39001a, _0x4eda19 = { ..._0x48decc }; if (_0x48decc[_0x54e986(0x48c)]) _0x4eda19[_0x54e986(0x48c)] = await _0x3cb589(_0x48decc[_0x54e986(0x48c)]); if (_0x48decc['cover']) _0x4eda19[_0x54e986(0x59e)] = await _0x3cb589(_0x48decc[_0x54e986(0x59e)]); return _0x4eda19; }); _0x3f0da7[_0x39001a(0x1fb)](...await Promise[_0x39001a(0x5dd)](_0x5c9966)); } } _0x3396e7(!![], _0x39001a(0x806)), localStorage[_0x39001a(0x7eb)](); for (const _0x21153e in _0x2bff84['localStorageData']) { localStorage[_0x39001a(0x7aa)](_0x21153e, _0x2bff84[_0x39001a(0x8e2)][_0x21153e]); } _0x3396e7(!![], _0x39001a(0x247)); const _0x3cc9e0 = await _0x4aa0e5, _0x453d2e = _0x3cc9e0['transaction']([_0x24051d, _0x27f8d9], 'readwrite'), _0x2dbf95 = _0x453d2e['objectStore'](_0x24051d), _0x5dd546 = _0x453d2e[_0x39001a(0x16c)](_0x27f8d9); _0x2dbf95[_0x39001a(0x7eb)](), _0x5dd546['clear'](), _0x1e43f3[_0x39001a(0x436)](_0x3ae372 => _0x2dbf95[_0x39001a(0x9f)](_0x3ae372)), _0x3f0da7[_0x39001a(0x436)](_0x2a8e1e => _0x5dd546[_0x39001a(0x9f)](_0x2a8e1e)), await new Promise((_0x40f930, _0x6bf0a0) => { const _0x1a93da = _0x39001a; _0x453d2e[_0x1a93da(0x229)] = _0x40f930, _0x453d2e[_0x1a93da(0x3bd)] = _0x4f3843 => _0x6bf0a0(_0x4f3843[_0x1a93da(0x94)][_0x1a93da(0x159)]); }), _0x3396e7(![]), _0x1bbd68('数据导入成功！应用即将刷新...'), setTimeout(() => location[_0x39001a(0x15f)](), 0x640); } catch (_0x40c432) { if ('RryhG' !== _0x39001a(0x545)) return (_0x1264b0?.[_0x39001a(0x382)] || [])['find'](_0x2da4d1 => _0x2da4d1['id'] === _0x55c1ce); else _0x3396e7(![]), console['error']('全量导入失败:', _0x40c432), _0x1bbd68(_0x39001a(0x7c2) + _0x40c432['message']); } finally { _0x337efb['value'] = ''; } else { let _0x399b9b = _0x52c9f5[_0x39001a(0x889)]('.typing-indicator'); !_0x399b9b && (_0x399b9b = _0x5afe70[_0x39001a(0x3e8)]('div'), _0x399b9b[_0x39001a(0x8d8)] = _0x39001a(0xfc), _0x399b9b[_0x39001a(0x26b)] = '对方正在行动中...', _0x399b9b[_0x39001a(0x27d)][_0x39001a(0x1b0)] = _0x39001a(0x6c7), _0x399b9b[_0x39001a(0x27d)][_0x39001a(0x5d1)] = _0x39001a(0x6b2), _0x399b9b['style'][_0x39001a(0x6d2)] = _0x39001a(0x861), _0xc254d2[_0x39001a(0x7d)](_0x399b9b)); } }, _0x1f57eb[_0xd76f5c(0x1f4)](_0x443490); }); } else { if (_0x3a0672[_0x38d7fa(0x286)] === 0x0) return; _0x14947c = (_0x480dbd - 0x1 + _0x103439['length']) % _0x4bd053[_0x38d7fa(0x286)], _0x354a85(_0x40449a[_0x5a787c], _0x3435fa); } }); function _0x4efade() { const _0xc11ad6 = _0x311e9d; if (_0xc11ad6(0x6f8) === _0xc11ad6(0x5b0)) { if (_0x256637 === null) return; const _0x27f0b2 = _0x38333d[_0xc11ad6(0x393)][_0x2b5774]; if (!_0x27f0b2) return; const _0x4e68bf = _0x5ddd64(); let _0x494a08 = '未知'; if (_0x27f0b2[_0xc11ad6(0x837)] === 'user') _0x494a08 = _0x13262f[_0xc11ad6(0x92)]['name'] || '我'; else { const _0x465285 = _0x27f0b2[_0xc11ad6(0x2b9)] || _0x4e68bf?.[_0xc11ad6(0x239)][0x0], _0x1b49c5 = _0x43751(_0x465285); _0x494a08 = _0x1b49c5 ? _0x1b49c5['name'] : '角色'; } let _0x4f20ad = _0x27f0b2[_0xc11ad6(0x812)] || ''; if (_0x27f0b2[_0xc11ad6(0x220)]) _0x4f20ad = _0xc11ad6(0x6de); if (_0x27f0b2[_0xc11ad6(0x888)]) _0x4f20ad = _0xc11ad6(0x49a); if (_0x4f20ad[_0xc11ad6(0x286)] > 0x32) _0x4f20ad = _0x4f20ad[_0xc11ad6(0x23c)](0x0, 0x32) + _0xc11ad6(0x72c); _0xf0b2f1[_0xc11ad6(0x8bc)] = { 'sender': _0x494a08, 'content': _0x4f20ad }, _0x3c8574(), _0x28cf54(), _0x20cb64['focus'](); } else _0xb7dfd6[_0xc11ad6(0x815)] = _0x40321a[_0xc11ad6(0x5ee)][_0xc11ad6(0x7e6)] || '', _0x2008c6[_0xc11ad6(0x815)] = _0x40321a[_0xc11ad6(0x5ee)]['key'] || '', _0x5cc388[_0xc11ad6(0x815)] = _0x40321a['apiSettings'][_0xc11ad6(0x4e7)] || '', _0x1b6a81[_0xc11ad6(0x815)] = String(_0x40321a[_0xc11ad6(0x42f)]?.[_0xc11ad6(0x543)] ?? 0x64), document[_0xc11ad6(0x3a7)](_0xc11ad6(0x4e0))[_0xc11ad6(0x815)] = _0x40321a['apiSettings'][_0xc11ad6(0x19b)] || _0xc11ad6(0x4fa); } function _0x1fceeb() { const _0x285135 = _0x311e9d; if (_0x285135(0x1e6) === _0x285135(0x1e6)) { _0x40321a[_0x285135(0x5ee)][_0x285135(0x7e6)] = _0xb7dfd6['value'][_0x285135(0x3e3)](), _0x40321a[_0x285135(0x5ee)]['key'] = _0x2008c6[_0x285135(0x815)][_0x285135(0x3e3)](), _0x40321a[_0x285135(0x5ee)]['model'] = _0x5cc388[_0x285135(0x815)][_0x285135(0x3e3)](), _0x40321a[_0x285135(0x5ee)]['provider'] = document[_0x285135(0x3a7)](_0x285135(0x4e0))[_0x285135(0x815)]; const _0x483e8b = parseInt(_0x1b6a81['value'], 0xa); _0x40321a[_0x285135(0x42f)][_0x285135(0x543)] = Number[_0x285135(0x283)](_0x483e8b) && _0x483e8b > 0x0 ? _0x483e8b : 0x64, _0x544cbe(), _0x1bbd68(_0x285135(0x873)); } else _0x32b6aa(new _0x366a18(_0x285135(0x45a))); } function _0x22b0ce() { const _0x401f5c = _0x311e9d; _0x4314a9['value'] = _0x40321a[_0x401f5c(0x92)][_0x401f5c(0x2e6)] || '', _0x2a99e4[_0x401f5c(0x8c7)] = _0x40321a[_0x401f5c(0x92)][_0x401f5c(0xe7)] || _0x579f27, _0x37ea6e['value'] = _0x40321a[_0x401f5c(0x92)][_0x401f5c(0x838)] || ''; } function _0x27125d() { const _0x5b41bf = _0x311e9d; _0x5b41bf(0x497) === _0x5b41bf(0x497) ? (_0x40321a[_0x5b41bf(0x92)]['name'] = _0x4314a9[_0x5b41bf(0x815)]['trim'](), _0x40321a[_0x5b41bf(0x92)][_0x5b41bf(0x838)] = _0x37ea6e[_0x5b41bf(0x815)][_0x5b41bf(0x3e3)](), _0x544cbe(), _0x259a7d(), _0x1bbd68(_0x5b41bf(0x799)), _0x6564ff(_0x5b41bf(0x2c0), 'userProfile')) : (_0x361f41[_0x5b41bf(0x229)] = _0x4bfe96, _0x302c16[_0x5b41bf(0x3bd)] = _0x3904ea => _0x1768bd(_0x3904ea['target'][_0x5b41bf(0x159)])); } async function _0x59deff(_0x116934 = null) { const _0x522c85 = _0x311e9d, _0x723a32 = _0x23145c; _0x6564ff(_0x522c85(0x4bb), _0x723a32); const _0x3dc932 = document['getElementById'](_0x522c85(0x3c6)); _0x3dc932['innerHTML'] = '', _0x40321a['worldBooks']['forEach'](_0xc0e000 => { const _0x5b61bc = _0x522c85, _0x4106c1 = document[_0x5b61bc(0x3e8)](_0x5b61bc(0x2de)); _0x4106c1[_0x5b61bc(0x49f)] = _0x5b61bc(0x324) + _0xc0e000['id'] + _0x5b61bc(0x734) + _0xc0e000['name'], _0x3dc932[_0x5b61bc(0x7d)](_0x4106c1); }), _0x5c0c37(_0x522c85(0x7a8)), _0x216a74[_0x522c85(0x8c7)] = '', _0x55562a[_0x522c85(0x815)] = '', _0x1f4106[_0x522c85(0x8c7)] = '', _0x3b9a27[_0x522c85(0x815)] = '', _0x93bae0['src'] = '', _0x3bc69e[_0x522c85(0x815)] = ''; const _0x105780 = ['normal', _0x522c85(0x6f7), _0x522c85(0x1eb), _0x522c85(0x1a5), _0x522c85(0x5e3)]; _0x105780[_0x522c85(0x436)](_0x27ea25 => { const _0x437522 = _0x522c85; if (_0x437522(0x61b) !== _0x437522(0x61b)) { const _0x45b331 = _0x30a1b0[_0x437522(0x393)][_0x5858e8 - 0x2], _0x24ded6 = _0xc91579[_0x437522(0x393)][_0x14b3b5 - 0x1]; if (_0x45b331['isOffline'] === ![] && _0x24ded6[_0x437522(0x7ec)] === !![]) _0x450493 = _0x437522(0x6fa) + _0x30564a[_0x437522(0x2e6)] + _0x437522(0xdf); else _0x45b331[_0x437522(0x7ec)] === !![] && _0x24ded6[_0x437522(0x7ec)] === ![] && (_0x3e9472 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x23ee28[_0x437522(0x2e6)] + _0x437522(0x30d)); } else document[_0x437522(0x3a7)](_0x437522(0x5bd) + _0x27ea25 + _0x437522(0x202))[_0x437522(0x8c7)] = '', document[_0x437522(0x3a7)]('char-edit-sprite-' + _0x27ea25 + '-input')['value'] = ''; }); if (_0x116934) { if (_0x522c85(0x196) !== _0x522c85(0x196)) { _0x3ca752(_0x522c85(0x358)); return; } else { const _0x4a1f54 = _0x40321a['characters']['find'](_0x4df374 => _0x4df374['id'] === _0x116934); if (!_0x4a1f54) return; _0x35cc5b[_0x522c85(0x815)] = _0x4a1f54['id'], _0x2f12dc[_0x522c85(0x26b)] = '编辑角色', _0x21e8b2[_0x522c85(0x815)] = _0x4a1f54[_0x522c85(0x2e6)], _0x241bc7['value'] = _0x4a1f54[_0x522c85(0x36b)], _0x82a905[_0x522c85(0x815)] = _0x4a1f54[_0x522c85(0x838)], document['getElementById'](_0x522c85(0x308))['value'] = _0x4a1f54[_0x522c85(0x2c8)] || ''; const _0x109cc3 = _0x40321a['chats'][_0x522c85(0x226)](_0x222abb => _0x222abb['type'] === _0x522c85(0x64f) && _0x222abb['participantIds'][_0x522c85(0x4fe)](_0x116934)); document['getElementById'](_0x522c85(0x7a8))['value'] = _0x109cc3?.[_0x522c85(0x87f)] || _0x40321a[_0x522c85(0x17e)]; try { if ('GObNc' === 'DjoTB') _0x1ff37b = _0x522c85(0x864), _0x4a00e3 = _0x522c85(0x4f4); else { const _0x5b7643 = await _0x500f4d('char_avatar_' + _0x4a1f54['id']), _0xa95902 = await _0x500f4d(_0x522c85(0x865) + _0x4a1f54['id']), _0x278e5c = await _0x500f4d('char_offline_bg_' + _0x4a1f54['id']); _0x216a74[_0x522c85(0x8c7)] = _0x5b7643 ? URL[_0x522c85(0x99)](_0x5b7643) : _0x4a1f54['avatar'] || _0x4716b3; if (_0xa95902) _0x1f4106[_0x522c85(0x8c7)] = URL[_0x522c85(0x99)](_0xa95902); if (_0x278e5c) _0x93bae0[_0x522c85(0x8c7)] = URL[_0x522c85(0x99)](_0x278e5c); for (const _0x50a7b0 of _0x105780) { if (_0x522c85(0xe2) !== _0x522c85(0x383)) { const _0x3c8e2f = await _0x500f4d(_0x522c85(0x3cc) + _0x50a7b0 + '_' + _0x4a1f54['id']); _0x3c8e2f && (document['getElementById']('char-edit-sprite-' + _0x50a7b0 + _0x522c85(0x202))[_0x522c85(0x8c7)] = URL[_0x522c85(0x99)](_0x3c8e2f)); } else _0x113d46[_0x522c85(0x27d)][_0x522c85(0x71a)] = _0x5c01ca[_0x522c85(0x71a)] + '%', _0x3013b0[_0x522c85(0x27d)][_0x522c85(0x40d)] = _0x390f0a[_0x522c85(0x40d)] + '%'; } } } catch (_0x53a3b7) { console[_0x522c85(0x159)](_0x522c85(0x39a) + _0x4a1f54['id'] + _0x522c85(0x599), _0x53a3b7), _0x216a74['src'] = _0x4a1f54[_0x522c85(0xe7)] || _0x4716b3; } _0x4a1f54['linkedWorldBookIds'] && (_0x522c85(0x613) === 'ulekC' ? _0x42c575[_0x522c85(0x11c)] === _0x522c85(0x1ad) && !_0x1c53b8[_0x522c85(0x28e)] && (_0xe372e4[_0x522c85(0x425)](), _0x1d2943()) : _0x3dc932[_0x522c85(0x21e)](_0x522c85(0x171))['forEach'](_0x2578fd => { const _0x1f8e18 = _0x522c85; if (_0x4a1f54['linkedWorldBookIds'][_0x1f8e18(0x4fe)](_0x2578fd[_0x1f8e18(0x815)])) _0x2578fd[_0x1f8e18(0x238)] = !![]; })), _0x1e1925(); } } else _0x522c85(0xad) === _0x522c85(0x4ec) ? _0x3fd29f['querySelector'](_0x522c85(0x8c3))[_0x522c85(0x6fe)] = () => { _0x4e10e3(_0x4957d8), _0x234067(); } : (_0x35cc5b['value'] = '', _0x2f12dc[_0x522c85(0x26b)] = _0x522c85(0x8d6), _0x21e8b2[_0x522c85(0x815)] = '新角色\x20' + (_0x40321a['characters']['length'] + 0x1), _0x241bc7[_0x522c85(0x815)] = '', _0x216a74[_0x522c85(0x8c7)] = _0x4716b3, _0x82a905['value'] = _0x522c85(0x3fd), document[_0x522c85(0x3a7)]('char-edit-css')[_0x522c85(0x815)] = '', _0x1e1925()); const _0x1e2c34 = document[_0x522c85(0x3a7)](_0x522c85(0x308)); let _0x298e39 = document[_0x522c85(0x3a7)](_0x522c85(0x3af)); !_0x298e39 && (_0x522c85(0x74b) === _0x522c85(0x74b) ? (_0x298e39 = document[_0x522c85(0x3e8)]('style'), _0x298e39['id'] = 'live-preview-style', document[_0x522c85(0x7ae)][_0x522c85(0x7d)](_0x298e39)) : _0x75eac1 = _0x4a84eb(_0x33ca12)); const _0x10abf8 = () => { const _0x262476 = _0x522c85; if ('BCBwf' === _0x262476(0x403)) _0x14d4ab(), _0x3b06d4(_0x262476(0x318), 'home'); else { const _0x165727 = _0x1e2c34['value']; let _0x5e07aa = _0x165727[_0x262476(0x3d9)](/\.bubble\.sent/g, _0x262476(0x7a))[_0x262476(0x3d9)](/\.bubble\.received/g, _0x262476(0x5db)); _0x298e39['innerHTML'] = _0x5e07aa; } }; _0x1e2c34[_0x522c85(0x34a)]('input', _0x10abf8), _0x1e2c34['addEventListener'](_0x522c85(0x54c), _0x10abf8), _0x10abf8(); } async function _0x2cdf26() { const _0x24677f = _0x311e9d, _0x200cb8 = _0x35cc5b[_0x24677f(0x815)]; if (!_0x200cb8) { if (_0x24677f(0x884) !== 'NMCfE') { _0x1bbd68(_0x24677f(0x1d7)); return; } else { const _0x174b08 = _0x45fc96(_0x10a191); if (!_0x174b08) return; _0xbe7f1c['activeDiaryCharacterId'] = _0xedc034; const _0x5f5308 = _0x30f8fc['diaries'][_0x24677f(0x226)](_0x3ccc78 => _0x3ccc78[_0x24677f(0x769)] === _0xfc5ff4), _0x2e75bf = _0x5f5308 ? _0x5f5308[_0x24677f(0x27f)][_0x24677f(0x286)] : 0x0, _0x56f69b = 0x2; _0x60b821[_0x24677f(0x8d9)] = _0x570631[_0x24677f(0x7d4)](0x0, _0x4a53ad[_0x24677f(0x826)](_0x2e75bf / _0x56f69b) - 0x1), _0xfa3b3a[_0x24677f(0x3a7)]('diary-char-name-header')[_0x24677f(0x26b)] = _0x174b08['name'] + _0x24677f(0x5b3), _0x6a0b72(), _0x41d149('diaryView', _0x24677f(0x679)); } } const _0x11f43f = _0x3f1cb7(_0x200cb8); if (!_0x11f43f) return; _0x3396e7(!![], _0x24677f(0x1ba) + _0x11f43f[_0x24677f(0x2e6)] + _0x24677f(0x22a)); try { if (_0x24677f(0x5b7) !== _0x24677f(0x5b7)) _0x5c1e03[_0x24677f(0x159)](_0x24677f(0x621), _0x106de); else { const _0x25c65e = { 'type': _0x24677f(0x3ca), 'version': 0x1, 'name': _0x11f43f[_0x24677f(0x2e6)], 'remark': _0x11f43f[_0x24677f(0x36b)], 'persona': _0x11f43f[_0x24677f(0x838)], 'bubbleCss': _0x11f43f[_0x24677f(0x2c8)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x48d4a0 = await _0x500f4d(_0x24677f(0x30c) + _0x11f43f['id']); if (_0x48d4a0) _0x25c65e['avatar'] = await _0x5cb5e3(_0x48d4a0); const _0x2260cd = [_0x24677f(0x4d6), 'happy', 'angry', 'sad', _0x24677f(0x5e3)]; for (const _0x539772 of _0x2260cd) { const _0x1dc192 = await _0x500f4d(_0x24677f(0x3cc) + _0x539772 + '_' + _0x11f43f['id']); if (_0x1dc192) { if (_0x24677f(0x40b) !== 'WFJIu') _0x25c65e[_0x24677f(0x6aa)][_0x539772] = await _0x5cb5e3(_0x1dc192); else { const _0xc4c740 = _0x4e2ed3[_0x24677f(0x812)] ? '\x20' + _0x199c46[_0x24677f(0x812)] : ''; _0x24a34e['push']('[' + _0x53153c(_0x101473) + _0x24677f(0x5cd) + _0xc4c740); } } } _0x11f43f[_0x24677f(0x3d5)] && _0x11f43f[_0x24677f(0x3d5)]['length'] > 0x0 && (_0x25c65e[_0x24677f(0x5e7)] = _0x11f43f[_0x24677f(0x3d5)][_0x24677f(0x7cc)](_0x30a3a3 => _0x40321a[_0x24677f(0x5e7)]['find'](_0xda34a5 => _0xda34a5['id'] === _0x30a3a3))['filter'](Boolean)[_0x24677f(0x7cc)](_0x36b796 => ({ 'name': _0x36b796[_0x24677f(0x2e6)], 'content': _0x36b796[_0x24677f(0x812)] }))); const _0x18f209 = new Blob([JSON[_0x24677f(0x504)](_0x25c65e, null, 0x2)], { 'type': _0x24677f(0xb4) }), _0x135f9c = URL['createObjectURL'](_0x18f209), _0x354548 = document[_0x24677f(0x3e8)]('a'); _0x354548['href'] = _0x135f9c, _0x354548['download'] = _0x11f43f[_0x24677f(0x2e6)] + '_NoirCard.json', document['body']['appendChild'](_0x354548), _0x354548['click'](), document[_0x24677f(0x7ee)]['removeChild'](_0x354548), URL['revokeObjectURL'](_0x135f9c); } } catch (_0x210c0b) { if (_0x24677f(0x6e7) === _0x24677f(0x2b2)) { _0x3be19a(_0x24677f(0x509) + _0x47d11e + _0x24677f(0x5fc)), _0x4efc8b(() => _0x4f6625['reload'](), 0x5dc); return; } else console[_0x24677f(0x159)](_0x24677f(0x55e), _0x210c0b), _0x1bbd68(_0x24677f(0x437) + _0x210c0b['message']); } finally { _0x3396e7(![]); } } async function _0x26b5ab(_0x1db239) { const _0x398d05 = _0x311e9d; if (_0x398d05(0x205) === 'krIdO') _0xcf2de4[_0x398d05(0x215)](_0x398d05(0x236), () => { const _0x4b5fa5 = _0x398d05; _0x5de830(_0x4b5fa5(0x868)); }); else { const _0x198f9c = _0x1db239['target'][_0x398d05(0x83b)][0x0]; if (!_0x198f9c) return; _0x3396e7(!![], _0x398d05(0x1e1)); const _0x372528 = new FileReader(); _0x372528[_0x398d05(0x5bc)] = async _0x10fa2d => { const _0x160af4 = _0x398d05; try { if (_0x160af4(0x310) !== _0x160af4(0x310)) { _0x4ff765[_0x160af4(0x49f)] = _0x160af4(0x3c5); return; } else { const _0x66a876 = JSON['parse'](_0x10fa2d['target'][_0x160af4(0x7ba)]); if (_0x66a876[_0x160af4(0x78c)] !== 'NoirCharacterCard') throw new Error(_0x160af4(0x728)); const _0x15fd9c = []; if (_0x66a876[_0x160af4(0x5e7)] && _0x66a876[_0x160af4(0x5e7)][_0x160af4(0x286)] > 0x0) for (const _0x1d6f87 of _0x66a876[_0x160af4(0x5e7)]) { if (_0x160af4(0x653) === _0x160af4(0x653)) { let _0x7309d = _0x40321a[_0x160af4(0x5e7)]['find'](_0x106abe => _0x106abe[_0x160af4(0x2e6)] === _0x1d6f87[_0x160af4(0x2e6)]); if (_0x7309d) _0x160af4(0x4ce) !== _0x160af4(0x4ce) ? _0x54288e[_0x160af4(0x5e9)](_0x537bcd => { const _0x1ececd = _0x160af4; _0x537bcd ? _0x17b54f(_0x537bcd) : _0x1e634e(new _0x4cd51b(_0x1ececd(0x45a))); }, _0xd803ec, _0xd9b26d) : _0x15fd9c[_0x160af4(0x1fb)](_0x7309d['id']); else { const _0x484c94 = { 'id': _0x160af4(0x186) + Date[_0x160af4(0x6bb)]() + '_' + Math[_0x160af4(0x775)](), 'name': _0x1d6f87[_0x160af4(0x2e6)], 'content': _0x1d6f87['content'] }; _0x40321a['worldBooks']['push'](_0x484c94), _0x15fd9c[_0x160af4(0x1fb)](_0x484c94['id']); } } else { _0x2d5e8c['id'] === _0xd87c38[_0x160af4(0x1cc)] && (_0x1e0ef4(), _0x31cae1[_0x160af4(0x393)] = [], _0x47d098()); try { _0x535dfd['removeItem']('chatHistory_' + _0x507788['id']), _0x1165c9('群聊\x22' + _0x22d2a8['name'] + '\x22\x20的聊天记录已清空。'); } catch (_0x45b408) { _0x2a38c2['error'](_0x160af4(0x59f) + _0x5c673f['id'], _0x45b408), _0x39f060(_0x160af4(0x3e0)); } } } const _0x17d372 = _0x160af4(0x686) + Date['now'](), _0x4c4f2d = { 'id': _0x17d372, 'name': _0x66a876[_0x160af4(0x2e6)], 'remark': _0x66a876['remark'] || '', 'persona': _0x66a876[_0x160af4(0x838)], 'avatar': _0x66a876[_0x160af4(0xe7)] || _0x4716b3, 'linkedWorldBookIds': _0x15fd9c, 'bubbleCss': _0x66a876['bubbleCss'] || '' }; if (_0x66a876[_0x160af4(0xe7)]) { const _0x1ed9a7 = await _0x3cb589(_0x66a876[_0x160af4(0xe7)]); await _0x5c7ad7('char_avatar_' + _0x17d372, _0x1ed9a7); } if (_0x66a876[_0x160af4(0x6aa)]) { if (_0x160af4(0xf7) !== _0x160af4(0xf7)) _0x4779fe('图片预览失败:\x20' + _0x2d0433[_0x160af4(0x15a)]); else for (const _0x56eb61 in _0x66a876[_0x160af4(0x6aa)]) { if (_0x160af4(0x7b6) !== _0x160af4(0x281)) { const _0x3e2382 = _0x66a876[_0x160af4(0x6aa)][_0x56eb61], _0x202b45 = await _0x3cb589(_0x3e2382); await _0x5c7ad7('char_sprite_' + _0x56eb61 + '_' + _0x17d372, _0x202b45); } else _0x1026a0[_0x160af4(0x1c1)][_0x160af4(0x47e)](_0x160af4(0x21b)), _0x3b9edc[_0x160af4(0x1c1)][_0x160af4(0x65b)](_0x160af4(0x21b)), _0x2577d3(); } } _0x40321a[_0x160af4(0x382)][_0x160af4(0x1fb)](_0x4c4f2d); const _0x3ac756 = { 'id': _0x160af4(0x1bd) + _0x17d372, 'type': 'private', 'participantIds': [_0x17d372], 'boundUserProfileId': _0x40321a['activeUserProfileId'] }; _0x40321a[_0x160af4(0x478)]['push'](_0x3ac756), _0x544cbe(), _0x5af13e(), _0x1bbd68('“' + _0x4c4f2d[_0x160af4(0x2e6)] + _0x160af4(0x1c9)); } } catch (_0x3bd08d) { if (_0x160af4(0x45f) !== _0x160af4(0x6e2)) console[_0x160af4(0x159)]('导入角色卡失败:', _0x3bd08d), _0x1bbd68('导入失败了，笨蛋:\x20' + _0x3bd08d['message']); else { const _0x391067 = _0xd5c9ff[_0x160af4(0x5b1)](_0x4988f8); _0x45aeb9['isArray'](_0x391067) && (_0xf27ddf = _0x391067[_0x160af4(0x16f)](_0x1b1f82 => _0x1b1f82 && typeof _0x1b1f82 === 'object' && typeof _0x1b1f82[_0x160af4(0x837)] === _0x160af4(0xac) && typeof _0x1b1f82[_0x160af4(0x812)] !== _0x160af4(0x570))); } } finally { _0x160af4(0x20d) !== _0x160af4(0x20d) ? (_0x122da8['classList'][_0x160af4(0x65b)](_0x160af4(0x4fd)), _0xce210b[_0x160af4(0x1c1)][_0x160af4(0x65b)](_0x160af4(0x60d)), _0xebdbe5[_0x160af4(0x1c1)][_0x160af4(0x65b)](_0x160af4(0xa9)), _0x56efa2(() => { const _0x39e311 = _0x160af4; _0x1c1e7c['classList'][_0x39e311(0x47e)](_0x39e311(0xa9), _0x39e311(0x60d)), _0x5d58f4['classList'][_0x39e311(0x47e)](_0x39e311(0x4fd)), _0xc5f196[_0x39e311(0x8d9)] = _0xc48b07, _0xf07d9b(), _0x57edb2[_0x39e311(0x8ca)] = ![]; }, 0x2bc)) : (_0x3396e7(![]), _0x1db239[_0x160af4(0x94)][_0x160af4(0x815)] = ''); } }, _0x372528[_0x398d05(0x1f4)](_0x198f9c); } } async function _0x525a63() { const _0x4fbcae = _0x311e9d; if (_0x4fbcae(0x4b1) === _0x4fbcae(0x4b1)) { const _0x5b4b58 = _0x35cc5b['value']; let _0x42f098 = null; const _0x566bac = _0x55562a[_0x4fbcae(0x83b)][0x0], _0xb2e4fc = _0x3b9a27['files'][0x0], _0x25dd98 = _0x3bc69e[_0x4fbcae(0x83b)][0x0], _0x440313 = document['querySelectorAll'](_0x4fbcae(0x659)), _0x98e1f1 = Array[_0x4fbcae(0x2d7)](_0x440313)[_0x4fbcae(0x7cc)](_0x5774d1 => _0x5774d1[_0x4fbcae(0x815)]), _0x1e00f1 = { 'name': _0x21e8b2[_0x4fbcae(0x815)][_0x4fbcae(0x3e3)](), 'remark': _0x241bc7[_0x4fbcae(0x815)]['trim'](), 'persona': _0x82a905[_0x4fbcae(0x815)][_0x4fbcae(0x3e3)](), 'linkedWorldBookIds': _0x98e1f1, 'boundUserProfileId': document[_0x4fbcae(0x3a7)]('char-edit-bind-user')[_0x4fbcae(0x815)], 'bubbleCss': document[_0x4fbcae(0x3a7)](_0x4fbcae(0x308))[_0x4fbcae(0x815)][_0x4fbcae(0x3e3)]() }; if (!_0x1e00f1[_0x4fbcae(0x2e6)]) { _0x1bbd68(_0x4fbcae(0x95)); return; } try { const _0x214acf = ['normal', _0x4fbcae(0x6f7), _0x4fbcae(0x1eb), _0x4fbcae(0x1a5), _0x4fbcae(0x5e3)]; if (_0x5b4b58) { const _0x1fb1f0 = _0x40321a[_0x4fbcae(0x382)]['find'](_0x220a1d => _0x220a1d['id'] === _0x5b4b58); if (_0x1fb1f0) { if (_0x4fbcae(0x476) === _0x4fbcae(0x476)) { Object[_0x4fbcae(0x616)](_0x1fb1f0, _0x1e00f1); if (_0x566bac) _0x1fb1f0['avatar'] = await _0x53aefa(_0x566bac); } else { const _0x3fe0fd = { 'id': _0x3ec700['id'], 'url': _0x573e9d[_0x4fbcae(0x89c)] }; _0x4f9b2e(this, _0x3fe0fd); } } if (_0x566bac) await _0x5c7ad7(_0x4fbcae(0x30c) + _0x5b4b58, _0x566bac); if (_0xb2e4fc) await _0x5c7ad7(_0x4fbcae(0x865) + _0x5b4b58, _0xb2e4fc); if (_0x25dd98) await _0x5c7ad7(_0x4fbcae(0x4dd) + _0x5b4b58, _0x25dd98); for (const _0x4ac9b9 of _0x214acf) { if (_0x4fbcae(0x2b4) === _0x4fbcae(0x2b4)) { const _0x2e0601 = document[_0x4fbcae(0x3a7)](_0x4fbcae(0x5bd) + _0x4ac9b9 + _0x4fbcae(0x528))['files'][0x0]; if (_0x2e0601) await _0x5c7ad7('char_sprite_' + _0x4ac9b9 + '_' + _0x5b4b58, _0x2e0601); } else { const _0x25d5d7 = _0x325a03[_0x4fbcae(0x3a7)](_0x5a98cc); _0x25d5d7[_0x4fbcae(0x49f)] = '', _0x2cc3a8['userProfiles'][_0x4fbcae(0x436)](_0x54793d => { const _0x5c6be6 = _0x4fbcae, _0x1ee396 = _0x37aa18[_0x5c6be6(0x3e8)]('option'); _0x1ee396['value'] = _0x54793d['id'], _0x1ee396[_0x5c6be6(0x26b)] = _0x54793d['name'], _0x25d5d7[_0x5c6be6(0x7d)](_0x1ee396); }); } } } else { _0x42f098 = 'char_' + Date[_0x4fbcae(0x6bb)](); const _0x4ed8e6 = { 'id': _0x42f098, ..._0x1e00f1 }; _0x4ed8e6[_0x4fbcae(0xe7)] = _0x566bac ? await _0x53aefa(_0x566bac) : _0x4716b3, _0x40321a[_0x4fbcae(0x382)][_0x4fbcae(0x1fb)](_0x4ed8e6); const _0x42798c = { 'id': 'chat_' + _0x42f098, 'type': _0x4fbcae(0x64f), 'participantIds': [_0x42f098], 'boundUserProfileId': _0x1e00f1[_0x4fbcae(0x87f)], 'listenTogetherSession': null }; _0x40321a[_0x4fbcae(0x478)][_0x4fbcae(0x1fb)](_0x42798c); if (_0x566bac) await _0x5c7ad7(_0x4fbcae(0x30c) + _0x42f098, _0x566bac); if (_0xb2e4fc) await _0x5c7ad7(_0x4fbcae(0x865) + _0x42f098, _0xb2e4fc); if (_0x25dd98) await _0x5c7ad7(_0x4fbcae(0x4dd) + _0x42f098, _0x25dd98); for (const _0x4c57fe of _0x214acf) { const _0x48757b = document[_0x4fbcae(0x3a7)](_0x4fbcae(0x5bd) + _0x4c57fe + '-input')[_0x4fbcae(0x83b)][0x0]; if (_0x48757b) await _0x5c7ad7('char_sprite_' + _0x4c57fe + '_' + _0x42f098, _0x48757b); } } _0x544cbe(), _0x5af13e(), _0x1bbd68('角色已保存！'), _0x6564ff(_0x4fbcae(0x8da), _0x4fbcae(0x4bb)); if (!_0x5b4b58) { const _0x594b41 = _0x4fbcae(0x1bd) + _0x42f098; _0x3bb312(_0x594b41), _0x22cc08(!![]); } } catch (_0x377c44) { _0x4fbcae(0x253) !== _0x4fbcae(0x472) ? (console[_0x4fbcae(0x159)](_0x4fbcae(0x565), _0x377c44), _0x1bbd68(_0x4fbcae(0x409) + _0x377c44['message'])) : (delete _0x2a21e1[_0x4fbcae(0x24e)], _0x4cb8ee(), _0x458690(_0x1842ea['id'], _0x4fbcae(0x4d6)), _0x5020f7(_0x4fbcae(0x28c)), _0x36bff0(!![])); } } else _0xb52b44(_0x142368[_0x4fbcae(0x3a0)])[_0x4fbcae(0x3fa)](_0x438f20 => { const _0x4b2771 = _0x4fbcae; if (_0x438f20) { const _0x1a87ec = _0x37c043[_0x4b2771(0x99)](_0x438f20); _0x5a5ec6['src'] = _0x1a87ec, _0xc5f7c2[_0x4b2771(0x5bc)] = () => _0x305c59[_0x4b2771(0x165)](_0x1a87ec); } }); } function _0x45d11c() { const _0x3601f5 = _0x311e9d; _0x4e7216['value'] = '', _0x599d02[_0x3601f5(0x49f)] = ''; if (_0x40321a[_0x3601f5(0x382)][_0x3601f5(0x286)] < 0x2) { _0x1bbd68(_0x3601f5(0x68d)); return; } _0x40321a[_0x3601f5(0x382)][_0x3601f5(0x436)](_0x52284a => { const _0x48ff97 = _0x3601f5, _0x16c3c8 = document[_0x48ff97(0x3e8)]('li'); _0x16c3c8[_0x48ff97(0x8d8)] = 'member-selection-item', _0x16c3c8[_0x48ff97(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-' + _0x52284a['id'] + _0x48ff97(0x4a0) + _0x52284a['id'] + _0x48ff97(0x14a) + (_0x52284a['avatar'] || _0x4716b3) + _0x48ff97(0x37b) + _0x52284a['id'] + '\x22\x20class=\x22char-name\x22>' + _0x52284a[_0x48ff97(0x2e6)] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x599d02['appendChild'](_0x16c3c8); }), _0x6564ff(_0x3601f5(0x4ee), 'charSelect'); } function _0x242e36() { const _0x3d0c72 = _0x311e9d; if (_0x3d0c72(0x93) !== 'pAHpA') { const _0x49ad61 = _0x8f3742(_0x48b96f['content'] ?? _0x41715a[_0x3d0c72(0x44f)] ?? '')[_0x3d0c72(0x3e3)]() || _0x3d0c72(0x22d) + (_0x3e9ef6 || _0x3d0c72(0x106)) + ']'; if (_0x49ad61) _0x105a64['events'][_0x3d0c72(0x1fb)]({ 'senderId': _0x316b70['id'], 'kind': _0x3d0c72(0x44f), 'content': _0x49ad61 }); } else { const _0x51f6e3 = _0x4e7216[_0x3d0c72(0x815)][_0x3d0c72(0x3e3)](); if (!_0x51f6e3) { _0x1bbd68('请输入群聊名称。'); return; } const _0x25b72b = Array[_0x3d0c72(0x2d7)](_0x599d02['querySelectorAll'](_0x3d0c72(0x475)))[_0x3d0c72(0x7cc)](_0x56de5b => _0x56de5b[_0x3d0c72(0x58e)]['id']); if (_0x25b72b[_0x3d0c72(0x286)] < 0x2) { _0x1bbd68(_0x3d0c72(0x3db)); return; } const _0x948be8 = { 'id': _0x3d0c72(0x5a8) + Date[_0x3d0c72(0x6bb)](), 'type': _0x3d0c72(0x3bc), 'name': _0x51f6e3, 'participantIds': _0x25b72b }; _0x40321a['chats'][_0x3d0c72(0x1fb)](_0x948be8), _0x40321a[_0x3d0c72(0x1cc)] = _0x948be8['id'], _0x544cbe(), _0x5af13e(), _0x53a615(), _0x5f2acc(), _0x1bbd68(_0x3d0c72(0x48e) + _0x51f6e3 + _0x3d0c72(0x2ab)), _0x6564ff(_0x3d0c72(0x8da), _0x3d0c72(0x4ee)); } } _0x264472[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x3ce796[_0x311e9d(0x236)]()), _0x1b86f7['addEventListener'](_0x311e9d(0x236), _0x3a5038), _0x3ce796[_0x311e9d(0x215)]('change', _0x17ba66), _0x570873[_0x311e9d(0x215)](_0x311e9d(0x236), _0x21849f), _0x51c7da['addEventListener'](_0x311e9d(0x236), () => _0xa8a51e['classList'][_0x311e9d(0x47e)](_0x311e9d(0x7de))), _0x4496f8[_0x311e9d(0x215)]('click', () => _0xa8a51e[_0x311e9d(0x1c1)][_0x311e9d(0x47e)](_0x311e9d(0x7de))), _0x570888[_0x311e9d(0x215)]('click', () => { const _0x3df5d4 = _0x311e9d; _0xe61e0a[_0x3df5d4(0x705)](), navigator['clipboard']['writeText'](_0xe61e0a[_0x3df5d4(0x815)])[_0x3df5d4(0x3fa)](() => { const _0x4779c3 = _0x3df5d4; if (_0x4779c3(0x3ba) === _0x4779c3(0x158)) { if (!_0xcbcb01['friendCircles'] || _0x48705d[_0x4779c3(0x7ab)][_0x4779c3(0x286)] === 0x0) { _0x481e48[_0x4779c3(0x159)](_0x4779c3(0x46b)); return; } const _0x53af01 = _0x56bd36[_0x4779c3(0x7ab)][0x0]; if (_0x53af01['memberCharacterIds'][_0x4779c3(0x286)] < 0x2) { _0x12d654[_0x4779c3(0x159)]('错误：第一个好友圈\x20\x22' + _0x53af01[_0x4779c3(0x2e6)] + _0x4779c3(0x405)); return; } const _0x12beb7 = { 'id': _0x4779c3(0x541) + _0x3701bd[_0x4779c3(0x6bb)](), 'authorType': _0x4779c3(0x37a), 'authorId': _0x53af01['memberCharacterIds'][0x0], 'content': _0x4779c3(0x849), 'timestamp': _0x922232[_0x4779c3(0x6bb)](), 'likes': [_0x53af01['memberCharacterIds'][0x1]], 'comments': [{ 'commentId': 'c_' + _0x3af035['now'](), 'authorId': _0x53af01[_0x4779c3(0x726)][0x1], 'content': _0x4779c3(0x3cb) }] }; _0x53af01['posts']['push'](_0x12beb7), _0x391a60(), _0x528ce9[_0x4779c3(0x336)](_0x4779c3(0x87a) + _0x53af01[_0x4779c3(0x2e6)] + '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。'), _0x1b033b('测试动态已添加！'); } else _0x1bbd68(_0x4779c3(0x756)); })[_0x3df5d4(0x412)](_0x5b4e3d => { const _0x45f8ad = _0x3df5d4; _0x45f8ad(0x4e2) === _0x45f8ad(0x105) ? _0x304f9c[_0x45f8ad(0x888)] = _0x2599f8 : _0x1bbd68(_0x45f8ad(0x1be)); }); }), _0x1b83ca[_0x311e9d(0x215)](_0x311e9d(0x236), _0x58de46), _0x172638['addEventListener'](_0x311e9d(0x236), _0xce3bd5), _0x592abd[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x44797b[_0x311e9d(0x1c1)]['remove']('show')), _0x3ae845[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x44797b[_0x311e9d(0x1c1)]['remove']('show')), _0x1f4106[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x3b9a27[_0x311e9d(0x236)]()), _0x93bae0[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x3bc69e[_0x311e9d(0x236)]()), _0x3b9a27['addEventListener']('change', async _0x1799a9 => { const _0x4bde54 = _0x311e9d, _0x228395 = _0x1799a9[_0x4bde54(0x94)][_0x4bde54(0x83b)][0x0]; if (!_0x228395) return; try { _0x1f4106['src'] = await _0x53aefa(_0x228395); } catch (_0x1dc29e) { _0x1bbd68(_0x4bde54(0x218) + _0x1dc29e[_0x4bde54(0x15a)]); } }), _0x3bc69e[_0x311e9d(0x215)](_0x311e9d(0x66a), async _0x3857ab => { const _0x2773a1 = _0x311e9d; if (_0x2773a1(0x6ce) === _0x2773a1(0x3b8)) try { _0x28bf7d[_0x2773a1(0x7aa)](_0x2773a1(0x493), _0x1727bc[_0x2773a1(0x504)]({ 'playlist': _0x43b305['musicPlaylist'], 'currentIndex': _0x5aefbc[_0x2773a1(0x4bc)] })); } catch (_0x299787) { _0x25339d[_0x2773a1(0x159)](_0x2773a1(0x621), _0x299787); } else { const _0x2342fd = _0x3857ab[_0x2773a1(0x94)]['files'][0x0]; if (!_0x2342fd) return; try { _0x93bae0[_0x2773a1(0x8c7)] = await _0x53aefa(_0x2342fd); } catch (_0x460768) { _0x1bbd68(_0x2773a1(0x218) + _0x460768['message']); } } }), _0x56a8f2[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x2344fd[_0x311e9d(0x236)]()), _0xdd6f5e[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x14b699 = _0x311e9d; localStorage[_0x14b699(0x73)](_0x14b699(0x70c)), _0x3d6fe9(), _0x1bbd68(_0x14b699(0x299)); }), _0x2344fd[_0x311e9d(0x215)]('change', async _0xefb0e3 => { const _0x9d3e50 = _0x311e9d; if (_0x9d3e50(0x782) !== _0x9d3e50(0x699)) { const _0x426e19 = _0xefb0e3[_0x9d3e50(0x94)][_0x9d3e50(0x83b)][0x0]; if (!_0x426e19) return; try { if ('BLOIl' === 'mVOKx') _0x17010d(_0x9d3e50(0x7d2) + _0x15985d[_0x9d3e50(0x2c1)]('\x0a')); else { const _0x20e878 = await _0x53aefa(_0x426e19); localStorage[_0x9d3e50(0x7aa)](_0x9d3e50(0x70c), _0x20e878), _0x3d6fe9(), _0x1bbd68(_0x9d3e50(0x6c5)); } } catch (_0xe5d5ed) { _0x1bbd68(_0x9d3e50(0x218) + _0xe5d5ed[_0x9d3e50(0x15a)]); } } else { if (!_0x2fa67e[_0x9d3e50(0x8bc)]) return; _0x1a6422[_0x9d3e50(0x26b)] = _0x9d3e50(0x357) + _0x1b5e72['activeQuote'][_0x9d3e50(0x353)], _0x2ff186[_0x9d3e50(0x26b)] = _0x5ebc2b['activeQuote'][_0x9d3e50(0x812)], _0x53cfd9['style'][_0x9d3e50(0x5a4)] = 'block'; } }), document[_0x311e9d(0x3a7)]('back-to-chat-from-group-settings')['addEventListener']('click', () => _0x6564ff(_0x311e9d(0x8da), _0x311e9d(0x50f))), document[_0x311e9d(0x3a7)](_0x311e9d(0x747))['addEventListener'](_0x311e9d(0x236), _0x3b9c0e); const _0x2b2d80 = document[_0x311e9d(0x3a7)](_0x311e9d(0x693)), _0x1d9c60 = document['getElementById'](_0x311e9d(0x3ce)); _0x2b2d80['addEventListener']('click', () => _0x1d9c60[_0x311e9d(0x236)]()), _0x1d9c60[_0x311e9d(0x215)](_0x311e9d(0x66a), _0x2655bc => { const _0x17fb89 = _0x311e9d, _0xa5caf1 = _0x2655bc[_0x17fb89(0x94)][_0x17fb89(0x83b)][0x0]; if (!_0xa5caf1) return; const _0x55bff6 = URL[_0x17fb89(0x99)](_0xa5caf1); _0x2b2d80[_0x17fb89(0x8c7)] = _0x55bff6, _0x2b2d80[_0x17fb89(0x5bc)] = () => { const _0x3d1241 = _0x17fb89; URL[_0x3d1241(0x165)](_0x55bff6); }; }); const _0x4423e3 = document[_0x311e9d(0x3a7)](_0x311e9d(0x2dd))[_0x311e9d(0x7ea)], _0x44f99d = document[_0x311e9d(0x3a7)](_0x311e9d(0x5ea)), _0x1e035f = document[_0x311e9d(0x3a7)]('group-bg-preview'); _0x4423e3[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x44f99d[_0x311e9d(0x236)]()), _0x44f99d[_0x311e9d(0x215)]('change', _0x4e8102 => { const _0x471787 = _0x311e9d; if (_0x471787(0x622) === _0x471787(0x450)) _0x40c692[_0x471787(0x25e)] = _0x312288(() => { const _0x5761d9 = _0x471787; if (_0x1d73f6['type'] === _0x5761d9(0xd0)) _0x4435e5['preventDefault'](); _0x45c307(_0xb3cdc7(_0x506e48, 0xa), _0x465461); }, 0x320); else { const _0x1ffc1b = _0x4e8102[_0x471787(0x94)][_0x471787(0x83b)][0x0]; if (!_0x1ffc1b) return; const _0x4a3e57 = URL[_0x471787(0x99)](_0x1ffc1b); _0x1e035f[_0x471787(0x8c7)] = _0x4a3e57, _0x1e035f[_0x471787(0x5bc)] = () => { const _0x3d0712 = _0x471787; _0x3d0712(0x5a7) === _0x3d0712(0x103) ? _0x2945c9[_0x3d0712(0x159)](_0x3d0712(0x8af) + _0x39421a[_0x3d0712(0x1cc)], _0x13dd50) : URL[_0x3d0712(0x165)](_0x4a3e57); }; } }); const _0x92d65e = document[_0x311e9d(0x889)](_0x311e9d(0x2c2)), _0x437878 = document['getElementById'](_0x311e9d(0x4ef)); _0x92d65e['addEventListener'](_0x311e9d(0x236), _0x2bbebd => { const _0x33c976 = _0x311e9d; _0x2bbebd['stopPropagation'](), _0x437878[_0x33c976(0x1c1)][_0x33c976(0x676)](_0x33c976(0x702)), _0x92d65e[_0x33c976(0x1c1)][_0x33c976(0x676)](_0x33c976(0x3e9)); }), _0x437878[_0x311e9d(0x215)]('change', _0x551221), document[_0x311e9d(0x3a7)](_0x311e9d(0x68c))['addEventListener'](_0x311e9d(0x236), _0x322153), document[_0x311e9d(0x3a7)](_0x311e9d(0x485))[_0x311e9d(0x215)](_0x311e9d(0x236), async () => { const _0x3853f0 = _0x311e9d; if (_0x3853f0(0x62c) !== _0x3853f0(0x3b3)) { const _0x5989cf = _0x4db4a7(); if (!_0x5989cf || _0x5989cf[_0x3853f0(0x78c)] !== _0x3853f0(0x3bc)) return; const _0x3d25f3 = await _0x4849f2(_0x3853f0(0x720) + _0x5989cf[_0x3853f0(0x2e6)] + '”吗？此操作不可撤销。'); _0x3d25f3 && (_0x2cb7e4(_0x5989cf['id']), _0x1bbd68(_0x3853f0(0x8c2)), _0x6564ff(_0x3853f0(0x8da)), _0x22cc08(![])); } else _0x3193ae[_0x3853f0(0x1fb)]({ 'name': _0x20627f[0x0]['trim'](), 'url': _0x4a23b1[0x1][_0x3853f0(0x3e3)]() }); }); const _0x267261 = document[_0x311e9d(0x889)]('.custom-multiselect\x20.select-box'), _0x186283 = document[_0x311e9d(0x3a7)](_0x311e9d(0x3c6)); _0x267261[_0x311e9d(0x215)](_0x311e9d(0x236), _0x1004e6 => { const _0x27e032 = _0x311e9d; if ('moIBB' !== _0x27e032(0x58d)) { if (_0x4060dc[_0x27e032(0x837)] === _0x27e032(0x18d)) { const _0x534bf7 = _0x4aa9bf[_0x27e032(0x779)][_0x594e39]; _0x534bf7 && _0x534bf7['length'] > 0x0 && (_0x513e50 = _0x534bf7['at'](-0x1)); } else _0x5f078a = { 'speaker': _0x2cd147[_0x27e032(0x2e6)], 'line': _0x6b6557[_0x27e032(0x812)], 'emotion': _0x27e032(0x4d6) }; } else _0x1004e6[_0x27e032(0x860)](), _0x186283[_0x27e032(0x1c1)]['toggle'](_0x27e032(0x702)), _0x267261[_0x27e032(0x1c1)][_0x27e032(0x676)](_0x27e032(0x3e9)); }), _0x186283[_0x311e9d(0x215)]('change', _0x1e1925), document[_0x311e9d(0x215)]('click', _0x1347c1 => { const _0x1fd45e = _0x311e9d; !document[_0x1fd45e(0x889)]('.custom-multiselect')[_0x1fd45e(0xa1)](_0x1347c1[_0x1fd45e(0x94)]) && (_0x186283[_0x1fd45e(0x1c1)][_0x1fd45e(0x47e)](_0x1fd45e(0x702)), _0x267261[_0x1fd45e(0x1c1)]['remove']('expanded')); }), _0x484750[_0x311e9d(0x215)]('click', () => { const _0x5bad3d = _0x311e9d; _0x5bad3d(0xf0) === _0x5bad3d(0xf0) ? (_0x437e36(), _0x6564ff('worldBook', _0x5bad3d(0x519))) : (_0xbf8e1c(), _0x38a019(_0x5bad3d(0x519), _0x5bad3d(0x8da))); }), document[_0x311e9d(0x3a7)]('back-to-home-from-world-book')[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x519), _0x311e9d(0x8cc))), document['getElementById'](_0x311e9d(0x67c))[_0x311e9d(0x215)]('click', () => _0x365bc8()), document['getElementById'](_0x311e9d(0x25d))[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x2081a1 = _0x311e9d; _0x2081a1(0x4bd) === 'hASOh' ? _0x28247e(_0x2081a1(0x1e4) + _0x1c6d80['message'] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1') : (_0x437e36(), _0x6564ff(_0x2081a1(0x8cc), _0x2081a1(0x551))); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x878))['addEventListener'](_0x311e9d(0x236), _0x14cf2b), document[_0x311e9d(0x3a7)](_0x311e9d(0x671))[_0x311e9d(0x215)](_0x311e9d(0x236), _0x1a25e1), _0x423c5e[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x6f1), _0x311e9d(0x519))), _0x2d80c2[_0x311e9d(0x215)]('click', () => _0x6564ff(_0x311e9d(0x519), 'wallpaper')), _0x237a43[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6bc31c[_0x311e9d(0x236)]()), _0x6bc31c['addEventListener']('change', async _0x2ace1f => { const _0x353d87 = _0x311e9d; if (_0x353d87(0x2bf) !== _0x353d87(0x69b)) { const _0x252dab = _0x2ace1f[_0x353d87(0x94)][_0x353d87(0x83b)][0x0]; if (!_0x252dab) return; await _0x211cc7(_0x252dab); } else { _0x6e378d[_0x353d87(0x159)](_0x353d87(0x46b)); return; } }), _0x1f153e[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x355dd7 = _0x311e9d; _0x5af13e(), _0x6564ff(_0x355dd7(0x8da), 'home'); }), _0x58d975[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x5df9ec = _0x311e9d; _0x4efade(); const _0x3e3819 = (_0x40321a[_0x5df9ec(0x5ee)][_0x5df9ec(0x7e6)] || '')['includes'](_0x59a2b9); _0x34450d[_0x5df9ec(0x313)] = _0x3e3819, _0x6564ff(_0x5df9ec(0x2c0), _0x5df9ec(0x519)); }), _0x3b96a5[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x519), _0x311e9d(0x2c0))), _0x4f7257[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x26ac01 = _0x311e9d; _0x4b7297(), _0x6564ff(_0x26ac01(0x519), _0x26ac01(0x8da)); }), _0x5a880a[_0x311e9d(0x215)]('click', () => { _0x4b7297(), _0x22cc08(![]); }), _0x5abc73[_0x311e9d(0x215)]('click', () => { const _0x34c35d = _0x311e9d; if (_0x34c35d(0x771) !== _0x34c35d(0x380)) _0x6564ff(_0x34c35d(0x8da), _0x34c35d(0x4bb)); else { const _0x3b2a27 = _0x3c37f3(_0x3aaf16['dataset'][_0x34c35d(0x7c6)], 0xa); _0x2672b4(_0x3b2a27); } }), _0x2fdf43['addEventListener'](_0x311e9d(0x236), () => { const _0x2af4e7 = _0x311e9d; _0x50d206[_0x2af4e7(0x1c1)][_0x2af4e7(0x65b)]('show'); }), _0x407cfd['addEventListener'](_0x311e9d(0x236), () => _0x3f1262()), _0x1fa2c8[_0x311e9d(0x215)](_0x311e9d(0x236), _0x5c5350); function _0x2e2884(_0x14a971) { const _0x106b7d = _0x311e9d; if (!_0x14a971 || _0x14a971['type'] !== _0x106b7d(0x3bc)) return; const _0x1ad6a4 = _0x106b7d(0x8ab); document['body'][_0x106b7d(0x6cb)](_0x106b7d(0x461), _0x1ad6a4); const _0x4afc45 = document[_0x106b7d(0x3a7)](_0x106b7d(0x456)), _0x3d796c = _0x4afc45[_0x106b7d(0x889)](_0x106b7d(0x635)), _0x299ca0 = document[_0x106b7d(0x3a7)]('group-clear-history'), _0x2e3c90 = document[_0x106b7d(0x3a7)](_0x106b7d(0x6c9)), _0x50101e = document[_0x106b7d(0x3a7)](_0x106b7d(0x8b5)), _0x32e1ab = document[_0x106b7d(0x3a7)](_0x106b7d(0x27e)), _0x41b6a7 = document[_0x106b7d(0x3a7)](_0x106b7d(0x4f2)), _0x4245db = () => _0x4afc45['remove'](); _0x299ca0['addEventListener'](_0x106b7d(0x236), async () => { const _0x5145ac = _0x106b7d; if (_0x5145ac(0x4b7) !== _0x5145ac(0x1e5)) { _0x4245db(); const _0x87b4b8 = await _0x4849f2(_0x5145ac(0xd8) + _0x14a971['name'] + _0x5145ac(0x5a2)); if (_0x87b4b8) { _0x14a971['id'] === _0x40321a[_0x5145ac(0x1cc)] && (_0x4b7297(), _0x40321a[_0x5145ac(0x393)] = [], _0x259a7d()); try { localStorage[_0x5145ac(0x73)](_0x5145ac(0x4a7) + _0x14a971['id']), _0x1bbd68(_0x5145ac(0x678) + _0x14a971[_0x5145ac(0x2e6)] + _0x5145ac(0x733)); } catch (_0x2f58ef) { if (_0x5145ac(0x8a8) !== 'HBEGx') console[_0x5145ac(0x159)]('Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20' + _0x14a971['id'], _0x2f58ef), _0x1bbd68(_0x5145ac(0x3e0)); else { const _0x454657 = _0x2333a7['getElementById'](_0x5145ac(0x672)); _0x461b16[_0x5145ac(0x3a7)](_0x5145ac(0x898))[_0x5145ac(0x26b)] = '账本', _0x277840['getElementById']('header-actions')[_0x5145ac(0x49f)] = ''; const _0xabaf2b = _0x2c27ac['keys'](_0x525757[_0x5145ac(0x41b)])[_0x5145ac(0x783)]((_0x2e229b, _0x4c9aa8) => new _0x23b952(_0x4c9aa8) - new _0x41de9d(_0x2e229b)); if (_0xabaf2b[_0x5145ac(0x286)] === 0x0) { _0x454657[_0x5145ac(0x49f)] = _0x5145ac(0x3c5); return; } _0x454657[_0x5145ac(0x49f)] = '', _0xabaf2b['forEach'](_0x5b692e => { const _0x5e49fd = _0x5145ac, _0x189dbd = _0x461663[_0x5e49fd(0x3e8)](_0x5e49fd(0x8cf)); _0x189dbd[_0x5e49fd(0x8d8)] = _0x5e49fd(0x8e1), _0x189dbd['style'][_0x5e49fd(0xb6)] = _0x5e49fd(0x2a2); const _0x2d8817 = _0xc95425[_0x5e49fd(0x41b)][_0x5b692e], _0x238835 = _0x2d8817['categorizedExpenses'][_0x5e49fd(0x24a)]((_0x153760, _0x4d4b7d) => _0x153760 + (_0x4d4b7d['amount'] || 0x0), 0x0); _0x189dbd[_0x5e49fd(0x49f)] = _0x5e49fd(0x8bf) + _0x5b692e + _0x5e49fd(0x314) + _0x238835[_0x5e49fd(0x524)](0x2) + _0x5e49fd(0x477), _0x189dbd[_0x5e49fd(0x215)](_0x5e49fd(0x236), () => { const _0x7bb9df = _0x5e49fd; _0x255c0b[_0x7bb9df(0x1c1)][_0x7bb9df(0x47e)](_0x7bb9df(0x21b)), _0x27c6e6[_0x7bb9df(0x1c1)][_0x7bb9df(0x65b)](_0x7bb9df(0x21b)), _0x5530a8(_0x2d8817, _0x5b692e); }), _0x454657['appendChild'](_0x189dbd); }); } } } } else { const _0x2919ff = _0x429ed6[_0x5145ac(0x7ab)][_0x5145ac(0x226)](_0x50d370 => _0x50d370['id'] === _0xdf93ed); _0x2919ff && (_0x2919ff[_0x5145ac(0x2e6)] = _0x246a1e, _0x2919ff[_0x5145ac(0x87f)] = _0x1debf3, _0x2919ff['memberCharacterIds'] = _0x236c49); } }), _0x2e3c90[_0x106b7d(0x215)](_0x106b7d(0x236), () => { const _0x49b615 = _0x106b7d; if (_0x49b615(0x632) === _0x49b615(0x632)) _0x4245db(), _0x1bbd68(_0x49b615(0x7ce)); else { const _0x341218 = _0x33606f(_0x7b2fa2[_0x49b615(0x574)]); if (!_0x341218) return; _0x5abc10 = !![], _0x4851eb[_0x49b615(0x27d)][_0x49b615(0x5a4)] = _0x49b615(0x7dc); const _0x5898f4 = _0x341218['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; _0x54a925['getElementById'](_0x49b615(0x558))[_0x49b615(0x815)] = _0x5898f4['x'], _0x2cb959['getElementById'](_0x49b615(0x526))[_0x49b615(0x815)] = _0x5898f4['y'], _0x7f544d['getElementById'](_0x49b615(0x43a))['value'] = _0x5898f4[_0x49b615(0x552)] * 0x64, _0x281091 = { ..._0x5898f4 }, _0xcfafbc[_0x49b615(0x3a7)]('galgame-textbox-container')[_0x49b615(0x27d)][_0x49b615(0x5a4)] = _0x49b615(0x87b), _0x20101a[_0x49b615(0x3a7)](_0x49b615(0xf8))[_0x49b615(0x27d)]['display'] = _0x49b615(0x87b); } }), _0x50101e['addEventListener'](_0x106b7d(0x236), async () => { const _0x3e4cda = _0x106b7d; _0x4245db(); const _0x708605 = prompt(_0x3e4cda(0x757), _0x14a971[_0x3e4cda(0x2e6)]); _0x708605 && _0x708605[_0x3e4cda(0x3e3)]() && _0x708605 !== _0x14a971['name'] && (_0x14a971['name'] = _0x708605[_0x3e4cda(0x3e3)](), _0x544cbe(), _0x5af13e(), _0x53a615(), _0x1bbd68(_0x3e4cda(0x18f) + _0x14a971[_0x3e4cda(0x2e6)] + '\x22。')); }), _0x32e1ab[_0x106b7d(0x215)](_0x106b7d(0x236), async () => { const _0x2ab554 = _0x106b7d; _0x4245db(); const _0x19e79b = await _0x4849f2(_0x2ab554(0x4a2) + _0x14a971[_0x2ab554(0x2e6)] + _0x2ab554(0x2b5)); if (_0x19e79b) { if (_0x2ab554(0x8b3) !== 'WoAlb') _0x2cb7e4(_0x14a971['id']), _0x1bbd68('群聊\x22' + _0x14a971['name'] + _0x2ab554(0x14f)), _0x22cc08(![]); else { _0x571d37('真是的，必需的祭品都还没准备好！'); return; } } }), _0x3d796c['addEventListener'](_0x106b7d(0x236), _0x4245db), _0x41b6a7[_0x106b7d(0x215)](_0x106b7d(0x236), _0x4245db); } _0x46cd3b[_0x311e9d(0x215)]('click', () => { const _0x5812eb = _0x311e9d; if (_0x5812eb(0x81) !== 'HJfAN') { if (_0xc23aad[_0x5812eb(0x11c)] === _0x5812eb(0x7ed)) _0x1c40fa(![]); if (_0x41dc55['key'] === _0x5812eb(0x1ad)) _0x174972(!![]); } else { const _0x30298a = _0x4db4a7(); if (_0x30298a && _0x30298a[_0x5812eb(0x78c)] === _0x5812eb(0x64f)) _0x59deff(_0x30298a[_0x5812eb(0x239)][0x0]); else _0x30298a && _0x30298a[_0x5812eb(0x78c)] === _0x5812eb(0x3bc) && (_0x5812eb(0x8c9) === 'cfSNq' ? _0x58805c(_0x30298a['id']) : (_0xdbb8a1[_0x5812eb(0x159)](_0x5812eb(0x55e), _0x158cbf), _0x1e9696(_0x5812eb(0x437) + _0x5deaf7[_0x5812eb(0x15a)]))); } }), _0x3a20f5[_0x311e9d(0x215)]('keydown', _0x53a3dc => { const _0x14ef7e = _0x311e9d; 'HTcXb' === _0x14ef7e(0x2d1) ? _0x53a3dc[_0x14ef7e(0x11c)] === _0x14ef7e(0x1ad) && !_0x53a3dc[_0x14ef7e(0x28e)] && (_0x53a3dc[_0x14ef7e(0x425)](), _0x3f1262()) : _0x3f5c29[_0x14ef7e(0x159)]('净化音乐封面时出错，真是的。', _0x4615de); }); const _0x5b6a07 = () => _0x50d206[_0x311e9d(0x1c1)][_0x311e9d(0x47e)](_0x311e9d(0x7de)); _0x4e794e[_0x311e9d(0x215)](_0x311e9d(0x236), _0x5b6a07), _0x581c7a[_0x311e9d(0x215)](_0x311e9d(0x236), _0x5b6a07), _0x5f5a93['addEventListener'](_0x311e9d(0x236), () => { _0x5b6a07(), _0x59deff(); }), _0x994140['addEventListener'](_0x311e9d(0x236), () => { _0x5b6a07(), _0x45d11c(); }), _0x31860c[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x17b0fe = _0x311e9d; _0x6564ff(_0x17b0fe(0x8da), 'groupChatCreate'), _0x22cc08(![]); }), _0x4f36bf[_0x311e9d(0x215)]('click', _0x242e36), _0x24fb32['addEventListener'](_0x311e9d(0x236), () => { const _0x241f80 = _0x311e9d; _0x241f80(0x5f2) !== _0x241f80(0x637) ? (_0x333188[_0x241f80(0x1c1)][_0x241f80(0x676)]('show'), _0x333188[_0x241f80(0x1c1)][_0x241f80(0xa1)]('show') && (_0x5a2162[_0x241f80(0x19c)] = _0x5a2162['scrollHeight'])) : (_0x1c98ca[_0x241f80(0x7d)](_0x294ec1), _0x42bf82['appendChild'](_0x44c390)); }), _0x55fe13[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x1aed37[_0x311e9d(0x236)]()); const _0x373700 = document[_0x311e9d(0x3a7)](_0x311e9d(0x776)); _0x1aed37['addEventListener'](_0x311e9d(0x66a), _0x283d7c), _0x373700['addEventListener'](_0x311e9d(0x236), _0x44794f), _0x5d84ab[_0x311e9d(0x215)](_0x311e9d(0x236), _0x1fceeb), _0x4f0835[_0x311e9d(0x215)](_0x311e9d(0x236), _0x27125d), _0xaba894[_0x311e9d(0x215)](_0x311e9d(0x236), _0x525a63), _0x5023b3['addEventListener'](_0x311e9d(0x236), _0x322153), _0x23d2e6[_0x311e9d(0x215)]('click', async () => { const _0x5da4f7 = _0x311e9d; if (_0x5da4f7(0x224) !== _0x5da4f7(0x506)) { const _0x409acf = _0x35cc5b[_0x5da4f7(0x815)]; if (!_0x409acf) return; const _0x4e705b = _0x3f1cb7(_0x409acf); if (!_0x4e705b) return; const _0x22c1ee = await _0x4849f2('确定要删除角色“' + _0x4e705b[_0x5da4f7(0x2e6)] + _0x5da4f7(0x377)); _0x22c1ee && (_0x312b87(_0x409acf), _0x1bbd68(_0x5da4f7(0x45c) + _0x4e705b[_0x5da4f7(0x2e6)] + '”已删除。'), _0x6564ff(_0x5da4f7(0x8da), 'characterEdit'), _0x22cc08(![])); } else { const _0x3aea45 = _0x58fccc[_0x5da4f7(0x3d5)]['map'](_0x20d7d4 => _0x3ec7b0[_0x5da4f7(0x5e7)][_0x5da4f7(0x226)](_0x31f60d => _0x31f60d['id'] === _0x20d7d4))['filter'](_0x46cd23)[_0x5da4f7(0x7cc)](_0x4e2e3d => _0x5da4f7(0x746) + _0x4e2e3d['name'] + '\x0a' + _0x4e2e3d[_0x5da4f7(0x812)])['join'](''); if (_0x3aea45) _0x3abc51 = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x3aea45; } }), _0xb7dfd6[_0x311e9d(0x215)](_0x311e9d(0x54c), () => { const _0x2d76f5 = _0x311e9d, _0x54da76 = _0xb7dfd6[_0x2d76f5(0x815)]['trim']()[_0x2d76f5(0x4fe)](_0x59a2b9); _0x34450d[_0x2d76f5(0x313)] = _0x54da76; }); async function _0xd88dac() { const _0x3e6d66 = _0x311e9d; if ('ofyJh' === _0x3e6d66(0xdb)) { const _0x42d509 = _0xb7dfd6['value'][_0x3e6d66(0x3e3)](), _0x42aea3 = _0x2008c6[_0x3e6d66(0x815)][_0x3e6d66(0x3e3)](); if (!_0x42d509 || !_0x42aea3) { _0x1bbd68('请先输入\x20API\x20接口地址和密钥。'); return; } const _0x381d63 = _0x42d509[_0x3e6d66(0x3d9)](/\/+$/, ''), _0x48e363 = _0x381d63 + _0x3e6d66(0x830); _0x34450d[_0x3e6d66(0x313)] = !![], _0x34450d[_0x3e6d66(0x26b)] = _0x3e6d66(0x3ee), _0x15938e[_0x3e6d66(0x1c1)]['remove'](_0x3e6d66(0x7de)); try { if ('VgGWb' !== _0x3e6d66(0x327)) { const _0x8cb576 = await fetch(_0x48e363, { 'headers': { 'Authorization': _0x3e6d66(0x3f3) + _0x57f5b7(_0x42aea3) } }); if (!_0x8cb576['ok']) throw new Error(_0x3e6d66(0x1d3) + _0x8cb576[_0x3e6d66(0x852)]); const _0x2be264 = await _0x8cb576[_0x3e6d66(0x4ff)](), _0xc75bb4 = (_0x2be264[_0x3e6d66(0x1a8)] || _0x2be264)['map'](_0x5c0de9 => _0x5c0de9['id'])[_0x3e6d66(0x783)](); _0xc75bb4[_0x3e6d66(0x286)] > 0x0 ? _0x3e6d66(0x666) === _0x3e6d66(0x51b) ? _0x1ced96(_0x3ee0eb[_0x3e6d66(0x239)][0x0]) : (_0x15938e['innerHTML'] = '', _0xc75bb4[_0x3e6d66(0x436)](_0x451be0 => { const _0x5dfc54 = _0x3e6d66; if (_0x5dfc54(0x515) !== _0x5dfc54(0x515)) { _0x5ed703(![]), _0x5c7446('错误：找不到签署契约的地方。'); return; } else { const _0x3c760c = document[_0x5dfc54(0x3e8)](_0x5dfc54(0x8cf)); _0x3c760c[_0x5dfc54(0x26b)] = _0x451be0, _0x3c760c['addEventListener'](_0x5dfc54(0x236), () => { const _0x2136e6 = _0x5dfc54; _0x5cc388[_0x2136e6(0x815)] = _0x451be0, _0x15938e['classList']['remove']('show'); }), _0x15938e[_0x5dfc54(0x7d)](_0x3c760c); } }), _0x15938e[_0x3e6d66(0x1c1)][_0x3e6d66(0x65b)](_0x3e6d66(0x7de)), _0x1bbd68(_0x3e6d66(0x81d) + _0xc75bb4[_0x3e6d66(0x286)] + _0x3e6d66(0x554))) : 'oGrnO' === _0x3e6d66(0x544) ? _0x1bbd68(_0x3e6d66(0x1fe)) : _0x81ada3 = _0x5e07c3['participantIds'][0x0]; } else _0xb7637b[_0x3e6d66(0x159)](_0x3e6d66(0x1d5), _0x5f091f), _0x521cdd['type'] = _0x3e6d66(0x44f); } catch (_0x48bd9b) { _0x1bbd68('获取模型失败:\x20' + _0x48bd9b[_0x3e6d66(0x15a)] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1'); } finally { _0x34450d['disabled'] = ![], _0x34450d['textContent'] = '获取'; } } else { _0x5b829f[_0x3e6d66(0x159)]('错误：第一个好友圈\x20\x22' + _0x82ac00[_0x3e6d66(0x2e6)] + _0x3e6d66(0x405)); return; } } _0x34450d[_0x311e9d(0x215)](_0x311e9d(0x236), _0x1a20a2 => { const _0x479b1f = _0x311e9d; 'PfSro' !== _0x479b1f(0x285) ? (_0x1a20a2[_0x479b1f(0x860)](), _0xd88dac()) : _0x2c222e(_0x1387ee, _0x442f1f); }), document['addEventListener'](_0x311e9d(0x236), _0x5639af => { const _0x49814f = _0x311e9d; if (_0x49814f(0x4c0) !== _0x49814f(0x4c0)) _0xddc756['type'] = _0x49814f(0x44f); else { if (!_0x15938e[_0x49814f(0xa1)](_0x5639af['target']) && _0x5639af[_0x49814f(0x94)] !== _0x5cc388 && _0x5639af['target'] !== _0x34450d) { if ('crCYk' === _0x49814f(0x839)) { const _0x28dca4 = _0xb6b198[_0x49814f(0x3e8)]('li'); _0x28dca4[_0x49814f(0x8d8)] = _0x49814f(0x51f), _0x28dca4[_0x49814f(0x49f)] = _0x49814f(0x410) + _0x3563ca['id'] + _0x49814f(0x4a0) + _0x44b814['id'] + _0x49814f(0x14a) + (_0x4628a2['avatar'] || _0x20670c) + _0x49814f(0x37b) + _0x4d78a6['id'] + _0x49814f(0x4bf) + _0x2b3282[_0x49814f(0x2e6)] + _0x49814f(0x8b2), _0x155c69['appendChild'](_0x28dca4); } else _0x15938e[_0x49814f(0x1c1)]['remove'](_0x49814f(0x7de)); } } }); async function _0x53aefa(_0x15fda8) { return await _0x774f7f(_0x15fda8, 0x190, 0.85); } _0x2a99e4[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x4b8d4d[_0x311e9d(0x236)]()), _0x4b8d4d[_0x311e9d(0x215)](_0x311e9d(0x66a), async _0x299d01 => { const _0x4bf77a = _0x311e9d; if (_0x4bf77a(0x1fd) !== _0x4bf77a(0x77a)) { const _0x6a6d5a = _0x299d01['target'][_0x4bf77a(0x83b)][0x0]; if (!_0x6a6d5a) return; try { const _0x5522d2 = await _0x53aefa(_0x6a6d5a); _0x2a99e4[_0x4bf77a(0x8c7)] = _0x5522d2; } catch (_0x418ca7) { if ('MlbaQ' === _0x4bf77a(0x465)) _0x1bbd68(_0x4bf77a(0x218) + _0x418ca7['message']); else return _0x519b04(_0x4bf77a(0x740)), ![]; } } else _0x446263[_0x4bf77a(0x7c0)] = _0x28e08b[_0x4bf77a(0x7c0)][_0x4bf77a(0x16f)](_0x443990 => _0x443990['id'] !== _0x42c3d9), _0x3d32a1[_0x4bf77a(0x17e)] === _0x501469 && (_0x1e0c20[_0x4bf77a(0x17e)] = _0x3fdb58[_0x4bf77a(0x7c0)][0x0]['id']), _0x4a1e48['chats'][_0x4bf77a(0x436)](_0x113c5c => { const _0x59265d = _0x4bf77a; _0x113c5c[_0x59265d(0x87f)] === _0x3e77a1 && (_0x113c5c[_0x59265d(0x87f)] = _0x2becac[_0x59265d(0x17e)]); }), _0x4cfc2e(), _0x889fc3(_0x4bf77a(0x542)), _0x33c344(), _0x928237(_0x4bf77a(0x77f), _0x4bf77a(0x92)); }), _0x216a74[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x55562a[_0x311e9d(0x236)]()), _0x55562a[_0x311e9d(0x215)](_0x311e9d(0x66a), async _0xa67b2f => { const _0x3f7130 = _0x311e9d; if (_0x3f7130(0x617) !== _0x3f7130(0x577)) { const _0x1b839a = _0xa67b2f[_0x3f7130(0x94)][_0x3f7130(0x83b)][0x0]; if (!_0x1b839a) return; try { _0x216a74[_0x3f7130(0x8c7)] = await _0x53aefa(_0x1b839a); } catch (_0x5c973b) { if (_0x3f7130(0x8c0) === _0x3f7130(0x4f0)) { _0x18e880(_0x3f7130(0x740)); return; } else _0x1bbd68(_0x3f7130(0x218) + _0x5c973b[_0x3f7130(0x15a)]); } } else _0x435ca8 = _0x2cb6f7[_0x3f7130(0x812)]; }); function _0x4b5ee5() { const _0x101005 = _0x311e9d; _0x101005(0x8b7) === _0x101005(0x427) ? _0x13a33b['innerHTML'] = _0x101005(0x5b4) + _0x41c7d3 + _0x101005(0x6f4) + _0x15d536 + _0x101005(0x2ef) + _0x288bdf[_0x101005(0x4de)] + _0x101005(0x4c7) + _0x24dc68['artist'] + _0x101005(0x1dc) + _0x2d058c['songId'] + _0x101005(0x23d) : (_0x333188[_0x101005(0x49f)] = '', _0x42bed1[_0x101005(0x436)](_0x544282 => { const _0x45651c = _0x101005, _0x42dad2 = document[_0x45651c(0x3e8)](_0x45651c(0x585)); _0x42dad2[_0x45651c(0x8c7)] = _0x544282[_0x45651c(0x5cb)], _0x42dad2[_0x45651c(0x35c)] = _0x45651c(0x39d), _0x42dad2[_0x45651c(0x373)] = _0x544282[_0x45651c(0x2e6)], _0x42dad2[_0x45651c(0x1c1)][_0x45651c(0x65b)](_0x45651c(0x6c3)), _0x42dad2[_0x45651c(0x215)](_0x45651c(0x236), () => _0x38346d(_0x544282)), _0x333188[_0x45651c(0x7d)](_0x42dad2); })); } function _0x2b67fb() { const _0x26faf0 = _0x311e9d, _0x2b705d = document[_0x26faf0(0x3a7)](_0x26faf0(0x291)); _0x2b705d[_0x26faf0(0x49f)] = ''; if (_0x40321a[_0x26faf0(0x7c0)][_0x26faf0(0x286)] === 0x0) { if ('SuxLN' !== _0x26faf0(0x49b)) { _0x2b705d['innerHTML'] = _0x26faf0(0x45b); return; } else { _0xc349b3[_0x26faf0(0x336)]('好友圈档案柜是空的，无需净化。'); return; } } _0x40321a[_0x26faf0(0x7c0)][_0x26faf0(0x436)](_0x1dfa06 => { const _0x3c50a1 = _0x26faf0; if (_0x3c50a1(0x39e) !== _0x3c50a1(0x69)) { const _0x316345 = document[_0x3c50a1(0x3e8)]('div'); _0x316345[_0x3c50a1(0x8d8)] = _0x3c50a1(0x341), _0x316345[_0x3c50a1(0x58e)]['id'] = _0x1dfa06['id']; const _0x334455 = _0x1dfa06['id'] === _0x40321a[_0x3c50a1(0x17e)] ? _0x3c50a1(0x3b5) : ''; _0x316345[_0x3c50a1(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x1dfa06[_0x3c50a1(0xe7)] || _0x579f27) + _0x3c50a1(0x6ae) + _0x1dfa06['name'] + _0x334455 + _0x3c50a1(0x891) + _0x1dfa06['persona'][_0x3c50a1(0x23c)](0x0, 0x64) + _0x3c50a1(0x626), _0x316345[_0x3c50a1(0x215)](_0x3c50a1(0x236), () => _0x5827f8(_0x1dfa06['id'])), _0x2b705d[_0x3c50a1(0x7d)](_0x316345); } else _0x50cec1['addEventListener'](_0x3c50a1(0x236), () => _0x14b21f['click']()), _0x29f4cc['addEventListener'](_0x3c50a1(0x66a), async _0x2c31e7 => { const _0x2b2b7a = _0x3c50a1, _0x282a42 = _0x2c31e7[_0x2b2b7a(0x94)][_0x2b2b7a(0x83b)][0x0]; if (!_0x282a42) return; try { _0x596024['src'] = _0x6d667e['createObjectURL'](_0x282a42); } catch (_0x8cb1c5) { _0x476a36(_0x2b2b7a(0xfa) + _0x8cb1c5[_0x2b2b7a(0x15a)]); } }); }); } function _0x5827f8(_0x3076ab = null) { const _0x37e0f4 = _0x311e9d; _0x6564ff(_0x37e0f4(0x92), _0x37e0f4(0x77f)); const _0x399db7 = document['getElementById']('set-active-user-button'); if (_0x3076ab) { const _0x588c7f = _0x40321a[_0x37e0f4(0x7c0)][_0x37e0f4(0x226)](_0x490f46 => _0x490f46['id'] === _0x3076ab); if (!_0x588c7f) return; document[_0x37e0f4(0x3a7)](_0x37e0f4(0x11d))['value'] = _0x588c7f['id'], document[_0x37e0f4(0x3a7)](_0x37e0f4(0x5bf))[_0x37e0f4(0x26b)] = '编辑用户', document[_0x37e0f4(0x3a7)](_0x37e0f4(0x52c))[_0x37e0f4(0x815)] = _0x588c7f[_0x37e0f4(0x2e6)], document[_0x37e0f4(0x3a7)](_0x37e0f4(0x211))[_0x37e0f4(0x8c7)] = _0x588c7f['avatar'], document[_0x37e0f4(0x3a7)](_0x37e0f4(0x6ac))[_0x37e0f4(0x815)] = _0x588c7f[_0x37e0f4(0x838)], _0x399db7['style'][_0x37e0f4(0x5a4)] = _0x588c7f['id'] === _0x40321a[_0x37e0f4(0x17e)] ? _0x37e0f4(0x87b) : _0x37e0f4(0x7dc); } else { if (_0x37e0f4(0x730) === 'ZOwhb') { _0x18fe2f(_0x37e0f4(0x68d)); return; } else document[_0x37e0f4(0x3a7)]('editing-user-id')[_0x37e0f4(0x815)] = '', document[_0x37e0f4(0x3a7)](_0x37e0f4(0x5bf))[_0x37e0f4(0x26b)] = '创建新用户', document[_0x37e0f4(0x3a7)](_0x37e0f4(0x52c))[_0x37e0f4(0x815)] = _0x37e0f4(0x793) + (_0x40321a['userProfiles']['length'] + 0x1), document['getElementById'](_0x37e0f4(0x211))[_0x37e0f4(0x8c7)] = _0x579f27, document[_0x37e0f4(0x3a7)](_0x37e0f4(0x6ac))[_0x37e0f4(0x815)] = '', _0x399db7['style'][_0x37e0f4(0x5a4)] = _0x37e0f4(0x87b); } } function _0x27125d() { const _0x29a841 = _0x311e9d, _0x53683c = document[_0x29a841(0x3a7)]('editing-user-id')[_0x29a841(0x815)], _0x5b4323 = { 'name': document[_0x29a841(0x3a7)]('user-name')[_0x29a841(0x815)][_0x29a841(0x3e3)](), 'persona': document[_0x29a841(0x3a7)](_0x29a841(0x6ac))[_0x29a841(0x815)][_0x29a841(0x3e3)](), 'avatar': document[_0x29a841(0x3a7)]('user-avatar-preview')['src'] }; if (!_0x5b4323['name']) { _0x1bbd68(_0x29a841(0x95)); return; } if (_0x53683c) { const _0x1378a3 = _0x40321a[_0x29a841(0x7c0)][_0x29a841(0x226)](_0x3384c1 => _0x3384c1['id'] === _0x53683c); if (_0x1378a3) Object['assign'](_0x1378a3, _0x5b4323); } else { if (_0x29a841(0x444) !== 'dczBG') { const _0x195c86 = { 'id': _0x29a841(0x199) + Date[_0x29a841(0x6bb)](), ..._0x5b4323 }; _0x40321a[_0x29a841(0x7c0)][_0x29a841(0x1fb)](_0x195c86), !_0x40321a[_0x29a841(0x17e)] && (_0x40321a[_0x29a841(0x17e)] = _0x195c86['id']); } else { const _0x232af2 = _0x3d59ff[_0x29a841(0x889)](_0x29a841(0x264) + _0x21fac4 + _0x29a841(0x4f7) + _0x5e68a4 + _0x29a841(0x758))?.['innerHTML']; _0x232af2 && (_0x109623[_0x29a841(0x49f)] = _0x232af2); } } _0x544cbe(), _0x1bbd68(_0x29a841(0x5dc)), _0x2b67fb(), _0x6564ff(_0x29a841(0x77f), _0x29a841(0x92)); } async function _0x2c2ce8() { const _0x301bf2 = _0x311e9d, _0x136696 = document[_0x301bf2(0x3a7)](_0x301bf2(0x11d))[_0x301bf2(0x815)]; if (!_0x136696) return; if (_0x40321a['userProfiles'][_0x301bf2(0x286)] <= 0x1) { _0x1bbd68(_0x301bf2(0x760)); return; } const _0x24b451 = await _0x4849f2(_0x301bf2(0xc9)); _0x24b451 && ('eDcbp' === _0x301bf2(0xbc) ? (_0x40292f(), _0x3534a2(_0x301bf2(0x328), _0x301bf2(0x519))) : (_0x40321a[_0x301bf2(0x7c0)] = _0x40321a[_0x301bf2(0x7c0)][_0x301bf2(0x16f)](_0xb063cb => _0xb063cb['id'] !== _0x136696), _0x40321a[_0x301bf2(0x17e)] === _0x136696 && (_0x40321a[_0x301bf2(0x17e)] = _0x40321a[_0x301bf2(0x7c0)][0x0]['id']), _0x40321a[_0x301bf2(0x478)][_0x301bf2(0x436)](_0x136aac => { const _0x41d190 = _0x301bf2; if (_0x41d190(0x173) !== _0x41d190(0x273)) _0x136aac[_0x41d190(0x87f)] === _0x136696 && (_0x136aac[_0x41d190(0x87f)] = _0x40321a[_0x41d190(0x17e)]); else { const _0x4f8022 = _0x500bfe[_0x41d190(0x6d)]['map'](_0x91ad8f => { const _0x176bbf = _0x41d190, _0x4fb711 = _0x53d671(_0x91ad8f['authorId'])?.[_0x176bbf(0x2e6)] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x4fb711 + _0x176bbf(0x1e2) + _0x91ad8f[_0x176bbf(0x812)] + _0x176bbf(0x4d9); })[_0x41d190(0x2c1)](''); _0x1762c9 = _0x41d190(0x5c5) + _0x4f8022 + _0x41d190(0x4d9); } }), _0x544cbe(), _0x1bbd68('用户已删除。'), _0x2b67fb(), _0x6564ff('userProfileList', _0x301bf2(0x92)))); } function _0x437e36() { const _0x454a4b = _0x311e9d; if ('ONgGD' !== _0x454a4b(0x6ad)) _0x3c6de4['classList']['remove'](_0x454a4b(0x7de)), _0x3e5ed1(() => _0x355037['style'][_0x454a4b(0x5a4)] = _0x454a4b(0x87b), 0x12c); else { const _0x36ddf9 = document['getElementById']('world-book-list-container'); _0x36ddf9[_0x454a4b(0x49f)] = ''; if (_0x40321a[_0x454a4b(0x5e7)][_0x454a4b(0x286)] === 0x0) { _0x36ddf9[_0x454a4b(0x49f)] = _0x454a4b(0x3a2); return; } _0x40321a[_0x454a4b(0x5e7)]['forEach'](_0x3a1c4e => { const _0x2c5eeb = _0x454a4b, _0x12c417 = document[_0x2c5eeb(0x3e8)](_0x2c5eeb(0x8cf)); _0x12c417[_0x2c5eeb(0x8d8)] = _0x2c5eeb(0x341), _0x12c417[_0x2c5eeb(0x58e)]['id'] = _0x3a1c4e['id'], _0x12c417[_0x2c5eeb(0x49f)] = _0x2c5eeb(0x578) + _0x3a1c4e['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x3a1c4e[_0x2c5eeb(0x812)][_0x2c5eeb(0x23c)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20', _0x12c417[_0x2c5eeb(0x215)](_0x2c5eeb(0x236), () => _0x365bc8(_0x3a1c4e['id'])), _0x36ddf9[_0x2c5eeb(0x7d)](_0x12c417); }); } } function _0x365bc8(_0x3415fc = null) { const _0x447141 = _0x311e9d; if (_0x447141(0x1ae) !== 'zreUv') { _0x6564ff(_0x447141(0x551), _0x447141(0x8cc)); if (_0x3415fc) { if (_0x447141(0x28a) === _0x447141(0x28a)) { const _0x454f12 = _0x40321a[_0x447141(0x5e7)][_0x447141(0x226)](_0x3ba590 => _0x3ba590['id'] === _0x3415fc); if (!_0x454f12) return; document[_0x447141(0x3a7)]('editing-world-book-id')['value'] = _0x454f12['id'], document[_0x447141(0x3a7)]('world-book-editor-title')[_0x447141(0x26b)] = _0x447141(0x6be), document['getElementById'](_0x447141(0x8dc))[_0x447141(0x815)] = _0x454f12[_0x447141(0x2e6)], document[_0x447141(0x3a7)](_0x447141(0x97))[_0x447141(0x815)] = _0x454f12[_0x447141(0x812)]; } else _0x3a028f = _0x201feb[_0x447141(0x3d5)]['map'](_0x54536b => _0x15f742['worldBooks']['find'](_0x238939 => _0x238939['id'] === _0x54536b))[_0x447141(0x16f)](_0x21a3ce)['map'](_0x151fea => _0x447141(0x52b) + _0x151fea[_0x447141(0x2e6)] + _0x447141(0x7ef) + _0x151fea['content'])['join'](''); } else _0x447141(0x86) === _0x447141(0x86) ? (document['getElementById'](_0x447141(0x362))[_0x447141(0x815)] = '', document['getElementById']('world-book-editor-title')[_0x447141(0x26b)] = _0x447141(0x76b), document[_0x447141(0x3a7)](_0x447141(0x8dc))[_0x447141(0x815)] = '', document[_0x447141(0x3a7)](_0x447141(0x97))[_0x447141(0x815)] = '') : _0x5ca9a1[_0x447141(0x2af)] = _0x447141(0x4f5); } else _0x2b417b[_0x447141(0x7d)](_0x27fdef), _0x14635b[_0x447141(0x7d)](_0x5a2c91); } function _0x14cf2b() { const _0x413913 = _0x311e9d; if (_0x413913(0xca) !== _0x413913(0x7c5)) { const _0x3320db = document[_0x413913(0x3a7)](_0x413913(0x362))['value'], _0x55bbba = document['getElementById'](_0x413913(0x8dc))['value'][_0x413913(0x3e3)](), _0x433e57 = document[_0x413913(0x3a7)](_0x413913(0x97))['value']['trim'](); if (!_0x55bbba || !_0x433e57) { if (_0x413913(0x355) === _0x413913(0x5eb)) { const _0x2f4126 = _0x127499['createElement']('div'); _0x2f4126[_0x413913(0x8d8)] = _0x413913(0x101); const _0x5c98f7 = _0x262b74[_0x413913(0x3e8)](_0x413913(0x8cf)); _0x5c98f7[_0x413913(0x8d8)] = _0x413913(0x379), _0x5c98f7[_0x413913(0x26b)] = _0x41e1c8[_0x413913(0x581)][_0x413913(0x353)]; const _0x40f07f = _0x18b8ec['createElement'](_0x413913(0x8cf)); _0x40f07f['className'] = 'quoted-content', _0x40f07f[_0x413913(0x26b)] = _0x3bbeae[_0x413913(0x581)][_0x413913(0x812)], _0x2f4126[_0x413913(0x7d)](_0x5c98f7), _0x2f4126['appendChild'](_0x40f07f), _0x4ba6ed[_0x413913(0x7d)](_0x2f4126); } else { _0x1bbd68('条目名称和内容都不能为空！'); return; } } if (_0x3320db) { const _0x4cfd4f = _0x40321a[_0x413913(0x5e7)][_0x413913(0x226)](_0xd946a4 => _0xd946a4['id'] === _0x3320db); if (_0x4cfd4f) { if (_0x413913(0x559) !== _0x413913(0x145)) _0x4cfd4f[_0x413913(0x2e6)] = _0x55bbba, _0x4cfd4f[_0x413913(0x812)] = _0x433e57; else { const _0x5df044 = _0x413913(0x47f); _0x3fa46e[_0x413913(0x7ee)]['insertAdjacentHTML'](_0x413913(0x461), _0x5df044); const _0x4e569d = _0x357af1[_0x413913(0x3a7)](_0x413913(0x4b6)), _0x3c1680 = _0x39782c[_0x413913(0x3a7)](_0x413913(0x575)), _0xdb517b = _0x4e6862['getElementById'](_0x413913(0x474)), _0x131ecf = _0x4d9765[_0x413913(0x3a7)](_0x413913(0x501)), _0x286982 = _0x4e569d['querySelector'](_0x413913(0x635)), _0x602982 = () => { const _0x5f1883 = _0x413913; _0x4e569d[_0x5f1883(0x47e)](), _0x767e22(); }; _0xdb517b[_0x413913(0x6fe)] = () => { const _0x3d5382 = _0x413913; _0x3a846d(_0x3c1680[_0x3d5382(0x815)]), _0x602982(); }, _0x131ecf[_0x413913(0x6fe)] = _0x602982, _0x286982[_0x413913(0x6fe)] = _0x602982; } } } else { const _0x2c4d84 = { 'id': _0x413913(0x186) + Date[_0x413913(0x6bb)](), 'name': _0x55bbba, 'content': _0x433e57 }; _0x40321a[_0x413913(0x5e7)]['push'](_0x2c4d84); } _0x544cbe(), _0x1bbd68(_0x413913(0x63e)), _0x437e36(), _0x6564ff(_0x413913(0x8cc), _0x413913(0x551)); } else _0xdace4b[_0x413913(0x1c1)][_0x413913(0x47e)](_0x413913(0x702)), _0x38536b['classList'][_0x413913(0x47e)](_0x413913(0x3e9)); } async function _0x1a25e1() { const _0x3963d4 = _0x311e9d; if (_0x3963d4(0x790) === _0x3963d4(0x790)) { const _0xb613e9 = document[_0x3963d4(0x3a7)](_0x3963d4(0x362))[_0x3963d4(0x815)]; if (!_0xb613e9) return; const _0x3f1f23 = await _0x4849f2(_0x3963d4(0x315)); _0x3f1f23 && (_0x40321a[_0x3963d4(0x5e7)] = _0x40321a[_0x3963d4(0x5e7)][_0x3963d4(0x16f)](_0x232700 => _0x232700['id'] !== _0xb613e9), _0x40321a[_0x3963d4(0x382)][_0x3963d4(0x436)](_0x10a54b => { const _0x3b62df = _0x3963d4; if (_0x10a54b['linkedWorldBookIds']) { if (_0x3b62df(0xae) === _0x3b62df(0xae)) _0x10a54b[_0x3b62df(0x3d5)] = _0x10a54b[_0x3b62df(0x3d5)][_0x3b62df(0x16f)](_0x1f5d07 => _0x1f5d07 !== _0xb613e9); else { if (_0x1598bf[_0x3b62df(0x759)]()['toString']()) return; const _0x32f8ca = _0x403fb8[_0x3b62df(0x94)]['closest']('.message-container'), _0x4b0314 = _0x235392[_0x3b62df(0x94)]['closest'](_0x3b62df(0x1b3)); if (!_0x32f8ca || _0x4b0314) return; const _0x240bfd = _0x458d37(_0x32f8ca[_0x3b62df(0x58e)][_0x3b62df(0x736)], 0xa); if (_0x38a745(_0x240bfd)) return; _0x16e5d7(_0x240bfd); } } }), _0x544cbe(), _0x1bbd68('条目已删除。'), _0x437e36(), _0x6564ff(_0x3963d4(0x8cc), 'worldBookEditor')); } else { const _0x3bbd08 = _0x3963d4(0x88e) + _0x5e9894; let _0x1ab008 = _0x22bcec['getElementById'](_0x3bbd08); if (_0x1ab008) return; const _0x299d33 = _0x3963d4(0x684) + _0x3bbd08 + _0x3963d4(0x2d5) + (_0xd8d6c8 === 'ai' ? _0x3963d4(0x5a3) : '') + _0x3963d4(0x64d); _0x102509[_0x3963d4(0x7ee)][_0x3963d4(0x6cb)](_0x3963d4(0x461), _0x299d33); const _0x334435 = _0x462529[_0x3963d4(0x3a7)](_0x3bbd08), _0x31ca83 = () => _0x334435[_0x3963d4(0x47e)](); _0x334435[_0x3963d4(0x889)](_0x3963d4(0x635))[_0x3963d4(0x6fe)] = _0x31ca83, _0x334435['querySelector'](_0x3963d4(0x67e))[_0x3963d4(0x6fe)] = _0x31ca83, _0x334435[_0x3963d4(0x889)]('#diary-action-delete')[_0x3963d4(0x6fe)] = () => { _0x22b51d(_0x5a8289), _0x31ca83(); }, _0x2767a5 === 'ai' && (_0x334435['querySelector']('#diary-action-reroll')[_0x3963d4(0x6fe)] = () => { _0x1a9cf0(_0x1fd0b9), _0x31ca83(); }); } } function _0x1e1925() { const _0x14731e = _0x311e9d; if (_0x14731e(0x64a) === 'LTckJ') { const _0x3f2d9c = document[_0x14731e(0x3a7)](_0x14731e(0x3c6)), _0x396b4e = _0x3f2d9c['querySelectorAll'](_0x14731e(0x5e8)), _0x168777 = document[_0x14731e(0x889)](_0x14731e(0x423)); if (_0x396b4e['length'] === 0x0) 'hfXGN' === 'mkfrG' ? _0x14d51b() : _0x168777[_0x14731e(0x26b)] = '--\x20点击选择\x20--'; else _0x396b4e[_0x14731e(0x286)] > 0x2 ? _0x168777[_0x14731e(0x26b)] = _0x14731e(0x797) + _0x396b4e[_0x14731e(0x286)] + '\x20项' : _0x168777['textContent'] = Array[_0x14731e(0x2d7)](_0x396b4e)[_0x14731e(0x7cc)](_0x2774dd => _0x2774dd[_0x14731e(0x7ea)]['textContent'][_0x14731e(0x3e3)]())[_0x14731e(0x2c1)]('、'); } else _0x3a7595[_0x14731e(0x159)](_0x14731e(0x39b), _0x58bf10); } function _0x58805c(_0x18d1de) { const _0x5beb7a = _0x311e9d, _0x24a068 = _0x40321a[_0x5beb7a(0x478)][_0x5beb7a(0x226)](_0x119dc3 => _0x119dc3['id'] === _0x18d1de); if (!_0x24a068 || _0x24a068['type'] !== _0x5beb7a(0x3bc)) return; document[_0x5beb7a(0x3a7)](_0x5beb7a(0x335))[_0x5beb7a(0x815)] = _0x24a068[_0x5beb7a(0x2e6)] || '', _0x5c0c37(_0x5beb7a(0x598)), document[_0x5beb7a(0x3a7)](_0x5beb7a(0x598))[_0x5beb7a(0x815)] = _0x24a068[_0x5beb7a(0x87f)] || _0x40321a[_0x5beb7a(0x17e)]; const _0x45ba64 = document[_0x5beb7a(0x3a7)]('group-world-book-checkboxes'); _0x45ba64['innerHTML'] = '', _0x40321a[_0x5beb7a(0x5e7)]['forEach'](_0xa04f8c => { const _0x5eda2a = _0x5beb7a, _0x5849c4 = _0x24a068[_0x5eda2a(0x3d5)]?.['includes'](_0xa04f8c['id']), _0x5eac5c = document[_0x5eda2a(0x3e8)]('label'); _0x5eac5c['innerHTML'] = _0x5eda2a(0x324) + _0xa04f8c['id'] + '\x22\x20' + (_0x5849c4 ? _0x5eda2a(0x238) : '') + '>\x20' + _0xa04f8c[_0x5eda2a(0x2e6)], _0x45ba64[_0x5eda2a(0x7d)](_0x5eac5c); }), _0x551221(); const _0x15211b = document[_0x5beb7a(0x3a7)]('group-avatar-preview'), _0xbd197e = document[_0x5beb7a(0x3a7)](_0x5beb7a(0x2dd)); _0x500f4d('group_avatar_' + _0x18d1de)[_0x5beb7a(0x3fa)](_0x2b8c27 => { const _0x3e41e4 = _0x5beb7a; _0x15211b[_0x3e41e4(0x8c7)] = _0x2b8c27 ? URL['createObjectURL'](_0x2b8c27) : _0x4716b3; }), _0x500f4d('group_bg_' + _0x18d1de)[_0x5beb7a(0x3fa)](_0xbedabd => { const _0x401cb1 = _0x5beb7a; _0x401cb1(0x589) === _0x401cb1(0x589) ? _0xbd197e[_0x401cb1(0x8c7)] = _0xbedabd ? URL[_0x401cb1(0x99)](_0xbedabd) : '' : _0x30bb87[_0x401cb1(0x581)] = { ..._0x2f2bcc[_0x401cb1(0x8bc)] }; }), _0x6564ff('groupSettings', 'chat'); } async function _0x3b9c0e() { const _0x3ce17e = _0x311e9d, _0x577741 = _0x4db4a7(); if (!_0x577741 || _0x577741['type'] !== 'group') return; const _0x500448 = document['getElementById'](_0x3ce17e(0x335))['value'][_0x3ce17e(0x3e3)](); if (!_0x500448) { if ('NEssZ' !== _0x3ce17e(0x124)) { _0x1bbd68(_0x3ce17e(0x673)); return; } else _0x14ee8d['push'](_0x233bc3['slice'](_0x533566, _0x537859 + _0x49753c)); } _0x577741[_0x3ce17e(0x2e6)] = _0x500448; const _0x5c3212 = document['querySelectorAll'](_0x3ce17e(0x2e0)); _0x577741[_0x3ce17e(0x3d5)] = Array[_0x3ce17e(0x2d7)](_0x5c3212)['map'](_0x2b3b2f => _0x2b3b2f[_0x3ce17e(0x815)]), _0x577741[_0x3ce17e(0x87f)] = document[_0x3ce17e(0x3a7)](_0x3ce17e(0x598))['value']; const _0x4bccb7 = document[_0x3ce17e(0x3a7)](_0x3ce17e(0x3ce))[_0x3ce17e(0x83b)][0x0], _0x1c40cf = document[_0x3ce17e(0x3a7)]('group-bg-input')[_0x3ce17e(0x83b)][0x0]; if (_0x4bccb7) await _0x5c7ad7(_0x3ce17e(0x66b) + _0x577741['id'], _0x4bccb7); if (_0x1c40cf) await _0x5c7ad7(_0x3ce17e(0x527) + _0x577741['id'], _0x1c40cf); _0x544cbe(), _0x53a615(), await _0x5af13e(), _0x1bbd68(_0x3ce17e(0x6d6)), _0x6564ff(_0x3ce17e(0x8da), _0x3ce17e(0x50f)); } function _0x551221() { const _0x22e145 = _0x311e9d, _0x52d17d = document[_0x22e145(0x3a7)](_0x22e145(0x4ef)), _0x506166 = _0x52d17d[_0x22e145(0x21e)]('input:checked'), _0x103a04 = document[_0x22e145(0x889)]('#group-settings-screen\x20.selected-options-text'); if (_0x506166[_0x22e145(0x286)] === 0x0) _0x103a04[_0x22e145(0x26b)] = '--\x20点击选择\x20--'; else { if (_0x506166[_0x22e145(0x286)] > 0x2) { if (_0x22e145(0x2a6) !== 'eNljL') { const _0x186252 = _0x1207fa[_0x22e145(0x94)]['dataset']['id']; _0xb0add3(_0x22e145(0x40c))[_0x22e145(0x3fa)](_0x2a16bf => { _0x2a16bf && _0x3cc5b5(_0x186252); }); } else _0x103a04[_0x22e145(0x26b)] = _0x22e145(0x797) + _0x506166[_0x22e145(0x286)] + '\x20项'; } else _0x103a04[_0x22e145(0x26b)] = Array['from'](_0x506166)['map'](_0x371884 => _0x371884[_0x22e145(0x7ea)][_0x22e145(0x26b)][_0x22e145(0x3e3)]())[_0x22e145(0x2c1)]('、'); } } async function _0x584b26() { const _0x36765e = _0x311e9d, _0x254e38 = _0x4db4a7(), _0x9fce3f = (_0x254e38?.[_0x36765e(0x239)] || [])[_0x36765e(0x7cc)](_0x3f1cb7)[_0x36765e(0x16f)](Boolean), _0x852066 = _0x9333e5(_0x254e38['id']); if (!_0x254e38 || _0x254e38[_0x36765e(0x78c)] !== 'group' || _0x9fce3f[_0x36765e(0x286)] < 0x2) return null; const _0x6a342c = _0x254e38[_0x36765e(0x3d5)] && _0x254e38[_0x36765e(0x3d5)][_0x36765e(0x286)] > 0x0 ? _0x36765e(0x320) + _0x254e38[_0x36765e(0x3d5)][_0x36765e(0x7cc)](_0x53443d => _0x40321a[_0x36765e(0x5e7)][_0x36765e(0x226)](_0x3746b7 => _0x3746b7['id'] === _0x53443d))[_0x36765e(0x16f)](Boolean)[_0x36765e(0x7cc)](_0x12c09e => _0x36765e(0x843) + _0x12c09e['name'] + '\x0a' + _0x12c09e['content'])[_0x36765e(0x2c1)]('') : '', _0x176f94 = _0x852066[_0x36765e(0x838)] ? _0x36765e(0x210) + _0x852066[_0x36765e(0x2e6)] + _0x36765e(0x8a3) + _0x852066[_0x36765e(0x838)] : ''; let _0x129b5e = ''; const _0x48642d = new Date(), _0x138c16 = _0x40321a[_0x36765e(0x393)]['at'](-0x1); _0x129b5e += _0x36765e(0x28d) + _0x48642d[_0x36765e(0x5b6)](_0x36765e(0x7a0), { 'dateStyle': _0x36765e(0x8c), 'timeStyle': 'short' }); if (_0x138c16) { const _0x3d0066 = new Date(_0x138c16[_0x36765e(0x375)]), _0x44574e = Math[_0x36765e(0xf2)]((_0x48642d - _0x3d0066) / (0x3e8 * 0x3c)); if (_0x44574e < 0x5) _0x129b5e += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0x44574e < 0x78) _0x129b5e += '\x0a-\x20**对话状态**:\x20群里在' + _0x44574e + _0x36765e(0x717); else { const _0x1fff54 = Math['floor'](_0x44574e / 0x3c); if (_0x1fff54 < 0x30) _0x129b5e += _0x36765e(0x597) + _0x1fff54 + _0x36765e(0x348); else _0x129b5e += '\x0a-\x20**对话状态**:\x20群里已经有' + Math[_0x36765e(0xf2)](_0x1fff54 / 0x18) + '天没动静了。你的角色们应该发起新的问候或话题。'; } } } else _0x129b5e += '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。'; const _0x46bccc = [..._0x40321a['conversationHistory']][_0x36765e(0x18c)]()[_0x36765e(0x226)](_0x526608 => _0x526608[_0x36765e(0x837)] === 'user')?.[_0x36765e(0x812)] || '', _0x3bcbe1 = _0x3a6450(_0x254e38, _0x46bccc), _0x29b6a1 = _0x40321a[_0x36765e(0x393)][_0x36765e(0xb5)](-0x78), _0x303551 = _0x42bed1[_0x36765e(0x7cc)](_0x18b64c => _0x18b64c['name']), _0x2d7c7b = _0x5bc7c6(), _0x2c5d28 = _0x9fce3f[_0x36765e(0x7cc)](_0x390776 => { const _0x542d0b = _0x36765e; if (_0x542d0b(0x1e8) !== _0x542d0b(0x88b)) { const { omniText: _0x128ebd } = _0x4fa46e(_0x390776['id'], _0x254e38['id']), _0x3ae671 = _0x38da7e(_0x390776['id']), _0x2793b8 = _0x390776[_0x542d0b(0x3d5)] && _0x390776['linkedWorldBookIds'][_0x542d0b(0x286)] > 0x0 ? _0x542d0b(0x426) + _0x390776['name'] + _0x542d0b(0x166) + _0x390776[_0x542d0b(0x3d5)][_0x542d0b(0x7cc)](_0x2f9eb0 => _0x40321a['worldBooks'][_0x542d0b(0x226)](_0x534510 => _0x534510['id'] === _0x2f9eb0))['filter'](Boolean)['map'](_0x1aacf0 => '\x0a##\x20条目:\x20' + _0x1aacf0['name'] + '\x0a' + _0x1aacf0[_0x542d0b(0x812)])[_0x542d0b(0x2c1)]('') : ''; return { 'id': _0x390776['id'], 'name': _0x390776[_0x542d0b(0x2e6)], 'persona': _0x390776[_0x542d0b(0x838)] || _0x542d0b(0x5bb), 'memory': _0x128ebd + _0x3ae671 + _0x2793b8 }; } else _0x23b86c[_0x542d0b(0x159)](_0x542d0b(0x198), _0x128f48), _0x2b1082[_0x542d0b(0x815)] = _0x542d0b(0x7e4) + _0x4c2fb8[_0x542d0b(0x15a)]; }), _0x5469da = 0x5, _0x2dd3d0 = 0xc, _0x2c5366 = _0x36765e(0x1ec)[_0x36765e(0x3e3)](), _0x2e0e2e = { 'instruction': (_0x36765e(0x19d) + (_0x852066[_0x36765e(0x2e6)] || '用户') + _0x36765e(0x23f) + (_0x852066[_0x36765e(0x2e6)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x5469da + _0x36765e(0x104) + _0x2dd3d0 + '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕' + (_0x852066[_0x36765e(0x2e6)] || '用户') + _0x36765e(0x30f) + _0x129b5e + '\x20\x0a' + _0x176f94 + '\x0a' + _0x6a342c + '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a' + _0x2d7c7b + '\x0a')[_0x36765e(0x3e3)](), 'personas': _0x2c5d28, 'mentioned': _0x3bcbe1 ? { 'id': _0x3bcbe1['id'], 'name': _0x3bcbe1[_0x36765e(0x2e6)] } : null, 'stickerList': _0x303551 }, _0x2fd565 = { 'type': _0x36765e(0x645), 'properties': { 'events': { 'type': _0x36765e(0x4c2), 'items': { 'type': 'object', 'required': [_0x36765e(0x2b9), _0x36765e(0x566)], 'properties': { 'senderId': { 'type': 'string' }, 'kind': { 'type': _0x36765e(0xac), 'enum': [_0x36765e(0x44f), _0x36765e(0x272), _0x36765e(0x242)] }, 'content': { 'type': _0x36765e(0xac) }, 'sticker': { 'type': _0x36765e(0xac) }, 'songName': { 'type': _0x36765e(0xac) }, 'artist': { 'type': _0x36765e(0xac) } } } } }, 'required': [_0x36765e(0x471)] }, _0x48e7ed = []; _0x48e7ed['push']({ 'role': _0x36765e(0x70d), 'content': _0x2c5366 }); for (const _0x2c83f3 of _0x29b6a1) { if (_0x36765e(0x7a3) === 'ZdOTz') { const _0x388b26 = _0x2c83f3['role'] === 'ai' || _0x2c83f3[_0x36765e(0x837)] === _0x36765e(0x18d) ? 'assistant' : _0x36765e(0x447); let _0x10fde4 = { 'role': _0x388b26, 'content': _0x2c83f3['content'] }, _0x359f34 = !!_0x2c83f3[_0x36765e(0x812)], _0x82f452 = null; if (_0x2c83f3['image']) _0x82f452 = _0x2c83f3[_0x36765e(0x888)]; else { if (_0x2c83f3[_0x36765e(0x3a0)]) { if (_0x36765e(0x550) !== _0x36765e(0x550)) _0x1c330f[_0x36765e(0x29d)](_0x1583c3, { 'keyPath': 'id' }); else try { if (_0x36765e(0x162) !== _0x36765e(0x162)) _0x25fd1b[_0x36765e(0x8c7)] = _0x32c9a6 ? _0x5d2169[_0x36765e(0x99)](_0x4a23cc) : _0x12cdbf; else { const _0xef654b = await _0x500f4d(_0x2c83f3['imageId']); if (_0xef654b) { if (_0x36765e(0x3ae) !== _0x36765e(0x6f5)) _0x82f452 = await _0x5cb5e3(_0xef654b); else { _0x2097b3(); return; } } } } catch (_0x1b4ac9) { if ('Xehsa' !== 'Xehsa') { const _0x1ffac4 = _0x5b1666[_0x2795e5]; _0x624213(_0x1ffac4); } else console[_0x36765e(0x159)](_0x36765e(0x8d4), _0x1b4ac9); } } } if (_0x82f452) { if (_0x36765e(0x302) !== _0x36765e(0x4c6)) _0x10fde4['image'] = _0x82f452, _0x359f34 = !![]; else { const { omniText: _0x230c18 } = _0x2a17b3(_0xf2f43a['id'], _0x5967d6['id']), _0x48682f = _0x2a1157(_0x19287f['id']), _0x333f31 = _0x4b7e06['linkedWorldBookIds'] && _0x17a6db['linkedWorldBookIds'][_0x36765e(0x286)] > 0x0 ? _0x36765e(0x426) + _0x2e9564[_0x36765e(0x2e6)] + _0x36765e(0x166) + _0x6b3a70[_0x36765e(0x3d5)][_0x36765e(0x7cc)](_0x4fa135 => _0x570b49[_0x36765e(0x5e7)][_0x36765e(0x226)](_0x38da99 => _0x38da99['id'] === _0x4fa135))[_0x36765e(0x16f)](_0x3c1c3d)[_0x36765e(0x7cc)](_0x3b8fb4 => _0x36765e(0x482) + _0x3b8fb4[_0x36765e(0x2e6)] + '\x0a' + _0x3b8fb4[_0x36765e(0x812)])[_0x36765e(0x2c1)]('') : ''; return { 'id': _0x40ecbc['id'], 'name': _0x4d2be0[_0x36765e(0x2e6)], 'persona': _0x359a17[_0x36765e(0x838)] || _0x36765e(0x5bb), 'memory': _0x230c18 + _0x48682f + _0x333f31 }; } } _0x359f34 && _0x48e7ed[_0x36765e(0x1fb)](_0x10fde4); } else { const _0x1112aa = _0x174ba8[_0x36765e(0x94)]['files'][0x0]; if (!_0x1112aa) return; const _0x19c43e = _0xc5fd78[_0x36765e(0x99)](_0x1112aa); _0x56bcff[_0x36765e(0x8c7)] = _0x19c43e, _0x345136[_0x36765e(0x5bc)] = () => { const _0x532879 = _0x36765e; _0x11e9cd[_0x532879(0x165)](_0x19c43e); }; } } _0x48e7ed['push']({ 'role': _0x36765e(0x447), 'content': _0x36765e(0x6f9) + JSON[_0x36765e(0x504)](_0x2fd565) + '\x0a\x0aINPUT:\x0a' + JSON[_0x36765e(0x504)](_0x2e0e2e) }); try { const _0x3e7a58 = await _0x56cc62(_0x48e7ed, { 'json': !![] }); if (!_0x3e7a58) return null; let _0x4bbfc6 = _0x3e7a58['trim'](); const _0x4800c2 = _0x4bbfc6[_0x36765e(0x33f)](/```json([\s\S]*?)```/i); if (_0x4800c2) _0x4bbfc6 = _0x4800c2[0x1]['trim'](); _0x4bbfc6 = _0x307743(_0x4bbfc6); let _0x1cad14 = null; try { _0x1cad14 = JSON[_0x36765e(0x5b1)](_0x4bbfc6); } catch (_0x4338a6) { console[_0x36765e(0x159)](_0x36765e(0xdd), _0x4338a6), console[_0x36765e(0x159)](_0x36765e(0x531), _0x4bbfc6); } if (!_0x1cad14 || !Array[_0x36765e(0x1d4)](_0x1cad14['events'])) return null; return _0x1cad14 = _0x414788(_0x1cad14, _0x9fce3f, _0x303551), _0x1cad14['events'] = _0x1cad14[_0x36765e(0x471)][_0x36765e(0xb5)](0x0, _0x2dd3d0), _0x1cad14['events']['length'] ? _0x1cad14 : null; } catch (_0x2aaa6f) { return _0x2aaa6f[_0x36765e(0x2e6)] !== _0x36765e(0x75c) && console[_0x36765e(0x159)](_0x36765e(0x75a), _0x2aaa6f), null; } } function _0x1d07fb() { const _0xfd347d = _0x311e9d, _0x217fe5 = document[_0xfd347d(0x3a7)]('friend-circle-list-container'); _0x217fe5[_0xfd347d(0x49f)] = ''; if (_0x40321a[_0xfd347d(0x7ab)][_0xfd347d(0x286)] === 0x0) { if (_0xfd347d(0x43e) === 'rtjLe') _0x163900[_0xfd347d(0x27d)][_0xfd347d(0x3b9)] = 'absolute', _0x361913[_0xfd347d(0x27d)]['top'] = _0xfd347d(0x440), _0x367e1f[_0xfd347d(0x27d)][_0xfd347d(0x40d)] = _0xfd347d(0x287), _0x1e8a6f[_0xfd347d(0x27d)][_0xfd347d(0x290)] = _0xfd347d(0x6d3), _0x1ca034[_0xfd347d(0x27d)]['display'] = _0xfd347d(0x7dc); else { _0x217fe5[_0xfd347d(0x49f)] = _0xfd347d(0x3aa); return; } } _0x40321a[_0xfd347d(0x7ab)][_0xfd347d(0x436)](_0x4d62d5 => { const _0x3760cd = _0xfd347d; if ('Djooh' === _0x3760cd(0x7bf)) { const _0x32d2d1 = _0x40321a['userProfiles']['find'](_0x56d121 => _0x56d121['id'] === _0x4d62d5[_0x3760cd(0x87f)]) || { 'name': _0x3760cd(0x7f0) }, _0x444f9b = document[_0x3760cd(0x3e8)](_0x3760cd(0x8cf)); _0x444f9b[_0x3760cd(0x8d8)] = _0x3760cd(0x341), _0x444f9b[_0x3760cd(0x58e)]['id'] = _0x4d62d5['id'], _0x444f9b['innerHTML'] = _0x3760cd(0x578) + _0x4d62d5[_0x3760cd(0x2e6)] + _0x3760cd(0x370) + _0x32d2d1[_0x3760cd(0x2e6)] + '\x20|\x20' + _0x4d62d5[_0x3760cd(0x726)][_0x3760cd(0x286)] + _0x3760cd(0x683), _0x444f9b['addEventListener'](_0x3760cd(0x236), () => _0x51bf9e(_0x4d62d5['id'])), _0x217fe5[_0x3760cd(0x7d)](_0x444f9b); } else _0x628681[_0x3760cd(0x7e5)] = _0x1019c3[_0x3760cd(0x7e5)]; }); } function _0xedd5b6(_0x43ed05 = null) { const _0x5c06af = _0x311e9d; if (_0x5c06af(0xd9) !== _0x5c06af(0x4c4)) { const _0x3f10fd = document['getElementById']('friend-circle-edit-name'), _0x185b64 = document[_0x5c06af(0x3a7)](_0x5c06af(0x657)), _0x4e44a3 = document[_0x5c06af(0x3a7)]('friend-circle-member-selection'), _0x25d5ef = document[_0x5c06af(0x3a7)](_0x5c06af(0x10a)), _0x19a042 = document[_0x5c06af(0x3a7)](_0x5c06af(0x1d9)), _0x4a8d46 = document['getElementById']('delete-friend-circle-button'); _0x5c0c37('friend-circle-edit-bind-user'), _0x4e44a3[_0x5c06af(0x49f)] = '', _0x40321a['characters'][_0x5c06af(0x436)](_0x8434fa => { const _0x433b8f = _0x5c06af, _0x1b7d39 = document['createElement'](_0x433b8f(0x8cf)); _0x1b7d39[_0x433b8f(0x8d8)] = 'member-selection-item', _0x1b7d39[_0x433b8f(0x49f)] = _0x433b8f(0x845) + _0x8434fa['id'] + '\x22\x20data-id=\x22' + _0x8434fa['id'] + _0x433b8f(0x37d) + (_0x8434fa['avatar'] || _0x4716b3) + _0x433b8f(0x7e8) + _0x8434fa['id'] + _0x433b8f(0x4bf) + _0x8434fa['name'] + _0x433b8f(0x3d6), _0x4e44a3[_0x433b8f(0x7d)](_0x1b7d39); }); if (_0x43ed05) { if ('WshJn' === _0x5c06af(0x1e0)) _0x515b14[_0x5c06af(0x73)](_0x5c06af(0x6bf)), _0x4687b7['removeItem']('cardWidgetState'), _0x16cd24(_0x5c06af(0x2ea)), _0x2cffca(() => _0x453c6d[_0x5c06af(0x15f)](), 0x3e8); else { const _0x91e626 = _0x40321a[_0x5c06af(0x7ab)]['find'](_0x1e0064 => _0x1e0064['id'] === _0x43ed05); if (!_0x91e626) return; _0x25d5ef[_0x5c06af(0x26b)] = _0x5c06af(0x634), _0x19a042['value'] = _0x91e626['id'], _0x3f10fd[_0x5c06af(0x815)] = _0x91e626[_0x5c06af(0x2e6)], _0x185b64['value'] = _0x91e626[_0x5c06af(0x87f)], _0x4a8d46[_0x5c06af(0x27d)][_0x5c06af(0x5a4)] = _0x5c06af(0x7dc), _0x91e626[_0x5c06af(0x726)][_0x5c06af(0x436)](_0x3e19ae => { const _0x373bf1 = _0x5c06af, _0x24ff5a = _0x4e44a3[_0x373bf1(0x889)]('#member-select-' + _0x3e19ae); if (_0x24ff5a) _0x24ff5a['checked'] = !![]; }); } } else _0x25d5ef['textContent'] = _0x5c06af(0x6ee), _0x19a042[_0x5c06af(0x815)] = '', _0x3f10fd['value'] = _0x5c06af(0x292) + (_0x40321a['friendCircles'][_0x5c06af(0x286)] + 0x1), _0x185b64['value'] = _0x40321a[_0x5c06af(0x17e)], _0x4a8d46[_0x5c06af(0x27d)][_0x5c06af(0x5a4)] = _0x5c06af(0x87b); _0x6564ff('friendCircleEdit', _0x5c06af(0x115)); } else _0x5292d7[_0x5c06af(0x165)](_0x4d1014); } function _0x564afa() { const _0x18691c = _0x311e9d; if (_0x18691c(0x473) === _0x18691c(0x54d)) _0x3662f0[_0x18691c(0x27d)]['backgroundImage'] = '', _0x279f2c['style'][_0x18691c(0x86e)] = '', _0x4654f4[_0x18691c(0x21e)](_0x18691c(0x24f))[_0x18691c(0x436)](_0x3dc01b => { const _0x3ca1ba = _0x18691c; _0x3dc01b['style'][_0x3ca1ba(0x13d)] = ''; }); else { const _0x16edce = document[_0x18691c(0x3a7)]('editing-friend-circle-id')[_0x18691c(0x815)], _0x43195d = document['getElementById']('friend-circle-edit-name')[_0x18691c(0x815)][_0x18691c(0x3e3)](), _0x3af585 = document[_0x18691c(0x3a7)](_0x18691c(0x657))['value'], _0x150820 = Array[_0x18691c(0x2d7)](document[_0x18691c(0x21e)](_0x18691c(0x7f6)))[_0x18691c(0x7cc)](_0x52e7e1 => _0x52e7e1['dataset']['id']); if (!_0x43195d) { _0x1bbd68(_0x18691c(0x770)); return; } if (_0x150820['length'] === 0x0) { _0x1bbd68(_0x18691c(0x358)); return; } if (_0x16edce) { const _0x494e5e = _0x40321a[_0x18691c(0x7ab)][_0x18691c(0x226)](_0x5004d5 => _0x5004d5['id'] === _0x16edce); _0x494e5e && (_0x494e5e[_0x18691c(0x2e6)] = _0x43195d, _0x494e5e[_0x18691c(0x87f)] = _0x3af585, _0x494e5e[_0x18691c(0x726)] = _0x150820); } else { const _0x41fe5b = { 'id': _0x18691c(0x411) + Date[_0x18691c(0x6bb)](), 'name': _0x43195d, 'boundUserProfileId': _0x3af585, 'memberCharacterIds': _0x150820, 'posts': [] }; _0x40321a[_0x18691c(0x7ab)]['push'](_0x41fe5b); } _0x544cbe(), _0x1bbd68('好友圈已保存！'), _0x1d07fb(), _0x6564ff('friendCircleList', _0x18691c(0x52a)); } } async function _0x40f735() { const _0x206889 = _0x311e9d, _0x3fc8e9 = document[_0x206889(0x3a7)](_0x206889(0x1d9))[_0x206889(0x815)]; if (!_0x3fc8e9) return; const _0x185663 = await _0x4849f2(_0x206889(0x67d)); _0x185663 && (_0x206889(0x7fc) !== _0x206889(0x503) ? (_0x40321a[_0x206889(0x7ab)] = _0x40321a[_0x206889(0x7ab)][_0x206889(0x16f)](_0x529855 => _0x529855['id'] !== _0x3fc8e9), _0x40321a[_0x206889(0x57c)] === _0x3fc8e9 && (_0x40321a[_0x206889(0x57c)] = null), _0x544cbe(), _0x1bbd68(_0x206889(0x665)), _0x1d07fb(), _0x6564ff(_0x206889(0x115), 'friendCircleEdit')) : _0x4c64ca[_0x206889(0x132)] && _0xa53b6c[_0x206889(0x132)]['isActive'] && (_0x4f0d04[_0x206889(0x27d)][_0x206889(0x5a4)] = _0x206889(0x564), _0x540030(() => _0x3a977f[_0x206889(0x1c1)][_0x206889(0x65b)](_0x206889(0x7de)), 0xa))); } function _0x51bf9e(_0x369f85) { const _0x1825da = _0x311e9d; if (_0x1825da(0xc3) === _0x1825da(0xc3)) { _0x67bf98(); const _0x5cb911 = _0x40321a['friendCircles'][_0x1825da(0x226)](_0xaa4615 => _0xaa4615['id'] === _0x369f85); if (!_0x5cb911) return; _0x40321a[_0x1825da(0x57c)] = _0x369f85, _0x544cbe(), document['getElementById'](_0x1825da(0x5c7))[_0x1825da(0x26b)] = _0x5cb911[_0x1825da(0x2e6)], _0x28f111(), _0x6564ff(_0x1825da(0x242), _0x1825da(0x115)), _0xf819d6(); } else _0x36ad3b[_0x1825da(0x159)](_0x1825da(0x457), _0x38e461); } function _0x407ad8() { const _0x1f4aaa = _0x311e9d; if (_0x1f4aaa(0x1ed) !== _0x1f4aaa(0x1ed)) { const _0x110f69 = _0x243b69[_0x1f4aaa(0x815)]['trim'](), _0x46b2d3 = _0x24d721[_0x1f4aaa(0x815)][_0x1f4aaa(0x3e3)](); if (!_0x110f69 || !_0x46b2d3) { _0x3b5ff3(_0x1f4aaa(0x18a)); return; } _0xe8e95b({ 'songName': _0x110f69, 'artist': _0x46b2d3 }); } else { if (!_0x40321a['friendCircles'] || _0x40321a['friendCircles'][_0x1f4aaa(0x286)] === 0x0) { if (_0x1f4aaa(0x203) === _0x1f4aaa(0x203)) { console[_0x1f4aaa(0x159)](_0x1f4aaa(0x46b)); return; } else { const _0x410bf5 = _0x3733d5(_0x492bd3[_0x1f4aaa(0x815)]); if (_0x401071(_0x410bf5) || _0x410bf5 <= 0x0) { _0x4284a2(_0x1f4aaa(0x4ae)); return; } const _0x2b1ece = _0x243ab4(); let _0x3c8d04 = null; _0x2b1ece['type'] === _0x1f4aaa(0x3bc) ? _0x3c8d04 = _0x55f972[_0x1f4aaa(0x815)] : _0x3c8d04 = _0x2b1ece[_0x1f4aaa(0x239)][0x0]; const _0x4090e6 = _0x1a3de2(_0x2b1ece['id']), _0x466536 = { 'role': 'user', 'type': _0x1f4aaa(0x7d7), 'content': _0x1f4aaa(0x216) + (_0x29536f(_0x3c8d04)?.['name'] || '未知') + _0x1f4aaa(0x442) + _0x410bf5 + ']', 'amount': _0x410bf5, 'recipientId': _0x3c8d04, 'senderId': _0x4090e6['id'], 'timestamp': _0x5f4688[_0x1f4aaa(0x6bb)]() }; _0x4b48e6[_0x1f4aaa(0x393)][_0x1f4aaa(0x1fb)](_0x466536), _0x4f3d53(), _0x15e891(), _0x5bf310[_0x1f4aaa(0x1c1)][_0x1f4aaa(0x47e)]('show'); } } const _0x43c81f = _0x40321a[_0x1f4aaa(0x7ab)][0x0]; if (_0x43c81f[_0x1f4aaa(0x726)][_0x1f4aaa(0x286)] < 0x2) { console[_0x1f4aaa(0x159)](_0x1f4aaa(0x51c) + _0x43c81f[_0x1f4aaa(0x2e6)] + _0x1f4aaa(0x405)); return; } const _0x15d862 = { 'id': _0x1f4aaa(0x541) + Date[_0x1f4aaa(0x6bb)](), 'authorType': _0x1f4aaa(0x37a), 'authorId': _0x43c81f[_0x1f4aaa(0x726)][0x0], 'content': _0x1f4aaa(0x849), 'timestamp': Date[_0x1f4aaa(0x6bb)](), 'likes': [_0x43c81f['memberCharacterIds'][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x1f4aaa(0x6bb)](), 'authorId': _0x43c81f['memberCharacterIds'][0x1], 'content': _0x1f4aaa(0x3cb) }] }; _0x43c81f['posts'][_0x1f4aaa(0x1fb)](_0x15d862), _0x544cbe(), console['log'](_0x1f4aaa(0x87a) + _0x43c81f['name'] + _0x1f4aaa(0x176)), _0x1bbd68('测试动态已添加！'); } } window[_0x311e9d(0x78f)] = _0x407ad8; function _0x1b3e95(_0x35f4bf) { const _0x1c9104 = _0x311e9d; return _0x40321a[_0x1c9104(0x7c0)][_0x1c9104(0x226)](_0x11147e => _0x11147e['id'] === _0x35f4bf); } function _0x3396e7(_0x2735a0, _0x437d15 = _0x311e9d(0x80b)) { const _0x52e790 = _0x311e9d, _0x4adc8a = document[_0x52e790(0x3a7)](_0x52e790(0x7b)); let _0x3f661c = document[_0x52e790(0x3a7)]('feed-loader'); if (_0x2735a0) { if (_0x52e790(0x3dc) !== 'JgVII') { if (!_0x3f661c) { if ('RCIUH' !== _0x52e790(0x58b)) { _0x34ed10[_0x52e790(0x478)] = _0x273c4a[_0x52e790(0x478)][_0x52e790(0x16f)](_0x30d8bb => _0x30d8bb['id'] !== _0x55a69e); try { _0xf133bc[_0x52e790(0x73)](_0x52e790(0x4a7) + _0x41ebbf); } catch (_0x91e69) { _0x8c7871[_0x52e790(0x159)](_0x52e790(0x151) + _0x4d882d, _0x91e69); } _0x1970cf[_0x52e790(0x1cc)] === _0x1089bb && (_0x18f989[_0x52e790(0x1cc)] = _0x43055f['chats'][0x0]?.['id'] || null, _0x19fec5(_0x3dff7f[_0x52e790(0x1cc)])), _0x1ec7d7(), _0x58c470(); } else _0x3f661c = document[_0x52e790(0x3e8)](_0x52e790(0x8cf)), _0x3f661c['id'] = _0x52e790(0x3a8), _0x4adc8a[_0x52e790(0x7d)](_0x3f661c); } _0x3f661c['innerHTML'] = _0x52e790(0x44d) + _0x437d15 + _0x52e790(0x477), _0x3f661c[_0x52e790(0x27d)][_0x52e790(0x5a4)] = _0x52e790(0x564); } else { const _0x69e6ac = _0x17a9a0[_0x52e790(0x889)](_0x52e790(0x4a6)); if (!_0x69e6ac) return; _0x69e6ac['id'] === _0x52e790(0x2a1) ? _0x1c9842() : _0x357c46(); } } else _0x3f661c && (_0x3f661c[_0x52e790(0x27d)][_0x52e790(0x5a4)] = _0x52e790(0x87b)); } async function _0x5197db() { const _0xf3c6d5 = _0x311e9d; if ('lkQpj' === _0xf3c6d5(0x27b)) { const _0x10ce0f = _0x40321a[_0xf3c6d5(0x7ab)][_0xf3c6d5(0x226)](_0x2d518f => _0x2d518f['id'] === _0x40321a[_0xf3c6d5(0x57c)]); if (!_0x10ce0f || _0x40321a['isGenerating']) return; _0x3396e7(!![], _0xf3c6d5(0x282)), _0x40321a[_0xf3c6d5(0x160)] = !![]; try { let _0x13b0bb = Date['now'](); _0x10ce0f[_0xf3c6d5(0x188)] && _0x10ce0f[_0xf3c6d5(0x188)][_0xf3c6d5(0x286)] > 0x0 && (_0x13b0bb = Math[_0xf3c6d5(0x7d4)](..._0x10ce0f['posts'][_0xf3c6d5(0x7cc)](_0xf77870 => _0xf77870[_0xf3c6d5(0x375)]))); const _0x33f82b = await _0xa64473(_0x10ce0f); if (!_0x33f82b || _0x33f82b[_0xf3c6d5(0x286)] === 0x0) { _0x1bbd68(_0xf3c6d5(0x3ad)); return; } const _0x224dc0 = _0x33f82b[_0xf3c6d5(0x7cc)](async (_0x1f4ae3, _0x5399b9) => { const _0x3edb25 = _0xf3c6d5; if (_0x3edb25(0x56f) !== 'vuqwA') { _0x3396e7(!![], _0x3edb25(0x200) + (_0x5399b9 + 0x1) + '\x20/\x20' + _0x33f82b[_0x3edb25(0x286)] + _0x3edb25(0x668)); const _0x5b46a3 = _0x13b0bb + (_0x5399b9 + 0x1) * 0x3c * 0x3e8, _0x496927 = { 'id': _0x3edb25(0x258) + _0x1f4ae3[_0x3edb25(0x7d9)] + '_' + _0x5b46a3, 'authorType': _0x3edb25(0x37a), 'authorId': _0x1f4ae3['authorId'], 'content': _0x1f4ae3[_0x3edb25(0x71e)], 'timestamp': _0x5b46a3, 'likes': _0x1f4ae3['likes'] || [], 'comments': (_0x1f4ae3['comments'] || [])[_0x3edb25(0x7cc)]((_0x14e3b1, _0x3f4ad4) => ({ 'commentId': 'c_' + _0x5b46a3 + '_' + _0x3f4ad4, 'authorId': _0x14e3b1[_0x3edb25(0x7d9)], 'content': _0x14e3b1[_0x3edb25(0x812)] })) }; if (_0x1f4ae3[_0x3edb25(0x8e3)] === 'music' && _0x1f4ae3['songName'] && _0x1f4ae3[_0x3edb25(0x45d)]) try { const _0x15bb20 = await _0x117420(_0x1f4ae3[_0x3edb25(0x4de)], _0x1f4ae3[_0x3edb25(0x45d)]); _0x496927[_0x3edb25(0x78c)] = _0x3edb25(0x242), _0x496927['songName'] = _0x1f4ae3['songName'], _0x496927[_0x3edb25(0x45d)] = _0x1f4ae3[_0x3edb25(0x45d)], _0x496927['coverUrl'] = _0x15bb20[_0x3edb25(0x59e)], _0x496927[_0x3edb25(0x89c)] = _0x15bb20[_0x3edb25(0x5cb)]; } catch (_0x2ceae2) { if ('qMlEa' === 'qMlEa') console['error']('动态中的音乐搜索失败:', _0x2ceae2), _0x496927[_0x3edb25(0x78c)] = _0x3edb25(0x44f); else { if (_0x48861e[_0x3edb25(0x11c)] === _0x3edb25(0x7ed)) _0x624667(null); _0x411904['key'] === _0x3edb25(0x1ad) && (_0xb39d08[_0x3edb25(0x425)](), _0x51fd4c()); } } else _0x496927['type'] = _0x3edb25(0x44f); return _0x496927; } else { if (!_0x5b2d0f) return; const _0x3ebdfb = _0x5df24a[_0x3edb25(0x574)], _0x286426 = _0x297376(_0x3ebdfb); if (!_0x286426) return; const _0x362a91 = _0x487043(_0x51c69f[_0x3edb25(0x3a7)](_0x3edb25(0x558))[_0x3edb25(0x815)]), _0x21e62b = _0x5257a1(_0x8db57[_0x3edb25(0x3a7)](_0x3edb25(0x526))[_0x3edb25(0x815)]), _0x3d8d6b = _0x4a2efd(_0x47afb8[_0x3edb25(0x3a7)](_0x3edb25(0x43a))[_0x3edb25(0x815)]) / 0x64; _0x286426['spriteTransform'] = { 'x': _0x362a91, 'y': _0x21e62b, 'scale': _0x3d8d6b }; const _0x19edfc = _0x5c3c0f[_0x3edb25(0x3a7)](_0x3edb25(0x6b)), _0x356535 = 0x50 * _0x3d8d6b; _0x19edfc['style'][_0x3edb25(0x2df)] = _0x356535 + '%', _0x19edfc[_0x3edb25(0x27d)]['width'] = _0x356535 + '%', _0x19edfc[_0x3edb25(0x27d)][_0x3edb25(0x40d)] = _0x362a91 + '%', _0x19edfc[_0x3edb25(0x27d)][_0x3edb25(0x71a)] = _0x21e62b + '%', _0x19edfc[_0x3edb25(0x27d)]['transform'] = _0x3edb25(0x652); } }), _0x56c422 = await Promise[_0xf3c6d5(0x5dd)](_0x224dc0); _0x10ce0f['posts'][_0xf3c6d5(0x1fb)](..._0x56c422), _0x544cbe(); } catch (_0x240bd3) { if (_0xf3c6d5(0x483) !== 'KhEWF') console[_0xf3c6d5(0x159)](_0xf3c6d5(0x136), _0x240bd3), _0x1bbd68(_0xf3c6d5(0x1f2) + _0x240bd3[_0xf3c6d5(0x15a)]); else { const _0x408881 = _0xa14778, _0x4cf898 = _0x408881['scrollHeight'], _0x31c07a = _0x408881[_0xf3c6d5(0x19c)]; _0x485638[_0xf3c6d5(0x301)] += 0x64, _0x52911e(), _0x2b2ddc(() => { const _0x40905c = _0xf3c6d5, _0x12e189 = _0x408881[_0x40905c(0x602)]; _0x408881[_0x40905c(0x19c)] = _0x31c07a + (_0x12e189 - _0x4cf898); }); } } finally { _0x28f111(), _0x3396e7(![]), _0x40321a[_0xf3c6d5(0x160)] = ![]; } } else { const _0x205599 = _0x43071f[_0xf3c6d5(0x99)](_0x5384f4), _0x866257 = 'NoirCustomFont', _0x279b87 = _0xf3c6d5(0x5a0) + _0x866257 + '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27' + _0x205599 + '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x1c5192['innerHTML'] = _0x279b87, _0x1630e5[_0xf3c6d5(0x7f9)][_0xf3c6d5(0x27d)][_0xf3c6d5(0x31d)](_0xf3c6d5(0x404), '\x27' + _0x866257 + '\x27'), _0x1c5b68['textContent'] = '字体已应用！(Font\x20Applied!)'; } } async function _0xa64473(_0x42fdf4) { const _0x166e6f = _0x311e9d, _0x32ff71 = _0x42fdf4['memberCharacterIds']['map'](_0x5e8cf3 => _0x3f1cb7(_0x5e8cf3))['filter'](Boolean); if (_0x32ff71['length'] === 0x0) return null; const _0x2893fc = _0x5bc7c6(), _0x4b582c = _0x1b3e95(_0x42fdf4[_0x166e6f(0x87f)]) || _0x40321a[_0x166e6f(0x7c0)][0x0], _0x3bb537 = _0x4b582c ? _0x166e6f(0x495) + _0x4b582c['name'] + '\x0a-\x20人设:\x20' + (_0x4b582c[_0x166e6f(0x838)] || '无') + '\x0a' : '', _0xa14286 = _0x32ff71[_0x166e6f(0x7cc)](_0xb9601c => { const _0x1d1c6a = _0x166e6f; if (_0x1d1c6a(0x870) !== _0x1d1c6a(0xc7)) { const { omniText: _0x47c247 } = _0x4fa46e(_0xb9601c['id'], null), _0x4c2953 = _0x38da7e(_0xb9601c['id']), _0x3843d7 = _0xb9601c[_0x1d1c6a(0x3d5)] && _0xb9601c[_0x1d1c6a(0x3d5)][_0x1d1c6a(0x286)] > 0x0 ? _0x1d1c6a(0x426) + _0xb9601c[_0x1d1c6a(0x2e6)] + '的个人专属世界观设定\x0a' + _0xb9601c[_0x1d1c6a(0x3d5)][_0x1d1c6a(0x7cc)](_0x243c77 => _0x40321a[_0x1d1c6a(0x5e7)]['find'](_0x3eeb20 => _0x3eeb20['id'] === _0x243c77))[_0x1d1c6a(0x16f)](Boolean)[_0x1d1c6a(0x7cc)](_0x7207df => '\x0a##\x20条目:\x20' + _0x7207df['name'] + '\x0a' + _0x7207df[_0x1d1c6a(0x812)])[_0x1d1c6a(0x2c1)]('') : ''; return _0x1d1c6a(0x42b) + _0xb9601c[_0x1d1c6a(0x2e6)] + _0x1d1c6a(0x4d2) + _0xb9601c['id'] + _0x1d1c6a(0x8ac) + _0xb9601c['persona'] + _0x1d1c6a(0x842) + _0x47c247 + '\x0a' + _0x4c2953 + '\x0a' + _0x3843d7; } else _0x57271f(_0x30e909); })['join']('\x0a\x0a'), _0x14f084 = Math['floor'](Math[_0x166e6f(0x775)]() * 0x3) + 0x2, _0x2e2dcc = '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【' + _0x14f084 + '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a' + _0xa14286 + '\x0a' + _0x3bb537 + _0x166e6f(0x73e) + _0x2893fc + _0x166e6f(0x60c) + _0x14f084 + _0x166e6f(0xd2) + _0x14f084 + '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0xa7a5a = [{ 'role': 'system', 'content': _0x2e2dcc }, { 'role': 'user', 'content': '请根据以上所有信息，开始分析并返回JSON。' }]; _0xa7a5a[_0x166e6f(0x1fb)]({ 'role': _0x166e6f(0x447), 'content': _0x166e6f(0x576) + _0x14f084 + _0x166e6f(0x119) }); try { const _0x1811fd = await _0x56cc62(_0xa7a5a, { 'json': !![] }), _0x387718 = _0x1811fd[_0x166e6f(0x33f)](/(\[[\s\S]*\])/); if (!_0x387718) throw new Error(_0x166e6f(0x8ad)); const _0x50c5d8 = _0x387718[0x1], _0x388e99 = JSON[_0x166e6f(0x5b1)](_0x50c5d8); if (!Array[_0x166e6f(0x1d4)](_0x388e99)) throw new Error('AI返回的不是一个数组。'); return _0x388e99; } catch (_0x2c3db9) { if (_0x166e6f(0x789) === _0x166e6f(0x31e)) _0x2e91a0(), _0x334c9f['conversationHistory'] = [], _0x3b873b(); else return console[_0x166e6f(0x159)](_0x166e6f(0xa0), _0x2c3db9), console[_0x166e6f(0x159)](_0x166e6f(0x8a7), _0x2c3db9[_0x166e6f(0x8a9)] || _0x166e6f(0x63f)), null; } } async function _0x34fc63() { const _0x300ee8 = _0x311e9d; if ('Spuqh' !== _0x300ee8(0x29b)) _0x5eee1a(_0x8367e4['id']), _0x2dbbd7(_0x300ee8(0x8c2)), _0x6e868d(_0x300ee8(0x8da)), _0x1a324b(![]); else { const _0x189bbd = _0x40321a[_0x300ee8(0x7ab)][_0x300ee8(0x226)](_0x281f40 => _0x281f40['id'] === _0x40321a['activeFriendCircleId']); if (!_0x189bbd) return; const _0x2148c5 = await _0x4849f2(_0x300ee8(0x126) + _0x189bbd[_0x300ee8(0x2e6)] + _0x300ee8(0xcb)); _0x2148c5 && (_0x189bbd[_0x300ee8(0x188)] = [], _0x544cbe(), _0x28f111(), _0x1bbd68(_0x300ee8(0x234))); } } function _0x28f111() { const _0x384be9 = _0x311e9d; if (_0x384be9(0x2f1) !== 'zYecH') { _0x2da88d('群聊名称不能为空！'); return; } else { const _0x484fe7 = document[_0x384be9(0x3a7)](_0x384be9(0x778)), _0x133c8f = _0x40321a['friendCircles'][_0x384be9(0x226)](_0x469b85 => _0x469b85['id'] === _0x40321a[_0x384be9(0x57c)]); if (!_0x133c8f) { _0x484fe7[_0x384be9(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } if (!_0x133c8f[_0x384be9(0x188)] || _0x133c8f['posts'][_0x384be9(0x286)] === 0x0) { _0x484fe7['innerHTML'] = _0x384be9(0x8a4); return; } _0x484fe7[_0x384be9(0x49f)] = ''; const _0x1b1b5c = [..._0x133c8f[_0x384be9(0x188)]][_0x384be9(0x783)]((_0x30341f, _0x155866) => _0x155866[_0x384be9(0x375)] - _0x30341f['timestamp']); _0x1b1b5c['forEach'](_0xb8bda2 => { const _0x58c407 = _0x384be9, _0x48296e = document[_0x58c407(0x3e8)](_0x58c407(0x8cf)); _0x48296e[_0x58c407(0x8d8)] = _0x58c407(0x12f); let _0xa19dcc = '未知', _0x3b61e3 = _0x4716b3; if (_0xb8bda2['authorType'] === _0x58c407(0x447)) { const _0x55c984 = _0x1b3e95(_0xb8bda2[_0x58c407(0x7d9)]); _0x55c984 && (_0xa19dcc = _0x55c984[_0x58c407(0x2e6)], _0x3b61e3 = _0x55c984[_0x58c407(0xe7)]); } else { const _0x4ddfa7 = _0x3f1cb7(_0xb8bda2[_0x58c407(0x7d9)]); if (_0x4ddfa7) { if (_0x58c407(0x6bd) !== 'wNMRJ') _0xa19dcc = _0x4ddfa7[_0x58c407(0x2e6)], _0x3b61e3 = _0x4ddfa7[_0x58c407(0xe7)]; else { const _0x5b4595 = _0x2bde92[_0x58c407(0x5b1)](_0x5f53f5[_0x58c407(0x8b4)](_0x58c407(0x83d)) || '{}'), _0x226db2 = { ..._0x5b4595, ..._0x533e40 }; _0x599fb8['setItem'](_0x58c407(0x83d), _0x4332f7[_0x58c407(0x504)](_0x226db2)); } } } const _0x266c07 = _0x58c407(0x3c7) + _0x3b61e3 + _0x58c407(0x5e1) + _0xa19dcc + _0x58c407(0x43c), _0x246715 = _0x58c407(0xc0) + _0xb8bda2[_0x58c407(0x812)] + _0x58c407(0x579); let _0x44237f = ''; if (_0xb8bda2[_0x58c407(0x888)] || _0xb8bda2[_0x58c407(0x3a0)]) { const _0x37f0a3 = _0x58c407(0x6a1) + _0xb8bda2['id']; _0x44237f = _0x58c407(0x821) + _0x37f0a3 + '\x22\x20class=\x22post-image\x22></div>', setTimeout(() => { const _0x24335c = _0x58c407, _0xcb38c1 = document['getElementById'](_0x37f0a3); if (!_0xcb38c1) return; if (_0xb8bda2[_0x24335c(0x888)]) _0xcb38c1['src'] = _0xb8bda2['image']; else _0xb8bda2['imageId'] && _0x500f4d(_0xb8bda2[_0x24335c(0x3a0)])[_0x24335c(0x3fa)](_0x359bd9 => { const _0x3ee451 = _0x24335c; if (_0x359bd9) { if (_0x3ee451(0x74d) === _0x3ee451(0x189)) _0x1d8d7e[_0x3ee451(0x159)](_0x3ee451(0x565), _0x1bdd5e), _0x5c4308(_0x3ee451(0x409) + _0x2dcd3b[_0x3ee451(0x15a)]); else { const _0x4e786c = URL[_0x3ee451(0x99)](_0x359bd9); _0xcb38c1[_0x3ee451(0x8c7)] = _0x4e786c, _0xcb38c1[_0x3ee451(0x5bc)] = () => URL[_0x3ee451(0x165)](_0x4e786c); } } }); }, 0x0); } let _0x40a9dc = ''; _0xb8bda2[_0x58c407(0x78c)] === 'music' && _0xb8bda2[_0x58c407(0x4de)] && (_0x40a9dc = _0x58c407(0x67b) + _0xb8bda2['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0xb8bda2[_0x58c407(0x102)] || _0x4716b3) + _0x58c407(0x347) + _0xb8bda2[_0x58c407(0x4de)] + _0x58c407(0x157) + _0xb8bda2[_0x58c407(0x45d)] + _0x58c407(0x85f) + (_0xb8bda2[_0x58c407(0x89c)] ? '▶' : '⚠') + '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20'); const _0x39fcad = _0x58c407(0x60e) + new Date(_0xb8bda2[_0x58c407(0x375)])[_0x58c407(0x5b6)]('zh-CN') + _0x58c407(0x4d9); let _0x2fbae6 = ''; if (_0xb8bda2[_0x58c407(0xe4)] && _0xb8bda2['likes'][_0x58c407(0x286)] > 0x0 || _0xb8bda2['comments'] && _0xb8bda2[_0x58c407(0x6d)][_0x58c407(0x286)] > 0x0) { if ('CtoHJ' === 'CtoHJ') { let _0x36792a = ''; if (_0xb8bda2[_0x58c407(0xe4)] && _0xb8bda2[_0x58c407(0xe4)][_0x58c407(0x286)] > 0x0) { const _0x2bab22 = _0xb8bda2['likes'][_0x58c407(0x7cc)](_0x2780b8 => _0x3f1cb7(_0x2780b8)?.['name'] || '未知')[_0x58c407(0x2c1)]('、'), _0x73f56e = _0x58c407(0x1a7); _0x36792a = _0x58c407(0x514) + _0x73f56e + '\x20' + _0x2bab22 + '</div>'; } let _0x4fe57e = ''; if (_0xb8bda2[_0x58c407(0x6d)] && _0xb8bda2['comments'][_0x58c407(0x286)] > 0x0) { const _0x25d66b = _0xb8bda2[_0x58c407(0x6d)][_0x58c407(0x7cc)](_0x5dd064 => { const _0x467522 = _0x58c407, _0x461d45 = _0x3f1cb7(_0x5dd064['authorId'])?.[_0x467522(0x2e6)] || '未知'; return _0x467522(0x72e) + _0x461d45 + _0x467522(0x1e2) + _0x5dd064[_0x467522(0x812)] + _0x467522(0x4d9); })[_0x58c407(0x2c1)](''); _0x4fe57e = '<div\x20class=\x22post-comments-container\x22>' + _0x25d66b + '</div>'; } _0x2fbae6 = _0x58c407(0x4a4) + _0x36792a + _0x58c407(0x7b8) + _0x4fe57e + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } else _0x33948d['activeUserProfileId'] = _0x155c8d[_0x58c407(0x7c0)][0x0]['id']; } const _0x2eaced = _0x58c407(0x352) + _0x246715 + _0x44237f + _0x40a9dc + _0x58c407(0x4d9); _0x48296e['innerHTML'] = _0x266c07 + _0x2eaced + _0x39fcad + _0x2fbae6; if (_0xb8bda2['type'] === _0x58c407(0x242) && _0xb8bda2['playableUrl']) { const _0x1f7bf0 = _0x48296e[_0x58c407(0x889)](_0x58c407(0x8b1)); _0x1f7bf0 && _0x1f7bf0['addEventListener'](_0x58c407(0x236), function () { const _0x4162fa = _0x58c407; if ('RccPD' === _0x4162fa(0x38c)) _0x406e34[_0x4162fa(0x215)]('click', () => { const _0x37de80 = _0x4162fa; if (_0x54c17f[_0x37de80(0x286)] === 0x0) return; _0x2e20b1 = (_0x466e55 + 0x1) % _0x344831['length'], _0x198d46(_0x3ea9c3[_0x175388], _0x555272); }); else { const _0x2289e2 = { 'id': _0xb8bda2['id'], 'url': _0xb8bda2[_0x4162fa(0x89c)] }; _0x492919(this, _0x2289e2); } }); } _0x484fe7[_0x58c407(0x7d)](_0x48296e); }); } } document[_0x311e9d(0x3a7)](_0x311e9d(0x74c))[_0x311e9d(0x215)](_0x311e9d(0x236), _0x34fc63), document[_0x311e9d(0x3a7)]('refresh-feed-button')['addEventListener'](_0x311e9d(0x236), _0x5197db), document[_0x311e9d(0x3a7)](_0x311e9d(0x583))[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x519), 'friendCircleList')), document[_0x311e9d(0x3a7)]('add-friend-circle-button')[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0xedd5b6()), document['getElementById'](_0x311e9d(0x5f5))[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x115), 'friendCircleEdit')), document[_0x311e9d(0x3a7)]('save-friend-circle-button')[_0x311e9d(0x215)](_0x311e9d(0x236), _0x564afa), document[_0x311e9d(0x3a7)](_0x311e9d(0x8d5))[_0x311e9d(0x215)](_0x311e9d(0x236), _0x40f735), document[_0x311e9d(0x3a7)]('back-to-circle-list-from-feed')[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x5d609d = _0x311e9d; _0x5d609d(0x2d6) === _0x5d609d(0x397) ? (_0x33ae45 = _0x1e7b3f['touches'][0x0][_0x5d609d(0x732)], _0x3fe151 = _0x5a401e['touches'][0x0]['clientY'], _0x4ac6af = !![], _0x39c60e = '') : (_0x1d07fb(), _0x6564ff(_0x5d609d(0x115), 'music')); }), document['getElementById'](_0x311e9d(0xfe))[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x24cec0 = _0x311e9d; _0x24cec0(0x866) !== 'ZgoVH' ? (_0x4be076[_0x24cec0(0x159)](_0x24cec0(0x59f) + _0xdcbcf1['id'], _0x7f64b9), _0x2cfc30(_0x24cec0(0x3e0))) : _0x40321a[_0x24cec0(0x57c)] && _0xedd5b6(_0x40321a['activeFriendCircleId']); }), document['getElementById'](_0x311e9d(0x537))[_0x311e9d(0x215)](_0x311e9d(0x236), async () => { const _0x36effe = _0x311e9d, _0x1cf60d = _0x40321a[_0x36effe(0x7ab)]['find'](_0x3f1c06 => _0x3f1c06['id'] === _0x40321a['activeFriendCircleId']); if (!_0x1cf60d || _0x40321a['isGenerating']) return; const _0x54c3a9 = _0x1cf60d[_0x36effe(0x87f)], _0x46e0be = _0x40321a[_0x36effe(0x7c0)][_0x36effe(0x226)](_0x41fd9d => _0x41fd9d['id'] === _0x54c3a9); if (!_0x46e0be) { _0x1bbd68('错误：找不到此好友圈绑定的用户！'); return; } const _0x2c663b = document[_0x36effe(0x3a7)](_0x36effe(0x51e))[_0x36effe(0x815)][_0x36effe(0x3e3)](), _0x38bd75 = _0x40321a[_0x36effe(0x137)][_0x36effe(0x888)], _0x2124cd = _0x40321a[_0x36effe(0x137)][_0x36effe(0x242)], _0x227932 = _0x40321a[_0x36effe(0x137)][_0x36effe(0x3a0)]; if (!_0x2c663b && !_0x38bd75 && !_0x2124cd) { _0x1bbd68(_0x36effe(0xb0)); return; } const _0xa8dce4 = { 'id': _0x36effe(0x4f1) + Date[_0x36effe(0x6bb)](), 'authorType': _0x36effe(0x447), 'authorId': _0x46e0be['id'], 'content': _0x2c663b, 'timestamp': Date[_0x36effe(0x6bb)](), 'likes': [], 'comments': [] }; if (_0x227932) _0xa8dce4[_0x36effe(0x3a0)] = _0x227932; else _0x38bd75 && (_0xa8dce4[_0x36effe(0x888)] = _0x38bd75); _0x2124cd ? (_0xa8dce4[_0x36effe(0x78c)] = _0x36effe(0x242), Object[_0x36effe(0x616)](_0xa8dce4, _0x2124cd)) : _0x36effe(0x31b) === _0x36effe(0x3de) ? (_0x5a4d41[_0x36effe(0x888)] = _0x49393c, _0x3158f8 = !![]) : _0xa8dce4[_0x36effe(0x78c)] = _0x36effe(0x44f), _0x1cf60d[_0x36effe(0x188)][_0x36effe(0x1fb)](_0xa8dce4), _0x544cbe(), _0x28f111(), document[_0x36effe(0x3a7)](_0x36effe(0x51e))[_0x36effe(0x815)] = '', _0x40321a[_0x36effe(0x137)][_0x36effe(0x888)] = null, _0x40321a[_0x36effe(0x137)][_0x36effe(0x242)] = null, _0x40321a[_0x36effe(0x137)][_0x36effe(0x3a0)] = null, _0x304aa1(), _0x2f2d41(_0xa8dce4); }), document['getElementById'](_0x311e9d(0x63a))['addEventListener']('click', () => { const _0x23d06f = _0x311e9d; document['getElementById'](_0x23d06f(0x4dc))['click'](); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x4dc))[_0x311e9d(0x215)](_0x311e9d(0x66a), async _0x2bf92d => { const _0x186b32 = _0x311e9d, _0x4431c3 = _0x2bf92d['target']['files'][0x0]; if (!_0x4431c3) return; try { if (_0x186b32(0x5f8) !== _0x186b32(0x5f8)) { const _0x317145 = _0x2e628a[_0x186b32(0x27f)][_0x186b32(0x16f)](_0x2faafe => _0x2faafe[_0x186b32(0x563)] === _0x186b32(0x447))[_0x186b32(0x206)](); _0x317145 && (_0x10f3ae = _0x317145['content']); } else { const _0x128d70 = await _0x774f7f(_0x4431c3, 0x320, 0.8, !![]), _0x5ab4eb = 'post_image_' + Date[_0x186b32(0x6bb)](); await _0x5c7ad7(_0x5ab4eb, _0x128d70), _0x40321a[_0x186b32(0x137)][_0x186b32(0x3a0)] = _0x5ab4eb, _0x40321a[_0x186b32(0x137)][_0x186b32(0x888)] = null, _0x40321a[_0x186b32(0x137)][_0x186b32(0x242)] = null, _0x304aa1(); } } catch (_0x5b6267) { 'BElVf' !== 'BElVf' ? _0x4dfe70['getElementById'](_0x186b32(0x5bd) + _0x4f5ebc + _0x186b32(0x202))[_0x186b32(0x8c7)] = _0x456a73[_0x186b32(0x99)](_0x4325d1) : _0x1bbd68('图片处理失败:\x20' + _0x5b6267['message']); } _0x2bf92d[_0x186b32(0x94)]['value'] = ''; }), document[_0x311e9d(0x3a7)](_0x311e9d(0x2ee))['addEventListener'](_0x311e9d(0x236), async () => { const _0x56eda3 = _0x311e9d; if (_0x56eda3(0x57d) !== _0x56eda3(0x57d)) _0x479986[_0x56eda3(0x26b)] = _0x4a6c3c[_0x56eda3(0x2e6)] || _0x56eda3(0x571) + _0x3a0dab[_0x56eda3(0x239)][_0x56eda3(0x286)] + ')'; else { const _0x2e4e91 = await _0x123f8a(); if (!_0x2e4e91) return; _0x1bbd68(_0x56eda3(0x786)); try { if ('VuOvS' !== _0x56eda3(0x615)) { const _0x54285c = await _0x117420(_0x2e4e91['songName'], _0x2e4e91[_0x56eda3(0x45d)]); _0x40321a[_0x56eda3(0x137)][_0x56eda3(0x242)] = { 'songName': _0x2e4e91['songName'], 'artist': _0x2e4e91[_0x56eda3(0x45d)], 'coverUrl': _0x54285c[_0x56eda3(0x59e)], 'playableUrl': _0x54285c['url'] }, _0x40321a[_0x56eda3(0x137)][_0x56eda3(0x888)] = null, _0x304aa1(); } else _0x2482ec(), _0x2dbfe7(_0x56eda3(0x77f), _0x56eda3(0x519)); } catch (_0x1cc437) { if ('YbZDw' === _0x56eda3(0x259)) { if (_0x4211a1[_0x56eda3(0x286)] === 0x0) return; _0xa44904 = (_0x2ad0ba + 0x1) % _0x519a4f['length'], _0x13cd78(_0x258fe1[_0x5a303a], _0x4d875e); } else _0x1bbd68('音乐搜索失败:\x20' + _0x1cc437[_0x56eda3(0x15a)]); } } }); function _0x185058() { const _0x6a8d10 = _0x311e9d, _0x37bad9 = new Date(), _0x250d8d = document[_0x6a8d10(0x3a7)](_0x6a8d10(0x56d)), _0x2b9b3c = document[_0x6a8d10(0x3a7)]('home-date'); if (_0x250d8d && _0x2b9b3c) { const _0x63cebe = String(_0x37bad9['getHours']())['padStart'](0x2, '0'), _0x173fbd = String(_0x37bad9['getMinutes']())[_0x6a8d10(0x26e)](0x2, '0'); _0x250d8d[_0x6a8d10(0x26b)] = _0x63cebe + ':' + _0x173fbd; const _0x23e09f = _0x37bad9[_0x6a8d10(0x1a1)]() + 0x1, _0x413103 = _0x37bad9['getDate'](), _0x8045a7 = [_0x6a8d10(0x5cf), _0x6a8d10(0x3d4), _0x6a8d10(0x14e), '星期三', '星期四', _0x6a8d10(0x7d8), _0x6a8d10(0x6a3)][_0x37bad9[_0x6a8d10(0x385)]()]; _0x2b9b3c[_0x6a8d10(0x26b)] = _0x23e09f + '月' + _0x413103 + '日\x20' + _0x8045a7; } } function _0xc1a9db(_0x38db2b) { const _0x31fc16 = _0x311e9d; if (!_0x38db2b) return ''; const _0x51bddb = new Date(_0x38db2b), _0x100716 = String(_0x51bddb['getHours']())[_0x31fc16(0x26e)](0x2, '0'), _0x10c755 = String(_0x51bddb[_0x31fc16(0x46a)]())[_0x31fc16(0x26e)](0x2, '0'); return _0x100716 + ':' + _0x10c755; } function _0x5bc7c6() { const _0x6822d0 = _0x311e9d, _0x353040 = _0x40321a[_0x6822d0(0x7ab)][_0x6822d0(0x226)](_0xb055ef => _0xb055ef['id'] === _0x40321a[_0x6822d0(0x57c)]), _0xcc34b1 = _0x353040 ? _0x353040[_0x6822d0(0x188)] : []; if (!_0xcc34b1 || _0xcc34b1[_0x6822d0(0x286)] === 0x0) return ''; const _0x2310d2 = _0xcc34b1[_0x6822d0(0xb5)](0x0, 0x5), _0x3fd203 = _0x2310d2['map'](_0x320f21 => { const _0x5abdfe = _0x6822d0; if ('wtUFZ' !== _0x5abdfe(0x40f)) { const _0x4f9679 = _0x3f1cb7(_0x320f21['authorId']) || { 'name': '未知' }; let _0x33da67 = _0x5abdfe(0x161) + _0x4f9679[_0x5abdfe(0x2e6)] + _0x5abdfe(0x25b) + (_0x320f21[_0x5abdfe(0x83e)] || _0x320f21[_0x5abdfe(0x812)]) + '”'; if (_0x320f21[_0x5abdfe(0x78c)] === 'music') { if (_0x5abdfe(0x1a0) !== _0x5abdfe(0x62f)) _0x33da67 += _0x5abdfe(0x251) + _0x320f21[_0x5abdfe(0x4de)] + _0x5abdfe(0x604) + _0x320f21[_0x5abdfe(0x45d)] + ')'; else { if (_0x1f7627['role'] === _0x5abdfe(0x447)) return _0x3604b9['userProfile']?.[_0x5abdfe(0x2e6)] || _0x5abdfe(0x766); if (_0xc14b74[_0x5abdfe(0x78c)] === _0x5abdfe(0x3bc)) { const _0x1ddc0d = _0x5822c7[_0x5abdfe(0x2b9)] ? _0x76258d(_0x540453['senderId']) : null; return _0x1ddc0d?.[_0x5abdfe(0x2e6)] || _0x5abdfe(0x85b); } else { const _0x2af06b = _0xb7ace(_0x45165e[_0x5abdfe(0x239)][0x0]); return _0x2af06b?.['name'] || 'AI'; } } } return _0x33da67; } else _0x4d2ce1 = _0x161bd4[_0x5abdfe(0x7d4)](..._0x36cfea[_0x5abdfe(0x188)][_0x5abdfe(0x7cc)](_0x3d68fc => _0x3d68fc['timestamp'])); }); return '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a' + _0x3fd203[_0x6822d0(0x2c1)]('\x0a'); } function _0x38da7e(_0x470cd1) { const _0x539fdd = _0x311e9d, _0x25ec30 = _0x40321a[_0x539fdd(0x7c0)][_0x539fdd(0x226)](_0x195871 => _0x195871['id'] === _0x40321a['activeUserProfileId']) || { 'name': '你' }, _0x3587af = _0x40321a['diaries'][_0x539fdd(0x226)](_0x26cc8a => _0x26cc8a[_0x539fdd(0x769)] === _0x470cd1); if (!_0x3587af || !_0x3587af['entries'] || _0x3587af['entries'][_0x539fdd(0x286)] === 0x0) return ''; const _0x5b5f13 = _0x3587af[_0x539fdd(0x27f)][_0x539fdd(0xb5)](-0x8), _0x19751e = _0x5b5f13[_0x539fdd(0x7cc)](_0x17dc79 => { const _0x59d540 = _0x539fdd; if (_0x59d540(0x191) !== 'BgmzS') { const _0x1a9dfa = _0x17dc79['author'] === 'user' ? _0x25ec30[_0x59d540(0x2e6)] : _0x3f1cb7(_0x17dc79[_0x59d540(0x563)])[_0x59d540(0x2e6)]; return '-\x20[' + new Date(_0x17dc79['timestamp'])[_0x59d540(0x836)]() + ']\x20' + _0x1a9dfa + _0x59d540(0x98) + _0x17dc79['content']; } else _0xce8c74(_0x243940), _0x4e56f5(); })[_0x539fdd(0x2c1)]('\x0a'); return '\x0a#\x20交换日记摘要\x20(你和\x20' + _0x25ec30[_0x539fdd(0x2e6)] + _0x539fdd(0xa2) + _0x19751e; } function _0x190622() { const _0x1efff8 = _0x311e9d, _0xe7df12 = document[_0x1efff8(0x3a7)](_0x1efff8(0x5cc)), _0x372ba7 = _0x40321a[_0x1efff8(0x42f)][_0x1efff8(0x113)]; if (_0x372ba7) { if (_0x1efff8(0x150) === 'ijtCQ') _0xe7df12['style']['backgroundImage'] = _0x1efff8(0x462) + _0x372ba7 + ')', _0xe7df12[_0x1efff8(0x27d)][_0x1efff8(0x4b0)] = _0x1efff8(0x59e), _0xe7df12['style'][_0x1efff8(0x424)] = _0x1efff8(0x50d), _0xe7df12[_0x1efff8(0x27d)][_0x1efff8(0x86e)] = _0x1efff8(0x146), _0xe7df12[_0x1efff8(0x21e)](_0x1efff8(0x24f))[_0x1efff8(0x436)](_0x514074 => { const _0x558f50 = _0x1efff8; _0x514074['style'][_0x558f50(0x13d)] = _0x558f50(0xb1); }); else return [_0x4a9558]; } else _0xe7df12[_0x1efff8(0x27d)]['backgroundImage'] = '', _0xe7df12[_0x1efff8(0x27d)]['color'] = '', _0xe7df12[_0x1efff8(0x21e)]('.widget-info\x20>\x20div')[_0x1efff8(0x436)](_0x4a2e6e => { const _0x1a64ab = _0x1efff8; _0x1a64ab(0x85) !== _0x1a64ab(0x85) ? _0x4286e4 = _0x12e58c['image'] : _0x4a2e6e[_0x1a64ab(0x27d)][_0x1a64ab(0x13d)] = ''; }); } const _0x48a653 = document['getElementById']('app-music'), _0x5f48da = document[_0x311e9d(0x3a7)](_0x311e9d(0x58a)); _0x48a653[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x6996b0 = _0x311e9d; _0x1d07fb(), _0x6564ff(_0x6996b0(0x115), _0x6996b0(0x519)); }), _0x5f48da[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x37136a = _0x311e9d; _0x3a2f59(), _0x6564ff(_0x37136a(0x318), 'home'); }), document['getElementById']('back-to-home-from-meeting-list')[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x11add6 = _0x311e9d; _0x6564ff(_0x11add6(0x519), _0x11add6(0x318)); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x60a))['addEventListener']('click', () => { const _0x453798 = _0x311e9d; if (_0x47adb1) clearInterval(_0x47adb1); _0x47adb1 = null, _0x40321a[_0x453798(0x38b)] = [], _0x40321a[_0x453798(0x574)] = null, document[_0x453798(0x3a7)](_0x453798(0xf8))[_0x453798(0x27d)][_0x453798(0x5a4)] = 'none', _0x40321a[_0x453798(0x1cc)] = null, _0x544cbe(), _0x6564ff('meetingList', _0x453798(0x17f)); }); const _0x2b8078 = document[_0x311e9d(0x3a7)](_0x311e9d(0x2a9)), _0x28343e = document['getElementById'](_0x311e9d(0x42d)); _0x28343e[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x336891 = _0x311e9d, _0x3fd09a = _0x2b8078[_0x336891(0x815)][_0x336891(0x3e3)](); _0x3fd09a && (_0x3f1262(_0x3fd09a), _0x2b8078[_0x336891(0x815)] = '', setTimeout(_0x5c5350, 0x64)); }); function _0x492919(_0x52f539, _0xfe2bf8) { const _0x40b0dc = _0x311e9d; if (_0x40b0dc(0x4d8) !== _0x40b0dc(0x834)) { const _0x367c1 = document[_0x40b0dc(0x3a7)](_0x40b0dc(0x2aa)), _0x228e83 = document[_0x40b0dc(0x21e)]('.music-post-play-icon,\x20.music-share-play-icon'); _0x228e83[_0x40b0dc(0x436)](_0x3479d1 => { const _0x44eadf = _0x40b0dc; _0x3479d1 !== _0x52f539[_0x44eadf(0x889)]('.music-post-play-icon,\x20.music-share-play-icon') && (_0x3479d1['textContent'] = '▶'); }), _0x367c1[_0x40b0dc(0x8c7)] === _0xfe2bf8[_0x40b0dc(0x5cb)] && !_0x367c1[_0x40b0dc(0x700)] ? (_0x367c1[_0x40b0dc(0x7f8)](), _0x52f539[_0x40b0dc(0x889)](_0x40b0dc(0x5e4))[_0x40b0dc(0x26b)] = '▶') : (_0x367c1[_0x40b0dc(0x8c7)] = _0xfe2bf8['url'], _0x367c1['play'](), _0x52f539[_0x40b0dc(0x889)](_0x40b0dc(0x5e4))[_0x40b0dc(0x26b)] = '❚❚'); } else { let _0x56ff3d = ''; if (_0x546526[_0x40b0dc(0xe4)] && _0x3a3865['likes'][_0x40b0dc(0x286)] > 0x0) { const _0x324e68 = _0x51b7eb[_0x40b0dc(0xe4)]['map'](_0xd12903 => _0x28adfd(_0xd12903)?.['name'] || '未知')[_0x40b0dc(0x2c1)]('、'), _0x5721fe = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x56ff3d = _0x40b0dc(0x514) + _0x5721fe + '\x20' + _0x324e68 + _0x40b0dc(0x4d9); } let _0x3ffb17 = ''; if (_0x2fa472[_0x40b0dc(0x6d)] && _0x11d09e[_0x40b0dc(0x6d)][_0x40b0dc(0x286)] > 0x0) { const _0x2f3931 = _0x51e1a4['comments'][_0x40b0dc(0x7cc)](_0x26cdcf => { const _0xcb966e = _0x40b0dc, _0x38a9ac = _0x3e2be3(_0x26cdcf[_0xcb966e(0x7d9)])?.[_0xcb966e(0x2e6)] || '未知'; return _0xcb966e(0x72e) + _0x38a9ac + _0xcb966e(0x1e2) + _0x26cdcf[_0xcb966e(0x812)] + _0xcb966e(0x4d9); })[_0x40b0dc(0x2c1)](''); _0x3ffb17 = _0x40b0dc(0x5c5) + _0x2f3931 + _0x40b0dc(0x4d9); } _0x2b45bb = _0x40b0dc(0x4a4) + _0x56ff3d + _0x40b0dc(0x7b8) + _0x3ffb17 + _0x40b0dc(0x8bb); } } const _0x5e9d64 = document[_0x311e9d(0x3a7)](_0x311e9d(0x708)); async function _0x3a9faa(_0x326f89) { const _0x4f55af = _0x311e9d; if (_0x4f55af(0x707) === _0x4f55af(0x4da)) _0x1c4eed[_0x4f55af(0x27d)][_0x19b55c] = _0x322de6[_0x5cee12]; else { if (!_0x326f89 || !_0x326f89[_0x4f55af(0x279)](_0x4f55af(0x68f))) return ![]; return new Promise(_0xfd08a9 => { const _0x314f1b = _0x4f55af; if (_0x314f1b(0x14b) === _0x314f1b(0x344)) { const _0x5ab55a = _0x51a877[_0x314f1b(0x3e8)](_0x314f1b(0x829)); _0x5ab55a['value'] = _0x68adaa['id'], _0x5ab55a[_0x314f1b(0x26b)] = _0x5ec8d4['name'], _0x337624[_0x314f1b(0x7d)](_0x5ab55a); } else { const _0x774521 = document['createElement'](_0x314f1b(0x48c)); _0x774521['src'] = _0x326f89; const _0x202462 = setTimeout(() => { _0x3dc4ab(), _0xfd08a9(![]); }, 0xbb8), _0x3dc4ab = () => { const _0x122286 = _0x314f1b; clearTimeout(_0x202462), _0x774521[_0x122286(0x34a)](_0x122286(0x712), _0x1065ff), _0x774521[_0x122286(0x34a)]('error', _0x4c5cd8), _0x774521[_0x122286(0x8c7)] = '', _0x774521[_0x122286(0x47e)](); }, _0x1065ff = () => { _0x3dc4ab(), _0xfd08a9(!![]); }, _0x4c5cd8 = () => { const _0x4fd4f5 = _0x314f1b; _0x4fd4f5(0x63c) === 'eqZAy' ? _0x2baa8f[_0x4fd4f5(0x159)](_0x4fd4f5(0x7cd), _0x1ff324) : (_0x3dc4ab(), _0xfd08a9(![])); }; _0x774521[_0x314f1b(0x215)](_0x314f1b(0x712), _0x1065ff), _0x774521[_0x314f1b(0x215)](_0x314f1b(0x159), _0x4c5cd8); } }); } } async function _0x117420(_0x34cf5d, _0x378eb6) { const _0x50c071 = _0x311e9d, _0x121000 = [_0x50c071(0x183), _0x50c071(0x71b)]; for (const _0x1695a1 of _0x121000) { try { if (_0x50c071(0x180) === _0x50c071(0x180)) { const _0x4ae03b = 'https://api.vkeys.cn/v2/music/' + _0x1695a1 + _0x50c071(0x6d8) + encodeURIComponent(_0x34cf5d) + '-' + encodeURIComponent(_0x378eb6), _0x21d078 = await fetch(_0x4ae03b), _0x24c090 = await _0x21d078[_0x50c071(0x4ff)](); if (_0x24c090[_0x50c071(0x214)] !== 0xc8 || !_0x24c090[_0x50c071(0x1a8)] || _0x24c090[_0x50c071(0x1a8)]['length'] === 0x0) continue; const _0x1b5c72 = _0x24c090[_0x50c071(0x1a8)][_0x50c071(0xb5)](0x0, 0x5); for (const _0x3f22d5 of _0x1b5c72) { const _0x4091e6 = _0x50c071(0x367) + _0x1695a1 + _0x50c071(0x691) + _0x3f22d5['id'], _0x4758e3 = await fetch(_0x4091e6), _0x109267 = await _0x4758e3[_0x50c071(0x4ff)](), _0x5a55bc = _0x109267[_0x50c071(0x1a8)]?.[_0x50c071(0x5cb)]; if (await _0x3a9faa(_0x5a55bc)) return { 'url': _0x5a55bc, 'cover': _0x3f22d5[_0x50c071(0x59e)], 'source': _0x1695a1 }; } } else _0xf71308[_0x50c071(0x1c1)][_0x50c071(0x65b)]('is-entering-from-right'), _0x374ea3[_0x50c071(0x1c1)]['add'](_0x50c071(0x8d7)), _0x12e576[_0x50c071(0x1c1)]['add'](_0x50c071(0xa9)), _0x361419(() => { const _0x478369 = _0x50c071; _0x261640[_0x478369(0x1c1)][_0x478369(0x47e)](_0x478369(0xa9), _0x478369(0x8d7)), _0x311e47[_0x478369(0x1c1)][_0x478369(0x47e)]('is-entering-from-right'), _0x223619['diaryCurrentPage'] = _0x4c89ce, _0x49a073(), _0x1b5173[_0x478369(0x8ca)] = ![]; }, 0x2bc); } catch (_0x3f1f44) { console[_0x50c071(0x159)]('Error\x20fetching\x20from\x20' + _0x1695a1 + ':', _0x3f1f44); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x391589(_0x25774d) { const _0x41d1f3 = _0x311e9d; try { if ('OhUMF' !== _0x41d1f3(0x81a)) return _0x122bb7(_0x586db7)[_0x41d1f3(0x3fa)](_0x46ffa4 => _0x46ffa4[_0x41d1f3(0x5c0)]()); else { const _0x5eed4d = JSON['parse'](localStorage[_0x41d1f3(0x8b4)](_0x41d1f3(0x6bf)) || '{}'), _0x5b7a5f = { ..._0x5eed4d, ..._0x25774d }; localStorage[_0x41d1f3(0x7aa)](_0x41d1f3(0x6bf), JSON['stringify'](_0x5b7a5f)); } } catch (_0x355f2a) { if (_0x41d1f3(0x233) !== _0x41d1f3(0x170)) console['error'](_0x41d1f3(0x5d6), _0x355f2a); else { const _0x1c963d = _0x49177c['getElementById']('daily-expenses-list'), _0x4f9aaf = _0xe63f24[_0x41d1f3(0x3a7)](_0x41d1f3(0x502)), _0x3bd49f = new _0x4282a1(), _0x2d251e = _0x27c3fe['accountingData'][_0x41d1f3(0x16f)](_0x4cc03a => new _0x2493a0(_0x4cc03a['timestamp'])['toDateString']() === _0x3bd49f[_0x41d1f3(0x2d3)]()); if (_0x2d251e['length'] === 0x0) { _0x1c963d[_0x41d1f3(0x49f)] = _0x41d1f3(0x846), _0x4f9aaf['innerHTML'] = ''; return; } _0x1c963d[_0x41d1f3(0x49f)] = '', _0x2d251e[_0x41d1f3(0x783)]((_0x1eac51, _0x2f1e57) => _0x2f1e57[_0x41d1f3(0x375)] - _0x1eac51[_0x41d1f3(0x375)])[_0x41d1f3(0x436)](_0x319af6 => { const _0x36c478 = _0x41d1f3, _0x2ca071 = _0x330233[_0x36c478(0x3e8)](_0x36c478(0x8cf)); _0x2ca071[_0x36c478(0x8d8)] = 'expense-item', _0x2ca071[_0x36c478(0x49f)] = _0x36c478(0x8bf) + _0x319af6[_0x36c478(0x67f)] + '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20' + _0x319af6[_0x36c478(0x376)][_0x36c478(0x524)](0x2) + _0x36c478(0x4b5) + _0x319af6['id'] + _0x36c478(0x5a1), _0x1c963d[_0x36c478(0x7d)](_0x2ca071); }), _0x4f9aaf && (_0x4f9aaf[_0x41d1f3(0x49f)] = _0x41d1f3(0x10c), _0x342c06[_0x41d1f3(0x3a7)](_0x41d1f3(0x7bb))[_0x41d1f3(0x215)](_0x41d1f3(0x236), _0x11f5df)); } } } async function _0x417fb9() { const _0x27c2de = _0x311e9d; if ('rYQAA' === _0x27c2de(0x87c)) _0x31af5d['error'](_0x27c2de(0xbf), _0x3f1396), _0x2634fc(_0x27c2de(0x5f0)); else { const _0x404750 = document[_0x27c2de(0x3a7)](_0x27c2de(0x7ff)), _0x2abcba = document[_0x27c2de(0x3a7)]('badge-image'); try { let _0x226407 = await _0x500f4d('widget_badge'); if (!_0x226407) { const _0x107b51 = JSON['parse'](localStorage['getItem'](_0x27c2de(0x6bf)) || '{}'); _0x107b51['image'] && (_0x27c2de(0x6b8) !== _0x27c2de(0x6b8) ? (_0x200b60['style']['color'] = _0x27c2de(0x890), _0x4eaef9['style'][_0x27c2de(0x13d)] = _0x27c2de(0x87b)) : (console['log'](_0x27c2de(0x724)), _0x226407 = await _0x3cb589(_0x107b51['image']), await _0x5c7ad7(_0x27c2de(0x337), _0x226407))); } _0x226407 ? (_0x2abcba[_0x27c2de(0x8c7)] = URL[_0x27c2de(0x99)](_0x226407), _0x404750[_0x27c2de(0x27d)][_0x27c2de(0x5a4)] = _0x27c2de(0x7dc)) : _0x404750[_0x27c2de(0x27d)]['display'] = 'block'; } catch (_0x201c7f) { console[_0x27c2de(0x159)](_0x27c2de(0x76), _0x201c7f); } } } function _0x15c576(_0x2101f7) { const _0x4adb89 = _0x311e9d; try { if (_0x4adb89(0x87) === _0x4adb89(0x87)) { const _0x38f479 = JSON['parse'](localStorage[_0x4adb89(0x8b4)]('cardWidgetState') || '{}'), _0x2fd93c = { ..._0x38f479, ..._0x2101f7 }; localStorage[_0x4adb89(0x7aa)](_0x4adb89(0x83d), JSON[_0x4adb89(0x504)](_0x2fd93c)); } else _0xb94490(), _0xd9ecc8('chat', _0x4adb89(0x519)); } catch (_0x39e87a) { console[_0x4adb89(0x159)]('保存卡片状态失败', _0x39e87a); } } async function _0x1c82fe() { const _0x224ce9 = _0x311e9d, _0x97ef0c = document[_0x224ce9(0x3a7)](_0x224ce9(0x874)), _0x4029af = document[_0x224ce9(0x3a7)]('card-image'); try { if ('DyMKJ' !== _0x224ce9(0x317)) { let _0x57867d = await _0x500f4d(_0x224ce9(0x1f9)); if (!_0x57867d) { if (_0x224ce9(0x6e4) === 'KnRcv') { const _0x5aecfe = JSON[_0x224ce9(0x5b1)](localStorage[_0x224ce9(0x8b4)](_0x224ce9(0x83d)) || '{}'); _0x5aecfe['image'] && (_0x224ce9(0x60b) === 'SPpaQ' ? (console['log'](_0x224ce9(0x5a5)), _0x57867d = await _0x3cb589(_0x5aecfe['image']), await _0x5c7ad7(_0x224ce9(0x1f9), _0x57867d)) : _0x5eebc9[_0x224ce9(0x19c)] = _0x52ae07[_0x224ce9(0x602)]); } else _0x5f0395[_0x224ce9(0x26b)] = _0x4c7a67[_0x224ce9(0x2d7)](_0x2a43cc)[_0x224ce9(0x7cc)](_0x57d7f6 => _0x57d7f6[_0x224ce9(0x7ea)][_0x224ce9(0x26b)][_0x224ce9(0x3e3)]())['join']('、'); } _0x57867d ? (_0x4029af[_0x224ce9(0x8c7)] = URL[_0x224ce9(0x99)](_0x57867d), _0x97ef0c[_0x224ce9(0x27d)][_0x224ce9(0x5a4)] = _0x224ce9(0x7dc)) : _0x224ce9(0x361) === _0x224ce9(0x67a) ? (_0x1825c1['removeItem'](_0x224ce9(0x70c)), _0x74f40c(), _0x56b2cb(_0x224ce9(0x299))) : _0x97ef0c[_0x224ce9(0x27d)]['display'] = 'block'; } else { _0x31186a(_0x224ce9(0x3db)); return; } } catch (_0x78fe36) { _0x224ce9(0x66c) !== _0x224ce9(0x66c) ? _0x4fc6a7[_0x224ce9(0x3a7)](_0x224ce9(0x64b))['style'][_0x224ce9(0x31d)](_0x224ce9(0x438), _0x224ce9(0x462) + _0x4e786f + ')') : console['error'](_0x224ce9(0x2b8), _0x78fe36); } try { let _0x5b3b0b = await _0x500f4d(_0x224ce9(0x6e5)); const _0x322d8a = document[_0x224ce9(0x3a7)](_0x224ce9(0x2fd)), _0x462dae = document['getElementById'](_0x224ce9(0x3d3)); _0x5b3b0b ? _0x224ce9(0x7e0) !== _0x224ce9(0x7e0) ? _0xc44195[_0x224ce9(0x27d)][_0x224ce9(0x5a4)] = 'none' : (_0x322d8a[_0x224ce9(0x8c7)] = URL[_0x224ce9(0x99)](_0x5b3b0b), _0x462dae[_0x224ce9(0x27d)][_0x224ce9(0x5a4)] = _0x224ce9(0x7dc)) : _0x462dae[_0x224ce9(0x27d)][_0x224ce9(0x5a4)] = 'none'; } catch (_0x266d43) { console[_0x224ce9(0x159)](_0x224ce9(0x243), _0x266d43); } } _0x50e69a['addEventListener'](_0x311e9d(0x236), () => { const _0x28775e = _0x311e9d; if (_0x28775e(0x8c5) !== 'tGokD') { const _0xcec2bb = _0x37d9fc[_0x28775e(0x7ab)]['find'](_0x24efa7 => _0x24efa7['id'] === _0x47a8ad[_0x28775e(0x57c)]), _0x1676a8 = _0xcec2bb?.['boundUserProfileId']; let _0x5061d6 = _0x254cf1[_0x28775e(0x7c0)][_0x28775e(0x226)](_0x38491e => _0x38491e['id'] === _0x1676a8); !_0x5061d6 && (_0x5061d6 = _0x25e601[_0x28775e(0x7c0)]['find'](_0x5ca249 => _0x5ca249['id'] === _0x1d6979[_0x28775e(0x17e)])), !_0x5061d6 && (_0x5061d6 = _0x24dc52[_0x28775e(0x7c0)][0x0]), _0x5061d6 && (_0x407410[_0x28775e(0x3a7)](_0x28775e(0x3b6))[_0x28775e(0x8c7)] = _0x5061d6[_0x28775e(0xe7)] || _0x2722e); } else _0x2b67fb(), _0x6564ff(_0x28775e(0x77f), _0x28775e(0x519)); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x640))[_0x311e9d(0x215)]('click', () => _0x6564ff('home', 'userProfileList')), document[_0x311e9d(0x3a7)]('add-user-profile-button')['addEventListener'](_0x311e9d(0x236), () => _0x5827f8()), document[_0x311e9d(0x3a7)]('back-to-user-list-from-edit')[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x218c69 = _0x311e9d; _0x2b67fb(), _0x6564ff(_0x218c69(0x77f), 'userProfile'); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x636))[_0x311e9d(0x215)]('click', _0x27125d), document['getElementById'](_0x311e9d(0x13e))[_0x311e9d(0x215)](_0x311e9d(0x236), _0x2c2ce8), document['getElementById']('set-active-user-button')[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x1b2d87 = _0x311e9d; if (_0x1b2d87(0x8d2) !== _0x1b2d87(0x8d2)) _0x515ee9 = _0x24ca3a[_0x1b2d87(0x2e6)], _0x4d534b = _0x2f1002[_0x1b2d87(0xe7)]; else { const _0x5615f5 = document[_0x1b2d87(0x3a7)](_0x1b2d87(0x11d))[_0x1b2d87(0x815)]; _0x5615f5 && (_0x40321a[_0x1b2d87(0x17e)] = _0x5615f5, _0x544cbe(), _0x1bbd68('已设为当前用户！'), _0x2b67fb(), document['getElementById']('set-active-user-button')[_0x1b2d87(0x27d)][_0x1b2d87(0x5a4)] = _0x1b2d87(0x87b)); } }); function _0x9333e5(_0x5818dc) { const _0x5eda08 = _0x311e9d, _0x5b1870 = _0x40321a[_0x5eda08(0x478)][_0x5eda08(0x226)](_0x253705 => _0x253705['id'] === _0x5818dc), _0x5ac937 = _0x5b1870?.[_0x5eda08(0x87f)]; let _0x5eecc8 = _0x40321a[_0x5eda08(0x7c0)]['find'](_0x15097e => _0x15097e['id'] === _0x5ac937); return !_0x5eecc8 && (_0x5eda08(0x29f) !== _0x5eda08(0x29f) ? _0x44d84d['revokeObjectURL'](_0x15c49c) : _0x5eecc8 = _0x40321a[_0x5eda08(0x7c0)][_0x5eda08(0x226)](_0x2cacb6 => _0x2cacb6['id'] === _0x40321a[_0x5eda08(0x17e)]) || _0x40321a[_0x5eda08(0x7c0)][0x0]), _0x5eecc8 || { 'name': '用户', 'avatar': _0x579f27, 'persona': '' }; } function _0x5c0c37(_0x49b897) { const _0x3b4f66 = _0x311e9d, _0xb1acb = document[_0x3b4f66(0x3a7)](_0x49b897); _0xb1acb[_0x3b4f66(0x49f)] = '', _0x40321a[_0x3b4f66(0x7c0)]['forEach'](_0x2e17ac => { const _0xacf724 = _0x3b4f66, _0x3ca787 = document[_0xacf724(0x3e8)](_0xacf724(0x829)); _0x3ca787[_0xacf724(0x815)] = _0x2e17ac['id'], _0x3ca787[_0xacf724(0x26b)] = _0x2e17ac['name'], _0xb1acb[_0xacf724(0x7d)](_0x3ca787); }); } function _0x208b7d(_0x2ae71f) { const _0xb53ab2 = _0x311e9d, _0x48caaf = _0x3f1cb7(_0x2ae71f), _0x2eb363 = document[_0xb53ab2(0x3a7)]('chat-view-pane'); _0x2eb363[_0xb53ab2(0x27d)][_0xb53ab2(0xb3)] = ''; let _0x4ac0af = document['getElementById']('style-' + _0x2ae71f); if (_0x4ac0af) _0x4ac0af[_0xb53ab2(0x49f)] = ''; if (!_0x48caaf) return; _0x48caaf['chatWallpaper'] && (_0xb53ab2(0x858) === 'bMwwT' ? (_0x2eb363[_0xb53ab2(0x27d)][_0xb53ab2(0xb3)] = _0xb53ab2(0x3dd) + _0x48caaf[_0xb53ab2(0x459)] + '\x27)', _0x2eb363[_0xb53ab2(0x27d)][_0xb53ab2(0x4b0)] = _0xb53ab2(0x59e), _0x2eb363[_0xb53ab2(0x27d)][_0xb53ab2(0x424)] = _0xb53ab2(0x50d)) : _0x1225ec(_0xb53ab2(0x8d0) + _0x418c3b[_0xb53ab2(0x15a)])); if (_0x48caaf[_0xb53ab2(0x2c8)]) { let _0x4c380d = document['getElementById']('style-' + _0x48caaf['id']); !_0x4c380d && ('onViU' === _0xb53ab2(0x2b1) ? (_0x4c380d = document[_0xb53ab2(0x3e8)](_0xb53ab2(0x27d)), _0x4c380d['id'] = _0xb53ab2(0x5d0) + _0x48caaf['id'], document[_0xb53ab2(0x7ae)][_0xb53ab2(0x7d)](_0x4c380d)) : (_0x42660d['style'][_0xb53ab2(0x5a4)] = _0xb53ab2(0x7dc), _0xdb8c26[_0xb53ab2(0x27d)][_0xb53ab2(0x5a4)] = _0xb53ab2(0x87b))); const _0x3e7681 = _0x48caaf[_0xb53ab2(0x2c8)], _0x16c360 = _0x3e7681['replace'](/\.bubble\.sent/g, _0xb53ab2(0x72b) + _0x48caaf['id'] + _0xb53ab2(0x792))[_0xb53ab2(0x3d9)](/\.bubble\.received/g, _0xb53ab2(0x72b) + _0x48caaf['id'] + '.message.ai'); _0x4c380d[_0xb53ab2(0x49f)] = _0x16c360; } } function _0x304aa1() { const _0x597462 = _0x311e9d, _0x3ad693 = document[_0x597462(0x3a7)](_0x597462(0xe6)); _0x3ad693[_0x597462(0x49f)] = ''; const _0x44d963 = _0x5b1727 => { const _0x52c453 = _0x597462; _0x40321a['pendingPostAttachments'][_0x5b1727] = null; if (_0x5b1727 === _0x52c453(0x888)) _0x40321a[_0x52c453(0x137)][_0x52c453(0x3a0)] = null; _0x304aa1(); }, _0x206147 = _0x40321a['pendingPostAttachments'][_0x597462(0x3a0)], _0x49a29d = _0x40321a[_0x597462(0x137)][_0x597462(0x242)]; if (_0x206147) { if (_0x597462(0x418) !== _0x597462(0x418)) _0x31e7aa && _0x18d156(_0x1c9b6f['id'], _0x3a0521[_0x597462(0x7cc)](_0x42effd => _0x42effd['id'])); else { const _0x46dd91 = document[_0x597462(0x3e8)](_0x597462(0x8cf)); _0x46dd91[_0x597462(0x8d8)] = _0x597462(0x748), _0x46dd91['innerHTML'] = _0x597462(0x3c1), _0x46dd91[_0x597462(0x889)](_0x597462(0x56b))['onclick'] = () => _0x44d963('image'), _0x3ad693[_0x597462(0x7d)](_0x46dd91), _0x500f4d(_0x206147)[_0x597462(0x3fa)](_0x1c2292 => { const _0x5474aa = _0x597462, _0x347bb9 = document[_0x5474aa(0x3a7)](_0x5474aa(0x81c)); if (_0x347bb9 && _0x1c2292) { if ('LxjyN' !== _0x5474aa(0x15b)) _0x347bb9['src'] = URL[_0x5474aa(0x99)](_0x1c2292); else { _0x5f1954 = _0x3229dd(_0x522f40['lyrics']), _0x5411e8[_0x5474aa(0x49f)] = ''; if (_0x17ec52[_0x5474aa(0x286)] === 0x0) { _0x385d13[_0x5474aa(0x49f)] = _0x5474aa(0x6a0); return; } _0x1d9d2b[_0x5474aa(0x436)]((_0x545b64, _0x112e53) => { const _0x12b39c = _0x5474aa, _0x4627aa = _0x377991[_0x12b39c(0x3e8)]('p'); _0x4627aa[_0x12b39c(0x26b)] = _0x545b64['text'], _0x4627aa['id'] = _0x12b39c(0x90) + _0x112e53, _0x54b794[_0x12b39c(0x7d)](_0x4627aa); }); } } }); } } if (_0x49a29d) { const _0x7813e5 = document['createElement'](_0x597462(0x8cf)); _0x7813e5[_0x597462(0x8d8)] = _0x597462(0x748), _0x7813e5[_0x597462(0x49f)] = _0x597462(0x400) + (_0x49a29d[_0x597462(0x102)] || _0x4716b3) + _0x597462(0x88f) + _0x49a29d[_0x597462(0x4de)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>' + _0x49a29d[_0x597462(0x45d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x7813e5[_0x597462(0x889)]('.remove-attachment-btn')[_0x597462(0x6fe)] = () => _0x44d963(_0x597462(0x242)), _0x3ad693['appendChild'](_0x7813e5); } } async function _0x2f2d41(_0x357462) { const _0x132db9 = _0x311e9d; if (_0x132db9(0x7c8) !== 'FDpIC') { const _0x5d81e7 = _0x40321a['friendCircles'][_0x132db9(0x226)](_0x2808a6 => _0x2808a6['id'] === _0x40321a['activeFriendCircleId']); if (!_0x5d81e7) return; _0x3396e7(!![], '大家正在赶来回复...'), _0x40321a[_0x132db9(0x160)] = !![]; try { const _0x10a570 = _0x5d81e7[_0x132db9(0x726)]['map'](_0x464a26 => _0x3f1cb7(_0x464a26))['filter'](Boolean), _0x359114 = _0x5bc7c6(), _0x1459d9 = _0x10a570[_0x132db9(0x7cc)](_0x1f1ba5 => { const _0xff84b1 = _0x132db9; if (_0xff84b1(0x80f) !== _0xff84b1(0x364)) { const { omniText: _0x174c5c } = _0x4fa46e(_0x1f1ba5['id'], null), _0xdd13d6 = _0x38da7e(_0x1f1ba5['id']), _0x1322bf = _0x1f1ba5['linkedWorldBookIds'] && _0x1f1ba5['linkedWorldBookIds'][_0xff84b1(0x286)] > 0x0 ? _0xff84b1(0x426) + _0x1f1ba5[_0xff84b1(0x2e6)] + '的个人专属世界观设定\x0a' + _0x1f1ba5[_0xff84b1(0x3d5)][_0xff84b1(0x7cc)](_0x5b5ef8 => _0x40321a[_0xff84b1(0x5e7)]['find'](_0x2888ba => _0x2888ba['id'] === _0x5b5ef8))[_0xff84b1(0x16f)](Boolean)[_0xff84b1(0x7cc)](_0xf194ab => _0xff84b1(0x482) + _0xf194ab['name'] + '\x0a' + _0xf194ab[_0xff84b1(0x812)])[_0xff84b1(0x2c1)]('') : ''; return _0xff84b1(0x42b) + _0x1f1ba5[_0xff84b1(0x2e6)] + _0xff84b1(0x4d2) + _0x1f1ba5['id'] + '\x0a\x20\x20人设:\x20' + _0x1f1ba5[_0xff84b1(0x838)] + _0xff84b1(0x312) + _0x174c5c + '\x0a' + _0xdd13d6 + '\x0a' + _0x1322bf; } else _0x3bd265['musicPlaylist'] = _0x4c48c8, _0xd42e03[_0xff84b1(0x4bc)] = _0x152ae2, _0x2e4380[_0xff84b1(0x1b5)] = ![], _0x2ffe6b(); })['join']('\x0a\x0a'), _0x135e9f = _0x1b3e95(_0x357462[_0x132db9(0x7d9)]) || { 'name': '用户' }, _0x9820f = _0x135e9f[_0x132db9(0x838)] ? _0x132db9(0x76d) + _0x135e9f[_0x132db9(0x2e6)] + _0x132db9(0x831) + _0x135e9f[_0x132db9(0x838)] + '\x0a' : ''; let _0x3fc9b7 = null; if (_0x357462[_0x132db9(0x888)]) _0x132db9(0x5c9) === _0x132db9(0x26d) ? _0x1d85d8[_0x132db9(0x3a7)](_0x132db9(0x1c2))[_0x132db9(0x236)]() : _0x3fc9b7 = _0x357462[_0x132db9(0x888)]; else { if (_0x357462['imageId']) { if (_0x132db9(0x470) === _0x132db9(0x321)) { const _0x2d1326 = _0x332d88[_0x132db9(0x3e8)]('option'); _0x2d1326['value'] = _0x2f5588['id'], _0x2d1326['textContent'] = _0x377932['name'], _0x5ab12a['appendChild'](_0x2d1326); } else try { if (_0x132db9(0x248) === 'NrIFv') { const _0x2c1125 = await _0x500f4d(_0x357462[_0x132db9(0x3a0)]); if (_0x2c1125) { if ('jrOwo' === _0x132db9(0x81f)) { const _0xdc7891 = _0x56a048[_0x132db9(0x822)](_0x51a5d1, 'readwrite'), _0x16817e = _0xdc7891[_0x132db9(0x16c)](_0x3595df), _0x52af3d = _0x16817e[_0x132db9(0x9f)](_0x4ed6a3); _0x52af3d[_0x132db9(0x61f)] = () => _0x3cc322(_0x52af3d[_0x132db9(0x7ba)]), _0x52af3d[_0x132db9(0x3bd)] = () => _0x2c359c(_0x52af3d[_0x132db9(0x159)]); } else _0x3fc9b7 = await _0x5cb5e3(_0x2c1125); } } else { const _0x446947 = _0x2fff45['trim'](); if (!_0x446947 || !_0x12e4dd[_0x132db9(0x23e)]) return; let _0x38ce16 = _0x9dda94[_0x132db9(0x7e5)][_0x132db9(0x226)](_0x1eedbc => _0x1eedbc[_0x132db9(0x769)] === _0xfda861[_0x132db9(0x23e)]); !_0x38ce16 && (_0x38ce16 = { 'characterId': _0x114637[_0x132db9(0x23e)], 'entries': [] }, _0x1877a1[_0x132db9(0x7e5)]['push'](_0x38ce16)); _0x38ce16[_0x132db9(0x27f)][_0x132db9(0x1fb)]({ 'timestamp': _0x442702[_0x132db9(0x6bb)](), 'author': _0x132db9(0x447), 'content': _0x446947 }), _0x364c8c(); const _0x5bc6d0 = _0x38ce16['entries'][_0x132db9(0x286)]; _0x44bdce[_0x132db9(0x8d9)] = _0x1f6051[_0x132db9(0x826)](_0x5bc6d0 / 0x2) - 0x1, _0x5b61bb(); } } catch (_0x189102) { if (_0x132db9(0x520) !== _0x132db9(0x520)) { const _0x4fbade = _0x559912['senderId'] || _0x53321f?.[_0x132db9(0x239)][0x0], _0x197234 = _0x3c30de(_0x4fbade); _0x560131 = _0x197234 ? _0x197234['name'] : '角色'; } else console[_0x132db9(0x159)](_0x132db9(0x457), _0x189102); } } } let _0xcc9783 = _0x135e9f[_0x132db9(0x2e6)] + _0x132db9(0xb2) + _0x357462['content'] + '”'; _0x3fc9b7 && (_0xcc9783 += _0x132db9(0x24c)); _0x357462['type'] === _0x132db9(0x242) && (_0xcc9783 += '\x20[并分享了歌曲:\x20' + _0x357462['songName'] + _0x132db9(0x604) + _0x357462[_0x132db9(0x45d)] + ']'); const _0xf738db = _0x132db9(0x4d5) + _0x1459d9 + '\x0a\x0a' + _0x9820f + _0x132db9(0x6a) + _0x359114 + _0x132db9(0x761) + _0xcc9783 + _0x132db9(0x4e5), _0x1eb875 = [{ 'role': _0x132db9(0x70d), 'content': _0xf738db }], _0x4a7704 = { 'role': _0x132db9(0x447), 'content': '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。' }; if (_0x3fc9b7) { if ('dVKQX' === _0x132db9(0x2a7)) _0x4a7704['image'] = _0x3fc9b7; else { const _0x33615c = [_0x132db9(0x5cf), '星期一', '星期二', _0x132db9(0x2cd), _0x132db9(0x128), _0x132db9(0x7d8), '星期六']; return _0x33615c[_0x2d35b0[_0x132db9(0x385)]()] + '\x20' + _0x570db4; } } _0x1eb875[_0x132db9(0x1fb)](_0x4a7704); const _0x52cbe6 = await _0x56cc62(_0x1eb875, { 'json': !![] }), _0x9fa3c4 = _0x52cbe6[_0x132db9(0x33f)](/({[\s\S]*})/); if (!_0x9fa3c4) throw new Error(_0x132db9(0x7bc)); const _0x3e9250 = JSON[_0x132db9(0x5b1)](_0x9fa3c4[0x1]), _0x4a7bc9 = _0x5d81e7[_0x132db9(0x188)]['find'](_0x224bf1 => _0x224bf1['id'] === _0x357462['id']); _0x4a7bc9 && (_0x4a7bc9[_0x132db9(0xe4)] = _0x3e9250['likes'] || [], _0x4a7bc9[_0x132db9(0x6d)] = (_0x3e9250[_0x132db9(0x6d)] || [])[_0x132db9(0x7cc)]((_0x39146b, _0x22a049) => ({ ..._0x39146b, 'commentId': 'c_' + _0x357462[_0x132db9(0x375)] + '_' + _0x22a049 })), _0x544cbe(), _0x28f111()); } catch (_0x528ef2) { console[_0x132db9(0x159)](_0x132db9(0x6d9), _0x528ef2), _0x1bbd68('大家好像不知道该怎么回复...'); } finally { _0x3396e7(![]), _0x40321a[_0x132db9(0x160)] = ![]; } } else _0x4648f1[_0x132db9(0x159)](_0x132db9(0x136), _0x19e576), _0xd598ca(_0x132db9(0x1f2) + _0x45e6eb['message']); } function _0xf819d6() { const _0x3a1c40 = _0x311e9d; if (_0x3a1c40(0x3cf) !== _0x3a1c40(0x3cf)) { if (_0x57d1e2) { const _0x2cb439 = _0x101f17[_0x3a1c40(0x99)](_0x2f198d); _0x4b67e4[_0x3a1c40(0x8c7)] = _0x2cb439, _0x40b317[_0x3a1c40(0x5bc)] = () => { const _0x23e834 = _0x3a1c40; _0x20cc1e[_0x23e834(0x165)](_0x2cb439); }; } else _0x344150['alt'] = '图片加载失败'; } else { const _0x43956c = _0x40321a[_0x3a1c40(0x7ab)]['find'](_0xeb5c8e => _0xeb5c8e['id'] === _0x40321a[_0x3a1c40(0x57c)]), _0x17299d = _0x43956c?.[_0x3a1c40(0x87f)]; let _0x5be10a = _0x40321a[_0x3a1c40(0x7c0)]['find'](_0x1727c2 => _0x1727c2['id'] === _0x17299d); !_0x5be10a && (_0x3a1c40(0x451) === 'rWOwl' ? _0x3f0993[_0x3a1c40(0x8c7)] = _0x258411 ? _0x48661e['createObjectURL'](_0x238cde) : '' : _0x5be10a = _0x40321a['userProfiles']['find'](_0x1fcec1 => _0x1fcec1['id'] === _0x40321a[_0x3a1c40(0x17e)])); if (!_0x5be10a) { if (_0x3a1c40(0x3e2) !== _0x3a1c40(0x486)) _0x5be10a = _0x40321a[_0x3a1c40(0x7c0)][0x0]; else return []; } _0x5be10a && (document[_0x3a1c40(0x3a7)](_0x3a1c40(0x3b6))[_0x3a1c40(0x8c7)] = _0x5be10a[_0x3a1c40(0xe7)] || _0x579f27); } } function _0x5e4482(_0x29b15b) { const _0x3c40da = _0x311e9d; if (_0x3c40da(0xf5) !== _0x3c40da(0xf5)) return _0x47fe71['slice'](0x0, 0x9); else { let _0x5b94a0 = 0x0, _0x2db6f5 = 0x0, _0x51e673 = 0x0; if (_0x29b15b[_0x3c40da(0x286)] == 0x4) _0x5b94a0 = '0x' + _0x29b15b[0x1] + _0x29b15b[0x1], _0x2db6f5 = '0x' + _0x29b15b[0x2] + _0x29b15b[0x2], _0x51e673 = '0x' + _0x29b15b[0x3] + _0x29b15b[0x3]; else _0x29b15b['length'] == 0x7 && (_0x5b94a0 = '0x' + _0x29b15b[0x1] + _0x29b15b[0x2], _0x2db6f5 = '0x' + _0x29b15b[0x3] + _0x29b15b[0x4], _0x51e673 = '0x' + _0x29b15b[0x5] + _0x29b15b[0x6]); _0x5b94a0 /= 0xff, _0x2db6f5 /= 0xff, _0x51e673 /= 0xff; let _0x2afa11 = Math['min'](_0x5b94a0, _0x2db6f5, _0x51e673), _0x1b72bd = Math[_0x3c40da(0x7d4)](_0x5b94a0, _0x2db6f5, _0x51e673), _0xc9ebe = _0x1b72bd - _0x2afa11, _0x326a9c = 0x0, _0x5939ad = 0x0, _0x20e7e8 = 0x0; if (_0xc9ebe == 0x0) _0x326a9c = 0x0; else { if (_0x1b72bd == _0x5b94a0) _0x326a9c = (_0x2db6f5 - _0x51e673) / _0xc9ebe % 0x6; else { if (_0x1b72bd == _0x2db6f5) _0x326a9c = (_0x51e673 - _0x5b94a0) / _0xc9ebe + 0x2; else _0x326a9c = (_0x5b94a0 - _0x2db6f5) / _0xc9ebe + 0x4; } } _0x326a9c = Math[_0x3c40da(0x824)](_0x326a9c * 0x3c); if (_0x326a9c < 0x0) _0x326a9c += 0x168; return _0x20e7e8 = (_0x1b72bd + _0x2afa11) / 0x2, _0x5939ad = _0xc9ebe == 0x0 ? 0x0 : _0xc9ebe / (0x1 - Math[_0x3c40da(0x784)](0x2 * _0x20e7e8 - 0x1)), _0x5939ad = +(_0x5939ad * 0x64)['toFixed'](0x1), _0x20e7e8 = +(_0x20e7e8 * 0x64)[_0x3c40da(0x524)](0x1), { 'h': _0x326a9c, 's': _0x5939ad, 'l': _0x20e7e8 }; } } function _0x3df337() { const _0x67a431 = _0x311e9d, _0x2b6fc6 = (_0x4ce8be, _0x3b1c06, _0x118ede) => { const _0x53eed7 = _0x4fd4; if (_0x53eed7(0x2f3) !== _0x53eed7(0x7dd)) { const _0x5afcfa = document[_0x53eed7(0x3a7)](_0x4ce8be); if (!_0x5afcfa) return; let _0x1df8bc = null; try { _0x1df8bc = JSON[_0x53eed7(0x5b1)](localStorage[_0x53eed7(0x8b4)](_0x3b1c06) || '{}'); } catch { _0x1df8bc = {}; } _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x3b9)] = _0x53eed7(0x131), _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x71a)] = '', _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x40d)] = '', _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x762)] = '', _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x83)] = '', _0x5afcfa[_0x53eed7(0x27d)]['transform'] = ''; if (typeof _0x1df8bc[_0x53eed7(0x71a)] === _0x53eed7(0x47d) && typeof _0x1df8bc[_0x53eed7(0x40d)] === 'number') _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x71a)] = _0x1df8bc[_0x53eed7(0x71a)] + '%', _0x5afcfa[_0x53eed7(0x27d)][_0x53eed7(0x40d)] = _0x1df8bc[_0x53eed7(0x40d)] + '%'; else for (const _0x1c564e in _0x118ede) { _0x5afcfa[_0x53eed7(0x27d)][_0x1c564e] = _0x118ede[_0x1c564e]; } } else _0x2892d3[_0x53eed7(0x815)] = '', _0x328c09[_0x53eed7(0x26b)] = _0x53eed7(0x8d6), _0x3d7ee9[_0x53eed7(0x815)] = _0x53eed7(0x446) + (_0x29ef2e['characters'][_0x53eed7(0x286)] + 0x1), _0x2dc591[_0x53eed7(0x815)] = '', _0x510b99['src'] = _0x421023, _0x47bcbb[_0x53eed7(0x815)] = _0x53eed7(0x3fd), _0x23c3a4['getElementById'](_0x53eed7(0x308))[_0x53eed7(0x815)] = '', _0x3bb0fa(); }; _0x2b6fc6('home-clock-container', _0x67a431(0x55f), { 'top': _0x67a431(0x692), 'left': _0x67a431(0x287), 'transform': _0x67a431(0x6d3) }), _0x2b6fc6(_0x67a431(0x6ea), 'appIconPosition_app-wallpaper', { 'top': '20%', 'right': '4%' }), _0x2b6fc6(_0x67a431(0x738), 'appIconPosition_app-user-profiles', { 'top': _0x67a431(0x5c4), 'right': _0x67a431(0x896) }), _0x2b6fc6(_0x67a431(0x655), _0x67a431(0x3a1), { 'top': '8%', 'right': _0x67a431(0x896) }), _0x2b6fc6(_0x67a431(0x16d), _0x67a431(0x79e), { 'top': '8%', 'right': '4%' }), _0x2b6fc6('app-music-library', 'appIconPosition_app-music-library', { 'top': _0x67a431(0x3f4), 'left': '5%' }), _0x2b6fc6(_0x67a431(0x27c), _0x67a431(0x862), { 'top': _0x67a431(0x298), 'left': _0x67a431(0x288) }), _0x2b6fc6(_0x67a431(0x5c3), _0x67a431(0x1da), { 'top': '72%', 'left': '7%' }), _0x2b6fc6(_0x67a431(0x803), _0x67a431(0x8a0), { 'top': '59%', 'left': _0x67a431(0x288) }), _0x2b6fc6(_0x67a431(0x7ff), _0x67a431(0x6bf), { 'top': _0x67a431(0x2d8), 'right': '5%' }), _0x2b6fc6(_0x67a431(0x3d3), _0x67a431(0x8e), { 'top': '8%', 'left': '5%' }); const _0x3c2873 = document[_0x67a431(0x3a7)]('card-widget'); _0x3c2873 && ('Idkdq' !== 'ZkBhO' ? (_0x3c2873[_0x67a431(0x27d)][_0x67a431(0x3b9)] = _0x67a431(0x131), _0x3c2873['style']['top'] = '34%', _0x3c2873[_0x67a431(0x27d)]['left'] = _0x67a431(0x287), _0x3c2873[_0x67a431(0x27d)][_0x67a431(0x290)] = _0x67a431(0x6d3), _0x3c2873[_0x67a431(0x27d)][_0x67a431(0x5a4)] = _0x67a431(0x7dc)) : _0x20e225()); const _0xae3614 = document['getElementById'](_0x67a431(0x6f3)); _0xae3614 && (_0x67a431(0x42e) !== 'xaxfE' ? (_0xae3614[_0x67a431(0x27d)]['position'] = 'absolute', _0xae3614[_0x67a431(0x27d)][_0x67a431(0x71a)] = _0x67a431(0xa6), _0xae3614['style']['left'] = '50%', _0xae3614['style']['transform'] = 'translateX(-50%)', _0xae3614[_0x67a431(0x27d)]['display'] = _0x67a431(0x73a)) : (_0x586ff4[_0x67a431(0x24e)] = _0x52e426, _0x12e96d(_0x5cfa9f['activeMeetingCharId'], _0x67a431(0x4d6)))); } function _0x58c36a() { const _0x4962d9 = _0x311e9d, _0x5c22d3 = document[_0x4962d9(0x3a7)]('custom-icon-list-container'); _0x5c22d3[_0x4962d9(0x49f)] = ''; const _0x5b46db = document[_0x4962d9(0x21e)](_0x4962d9(0x556)); _0x5b46db[_0x4962d9(0x436)](_0x45b546 => { const _0x9bf0a8 = _0x4962d9, _0x2d0f76 = _0x45b546['id'], _0x81d69f = _0x45b546[_0x9bf0a8(0x889)]('span')[_0x9bf0a8(0x26b)], _0x2c7a46 = _0x9bf0a8(0x3bf) + _0x2d0f76, _0x1d56e3 = localStorage[_0x9bf0a8(0x8b4)](_0x2c7a46), _0x3abc6e = document[_0x9bf0a8(0x3e8)](_0x9bf0a8(0x8cf)); _0x3abc6e[_0x9bf0a8(0x8d8)] = _0x9bf0a8(0x51f), _0x3abc6e[_0x9bf0a8(0x27d)][_0x9bf0a8(0x5d1)] = '10px\x200', _0x3abc6e[_0x9bf0a8(0x49f)] = _0x9bf0a8(0x573) + _0x2d0f76 + '\x22\x20src=\x22' + (_0x1d56e3 || _0x9bf0a8(0x84e)) + _0x9bf0a8(0x882) + _0x81d69f + _0x9bf0a8(0x4d3) + _0x2d0f76 + _0x9bf0a8(0x2d0) + _0x2d0f76 + _0x9bf0a8(0x9e) + _0x2c7a46 + _0x9bf0a8(0x568), _0x5c22d3[_0x9bf0a8(0x7d)](_0x3abc6e); const _0x1a8140 = document[_0x9bf0a8(0x3a7)](_0x9bf0a8(0x365) + _0x2d0f76); _0x1a8140[_0x9bf0a8(0x215)]('change', async _0x26c70a => { const _0x2cbfae = _0x9bf0a8; if (_0x2cbfae(0x828) === _0x2cbfae(0x828)) { const _0x42fde9 = _0x26c70a[_0x2cbfae(0x94)][_0x2cbfae(0x83b)][0x0]; if (!_0x42fde9) return; try { const _0x2630b3 = await _0x53aefa(_0x42fde9); localStorage[_0x2cbfae(0x7aa)](_0x2c7a46, _0x2630b3), document[_0x2cbfae(0x3a7)](_0x2cbfae(0x614) + _0x2d0f76)[_0x2cbfae(0x8c7)] = _0x2630b3, _0x51f633(); } catch (_0x2e2845) { if ('krKvz' !== _0x2cbfae(0x116)) { const _0x66e88b = _0x1b5f63[_0x2cbfae(0x226)](_0x109eb6 => _0x109eb6[_0x2cbfae(0x2e6)] === _0xfa63b2[_0x2cbfae(0x2e6)]); if (_0x66e88b) _0x496f05[_0x2cbfae(0x616)](_0x3a28e3, { 'content': _0x2cbfae(0x79a) + _0x66e88b[_0x2cbfae(0x2e6)] + ']', 'displayUrl': _0x66e88b[_0x2cbfae(0x5cb)] }); else _0x4b7f3['content'] = '[sticker:' + _0x488506[_0x2cbfae(0x2e6)] + ']'; } else _0x1bbd68(_0x2cbfae(0x6d7) + _0x2e2845[_0x2cbfae(0x15a)]); } } else _0x3f5b5e('错误:\x20' + _0x15325b[_0x2cbfae(0x15a)]); }); }); } function _0x51f633() { const _0x4c3cc7 = _0x311e9d; if ('vViwc' !== _0x4c3cc7(0x82d)) _0x244e2f(_0x4c3cc7(0x612) + _0x4abd3d[_0x4c3cc7(0x15a)]); else { const _0x44d450 = document['querySelectorAll']('.app-icon'); _0x44d450[_0x4c3cc7(0x436)](_0x1fbff2 => { const _0x4b9ded = _0x4c3cc7; if (_0x4b9ded(0x1a6) !== _0x4b9ded(0x6c4)) { const _0x2eace5 = _0x1fbff2['id'], _0x27637a = _0x4b9ded(0x3bf) + _0x2eace5, _0x773ce1 = localStorage['getItem'](_0x27637a), _0x2f7eb5 = _0x1fbff2['querySelector'](_0x4b9ded(0x408)); if (_0x773ce1) _0x2f7eb5[_0x4b9ded(0x49f)] = _0x4b9ded(0x8de) + _0x773ce1 + _0x4b9ded(0x464); else { const _0x32a006 = document[_0x4b9ded(0x889)](_0x4b9ded(0x264) + _0x2eace5 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x2eace5 + _0x4b9ded(0x758))?.['innerHTML']; _0x32a006 && (_0x2f7eb5['innerHTML'] = _0x32a006); } } else return { 'url': _0x1c15d0, 'cover': _0xba9c25[_0x4b9ded(0x59e)], 'source': _0x456355 }; }); } } function _0x67bf98() { const _0x360fc3 = _0x311e9d, _0x37fba6 = _0x40321a[_0x360fc3(0x7ab)][_0x360fc3(0x226)](_0x50ee1b => _0x50ee1b['id'] === _0x40321a[_0x360fc3(0x57c)]), _0x5390bb = _0x4db4a7(); let _0x350da8 = []; if (_0x37fba6 && _0x37fba6[_0x360fc3(0x188)]) { const _0x823963 = _0x37fba6[_0x360fc3(0x188)]['filter'](_0x5e33db => _0x5e33db[_0x360fc3(0x78c)] === 'music' && _0x5e33db['playableUrl'])[_0x360fc3(0x7cc)](_0x59bc0c => ({ ..._0x59bc0c, 'source': _0x360fc3(0x89b) })); _0x350da8[_0x360fc3(0x1fb)](..._0x823963); } if (_0x5390bb && _0x40321a[_0x360fc3(0x393)]) { const _0x6cde32 = _0x40321a[_0x360fc3(0x393)]['filter'](_0x5aab32 => _0x5aab32[_0x360fc3(0x78c)] === 'music' && _0x5aab32['playableUrl'])['map'](_0x48c34c => ({ ..._0x48c34c, 'source': 'chat' })); _0x350da8[_0x360fc3(0x1fb)](..._0x6cde32); } const _0x4a6a8a = Array[_0x360fc3(0x2d7)](new Map(_0x350da8[_0x360fc3(0x7cc)](_0x2bc8e5 => [_0x2bc8e5[_0x360fc3(0x89c)], _0x2bc8e5]))['values']()); _0x40321a['musicPlaylist'] = _0x4a6a8a[_0x360fc3(0x783)]((_0x14a014, _0x573060) => _0x573060[_0x360fc3(0x375)] - _0x14a014[_0x360fc3(0x375)]); } function _0x1a2bb9(_0x3e49f6) { const _0x158ca4 = _0x311e9d; if (_0x3e49f6 < 0x0 || _0x3e49f6 >= _0x50a5a7['length']) return; _0x1960b7 = _0x3e49f6; const _0x134873 = _0x50a5a7[_0x3e49f6]; _0x77bdcd[_0x158ca4(0x8c7)] = _0x134873['playableUrl'] || _0x134873[_0x158ca4(0x5cb)], _0x77bdcd[_0x158ca4(0x2ed)](), _0x2ee7b0(), _0x4b4ff0(); } function _0x2ee7b0() { const _0x5b3260 = _0x311e9d; if ('lCDBE' !== _0x5b3260(0x709)) { const _0x258f8a = _0x50a5a7[_0x1960b7]; _0x5d1f29(_0x258f8a); } else { const _0x39cb2b = new _0x2b5b20(), _0x360edd = _0x2ac49f[_0x5b3260(0x3a7)](_0x5b3260(0x56d)), _0xd952ac = _0x25f787[_0x5b3260(0x3a7)](_0x5b3260(0x2bb)); if (_0x360edd && _0xd952ac) { const _0x1e76e0 = _0x3f2528(_0x39cb2b[_0x5b3260(0x499)]())[_0x5b3260(0x26e)](0x2, '0'), _0x4521c7 = _0x40a70d(_0x39cb2b[_0x5b3260(0x46a)]())[_0x5b3260(0x26e)](0x2, '0'); _0x360edd[_0x5b3260(0x26b)] = _0x1e76e0 + ':' + _0x4521c7; const _0x434623 = _0x39cb2b[_0x5b3260(0x1a1)]() + 0x1, _0xa08988 = _0x39cb2b[_0x5b3260(0xec)](), _0x515f8a = [_0x5b3260(0x5cf), _0x5b3260(0x3d4), _0x5b3260(0x14e), _0x5b3260(0x2cd), '星期四', _0x5b3260(0x7d8), _0x5b3260(0x6a3)][_0x39cb2b[_0x5b3260(0x385)]()]; _0xd952ac[_0x5b3260(0x26b)] = _0x434623 + '月' + _0xa08988 + '日\x20' + _0x515f8a; } } } function _0x4b4ff0() { const _0x3ab9ce = _0x311e9d; try { 'IeDGg' !== _0x3ab9ce(0x8ba) ? localStorage[_0x3ab9ce(0x7aa)](_0x3ab9ce(0x493), JSON[_0x3ab9ce(0x504)]({ 'playlist': _0x40321a[_0x3ab9ce(0x2cc)], 'currentIndex': _0x40321a['currentlyPlayingIndex'] })) : _0x52e42b['click'](); } catch (_0x5b9356) { console[_0x3ab9ce(0x159)](_0x3ab9ce(0x621), _0x5b9356); } } function _0x286ef5() { const _0x45da78 = _0x311e9d; try { const _0x48aaed = localStorage[_0x45da78(0x8b4)](_0x45da78(0x493)); if (_0x48aaed) { if ('zohEO' === 'zohEO') { const { playlist: _0x39b4c7, currentIndex: _0x3e5c5c } = JSON['parse'](_0x48aaed); Array['isArray'](_0x39b4c7) && _0x39b4c7[_0x45da78(0x286)] > 0x0 && _0x3e5c5c > -0x1 && (_0x40321a[_0x45da78(0x2cc)] = _0x39b4c7, _0x40321a[_0x45da78(0x4bc)] = _0x3e5c5c, _0x40321a[_0x45da78(0x1b5)] = ![], _0x2ee7b0()); } else { _0x51c6a3('好友圈数据升级完成，迁移了\x20' + _0x5bd190 + _0x45da78(0x369)), _0x27e840(() => _0x2ac363['reload'](), 0x5dc); return; } } } catch (_0x1202a6) { _0x45da78(0x512) !== 'MEemB' ? _0x21ff1b[_0x45da78(0x159)](_0x45da78(0x1e3), _0x854ced) : console['error'](_0x45da78(0x7cd), _0x1202a6); } } function _0x35da82(_0x1d739a) { const _0x46aa44 = _0x311e9d; if (window['diaryPressTimer']) clearTimeout(window[_0x46aa44(0x25e)]); const _0x50b9dc = _0x1d739a[_0x46aa44(0x94)][_0x46aa44(0x64c)](_0x46aa44(0x26f)); if (!_0x50b9dc) return; const _0x37f6f2 = _0x50b9dc[_0x46aa44(0x58e)][_0x46aa44(0x375)], _0x4fccc5 = _0x50b9dc[_0x46aa44(0x1c1)][_0x46aa44(0xa1)](_0x46aa44(0x447)) ? _0x46aa44(0x447) : 'ai'; if (!_0x37f6f2) return; const _0x17288d = () => { const _0x4040b0 = _0x46aa44; if (_0x4040b0(0x452) !== _0x4040b0(0x452)) { const _0xd6ab16 = _0x1bdd44[_0x4040b0(0x239)][0x0]; _0x49b681[_0x4040b0(0x1c1)][_0x4040b0(0x65b)]('bubble-' + _0xd6ab16); } else window[_0x4040b0(0x25e)] = setTimeout(() => { const _0x2ec4ab = _0x4040b0; if (_0x1d739a[_0x2ec4ab(0x78c)] === _0x2ec4ab(0xd0)) _0x1d739a[_0x2ec4ab(0x425)](); _0x3f3e6f(parseInt(_0x37f6f2, 0xa), _0x4fccc5); }, 0x320); }, _0x100203 = () => { const _0x4418f9 = _0x46aa44; if ('gScTo' === _0x4418f9(0x744)) { if (window[_0x4418f9(0x25e)]) clearTimeout(window[_0x4418f9(0x25e)]); } else _0x449784[_0x4418f9(0x860)](), _0x2c369e(_0x30755e['id']); }; document[_0x46aa44(0x215)](_0x46aa44(0xa3), _0x100203, { 'once': !![] }), document[_0x46aa44(0x215)]('touchend', _0x100203, { 'once': !![] }), document[_0x46aa44(0x215)]('touchcancel', _0x100203, { 'once': !![] }), _0x17288d(); } function _0x3f3e6f(_0x8d6bd, _0xfc254f) { const _0x2ec916 = _0x311e9d, _0x5eb49e = _0x2ec916(0x88e) + _0x8d6bd; let _0x29be99 = document[_0x2ec916(0x3a7)](_0x5eb49e); if (_0x29be99) return; const _0x59cc91 = _0x2ec916(0x684) + _0x5eb49e + _0x2ec916(0x2d5) + (_0xfc254f === 'ai' ? _0x2ec916(0x5a3) : '') + _0x2ec916(0x64d); document[_0x2ec916(0x7ee)]['insertAdjacentHTML'](_0x2ec916(0x461), _0x59cc91); const _0x3505fd = document[_0x2ec916(0x3a7)](_0x5eb49e), _0x269c0b = () => _0x3505fd[_0x2ec916(0x47e)](); _0x3505fd[_0x2ec916(0x889)](_0x2ec916(0x635))[_0x2ec916(0x6fe)] = _0x269c0b, _0x3505fd[_0x2ec916(0x889)](_0x2ec916(0x67e))[_0x2ec916(0x6fe)] = _0x269c0b, _0x3505fd[_0x2ec916(0x889)](_0x2ec916(0x56a))[_0x2ec916(0x6fe)] = () => { const _0x4ea06b = _0x2ec916; _0x4ea06b(0x704) === 'IMlWB' ? (_0x4ea79b(), _0xc30d45('worldBook', 'worldBookEditor')) : (_0xa1914e(_0x8d6bd), _0x269c0b()); }, _0xfc254f === 'ai' && (_0x3505fd[_0x2ec916(0x889)](_0x2ec916(0x8c3))['onclick'] = () => { _0x3d6b43(_0x8d6bd), _0x269c0b(); }); } async function _0xa1914e(_0x33e802) { const _0x2157b7 = _0x311e9d, _0x2e25b6 = await _0x4849f2('确定要删除这篇日记吗？此操作不可撤销。'); if (!_0x2e25b6) return; const _0x250492 = _0x40321a['diaries'][_0x2157b7(0x226)](_0x14de24 => _0x14de24[_0x2157b7(0x769)] === _0x40321a[_0x2157b7(0x23e)]); if (!_0x250492) return; const _0x48c7e4 = _0x250492[_0x2157b7(0x27f)]['findIndex'](_0x42987 => _0x42987[_0x2157b7(0x375)] === _0x33e802); if (_0x48c7e4 > -0x1) { if (_0x2157b7(0x1bb) === _0x2157b7(0x69d)) return new _0x3ff41b(_0x46d4cb => { const _0x429e7f = _0x2157b7, _0x4dce6d = _0x429e7f(0x47f); _0xb07b3e[_0x429e7f(0x7ee)][_0x429e7f(0x6cb)](_0x429e7f(0x461), _0x4dce6d); const _0x36ffe7 = _0x49b2a5[_0x429e7f(0x3a7)](_0x429e7f(0x4b6)), _0x103f34 = _0x1b0b52[_0x429e7f(0x3a7)](_0x429e7f(0x575)), _0x1ba0cc = _0xd19bcb[_0x429e7f(0x3a7)]('diary-modal-save'), _0x49c51b = _0x1d8b05[_0x429e7f(0x3a7)](_0x429e7f(0x501)), _0x389e2e = _0x36ffe7[_0x429e7f(0x889)]('.choice-modal-backdrop'), _0x1c7ee9 = () => { _0x36ffe7['remove'](), _0x46d4cb(); }; _0x1ba0cc['onclick'] = () => { const _0x3ee45c = _0x429e7f; _0x1d28ae(_0x103f34[_0x3ee45c(0x815)]), _0x1c7ee9(); }, _0x49c51b[_0x429e7f(0x6fe)] = _0x1c7ee9, _0x389e2e[_0x429e7f(0x6fe)] = _0x1c7ee9; }); else _0x250492[_0x2157b7(0x27f)]['splice'](_0x48c7e4, 0x1), _0x544cbe(), _0x169129(), _0x1bbd68(_0x2157b7(0x1d6)); } } async function _0x3d6b43(_0x3a042a) { const _0x25ad1a = _0x311e9d, _0xe52c5 = _0x40321a[_0x25ad1a(0x7e5)][_0x25ad1a(0x226)](_0xc87914 => _0xc87914[_0x25ad1a(0x769)] === _0x40321a[_0x25ad1a(0x23e)]); if (!_0xe52c5) return; const _0x1fba42 = _0xe52c5[_0x25ad1a(0x27f)][_0x25ad1a(0xcd)](_0x4b06f8 => _0x4b06f8[_0x25ad1a(0x375)] === _0x3a042a); _0x1fba42 > -0x1 && ('WJrsa' === _0x25ad1a(0x135) ? _0x1daef3 = _0x378835[_0x25ad1a(0x92)]['name'] || '我' : (_0xe52c5[_0x25ad1a(0x27f)][_0x25ad1a(0x855)](_0x1fba42, 0x1), _0x544cbe(), _0x169129(), await _0x11adbb())); } function _0x264b16() { const _0xc24914 = _0x311e9d; if (_0xc24914(0x35a) !== 'vBOHI') { const _0x554b5e = document[_0xc24914(0x3a7)]('diary-list-container'); _0x554b5e[_0xc24914(0x49f)] = ''; const _0x245ecb = _0x40321a[_0xc24914(0x382)][_0xc24914(0x16f)](_0x791423 => _0x40321a[_0xc24914(0x478)][_0xc24914(0x204)](_0x5b6cc8 => _0x5b6cc8[_0xc24914(0x78c)] === _0xc24914(0x64f) && _0x5b6cc8[_0xc24914(0x239)][_0xc24914(0x4fe)](_0x791423['id']))); if (_0x245ecb[_0xc24914(0x286)] === 0x0) { if (_0xc24914(0x1f5) === _0xc24914(0x7b1)) _0x4b035f(_0xc24914(0x519), 'meetingList'); else { _0x554b5e[_0xc24914(0x49f)] = _0xc24914(0x52d); return; } } _0x245ecb[_0xc24914(0x436)](_0x45de8e => { const _0x521656 = _0xc24914, _0xe63a3 = document[_0x521656(0x3e8)]('li'); _0xe63a3['className'] = 'character-item', _0xe63a3['dataset'][_0x521656(0x742)] = _0x45de8e['id'], _0xe63a3[_0x521656(0x49f)] = _0x521656(0x96) + (_0x45de8e[_0x521656(0xe7)] || _0x4716b3) + _0x521656(0x643) + _0x45de8e['name'] + _0x521656(0x13a), _0xe63a3[_0x521656(0x215)](_0x521656(0x236), () => { const _0x1ce837 = _0x521656; 'xrDwG' === _0x1ce837(0xd7) ? _0x498bf2[_0x25586e[_0x524020]] = _0x5bea2f : _0x280638(_0x45de8e['id']); }), _0xe63a3[_0x521656(0x889)]('.char-info-wrapper')[_0x521656(0x215)](_0x521656(0x236), () => { _0x280638(_0x45de8e['id']); }), _0xe63a3[_0x521656(0x889)](_0x521656(0xb7))[_0x521656(0x215)]('click', _0x21a535 => { const _0x53b926 = _0x521656; _0x21a535[_0x53b926(0x860)](), _0x31c172(_0x45de8e['id']); }), _0x554b5e['appendChild'](_0xe63a3); }); } else { let _0x531314 = _0x17d809[_0xc24914(0x7e5)][_0xc24914(0x226)](_0x7120bd => _0x7120bd[_0xc24914(0x769)] === _0x1fe763); !_0x531314 && (_0x531314 = { 'characterId': _0x5b117d, 'entries': [] }, _0x5708d4[_0xc24914(0x7e5)][_0xc24914(0x1fb)](_0x531314)); _0x531314[_0xc24914(0x27f)][_0xc24914(0x1fb)]({ 'timestamp': _0x3d57f2[_0xc24914(0x6bb)](), 'author': _0x3532ff, 'content': _0x465ae0 }), _0x58ea69(); const _0x4cb68d = _0x531314[_0xc24914(0x27f)][_0xc24914(0x286)]; _0x36cd05[_0xc24914(0x8d9)] = _0x5ee2f0['ceil'](_0x4cb68d / 0x2) - 0x1, _0x4835a7(); } } function _0x280638(_0x522440) { const _0x45bd3b = _0x311e9d; if (_0x45bd3b(0x813) !== _0x45bd3b(0x813)) _0x83e6c3[_0x45bd3b(0x26b)] = _0x45bd3b(0x6ff); else { const _0x169b20 = _0x3f1cb7(_0x522440); if (!_0x169b20) return; _0x40321a[_0x45bd3b(0x23e)] = _0x522440; const _0x313051 = _0x40321a['diaries'][_0x45bd3b(0x226)](_0x475b9a => _0x475b9a[_0x45bd3b(0x769)] === _0x522440), _0x18ca8e = _0x313051 ? _0x313051[_0x45bd3b(0x27f)]['length'] : 0x0, _0x2c8d89 = 0x2; _0x40321a[_0x45bd3b(0x8d9)] = Math[_0x45bd3b(0x7d4)](0x0, Math[_0x45bd3b(0x826)](_0x18ca8e / _0x2c8d89) - 0x1), document[_0x45bd3b(0x3a7)](_0x45bd3b(0x399))[_0x45bd3b(0x26b)] = _0x169b20['name'] + _0x45bd3b(0x5b3), _0x169129(), _0x6564ff('diaryView', _0x45bd3b(0x679)); } } function _0x169129() { const _0x1b4d8a = _0x311e9d, _0x2ec879 = document[_0x1b4d8a(0x3a7)]('diary-entries-container'), _0x282cc8 = document[_0x1b4d8a(0x3a7)](_0x1b4d8a(0x73f)); _0x2ec879[_0x1b4d8a(0x49f)] = '', _0x282cc8[_0x1b4d8a(0x49f)] = ''; const _0x1eda74 = _0x4b78c8() || { 'name': '我' }, _0x10ffb0 = _0x40321a[_0x1b4d8a(0x7e5)][_0x1b4d8a(0x226)](_0x34171a => _0x34171a[_0x1b4d8a(0x769)] === _0x40321a['activeDiaryCharacterId']); if (!_0x10ffb0 || !_0x10ffb0['entries'] || _0x10ffb0[_0x1b4d8a(0x27f)][_0x1b4d8a(0x286)] === 0x0) { if ('bvfUM' === _0x1b4d8a(0x223)) { const _0x3c16a0 = _0x5b81cc['getAll'](); _0x3c16a0[_0x1b4d8a(0x61f)] = () => _0x275797(_0x3c16a0[_0x1b4d8a(0x7ba)]), _0x3c16a0[_0x1b4d8a(0x3bd)] = () => _0x4acdaf(_0x3c16a0[_0x1b4d8a(0x159)]); } else { _0x2ec879[_0x1b4d8a(0x49f)] = _0x1b4d8a(0x197), _0x282cc8[_0x1b4d8a(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', document[_0x1b4d8a(0x3a7)](_0x1b4d8a(0x182))[_0x1b4d8a(0x215)](_0x1b4d8a(0x236), _0x50db44), document[_0x1b4d8a(0x3a7)]('diary-get-reply-button')['addEventListener']('click', _0x11adbb); return; } } const _0x1941ee = 0x2, _0x4edf9a = [..._0x10ffb0['entries']][_0x1b4d8a(0x783)]((_0x1785b1, _0x5edfd7) => _0x1785b1['timestamp'] - _0x5edfd7[_0x1b4d8a(0x375)]), _0x1c3081 = []; for (let _0xdfc7e4 = 0x0; _0xdfc7e4 < _0x4edf9a[_0x1b4d8a(0x286)]; _0xdfc7e4 += _0x1941ee) { _0x1b4d8a(0x1cf) === _0x1b4d8a(0x1cf) ? _0x1c3081[_0x1b4d8a(0x1fb)](_0x4edf9a[_0x1b4d8a(0xb5)](_0xdfc7e4, _0xdfc7e4 + _0x1941ee)) : _0x3f628c += '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a'; } const _0x655767 = _0x1c3081['length']; _0x1c3081[_0x1b4d8a(0x436)]((_0x1ded98, _0x4242e4) => { const _0x3142b4 = _0x1b4d8a, _0x28f0d1 = document[_0x3142b4(0x3e8)]('div'); _0x28f0d1[_0x3142b4(0x8d8)] = _0x3142b4(0x7fe), _0x28f0d1['id'] = _0x3142b4(0x36d) + _0x4242e4, _0x4242e4 === _0x40321a[_0x3142b4(0x8d9)] && (_0x3142b4(0xd1) === 'lalED' ? _0x1b96ba['error']('Error\x20fetching\x20from\x20' + _0x445de6 + ':', _0x533fe7) : _0x28f0d1['classList'][_0x3142b4(0x65b)](_0x3142b4(0xa9))), _0x1ded98[_0x3142b4(0x436)](_0x1e1a74 => { const _0xacbc96 = _0x3142b4, _0x417d5b = _0x1e1a74['author'] === 'user' ? _0xacbc96(0x447) : 'ai', _0x38d2b8 = _0x1e1a74['author'] === _0xacbc96(0x447) ? _0x1eda74['name'] : _0x3f1cb7(_0x1e1a74[_0xacbc96(0x563)])[_0xacbc96(0x2e6)], _0x335073 = document[_0xacbc96(0x3e8)](_0xacbc96(0x8cf)); _0x335073[_0xacbc96(0x8d8)] = _0xacbc96(0x879) + _0x417d5b, _0x335073['dataset']['timestamp'] = _0x1e1a74[_0xacbc96(0x375)], _0x335073[_0xacbc96(0x27d)][_0xacbc96(0x6a6)] = _0xacbc96(0x87b), _0x335073[_0xacbc96(0x27d)][_0xacbc96(0x46f)] = '0', _0x335073[_0xacbc96(0x49f)] = _0xacbc96(0x608) + _0x38d2b8 + _0xacbc96(0xe8) + new Date(_0x1e1a74[_0xacbc96(0x375)])[_0xacbc96(0x5b6)](_0xacbc96(0x7a0)) + _0xacbc96(0x629) + _0x1e1a74[_0xacbc96(0x812)]['replace'](/\n/g, '<br>') + _0xacbc96(0x54b), _0x28f0d1[_0xacbc96(0x7d)](_0x335073); }), _0x2ec879[_0x3142b4(0x7d)](_0x28f0d1); }), _0x282cc8[_0x1b4d8a(0x49f)] = _0x1b4d8a(0x41a) + (_0x40321a[_0x1b4d8a(0x8d9)] + 0x1) + _0x1b4d8a(0x84) + _0x655767 + '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', document[_0x1b4d8a(0x3a7)](_0x1b4d8a(0x266))[_0x1b4d8a(0x313)] = _0x40321a['diaryCurrentPage'] === 0x0, document[_0x1b4d8a(0x3a7)]('diary-next-button')['disabled'] = _0x40321a['diaryCurrentPage'] === _0x655767 - 0x1, document[_0x1b4d8a(0x3a7)](_0x1b4d8a(0x266))[_0x1b4d8a(0x215)]('click', _0x38b3c6), document[_0x1b4d8a(0x3a7)](_0x1b4d8a(0x6c0))[_0x1b4d8a(0x215)](_0x1b4d8a(0x236), _0x5cafab), document[_0x1b4d8a(0x3a7)]('diary-write-button')['addEventListener'](_0x1b4d8a(0x236), _0x50db44), document['getElementById'](_0x1b4d8a(0x7ac))[_0x1b4d8a(0x215)](_0x1b4d8a(0x236), _0x11adbb); } function _0x5cafab() { const _0x48b940 = _0x311e9d; if (_0x48b940(0x73d) !== _0x48b940(0x549)) { if (_0x40321a[_0x48b940(0x8ca)]) return; const _0x4a287b = _0x40321a[_0x48b940(0x8d9)], _0x247ed1 = Math['ceil'](_0x40321a['diaries'][_0x48b940(0x226)](_0x3cfe34 => _0x3cfe34[_0x48b940(0x769)] === _0x40321a[_0x48b940(0x23e)])[_0x48b940(0x27f)]['length'] / 0x2); if (_0x4a287b >= _0x247ed1 - 0x1) return; _0x40321a[_0x48b940(0x8ca)] = !![]; const _0x374037 = _0x4a287b + 0x1, _0x334687 = document[_0x48b940(0x3a7)]('diary-page-' + _0x4a287b), _0x3a4275 = document[_0x48b940(0x3a7)]('diary-page-' + _0x374037); _0x334687 && _0x3a4275 ? (_0x3a4275['classList'][_0x48b940(0x65b)](_0x48b940(0x781)), _0x334687['classList'][_0x48b940(0x65b)](_0x48b940(0x8d7)), _0x3a4275[_0x48b940(0x1c1)][_0x48b940(0x65b)](_0x48b940(0xa9)), setTimeout(() => { const _0x4b0220 = _0x48b940; _0x334687['classList'][_0x4b0220(0x47e)](_0x4b0220(0xa9), _0x4b0220(0x8d7)), _0x3a4275[_0x4b0220(0x1c1)][_0x4b0220(0x47e)](_0x4b0220(0x781)), _0x40321a[_0x4b0220(0x8d9)] = _0x374037, _0x169129(), _0x40321a[_0x4b0220(0x8ca)] = ![]; }, 0x2bc)) : _0x40321a[_0x48b940(0x8ca)] = ![]; } else _0x398c4d['appendChild'](_0x3edc26), _0x3788be[_0x48b940(0x7d)](_0x57831b); } function _0x38b3c6() { const _0x519a4e = _0x311e9d; if (_0x519a4e(0x19e) === _0x519a4e(0x19e)) { if (_0x40321a[_0x519a4e(0x8ca)]) return; const _0x1a63bf = _0x40321a[_0x519a4e(0x8d9)]; if (_0x1a63bf <= 0x0) return; _0x40321a['isAnimatingDiary'] = !![]; const _0x47da92 = _0x1a63bf - 0x1, _0x35ad22 = document[_0x519a4e(0x3a7)](_0x519a4e(0x36d) + _0x1a63bf), _0x214dd2 = document['getElementById']('diary-page-' + _0x47da92); _0x35ad22 && _0x214dd2 ? _0x519a4e(0x12b) !== _0x519a4e(0x12b) ? _0x4746f4[_0x519a4e(0x393)][_0x519a4e(0x436)]((_0x2c24da, _0x409165) => _0xbf2f41(_0x2c24da, _0x409165)) : (_0x214dd2[_0x519a4e(0x1c1)][_0x519a4e(0x65b)](_0x519a4e(0x4fd)), _0x35ad22[_0x519a4e(0x1c1)][_0x519a4e(0x65b)](_0x519a4e(0x60d)), _0x214dd2[_0x519a4e(0x1c1)][_0x519a4e(0x65b)](_0x519a4e(0xa9)), setTimeout(() => { const _0x45faf6 = _0x519a4e; _0x35ad22['classList'][_0x45faf6(0x47e)](_0x45faf6(0xa9), 'is-exiting-right'), _0x214dd2[_0x45faf6(0x1c1)]['remove'](_0x45faf6(0x4fd)), _0x40321a[_0x45faf6(0x8d9)] = _0x47da92, _0x169129(), _0x40321a['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x40321a[_0x519a4e(0x8ca)] = ![]; } else { if (!_0xd33ce2[_0x519a4e(0x23e)]) return _0x23a682[_0x519a4e(0x7c0)][_0x519a4e(0x226)](_0x2a6e23 => _0x2a6e23['id'] === _0x3626cd[_0x519a4e(0x17e)]) || _0x52cec9[_0x519a4e(0x7c0)][0x0]; const _0x426ede = _0x29ea74[_0x519a4e(0x478)][_0x519a4e(0x226)](_0x1d17ba => _0x1d17ba[_0x519a4e(0x78c)] === _0x519a4e(0x64f) && _0x1d17ba[_0x519a4e(0x239)][_0x519a4e(0x4fe)](_0x45ee74[_0x519a4e(0x23e)])), _0xa37287 = _0x426ede?.['boundUserProfileId'] || _0x3467e9[_0x519a4e(0x17e)]; return _0x488a37[_0x519a4e(0x7c0)][_0x519a4e(0x226)](_0x4bff78 => _0x4bff78['id'] === _0xa37287) || _0x4c3e67[_0x519a4e(0x7c0)][0x0]; } } function _0x50db44() { return new Promise(_0x3b353d => { const _0x1a1d34 = _0x4fd4, _0x416f48 = _0x1a1d34(0x47f); document[_0x1a1d34(0x7ee)]['insertAdjacentHTML'](_0x1a1d34(0x461), _0x416f48); const _0x27e8b5 = document[_0x1a1d34(0x3a7)](_0x1a1d34(0x4b6)), _0x3c929f = document[_0x1a1d34(0x3a7)](_0x1a1d34(0x575)), _0x1b7947 = document[_0x1a1d34(0x3a7)](_0x1a1d34(0x474)), _0x58c08a = document['getElementById'](_0x1a1d34(0x501)), _0x4c0be8 = _0x27e8b5[_0x1a1d34(0x889)]('.choice-modal-backdrop'), _0x541aa9 = () => { const _0x41be83 = _0x1a1d34; 'GgNHS' === _0x41be83(0xf3) ? (_0x23d8b6[_0x41be83(0x8c7)] = _0x5f278e[_0x41be83(0x99)](_0x30899b), _0x3593e7[_0x41be83(0x27d)]['display'] = _0x41be83(0x7dc)) : (_0x27e8b5[_0x41be83(0x47e)](), _0x3b353d()); }; _0x1b7947[_0x1a1d34(0x6fe)] = () => { const _0x4f174a = _0x1a1d34; if ('QtJEH' !== _0x4f174a(0x75)) _0x4a9ce5(_0x3c929f['value']), _0x541aa9(); else throw new _0x3c1779('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x48888a); }, _0x58c08a[_0x1a1d34(0x6fe)] = _0x541aa9, _0x4c0be8[_0x1a1d34(0x6fe)] = _0x541aa9; }); } function _0x4a9ce5(_0x2eec53) { const _0x2a8036 = _0x311e9d, _0x763fc5 = _0x2eec53[_0x2a8036(0x3e3)](); if (!_0x763fc5 || !_0x40321a[_0x2a8036(0x23e)]) return; let _0x3324c4 = _0x40321a[_0x2a8036(0x7e5)][_0x2a8036(0x226)](_0xac83ea => _0xac83ea[_0x2a8036(0x769)] === _0x40321a[_0x2a8036(0x23e)]); !_0x3324c4 && (_0x3324c4 = { 'characterId': _0x40321a['activeDiaryCharacterId'], 'entries': [] }, _0x40321a[_0x2a8036(0x7e5)][_0x2a8036(0x1fb)](_0x3324c4)); _0x3324c4[_0x2a8036(0x27f)][_0x2a8036(0x1fb)]({ 'timestamp': Date['now'](), 'author': _0x2a8036(0x447), 'content': _0x763fc5 }), _0x544cbe(); const _0x3d113a = _0x3324c4[_0x2a8036(0x27f)][_0x2a8036(0x286)]; _0x40321a[_0x2a8036(0x8d9)] = Math[_0x2a8036(0x826)](_0x3d113a / 0x2) - 0x1, _0x169129(); } async function _0x11adbb() { const _0x51543f = _0x311e9d, _0x3f774a = _0x40321a['diaries'][_0x51543f(0x226)](_0x5cd9ae => _0x5cd9ae[_0x51543f(0x769)] === _0x40321a['activeDiaryCharacterId']), _0x9e1253 = _0x40321a[_0x51543f(0x23e)], _0x53d4a4 = _0x3f1cb7(_0x9e1253); if (!_0x53d4a4 || _0x40321a[_0x51543f(0x160)]) return; _0x3396e7(!![], _0x51543f(0x263)), _0x40321a[_0x51543f(0x160)] = !![]; let _0x478c79 = []; try { const _0x43cbc0 = _0x4b78c8() || { 'name': '你' }, _0x442ca1 = _0x38da7e(_0x9e1253), { omniText: _0x5047e4 } = _0x4fa46e(_0x9e1253, _0x40321a['activeChatId']); let _0x43798e = ''; if (_0x53d4a4['linkedWorldBookIds'] && _0x53d4a4[_0x51543f(0x3d5)]['length'] > 0x0) { if (_0x51543f(0x7fb) !== _0x51543f(0x7a5)) { const _0x1d49ae = _0x53d4a4[_0x51543f(0x3d5)][_0x51543f(0x7cc)](_0x10ac4f => _0x40321a[_0x51543f(0x5e7)][_0x51543f(0x226)](_0x5a6b1e => _0x5a6b1e['id'] === _0x10ac4f))[_0x51543f(0x16f)](Boolean)[_0x51543f(0x7cc)](_0x3e0ec9 => '\x0a\x0a##\x20世界书条目:\x20' + _0x3e0ec9[_0x51543f(0x2e6)] + '\x0a' + _0x3e0ec9[_0x51543f(0x812)])['join'](''); if (_0x1d49ae) _0x43798e = _0x51543f(0x343) + _0x1d49ae; } else _0x149620['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x47793a + _0x51543f(0x2ef) + _0x697334[_0x51543f(0x4de)] + _0x51543f(0x4c7) + _0x5414c7[_0x51543f(0x45d)] + _0x51543f(0x7fa); } const _0xd7fbe1 = _0x43cbc0[_0x51543f(0x838)] ? _0x51543f(0x15d) + _0x43cbc0[_0x51543f(0x2e6)] + _0x51543f(0x8a3) + _0x43cbc0['persona'] : '', _0x12fe69 = _0x5bc7c6(); let _0x4e5641 = '你还没有写日记。'; if (_0x3f774a && _0x3f774a[_0x51543f(0x27f)]) { const _0x5a0688 = _0x3f774a[_0x51543f(0x27f)][_0x51543f(0x16f)](_0x15a5a8 => _0x15a5a8[_0x51543f(0x563)] === 'user')['pop'](); _0x5a0688 && (_0x4e5641 = _0x5a0688[_0x51543f(0x812)]); } const _0x34592c = _0x51543f(0x741) + _0x53d4a4[_0x51543f(0x2e6)] + _0x51543f(0x548) + _0x43cbc0[_0x51543f(0x2e6)] + _0x51543f(0x149) + _0x43cbc0['name'] + _0x51543f(0x66f) + _0x4e5641 + _0x51543f(0x32f) + _0x53d4a4[_0x51543f(0x838)] + '\x0a' + _0xd7fbe1 + '\x0a' + _0x43798e + _0x51543f(0x854) + new Date()['toLocaleString'](_0x51543f(0x7a0), { 'dateStyle': _0x51543f(0x8c), 'timeStyle': _0x51543f(0x555) }) + _0x51543f(0x2f7) + _0x5ea1f0(new Date(_0x3f774a?.[_0x51543f(0x27f)]?.['at'](-0x1)?.['timestamp'] || Date['now']())) + _0x51543f(0x1df) + (_0x5047e4 || '最近没有互动记录。') + '\x0a---\x0a##\x20最近的朋友圈动态\x0a' + (_0x12fe69 || _0x51543f(0x22e)) + '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。'; _0x478c79 = [{ 'role': _0x51543f(0x70d), 'content': _0x34592c }, { 'role': _0x51543f(0x447), 'content': _0x51543f(0x719) }]; const _0x2e689e = await _0x56cc62(_0x478c79); if (_0x2e689e) { let _0x242afc = _0x40321a[_0x51543f(0x7e5)][_0x51543f(0x226)](_0x4e3f9a => _0x4e3f9a[_0x51543f(0x769)] === _0x9e1253); !_0x242afc && ('AURFn' === _0x51543f(0x490) ? (_0x7f76f8[_0x51543f(0x425)](), _0x2ded61()) : (_0x242afc = { 'characterId': _0x9e1253, 'entries': [] }, _0x40321a[_0x51543f(0x7e5)][_0x51543f(0x1fb)](_0x242afc))); _0x242afc[_0x51543f(0x27f)]['push']({ 'timestamp': Date['now'](), 'author': _0x9e1253, 'content': _0x2e689e }), _0x544cbe(); const _0x1975e7 = _0x242afc[_0x51543f(0x27f)]['length']; _0x40321a[_0x51543f(0x8d9)] = Math['ceil'](_0x1975e7 / 0x2) - 0x1, _0x169129(); } } catch (_0x5b7a48) { _0x1bbd68('生成日记失败:\x20' + _0x5b7a48[_0x51543f(0x15a)]); } finally { if ('oGKyX' === _0x51543f(0x4b2)) { _0x24dec7[_0x51543f(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>'; return; } else _0x3396e7(![]), _0x40321a[_0x51543f(0x160)] = ![]; } } function _0x46828b() { const _0x525554 = _0x311e9d, _0x4f751c = document[_0x525554(0x3a7)]('meeting-scene-view'), _0x3525e9 = document[_0x525554(0x3a7)]('galgame-view-container'), _0x11cd40 = document[_0x525554(0x889)](_0x525554(0x5b2)); _0x40321a['meetingViewMode'] === _0x525554(0x293) ? 'MriGY' === _0x525554(0x807) ? _0x46aa91[_0x525554(0x3d5)] && (_0x3b45e5[_0x525554(0x3d5)] = _0x57f3f6[_0x525554(0x3d5)][_0x525554(0x16f)](_0x4c5b45 => _0x4c5b45 !== _0x398680)) : (_0x4f751c['style'][_0x525554(0x5a4)] = _0x525554(0x87b), _0x3525e9[_0x525554(0x27d)][_0x525554(0x5a4)] = 'block') : (_0x4f751c[_0x525554(0x27d)]['display'] = _0x525554(0x7dc), _0x3525e9[_0x525554(0x27d)][_0x525554(0x5a4)] = _0x525554(0x87b)), _0x11cd40[_0x525554(0x27d)][_0x525554(0x5a4)] = _0x525554(0x7dc); } function _0x104d57() { const _0x1f624b = _0x311e9d, _0x59dccb = document['getElementById']('galgame-speaker'), _0x5db446 = document[_0x1f624b(0x3a7)](_0x1f624b(0x76e)); if (_0x40321a['activeMeetingScriptQueue'][_0x1f624b(0x286)] > 0x0) { if ('RnLnt' === _0x1f624b(0x303)) { const _0x41e047 = _0x40321a[_0x1f624b(0x38b)][_0x1f624b(0x9b)](); _0x59dccb[_0x1f624b(0x26b)] = _0x41e047[_0x1f624b(0x244)] === 'narrator' ? '旁白' : _0x41e047[_0x1f624b(0x244)], _0x5db446['textContent'] = _0x41e047[_0x1f624b(0x175)], _0x41e047['speaker'] !== _0x1f624b(0x37f) && _0x347506(_0x40321a['activeMeetingCharId'], _0x41e047[_0x1f624b(0x81b)]); } else return _0x5c1638[_0x1f624b(0x23c)](_0x5f3ea7, _0x2c6f55 + 0x1); } else { const _0x2778b5 = _0x40321a[_0x1f624b(0x779)][_0x40321a[_0x1f624b(0x574)]]; if (_0x2778b5 && _0x2778b5[_0x1f624b(0x286)] > 0x0) { if (_0x1f624b(0x2d2) === 'hGRPe') { _0x40321a[_0x1f624b(0x38b)] = [..._0x2778b5]; const _0x2a47ea = _0x40321a['activeMeetingScriptQueue']['shift'](); _0x59dccb[_0x1f624b(0x26b)] = _0x2a47ea[_0x1f624b(0x244)] === _0x1f624b(0x37f) ? '旁白' : _0x2a47ea[_0x1f624b(0x244)], _0x5db446[_0x1f624b(0x26b)] = _0x2a47ea[_0x1f624b(0x175)], _0x2a47ea[_0x1f624b(0x244)] !== _0x1f624b(0x37f) && _0x347506(_0x40321a[_0x1f624b(0x574)], _0x2a47ea[_0x1f624b(0x81b)]); } else _0x9c5afa(_0xa2b55d); } else _0x59dccb[_0x1f624b(0x26b)] = '旁白', _0x5db446['textContent'] = '（对话结束）'; } } async function _0x347506(_0xd74097, _0x5d7ff1) { const _0x5306ee = _0x311e9d, _0x115dd2 = document[_0x5306ee(0x3a7)](_0x5306ee(0x363)), _0x10d37d = document['getElementById'](_0x5306ee(0x6b)), _0x4b9c68 = _0x3f1cb7(_0xd74097), _0xc92410 = _0x4b9c68?.[_0x5306ee(0x24e)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x49f669 = 0x50 * _0xc92410['scale']; _0x10d37d[_0x5306ee(0x27d)][_0x5306ee(0x2df)] = _0x49f669 + '%', _0x10d37d[_0x5306ee(0x27d)][_0x5306ee(0x3bb)] = _0x49f669 + '%', _0x10d37d[_0x5306ee(0x27d)][_0x5306ee(0x40d)] = _0xc92410['x'] + '%', _0x10d37d[_0x5306ee(0x27d)]['top'] = _0xc92410['y'] + '%', _0x10d37d[_0x5306ee(0x27d)]['transform'] = _0x5306ee(0x652), _0x10d37d[_0x5306ee(0x27d)]['bottom'] = 'auto'; const _0x2e268a = [_0x5306ee(0x4d6), _0x5306ee(0x6f7), _0x5306ee(0x1eb), _0x5306ee(0x1a5), _0x5306ee(0x5e3)], _0x4371a5 = _0x2e268a[_0x5306ee(0x4fe)](_0x5d7ff1) ? _0x5d7ff1 : _0x5306ee(0x4d6); try { const _0x1f6747 = await _0x500f4d(_0x5306ee(0x3cc) + _0x4371a5 + '_' + _0xd74097); if (_0x1f6747) { if ('MMwGj' === _0x5306ee(0x8c4)) { if (_0x115dd2[_0x5306ee(0x8c7)] && _0x115dd2['style'][_0x5306ee(0x3ab)] !== '0') { if (_0x5306ee(0x5ef) !== 'YlsmY') { _0x13e33e('请先输入\x20API\x20接口地址和密钥。'); return; } else _0x115dd2[_0x5306ee(0x27d)][_0x5306ee(0x3ab)] = 0x0, setTimeout(() => { const _0x2419bd = _0x5306ee; _0x115dd2[_0x2419bd(0x8c7)] = URL[_0x2419bd(0x99)](_0x1f6747), _0x115dd2[_0x2419bd(0x27d)][_0x2419bd(0x3ab)] = 0x1; }, 0x96); } else _0x115dd2[_0x5306ee(0x8c7)] = URL[_0x5306ee(0x99)](_0x1f6747), _0x115dd2['style'][_0x5306ee(0x3ab)] = 0x1; } else _0x5e134a[_0x5306ee(0x159)](_0x5306ee(0x138) + _0x190da3 + ':', _0x410036), _0x3f88a1['style'][_0x5306ee(0xb3)] = _0x5306ee(0x87b); } else { const _0x1be3a0 = await _0x500f4d(_0x5306ee(0xd3) + _0xd74097); _0x115dd2[_0x5306ee(0x8c7)] = _0x1be3a0 ? URL['createObjectURL'](_0x1be3a0) : ''; } } catch (_0x10c338) { _0x5306ee(0x1fa) !== _0x5306ee(0x1fa) ? _0x1ecf0d(() => { const _0x402639 = _0x5306ee, _0x4bfaba = _0x22d241[_0x402639(0x3a7)](_0x31fbaf); if (_0x4bfaba) _0x4bfaba[_0x402639(0x8c7)] = _0x50d229[_0x402639(0x102)]; }, 0x0) : (console[_0x5306ee(0x159)](_0x5306ee(0x77d), _0x10c338), _0x115dd2[_0x5306ee(0x8c7)] = ''); } } let _0x195a43 = ![], _0x3acca6 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x3e304c = document[_0x311e9d(0x3a7)]('sprite-adjust-button'), _0xfa9a95 = document[_0x311e9d(0x3a7)](_0x311e9d(0x623)), _0x5242e6 = document[_0x311e9d(0x3a7)](_0x311e9d(0xda)), _0x578b6d = document[_0x311e9d(0x3a7)](_0x311e9d(0x751)), _0x5491c3 = document[_0x311e9d(0x3a7)]('galgame-sprite-controls'), _0x53d578 = document[_0x311e9d(0x3a7)](_0x311e9d(0x6b)), _0x246cb4 = document[_0x311e9d(0x3a7)]('sprite-resize-handle'), _0x2db4ef = document[_0x311e9d(0x3a7)](_0x311e9d(0x8b6)); let _0x586518 = {}; function _0xa1db0b() { const _0x5093de = _0x311e9d, _0x22fbf2 = _0x3f1cb7(_0x40321a[_0x5093de(0x574)]); if (!_0x22fbf2) return; _0x195a43 = !![], _0x5491c3['style'][_0x5093de(0x5a4)] = 'block'; const _0x3c30d3 = _0x22fbf2[_0x5093de(0x24e)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x5093de(0x3a7)](_0x5093de(0x558))[_0x5093de(0x815)] = _0x3c30d3['x'], document[_0x5093de(0x3a7)](_0x5093de(0x526))[_0x5093de(0x815)] = _0x3c30d3['y'], document[_0x5093de(0x3a7)](_0x5093de(0x43a))['value'] = _0x3c30d3[_0x5093de(0x552)] * 0x64, _0x586518 = { ..._0x3c30d3 }, document[_0x5093de(0x3a7)](_0x5093de(0x9a))[_0x5093de(0x27d)][_0x5093de(0x5a4)] = 'none', document[_0x5093de(0x3a7)](_0x5093de(0xf8))[_0x5093de(0x27d)]['display'] = _0x5093de(0x87b); } function _0x281a71(_0x429c49 = ![]) { const _0x4d8e3d = _0x311e9d; if ('daMWH' === 'daMWH') { _0x195a43 = ![], _0x5491c3[_0x4d8e3d(0x27d)][_0x4d8e3d(0x5a4)] = _0x4d8e3d(0x87b), document[_0x4d8e3d(0x3a7)](_0x4d8e3d(0x9a))['style'][_0x4d8e3d(0x5a4)] = _0x4d8e3d(0x7dc), document[_0x4d8e3d(0x3a7)](_0x4d8e3d(0xf8))[_0x4d8e3d(0x27d)][_0x4d8e3d(0x5a4)] = 'block'; if (!_0x429c49) { if (_0x4d8e3d(0x8a5) !== _0x4d8e3d(0x29c)) { const _0x5f0775 = _0x3f1cb7(_0x40321a[_0x4d8e3d(0x574)]); _0x5f0775 && (_0x4d8e3d(0x76a) !== _0x4d8e3d(0x6e9) ? (_0x5f0775[_0x4d8e3d(0x24e)] = _0x586518, _0x347506(_0x40321a[_0x4d8e3d(0x574)], _0x4d8e3d(0x4d6))) : _0x4d791d[_0x4d8e3d(0x7f8)]()); } else { if (!_0x41b2f9) return []; const _0x2e9c25 = _0xa5242(_0x576b64)[_0x4d8e3d(0x3e3)](), _0x22de9c = _0x2e9c25[_0x4d8e3d(0x480)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x4d8e3d(0x7cc)](_0x4270e9 => _0x4270e9[_0x4d8e3d(0x3e3)]())['filter'](_0x88df3d); if (_0x22de9c[_0x4d8e3d(0x286)] > 0x0) return _0x22de9c['slice'](0x0, 0x9); return [_0x2e9c25][_0x4d8e3d(0x16f)](_0x1f10ad); } } } else !_0x596bda[_0x4d8e3d(0x1c1)][_0x4d8e3d(0xa1)]('load-more-btn') && _0x1d2594[_0x4d8e3d(0x47e)](); } function _0x162f33() { const _0x3e3bee = _0x311e9d; if (_0x3e3bee(0x76f) === 'VVXxm') { const _0x1ebec0 = _0x3f1cb7(_0x40321a[_0x3e3bee(0x574)]); if (!_0x1ebec0) return; const _0x2e2bb5 = parseFloat(document[_0x3e3bee(0x3a7)](_0x3e3bee(0x558))[_0x3e3bee(0x815)]), _0x271c78 = parseFloat(document[_0x3e3bee(0x3a7)](_0x3e3bee(0x526))['value']), _0x414a00 = parseFloat(document[_0x3e3bee(0x3a7)](_0x3e3bee(0x43a))['value']) / 0x64; _0x1ebec0[_0x3e3bee(0x24e)] = { 'x': _0x2e2bb5, 'y': _0x271c78, 'scale': _0x414a00 }, _0x544cbe(), _0x1bbd68('哼，就按你说的办好了。'), _0x281a71(!![]); } else _0x2907a6(![]), _0x44b014['error'](_0x3e3bee(0x727), _0x46b0f4), _0x45321a('上传失败了，笨蛋！\x20' + _0x2d7c1c['message']); } function _0x1d2274() { const _0x5eb7ae = _0x311e9d; if ('fKxns' === _0x5eb7ae(0x387)) _0x4849f2(_0x5eb7ae(0x468))[_0x5eb7ae(0x3fa)](_0x24baa5 => { const _0x26b38a = _0x5eb7ae; if (_0x24baa5) { if (_0x26b38a(0x538) !== _0x26b38a(0x538)) _0x32b043[_0x26b38a(0x27d)][_0x26b38a(0x5a4)] = _0x26b38a(0x87b); else { const _0x21fbb3 = _0x3f1cb7(_0x40321a[_0x26b38a(0x574)]); _0x21fbb3 && (delete _0x21fbb3[_0x26b38a(0x24e)], _0x544cbe(), _0x347506(_0x21fbb3['id'], _0x26b38a(0x4d6)), _0x1bbd68('已恢复默认。'), _0x281a71(!![])); } } }); else { const _0xacded8 = _0xb2425e(_0x5aed39), _0x66888c = _0x38b9a3[_0x5eb7ae(0x3a7)]('chat-view-pane'); _0x66888c[_0x5eb7ae(0x27d)]['backgroundImage'] = ''; let _0x2cc50f = _0x2069d7[_0x5eb7ae(0x3a7)](_0x5eb7ae(0x5d0) + _0x456685); if (_0x2cc50f) _0x2cc50f[_0x5eb7ae(0x49f)] = ''; if (!_0xacded8) return; _0xacded8['chatWallpaper'] && (_0x66888c[_0x5eb7ae(0x27d)]['backgroundImage'] = _0x5eb7ae(0x3dd) + _0xacded8[_0x5eb7ae(0x459)] + '\x27)', _0x66888c['style'][_0x5eb7ae(0x4b0)] = _0x5eb7ae(0x59e), _0x66888c[_0x5eb7ae(0x27d)][_0x5eb7ae(0x424)] = 'center'); if (_0xacded8['bubbleCss']) { let _0x3ef0c6 = _0x19a3c8[_0x5eb7ae(0x3a7)]('style-' + _0xacded8['id']); !_0x3ef0c6 && (_0x3ef0c6 = _0x1ebf00['createElement'](_0x5eb7ae(0x27d)), _0x3ef0c6['id'] = _0x5eb7ae(0x5d0) + _0xacded8['id'], _0x54872f[_0x5eb7ae(0x7ae)][_0x5eb7ae(0x7d)](_0x3ef0c6)); const _0x22cb50 = _0xacded8['bubbleCss'], _0x2d9b08 = _0x22cb50[_0x5eb7ae(0x3d9)](/\.bubble\.sent/g, _0x5eb7ae(0x72b) + _0xacded8['id'] + _0x5eb7ae(0x792))[_0x5eb7ae(0x3d9)](/\.bubble\.received/g, _0x5eb7ae(0x72b) + _0xacded8['id'] + _0x5eb7ae(0x63d)); _0x3ef0c6[_0x5eb7ae(0x49f)] = _0x2d9b08; } } } function _0x5b2383() { const _0x13e143 = _0x311e9d; if (_0x13e143(0x7a9) === _0x13e143(0x7a9)) { if (!_0x195a43) return; const _0xcb3c08 = _0x40321a['activeMeetingCharId'], _0x401418 = _0x3f1cb7(_0xcb3c08); if (!_0x401418) return; const _0x1f8d7f = parseFloat(document[_0x13e143(0x3a7)](_0x13e143(0x558))[_0x13e143(0x815)]), _0x27d57f = parseFloat(document[_0x13e143(0x3a7)](_0x13e143(0x526))[_0x13e143(0x815)]), _0x4393e9 = parseFloat(document[_0x13e143(0x3a7)](_0x13e143(0x43a))[_0x13e143(0x815)]) / 0x64; _0x401418[_0x13e143(0x24e)] = { 'x': _0x1f8d7f, 'y': _0x27d57f, 'scale': _0x4393e9 }; const _0x121322 = document[_0x13e143(0x3a7)](_0x13e143(0x6b)), _0x55872f = 0x50 * _0x4393e9; _0x121322[_0x13e143(0x27d)]['height'] = _0x55872f + '%', _0x121322[_0x13e143(0x27d)][_0x13e143(0x3bb)] = _0x55872f + '%', _0x121322[_0x13e143(0x27d)][_0x13e143(0x40d)] = _0x1f8d7f + '%', _0x121322['style']['top'] = _0x27d57f + '%', _0x121322[_0x13e143(0x27d)]['transform'] = _0x13e143(0x652); } else _0x2ee124[_0x13e143(0x860)](), _0x3e0486[_0x13e143(0x1c1)]['toggle'](_0x13e143(0x702)), _0x437ff5[_0x13e143(0x1c1)][_0x13e143(0x676)](_0x13e143(0x3e9)); } document['getElementById'](_0x311e9d(0x558))[_0x311e9d(0x215)](_0x311e9d(0x54c), _0x5b2383), document[_0x311e9d(0x3a7)](_0x311e9d(0x526))[_0x311e9d(0x215)](_0x311e9d(0x54c), _0x5b2383), document[_0x311e9d(0x3a7)](_0x311e9d(0x43a))[_0x311e9d(0x215)]('input', _0x5b2383), _0x3e304c['addEventListener']('click', _0xa1db0b), _0xfa9a95[_0x311e9d(0x215)]('click', _0x162f33), _0x5242e6[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x281a71(![])), _0x578b6d[_0x311e9d(0x215)]('click', _0x1d2274); function _0x1eb237(_0xbc76c8) { const _0x464515 = _0x311e9d, _0x2f1162 = _0x3f1cb7(_0xbc76c8); if (!_0x2f1162) return; const _0x28c6b4 = _0x40321a[_0x464515(0x478)][_0x464515(0x226)](_0x465df3 => _0x465df3[_0x464515(0x78c)] === 'private' && _0x465df3[_0x464515(0x239)][_0x464515(0x4fe)](_0xbc76c8)), _0x3e6f1a = _0x9333e5(_0x28c6b4['id']), _0x2f57af = _0x40321a[_0x464515(0x393)][_0x464515(0x16f)](_0x2686a0 => _0x2686a0[_0x464515(0x7ec)])['pop'](), _0x31f998 = document[_0x464515(0x3a7)](_0x464515(0x627)), _0x23b7b4 = document['getElementById'](_0x464515(0x76e)); let _0x14269b = null; if (_0x2f57af) { if (_0x2f57af[_0x464515(0x837)] === _0x464515(0x18d)) { const _0x49fdf4 = _0x40321a['characterLastScripts'][_0xbc76c8]; _0x49fdf4 && _0x49fdf4[_0x464515(0x286)] > 0x0 && (_0x14269b = _0x49fdf4['at'](-0x1)); } else _0x464515(0x2be) === _0x464515(0x2be) ? _0x14269b = { 'speaker': _0x3e6f1a[_0x464515(0x2e6)], 'line': _0x2f57af['content'], 'emotion': _0x464515(0x4d6) } : _0x3f8910 = _0x1e4db8['parse'](_0x1cb8ab); } if (_0x14269b) { if ('FEzNa' === _0x464515(0xc1)) { const _0x2b0b33 = { 'id': _0x464515(0x857) + _0x4c3761[_0x464515(0x375)], 'url': _0x3664d8[_0x464515(0x89c)] }; _0x5c9560(this, _0x2b0b33); } else _0x31f998[_0x464515(0x26b)] = _0x14269b[_0x464515(0x244)] === _0x464515(0x37f) ? '旁白' : _0x14269b[_0x464515(0x244)], _0x23b7b4[_0x464515(0x26b)] = _0x14269b['line'], _0x14269b['speaker'] === _0x2f1162[_0x464515(0x2e6)] ? _0x347506(_0xbc76c8, _0x14269b['emotion']) : _0x347506(_0xbc76c8, _0x464515(0x4d6)); } else _0x464515(0x319) !== _0x464515(0x6e6) ? (_0x31f998[_0x464515(0x26b)] = _0x2f1162['name'], _0x23b7b4[_0x464515(0x26b)] = _0x464515(0x2c4), _0x347506(_0xbc76c8, 'normal')) : _0x492edc(_0x1c6d1a, _0x464515(0x4d6)); } function _0x3a6fd9() { const _0x523c7d = _0x311e9d, _0x3f1607 = new Date(), _0x2dd473 = document[_0x523c7d(0x3a7)]('galgame-time'), _0x5d1456 = document['getElementById'](_0x523c7d(0x8f)); if (_0x2dd473 && _0x5d1456) { const _0xde8afd = String(_0x3f1607[_0x523c7d(0x499)]())[_0x523c7d(0x26e)](0x2, '0'), _0x23c171 = String(_0x3f1607[_0x523c7d(0x46a)]())['padStart'](0x2, '0'); _0x2dd473['textContent'] = _0xde8afd + ':' + _0x23c171; const _0x1bce8b = _0x3f1607[_0x523c7d(0x1a1)]() + 0x1, _0xaed12d = _0x3f1607['getDate'](), _0x46766d = ['星期日', _0x523c7d(0x3d4), _0x523c7d(0x14e), '星期三', _0x523c7d(0x128), '星期五', _0x523c7d(0x6a3)][_0x3f1607['getDay']()]; _0x5d1456['textContent'] = _0x1bce8b + '月' + _0xaed12d + '日\x20' + _0x46766d; } } const _0x6d84fc = document['getElementById']('listen-together-modal'), _0x2dca4b = document[_0x311e9d(0x3a7)](_0x311e9d(0x7e1)), _0x3246e4 = document[_0x311e9d(0x3a7)]('cancel-listen-together'), _0x5d25ef = document[_0x311e9d(0x3a7)](_0x311e9d(0x894)), _0x42864a = document[_0x311e9d(0x3a7)](_0x311e9d(0x4d0)), _0x77bdcd = document[_0x311e9d(0x3a7)](_0x311e9d(0x6cf)), _0xa8d7f7 = document['getElementById'](_0x311e9d(0x371)), _0x5170b8 = document[_0x311e9d(0x3a7)](_0x311e9d(0x77e)), _0x56ef22 = document[_0x311e9d(0x3a7)]('lt-ui-lyrics-container'); let _0x1bb571 = []; async function _0x2de131() { const _0x4a795b = _0x311e9d; if (_0x4a795b(0x609) === _0x4a795b(0x609)) { if (!_0x40321a[_0x4a795b(0x1cc)]) return; _0x42864a[_0x4a795b(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', _0x6d84fc[_0x4a795b(0x1c1)][_0x4a795b(0x65b)](_0x4a795b(0x7de)); const _0x20442b = await _0x2ed83b(); if (_0x20442b[_0x4a795b(0x286)] === 0x0) { if (_0x4a795b(0x840) !== _0x4a795b(0xd4)) { _0x42864a[_0x4a795b(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } else { const _0x25ef89 = _0x5b2f78[_0x4a795b(0x3a7)](_0x4a795b(0x1a4)), _0x5cf115 = _0x242289[_0x4a795b(0x3a7)]('expense-amount'), _0x29733d = _0x25ef89['value'][_0x4a795b(0x3e3)](), _0xd9a54d = _0x1fc44b(_0x5cf115[_0x4a795b(0x815)]); if (!_0x29733d || _0x326275(_0xd9a54d) || _0xd9a54d <= 0x0) { _0xc48ff2(_0x4a795b(0x848)); return; } _0x46bdc6['accountingData'][_0x4a795b(0x1fb)]({ 'id': 'exp_' + _0x1e3e85[_0x4a795b(0x6bb)](), 'description': _0x29733d, 'amount': _0xd9a54d, 'timestamp': _0x47a8b5[_0x4a795b(0x6bb)]() }), _0x34ff66(), _0x4fe2d8(), _0x25ef89[_0x4a795b(0x815)] = '', _0x5cf115[_0x4a795b(0x815)] = '', _0x25ef89['focus'](); } } _0x42864a[_0x4a795b(0x49f)] = '', _0x20442b[_0x4a795b(0x436)](_0x3e97da => { const _0x515a72 = _0x4a795b, _0x48da53 = document['createElement'](_0x515a72(0x8cf)); _0x48da53[_0x515a72(0x8d8)] = _0x515a72(0x4af); const _0x5a0035 = _0x3e97da[_0x515a72(0x59e)] ? URL[_0x515a72(0x99)](_0x3e97da[_0x515a72(0x59e)]) : _0x4716b3; _0x48da53['innerHTML'] = _0x515a72(0x24b) + _0x5a0035 + _0x515a72(0x15e) + (_0x3e97da[_0x515a72(0x8df)][_0x515a72(0x722)] || '未知歌曲') + _0x515a72(0x306) + (_0x3e97da['info']['歌手'] || '未知艺术家') + _0x515a72(0x79b), _0x48da53[_0x515a72(0x215)](_0x515a72(0x236), () => { _0x1be284(_0x3e97da); }), _0x42864a[_0x515a72(0x7d)](_0x48da53); }); } else { const _0x4f0931 = { 'quotedMessage': null, 'content': _0x50c0b8 }, _0x2e5731 = _0x4c6368[_0x4a795b(0x33f)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x2e5731 && (_0x4f0931['quotedMessage'] = { 'sender': _0x2e5731[0x1][_0x4a795b(0x3e3)](), 'content': _0x2e5731[0x2][_0x4a795b(0x3e3)]() }, _0x4f0931[_0x4a795b(0x812)] = _0x1ecbdc['substring'](_0x2e5731[0x0][_0x4a795b(0x286)])[_0x4a795b(0x3e3)]()), _0x4f0931; } } function _0x2c4658() { const _0xb9eaf2 = _0x311e9d; _0x6d84fc[_0xb9eaf2(0x1c1)]['remove'](_0xb9eaf2(0x7de)); } async function _0x1be284(_0x34274b) { const _0x439971 = _0x311e9d; if (!_0x40321a[_0x439971(0x1cc)] || !_0x34274b) return; let _0x3efe70 = null; if (_0x34274b[_0x439971(0x59e)]) try { _0x3efe70 = _0x439971(0x62d) + Date[_0x439971(0x6bb)]() + '_' + Math[_0x439971(0x775)](), await _0x5c7ad7(_0x3efe70, _0x34274b[_0x439971(0x59e)]); } catch (_0x38421a) { console['error'](_0x439971(0x39b), _0x38421a); } const _0x892a79 = { 'role': _0x439971(0x447), 'type': 'listen-together-invite', 'content': _0x439971(0x5f7) + _0x34274b[_0x439971(0x8df)][_0x439971(0x722)] + ']', 'songId': _0x34274b['id'], 'songName': _0x34274b[_0x439971(0x8df)][_0x439971(0x722)], 'artist': _0x34274b[_0x439971(0x8df)]['歌手'], 'coverId': _0x3efe70, 'timestamp': Date['now']() }; _0x40321a[_0x439971(0x393)][_0x439971(0x1fb)](_0x892a79), _0x174e50(), _0x259a7d(), _0x2c4658(), setTimeout(_0x5c5350, 0x64); } _0x2dca4b[_0x311e9d(0x215)](_0x311e9d(0x236), _0x2de131), _0x3246e4[_0x311e9d(0x215)](_0x311e9d(0x236), _0x2c4658), _0x5d25ef['addEventListener']('click', _0x2c4658); async function _0x58fca2(_0x5cea12, _0x5670f2, _0x2f7d57) { const _0x35f438 = _0x311e9d; if (_0x35f438(0x240) === _0x35f438(0x2c7)) _0x26240f[_0x35f438(0x159)](_0x35f438(0x6af), _0x5d7494); else { const _0x7e92e7 = _0x40321a[_0x35f438(0x478)]['find'](_0x3e3dc2 => _0x3e3dc2[_0x35f438(0x4c5)] && _0x3e3dc2['activeListenSession'][_0x35f438(0x219)]), _0xdc2b59 = _0x4db4a7(); if (_0x7e92e7 && _0x7e92e7['id'] !== _0xdc2b59['id']) _0x7e92e7[_0x35f438(0x4c5)] = null, _0x1bbd68(_0x35f438(0x54a)), _0x544cbe(); else { if (_0x7e92e7 && _0x7e92e7['id'] === _0xdc2b59['id']) { if (_0x35f438(0x820) !== _0x35f438(0x648)) _0x1bbd68(_0x35f438(0x1de)); else return _0x470533 + '分钟前'; } } _0x3396e7(!![], _0x35f438(0x805)); if (!_0xdc2b59) { if (_0x35f438(0x572) === _0x35f438(0x572)) { _0x3396e7(![]), _0x1bbd68(_0x35f438(0x594)); return; } else { const _0x2d39e2 = _0x453e2a(_0x101f57[_0x35f438(0x2b9)] || _0x308f6e[_0x35f438(0x574)]); _0x20d202 = _0x2d39e2?.['name'] || '角色', _0x5225d2 = _0x35f438(0x71); } } const _0x33d5aa = await _0x344a0a(_0x5cea12); if (!_0x33d5aa) { _0x3396e7(![]), _0x1bbd68('错误：找不到这首作为“信物”的歌。'); return; } _0xdc2b59['activeListenSession'] = { 'isActive': !![], 'songId': _0x5cea12, 'leaderId': _0x35f438(0x447), 'songName': _0x33d5aa[_0x35f438(0x8df)][_0x35f438(0x722)], 'artist': _0x33d5aa['info']['歌手'], 'cover': _0x33d5aa[_0x35f438(0x59e)] }, _0x544cbe(), document[_0x35f438(0x3a7)]('lt-ui-cover-art')[_0x35f438(0x8c7)] = _0x33d5aa[_0x35f438(0x59e)] ? URL['createObjectURL'](_0x33d5aa[_0x35f438(0x59e)]) : _0x4716b3, document[_0x35f438(0x3a7)](_0x35f438(0x562))[_0x35f438(0x26b)] = _0x33d5aa['info'][_0x35f438(0x722)], document[_0x35f438(0x3a7)](_0x35f438(0x83a))[_0x35f438(0x26b)] = _0x33d5aa['info']['歌手'], _0x388eec(_0x33d5aa), _0xa8d7f7['style'][_0x35f438(0x5a4)] = _0x35f438(0x564), setTimeout(() => _0xa8d7f7[_0x35f438(0x1c1)][_0x35f438(0x65b)](_0x35f438(0x7de)), 0xa), _0x2f7d57[_0x35f438(0x49f)] = '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>' + _0x2f7d57[_0x35f438(0x889)](_0x35f438(0x46e))['outerHTML'], _0x40321a[_0x35f438(0x393)][_0x5670f2] && (_0x40321a[_0x35f438(0x393)][_0x5670f2][_0x35f438(0x754)] = !![], _0x174e50()), _0x3396e7(![]), _0x3eea24(_0x5cea12, [_0x5cea12]), _0x5d1f29(_0x33d5aa, !![]); } } function _0xae7e03() { const _0xbac8c4 = _0x311e9d, _0x558538 = _0x40321a[_0xbac8c4(0x478)]['find'](_0x5f3961 => _0x5f3961[_0xbac8c4(0x4c5)] && _0x5f3961[_0xbac8c4(0x4c5)]['isActive']); _0x558538 && (_0x558538[_0xbac8c4(0x4c5)] = null, _0x544cbe(), _0x1bbd68('同步已断开。'), _0x5d1f29(), _0xa8d7f7[_0xbac8c4(0x1c1)][_0xbac8c4(0x47e)](_0xbac8c4(0x7de)), setTimeout(() => _0xa8d7f7[_0xbac8c4(0x27d)]['display'] = 'none', 0x12c)); } function _0x5f46c6(_0x21c8bb) { const _0x17e7f0 = _0x311e9d; if (!_0x21c8bb) return []; const _0x5713a0 = _0x21c8bb[_0x17e7f0(0x480)]('\x0a'), _0x3af662 = [], _0x2e64a7 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x43cd07 of _0x5713a0) { if (_0x17e7f0(0x567) === _0x17e7f0(0x1c6)) _0x1967f6 += _0x17e7f0(0x24c); else { const _0x185192 = _0x43cd07[_0x17e7f0(0x33f)](_0x2e64a7); if (_0x185192) { const _0x23893a = parseInt(_0x185192[0x1], 0xa), _0x3ed418 = parseInt(_0x185192[0x2], 0xa), _0x3a9bce = parseInt(_0x185192[0x3], 0xa) * (_0x185192[0x3][_0x17e7f0(0x286)] === 0x2 ? 0xa : 0x1), _0x4ff986 = _0x23893a * 0x3c + _0x3ed418 + _0x3a9bce / 0x3e8, _0x52d453 = _0x43cd07['replace'](_0x2e64a7, '')['trim'](); if (_0x52d453) { if (_0x17e7f0(0x8b0) === _0x17e7f0(0x334)) { const _0x5a04a3 = _0x4dbb3c['createElement'](_0x17e7f0(0x8cf)); _0x5a04a3['className'] = _0x17e7f0(0x8e1), _0x5a04a3[_0x17e7f0(0x27d)]['cursor'] = _0x17e7f0(0x2a2); const _0x43f62a = _0x41da30[_0x17e7f0(0x41b)][_0xe7598c], _0x34878a = _0x43f62a[_0x17e7f0(0x311)][_0x17e7f0(0x24a)]((_0x3014f0, _0x1a4f0d) => _0x3014f0 + (_0x1a4f0d['amount'] || 0x0), 0x0); _0x5a04a3[_0x17e7f0(0x49f)] = _0x17e7f0(0x8bf) + _0xeaf7e5 + _0x17e7f0(0x314) + _0x34878a['toFixed'](0x2) + _0x17e7f0(0x477), _0x5a04a3[_0x17e7f0(0x215)](_0x17e7f0(0x236), () => { const _0x49f7 = _0x17e7f0; _0x2045a8[_0x49f7(0x1c1)][_0x49f7(0x47e)](_0x49f7(0x21b)), _0x26722c[_0x49f7(0x1c1)][_0x49f7(0x65b)](_0x49f7(0x21b)), _0x5f5372(_0x43f62a, _0x5ddbe0); }), _0x16080e[_0x17e7f0(0x7d)](_0x5a04a3); } else _0x3af662[_0x17e7f0(0x1fb)]({ 'time': _0x4ff986, 'text': _0x52d453 }); } } } } return _0x3af662; } function _0x388eec(_0x22fca4) { const _0x1fbc05 = _0x311e9d; _0x1bb571 = _0x5f46c6(_0x22fca4[_0x1fbc05(0x3a5)]), _0x56ef22[_0x1fbc05(0x49f)] = ''; if (_0x1bb571[_0x1fbc05(0x286)] === 0x0) { _0x56ef22[_0x1fbc05(0x49f)] = _0x1fbc05(0x6a0); return; } _0x1bb571[_0x1fbc05(0x436)]((_0x16decd, _0xdca4d9) => { const _0x2a8935 = _0x1fbc05, _0x3d6c05 = document[_0x2a8935(0x3e8)]('p'); _0x3d6c05[_0x2a8935(0x26b)] = _0x16decd[_0x2a8935(0x44f)], _0x3d6c05['id'] = _0x2a8935(0x90) + _0xdca4d9, _0x56ef22[_0x2a8935(0x7d)](_0x3d6c05); }); } function _0x5d8bf1(_0x260dbe, _0x1cc808, _0x3b70e4, _0x2f204d) { const _0x2ff437 = _0x311e9d, _0x47aebe = (_0x2f204d - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x260dbe + _0x3b70e4 * Math['cos'](_0x47aebe), 'y': _0x1cc808 + _0x3b70e4 * Math[_0x2ff437(0x8bd)](_0x47aebe) }; } function _0x510ada(_0x2151b1) { const _0x295e66 = _0x311e9d, _0x313fb1 = _0x295e66(0x638), _0x20d2f = document[_0x295e66(0x107)](_0x313fb1, _0x295e66(0x6fc)), _0x519d85 = 0xfa, _0x3f8267 = _0x519d85 / 0x2, _0x4fb004 = _0x519d85 / 0x2, _0x162295 = _0x519d85 / 0x2 - 0x14; _0x20d2f[_0x295e66(0x698)](_0x295e66(0x3bb), _0x295e66(0x231)), _0x20d2f[_0x295e66(0x698)](_0x295e66(0x2df), '100%'), _0x20d2f[_0x295e66(0x698)](_0x295e66(0x887), _0x295e66(0x3c3) + _0x519d85 + '\x20' + _0x519d85); const _0x39d717 = Object[_0x295e66(0x34e)](_0x2151b1)[_0x295e66(0x24a)]((_0x5cc2fc, _0x5e4860) => _0x5cc2fc + _0x5e4860, 0x0); if (_0x39d717 === 0x0) return _0x20d2f; let _0x47caa0 = -0x5a; const _0x56753e = [_0x295e66(0x5e2), _0x295e66(0x9c), _0x295e66(0x12c), _0x295e66(0x4fc), '#c299ff', _0x295e66(0x241), _0x295e66(0x420), '#ff8c66']; let _0x32cb98 = 0x0; for (const _0x4ae0a8 in _0x2151b1) { if (_0x295e66(0x7e) === _0x295e66(0x441)) { _0x29ba6b[_0x295e66(0x815)] = ''; return; } else { const _0x5d132a = _0x2151b1[_0x4ae0a8]; if (_0x5d132a <= 0x0) continue; const _0xe59a55 = _0x5d132a / _0x39d717 * 0x168, _0x1b058c = _0x47caa0 + _0xe59a55, _0x121a47 = _0x5d8bf1(_0x3f8267, _0x4fb004, _0x162295, _0x1b058c), _0x3ec4aa = _0x5d8bf1(_0x3f8267, _0x4fb004, _0x162295, _0x47caa0), _0x332a42 = _0xe59a55 > 0xb4 ? '1' : '0', _0x386330 = ['M', _0x121a47['x'], _0x121a47['y'], 'A', _0x162295, _0x162295, 0x0, _0x332a42, 0x1, _0x3ec4aa['x'], _0x3ec4aa['y'], 'L', _0x3f8267, _0x4fb004, 'Z'][_0x295e66(0x2c1)]('\x20'), _0x1a9ea3 = document['createElementNS'](_0x313fb1, _0x295e66(0x631)); _0x1a9ea3[_0x295e66(0x698)]('d', _0x386330), _0x1a9ea3[_0x295e66(0x698)]('fill', _0x56753e[_0x32cb98 % _0x56753e[_0x295e66(0x286)]]), _0x32cb98++; const _0x4953b6 = document[_0x295e66(0x107)](_0x313fb1, _0x295e66(0x373)); _0x4953b6['textContent'] = _0x4ae0a8 + ':\x20' + _0x5d132a[_0x295e66(0x524)](0x2) + '\x20(' + (_0x5d132a / _0x39d717 * 0x64)[_0x295e66(0x524)](0x1) + '%)', _0x1a9ea3['appendChild'](_0x4953b6), _0x20d2f[_0x295e66(0x7d)](_0x1a9ea3), _0x47caa0 = _0x1b058c; } } return _0x20d2f; } function _0x8f70ff() { const _0x177cb5 = _0x311e9d; if (_0x1bb571[_0x177cb5(0x286)] === 0x0) return; const _0x2ef52e = _0x77bdcd['currentTime']; let _0x2b5235 = -0x1; for (let _0x53ef5c = 0x0; _0x53ef5c < _0x1bb571[_0x177cb5(0x286)]; _0x53ef5c++) { if (_0x177cb5(0x850) === 'xGJEB') { if (_0x2ef52e >= _0x1bb571[_0x53ef5c]['time']) _0x2b5235 = _0x53ef5c; else { if (_0x177cb5(0x453) !== _0x177cb5(0x3b1)) break; else { _0x2db03c(_0x177cb5(0x4ae)); return; } } } else _0x791bad[_0x177cb5(0x4c5)] = null, _0x1f6e08(), _0x29bcda(_0x177cb5(0x1ff)), _0x72ae20(), _0x3518ff['classList']['remove']('show'), _0x4eeda7(() => _0x22d1a9[_0x177cb5(0x27d)][_0x177cb5(0x5a4)] = _0x177cb5(0x87b), 0x12c); } if (_0x2b5235 !== -0x1) { const _0x315d0c = _0x56ef22[_0x177cb5(0x21e)]('p'); _0x315d0c[_0x177cb5(0x436)](_0x40c539 => _0x40c539[_0x177cb5(0x1c1)][_0x177cb5(0x47e)](_0x177cb5(0x21b))); const _0x485cef = document['getElementById'](_0x177cb5(0x90) + _0x2b5235); _0x485cef && (_0x485cef['classList']['add'](_0x177cb5(0x21b)), _0x485cef['scrollIntoView']({ 'behavior': _0x177cb5(0x7f5), 'block': _0x177cb5(0x50d) })); } } _0x5170b8['addEventListener'](_0x311e9d(0x236), () => { const _0x1687da = _0x311e9d; _0xa8d7f7[_0x1687da(0x1c1)][_0x1687da(0x47e)](_0x1687da(0x7de)), setTimeout(() => _0xa8d7f7[_0x1687da(0x27d)][_0x1687da(0x5a4)] = _0x1687da(0x87b), 0x12c); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x5cc))[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x3ace16 = _0x311e9d; _0x40321a[_0x3ace16(0x132)] && _0x40321a[_0x3ace16(0x132)][_0x3ace16(0x219)] && (_0xa8d7f7['style'][_0x3ace16(0x5a4)] = _0x3ace16(0x564), setTimeout(() => _0xa8d7f7[_0x3ace16(0x1c1)]['add'](_0x3ace16(0x7de)), 0xa)); }), _0x77bdcd[_0x311e9d(0x215)](_0x311e9d(0x7e3), _0x8f70ff); const _0x36107 = document[_0x311e9d(0x3a7)]('widget-play-pause-btn'), _0x4393b0 = document['getElementById'](_0x311e9d(0x433)), _0x4be690 = document[_0x311e9d(0x3a7)](_0x311e9d(0x142)); _0x36107['addEventListener'](_0x311e9d(0x236), () => { const _0x1e3ca6 = _0x311e9d; if ('iteHe' === _0x1e3ca6(0x6da)) _0x142ff9[_0x1e3ca6(0x159)](_0x1e3ca6(0x1aa), _0x2718a0), _0x295739('无法读取状态，浏览器可能禁用了存储功能。'); else { if (_0x77bdcd[_0x1e3ca6(0x8c7)]) { if ('ZKFWB' === _0x1e3ca6(0x536)) _0x77bdcd['paused'] ? _0x1e3ca6(0x3f9) !== _0x1e3ca6(0x392) ? _0x77bdcd[_0x1e3ca6(0x2ed)]() : _0x1aca7a['style'][_0x1e3ca6(0x13d)] = '' : _0x77bdcd[_0x1e3ca6(0x7f8)](); else { const _0x58189e = _0x3e3650(_0x10d3bb[_0x1e3ca6(0x1cc)]); _0xf3bb7 = _0x58189e['avatar'] || _0x1bcf3b; } } } }), _0x4393b0[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x25de7d = _0x311e9d; if (_0x50a5a7['length'] === 0x0) return; _0x1960b7 = (_0x1960b7 + 0x1) % _0x50a5a7[_0x25de7d(0x286)], _0x3eea24(_0x50a5a7[_0x1960b7], _0x50a5a7); }), _0x4be690[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x2f8466 = _0x311e9d; if (_0x2f8466(0x6df) !== _0x2f8466(0x6df)) { const _0x1479f5 = _0x2f743d[_0x2f8466(0x94)][_0x2f8466(0x7ba)]; !_0x1479f5['objectStoreNames'][_0x2f8466(0xa1)](_0x58b260) && _0x1479f5[_0x2f8466(0x29d)](_0x3afe46, { 'keyPath': 'id' }), !_0x1479f5[_0x2f8466(0x3e1)][_0x2f8466(0xa1)]('music_library') && _0x1479f5[_0x2f8466(0x29d)](_0x2f8466(0x55b), { 'keyPath': 'id' }); } else { if (_0x50a5a7[_0x2f8466(0x286)] === 0x0) return; _0x1960b7 = (_0x1960b7 - 0x1 + _0x50a5a7[_0x2f8466(0x286)]) % _0x50a5a7[_0x2f8466(0x286)], _0x3eea24(_0x50a5a7[_0x1960b7], _0x50a5a7); } }), _0x77bdcd[_0x311e9d(0x215)]('play', () => { const _0x5cb7b9 = _0x311e9d; _0x36107[_0x5cb7b9(0x26b)] = '❚❚'; }), _0x77bdcd['addEventListener'](_0x311e9d(0x7f8), () => { const _0x4b1f13 = _0x311e9d; 'XRjpU' === _0x4b1f13(0x6ef) ? _0x445aa6(!![]) : _0x36107[_0x4b1f13(0x26b)] = '▶'; }), _0x77bdcd[_0x311e9d(0x215)](_0x311e9d(0x330), () => { const _0xb274b6 = _0x311e9d; _0x4393b0[_0xb274b6(0x236)](); }), _0x77bdcd[_0x311e9d(0x215)]('play', () => { const _0x58acff = _0x311e9d, _0x456209 = document[_0x58acff(0x3a7)](_0x58acff(0x3a3)); if (_0x456209) _0x456209['textContent'] = '❚❚'; }), _0x77bdcd['addEventListener'](_0x311e9d(0x7f8), () => { const _0x599ba5 = _0x311e9d, _0x5bbb41 = document[_0x599ba5(0x3a7)](_0x599ba5(0x3a3)); if (_0x5bbb41) _0x5bbb41['textContent'] = '▶'; }), _0x77bdcd[_0x311e9d(0x215)](_0x311e9d(0x330), () => { const _0x47733b = _0x311e9d; if (_0x47733b(0x32e) === _0x47733b(0x6ba)) _0x344a7f(_0x47733b(0x1f6)); else { const _0x11a80d = document[_0x47733b(0x3a7)]('global-player-next-btn'); if (_0x11a80d) { if (_0x47733b(0x498) !== _0x47733b(0x5a6)) _0x11a80d[_0x47733b(0x236)](); else { const _0x2c3644 = _0x32343d(_0x17b969['getHours']())['padStart'](0x2, '0'), _0x48eae1 = _0x1b2a38(_0x5c6d51[_0x47733b(0x46a)]())[_0x47733b(0x26e)](0x2, '0'); _0xafaa4e[_0x47733b(0x26b)] = _0x2c3644 + ':' + _0x48eae1; const _0x5527e4 = _0x331591[_0x47733b(0x1a1)]() + 0x1, _0x72e522 = _0x587134[_0x47733b(0xec)](), _0x56924b = [_0x47733b(0x5cf), _0x47733b(0x3d4), _0x47733b(0x14e), _0x47733b(0x2cd), _0x47733b(0x128), _0x47733b(0x7d8), '星期六'][_0x4002fc['getDay']()]; _0x309ea8['textContent'] = _0x5527e4 + '月' + _0x72e522 + '日\x20' + _0x56924b; } } } }); function _0x1cc7fc(_0x2007b6) { const _0x22829b = _0x311e9d; if ('VenVC' === _0x22829b(0x30b)) { const _0x51d0b6 = _0x2741be[_0x22829b(0x7c0)][_0x22829b(0x226)](_0x63e82e => _0x63e82e['id'] === _0x658a0b); if (_0x51d0b6) _0xf0fdd['assign'](_0x51d0b6, _0x1dea2c); } else { if (!_0x2007b6 || typeof _0x2007b6 !== 'string') return null; const _0x232023 = _0x2007b6[_0x22829b(0x2f4)]('['), _0x57b4e4 = _0x2007b6[_0x22829b(0x607)](']'); if (_0x232023 > -0x1 && _0x57b4e4 > _0x232023) return _0x2007b6['substring'](_0x232023, _0x57b4e4 + 0x1); return null; } } document['getElementById']('app-accounting')['addEventListener'](_0x311e9d(0x236), () => { const _0x22f219 = _0x311e9d; _0x19e39a(), _0x6564ff('accounting', _0x22f219(0x519)); }), document['getElementById'](_0x311e9d(0x71c))[_0x311e9d(0x215)](_0x311e9d(0x236), () => _0x6564ff(_0x311e9d(0x519), _0x311e9d(0x328))); const _0x4be857 = document[_0x311e9d(0x3a7)](_0x311e9d(0x252)), _0x4f6e7e = document[_0x311e9d(0x3a7)](_0x311e9d(0x83f)); _0x4be857[_0x311e9d(0x215)](_0x311e9d(0x236), _0x19e39a), _0x4f6e7e[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x5024ec = _0x311e9d; if ('NLkQv' === _0x5024ec(0x49c)) { const _0x14b8cb = _0x5009d2[_0x5024ec(0x94)][_0x5024ec(0x7ba)]; !_0x14b8cb[_0x5024ec(0x3e1)][_0x5024ec(0xa1)](_0x41a04d) && _0x14b8cb[_0x5024ec(0x29d)](_0x2b4d3f, { 'keyPath': 'id' }); const _0x2eed1e = _0x5024ec(0x55b); !_0x14b8cb[_0x5024ec(0x3e1)]['contains'](_0x2eed1e) && _0x14b8cb[_0x5024ec(0x29d)](_0x2eed1e, { 'keyPath': 'id' }); } else _0x4be857['classList'][_0x5024ec(0x47e)](_0x5024ec(0x21b)), _0x4f6e7e[_0x5024ec(0x1c1)][_0x5024ec(0x65b)](_0x5024ec(0x21b)), _0x331a54(); }); function _0x19e39a() { const _0x1e24ed = _0x311e9d; _0x4f6e7e[_0x1e24ed(0x1c1)]['remove'](_0x1e24ed(0x21b)), _0x4be857[_0x1e24ed(0x1c1)][_0x1e24ed(0x65b)](_0x1e24ed(0x21b)), _0x5a319f(); } function _0x5a319f() { const _0x5a187d = _0x311e9d, _0x178590 = document[_0x5a187d(0x3a7)](_0x5a187d(0x672)); document['getElementById'](_0x5a187d(0x898))[_0x5a187d(0x26b)] = _0x5a187d(0xef), document[_0x5a187d(0x3a7)]('header-actions')[_0x5a187d(0x49f)] = '', _0x178590[_0x5a187d(0x49f)] = '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', _0xf6f3(), document['getElementById'](_0x5a187d(0x110))[_0x5a187d(0x215)](_0x5a187d(0x236), _0x14a719), document[_0x5a187d(0x3a7)]('daily-expenses-list')[_0x5a187d(0x215)](_0x5a187d(0x236), _0x589aca => { const _0x32b240 = _0x5a187d; if (_0x32b240(0x660) !== 'UlWGt') { if (_0x589aca[_0x32b240(0x94)]['classList'][_0x32b240(0xa1)](_0x32b240(0x5d3))) { const _0xefea9f = _0x589aca[_0x32b240(0x94)][_0x32b240(0x58e)]['id']; _0x4849f2(_0x32b240(0x40c))[_0x32b240(0x3fa)](_0x3ece2a => { const _0x66288c = _0x32b240; if ('Tyevm' === 'NCAGZ') { const _0x20a79b = _0x2d6179['chats'][_0x66288c(0x226)](_0x290799 => _0x290799['id'] === _0x44db10); if (!_0x20a79b || _0x20a79b['type'] !== _0x66288c(0x3bc)) return; _0x28d478['getElementById']('group-settings-name')[_0x66288c(0x815)] = _0x20a79b[_0x66288c(0x2e6)] || '', _0x31cf6b(_0x66288c(0x598)), _0x4bff36[_0x66288c(0x3a7)](_0x66288c(0x598))['value'] = _0x20a79b['boundUserProfileId'] || _0x2dfae3[_0x66288c(0x17e)]; const _0x1fced4 = _0x3d9601[_0x66288c(0x3a7)](_0x66288c(0x4ef)); _0x1fced4['innerHTML'] = '', _0x10d3aa[_0x66288c(0x5e7)][_0x66288c(0x436)](_0x1c25ed => { const _0xe0108b = _0x66288c, _0x4a7588 = _0x20a79b[_0xe0108b(0x3d5)]?.['includes'](_0x1c25ed['id']), _0x56aad4 = _0x44b735[_0xe0108b(0x3e8)](_0xe0108b(0x2de)); _0x56aad4[_0xe0108b(0x49f)] = _0xe0108b(0x324) + _0x1c25ed['id'] + '\x22\x20' + (_0x4a7588 ? _0xe0108b(0x238) : '') + '>\x20' + _0x1c25ed['name'], _0x1fced4['appendChild'](_0x56aad4); }), _0x354fb2(); const _0x5c57d1 = _0x22b701[_0x66288c(0x3a7)](_0x66288c(0x693)), _0x418eb7 = _0x3f33b2[_0x66288c(0x3a7)](_0x66288c(0x2dd)); _0x2c23f4(_0x66288c(0x66b) + _0x2f480e)[_0x66288c(0x3fa)](_0x31ed3b => { const _0x666c72 = _0x66288c; _0x5c57d1[_0x666c72(0x8c7)] = _0x31ed3b ? _0x2c0500[_0x666c72(0x99)](_0x31ed3b) : _0x3a15f7; }), _0x1dbd6f(_0x66288c(0x527) + _0x436696)[_0x66288c(0x3fa)](_0x5ab1e6 => { const _0x2998fb = _0x66288c; _0x418eb7[_0x2998fb(0x8c7)] = _0x5ab1e6 ? _0xc3d2a2[_0x2998fb(0x99)](_0x5ab1e6) : ''; }), _0x25f046(_0x66288c(0x50f), _0x66288c(0x8da)); } else _0x3ece2a && (_0x66288c(0x322) !== 'FBeWB' ? _0x74f9a4(_0xefea9f) : _0x311206[_0x66288c(0x7aa)](_0x66288c(0x493), _0x159563['stringify']({ 'playlist': _0x23782d[_0x66288c(0x2cc)], 'currentIndex': _0x800f48['currentlyPlayingIndex'] }))); }); } } else { const _0xcfaa12 = _0x32b240(0x1bd) + _0x2f392f; _0x2f4af3(_0xcfaa12), _0x2d9ccd(!![]); } }), document['getElementById'](_0x5a187d(0x1a4))[_0x5a187d(0x7c9)](); } function _0x2be66c(_0x1aed73, _0x21d2e5) { const _0x484cd2 = _0x311e9d, _0x2cc344 = document[_0x484cd2(0x3a7)](_0x484cd2(0x672)), _0x21c1bb = document['getElementById'](_0x484cd2(0x4b9)); document[_0x484cd2(0x3a7)]('accounting-title')[_0x484cd2(0x26b)] = _0x21d2e5 + _0x484cd2(0x43d); const _0x1d4792 = _0x1aed73[_0x484cd2(0x311)][_0x484cd2(0x24a)]((_0x49549d, _0xdbb589) => _0x49549d + (_0xdbb589[_0x484cd2(0x376)] || 0x0), 0x0); let _0x4df865 = _0x484cd2(0x265) + _0x1d4792[_0x484cd2(0x524)](0x2) + '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>'; _0x2cc344[_0x484cd2(0x49f)] = _0x4df865; const _0x3c3bd8 = document[_0x484cd2(0x3a7)](_0x484cd2(0x534)), _0x4d5d6b = { '餐饮美食': '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '交通出行': _0x484cd2(0x6c6), '购物消费': _0x484cd2(0x5da), '生活服务': _0x484cd2(0x560), '休闲娱乐': _0x484cd2(0x6db), '医疗健康': _0x484cd2(0x269), '人情红包': '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '其他杂项': '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', '默认': _0x484cd2(0x297) }; _0x1aed73[_0x484cd2(0x311)][_0x484cd2(0x436)](_0x3e81d7 => { const _0x3707b1 = _0x484cd2, _0x4d527a = document[_0x3707b1(0x3e8)](_0x3707b1(0x8cf)); _0x4d527a['className'] = _0x3707b1(0x8e1), _0x4d527a[_0x3707b1(0x27d)][_0x3707b1(0x384)] = _0x3707b1(0x818), _0x4d527a['style'][_0x3707b1(0x767)] = 'stretch', _0x4d527a[_0x3707b1(0x27d)][_0x3707b1(0x5d1)] = _0x3707b1(0x10d), _0x4d527a[_0x3707b1(0x27d)][_0x3707b1(0x667)] = '0'; const _0x2e9293 = _0x4d5d6b[_0x3e81d7[_0x3707b1(0x86d)]] || _0x4d5d6b['默认'], _0x18afbe = _0x3707b1(0x752) + _0x2e9293 + _0x3707b1(0x270), _0x554dd7 = '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>' + _0x18afbe + '</span><div><div\x20class=\x22description\x22>' + _0x3e81d7['description'] + _0x3707b1(0x89) + (_0x3e81d7[_0x3707b1(0x86d)] || _0x3707b1(0x2e2)) + _0x3707b1(0x5ab) + (_0x3e81d7[_0x3707b1(0x376)] || 0x0)['toFixed'](0x2) + '</span></div>'; let _0x3ce308 = ''; if (_0x3e81d7['review'] && _0x3e81d7[_0x3707b1(0x58f)][_0x3707b1(0x742)]) { const _0x5722d1 = _0x3f1cb7(_0x3e81d7[_0x3707b1(0x58f)][_0x3707b1(0x742)]); if (_0x5722d1) { if (_0x3707b1(0x7d5) === _0x3707b1(0x7d5)) _0x3ce308 = _0x3707b1(0x8d) + _0x5722d1['avatar'] + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>' + _0x5722d1[_0x3707b1(0x2e6)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x3e81d7[_0x3707b1(0x58f)][_0x3707b1(0x44f)] + _0x3707b1(0x3e4); else return _0xbe4047[_0x3707b1(0x336)](_0x3707b1(0x222)), ''; } } _0x4d527a['innerHTML'] = _0x554dd7 + _0x3ce308, _0x3c3bd8['appendChild'](_0x4d527a); }), _0x21c1bb[_0x484cd2(0x49f)] = _0x484cd2(0x41f), document[_0x484cd2(0x3a7)](_0x484cd2(0x8dd))[_0x484cd2(0x215)]('click', async () => { const _0x15c291 = _0x484cd2, _0x82326a = await _0x4849f2(_0x15c291(0x517)); if (_0x82326a) { if (_0x15c291(0x2a3) === _0x15c291(0x386)) { const _0x4cb505 = _0x3caa6e(_0x52da30['review']['charId']); _0x4cb505 && (_0x58b226 = _0x15c291(0x8d) + _0x4cb505[_0x15c291(0xe7)] + _0x15c291(0x7fd) + _0x4cb505[_0x15c291(0x2e6)] + _0x15c291(0x6b9) + _0x2574c7['review'][_0x15c291(0x44f)] + _0x15c291(0x3e4)); } else delete _0x40321a[_0x15c291(0x41b)][_0x21d2e5], _0x544cbe(), _0x5a319f(); } }); } function _0x331a54() { const _0x34ef92 = _0x311e9d, _0x5da455 = document[_0x34ef92(0x3a7)](_0x34ef92(0x672)); document[_0x34ef92(0x3a7)](_0x34ef92(0x898))[_0x34ef92(0x26b)] = '账本', document[_0x34ef92(0x3a7)](_0x34ef92(0x4b9))[_0x34ef92(0x49f)] = ''; const _0x322951 = Object[_0x34ef92(0x649)](_0x40321a['accountingLedger'])[_0x34ef92(0x783)]((_0x3ce12a, _0x3fe864) => new Date(_0x3fe864) - new Date(_0x3ce12a)); if (_0x322951[_0x34ef92(0x286)] === 0x0) { _0x5da455[_0x34ef92(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>'; return; } _0x5da455[_0x34ef92(0x49f)] = '', _0x322951[_0x34ef92(0x436)](_0x590840 => { const _0x2074c0 = _0x34ef92; if (_0x2074c0(0x5de) !== 'NcCUY') _0x2abec3[_0x2074c0(0x49f)] = '<span\x20class=\x22' + _0x53aa65 + _0x2074c0(0x630) + (_0x3da43a === _0x2074c0(0x66e) ? _0x2074c0(0x75e) : '#f2b7c6') + _0x2074c0(0x6c) + _0x180834 + _0x2074c0(0x510) + _0x1f597e; else { const _0x5906b4 = document[_0x2074c0(0x3e8)]('div'); _0x5906b4[_0x2074c0(0x8d8)] = _0x2074c0(0x8e1), _0x5906b4[_0x2074c0(0x27d)][_0x2074c0(0xb6)] = _0x2074c0(0x2a2); const _0xc35d8 = _0x40321a[_0x2074c0(0x41b)][_0x590840], _0x3ad600 = _0xc35d8[_0x2074c0(0x311)]['reduce']((_0x401aab, _0x567c0a) => _0x401aab + (_0x567c0a[_0x2074c0(0x376)] || 0x0), 0x0); _0x5906b4[_0x2074c0(0x49f)] = _0x2074c0(0x8bf) + _0x590840 + '</span><span\x20class=\x22amount\x22>总计:\x20' + _0x3ad600[_0x2074c0(0x524)](0x2) + '</span>', _0x5906b4[_0x2074c0(0x215)](_0x2074c0(0x236), () => { const _0x201a8a = _0x2074c0; _0x201a8a(0x443) !== 'nzVsr' ? (_0x4be857['classList'][_0x201a8a(0x47e)](_0x201a8a(0x21b)), _0x4f6e7e[_0x201a8a(0x1c1)][_0x201a8a(0x65b)](_0x201a8a(0x21b)), _0x2be66c(_0xc35d8, _0x590840)) : _0x59686d = _0x30cf86[_0x201a8a(0x2e6)]; }), _0x5da455[_0x2074c0(0x7d)](_0x5906b4); } }); } function _0x14a719() { const _0x40bf21 = _0x311e9d, _0x3cf3a0 = document['getElementById'](_0x40bf21(0x1a4)), _0x46f788 = document[_0x40bf21(0x3a7)](_0x40bf21(0x3ea)), _0xff64e1 = _0x3cf3a0[_0x40bf21(0x815)]['trim'](), _0x837486 = parseFloat(_0x46f788[_0x40bf21(0x815)]); if (!_0xff64e1 || isNaN(_0x837486) || _0x837486 <= 0x0) { if (_0x40bf21(0x374) !== 'xHpZc') { _0x1bbd68('哼，不好好写清楚花在哪、花了多少，我怎么记？'); return; } else { let _0x8c20b5 = null; const _0x4d384c = _0x62a036[_0x40bf21(0x478)]['filter'](_0x4a14c1 => _0x4a14c1['participantIds'][_0x40bf21(0x4fe)](_0x47ea26)); for (const _0x1dbce0 of _0x4d384c) { const _0x15e4c0 = _0x5115e7(_0x1dbce0['id']); if (_0x15e4c0 && _0x15e4c0[_0x40bf21(0x286)] > 0x0) { const _0x103ecf = _0x15e4c0[_0x15e4c0[_0x40bf21(0x286)] - 0x1]; (!_0x8c20b5 || _0x103ecf[_0x40bf21(0x375)] > _0x8c20b5[_0x40bf21(0x375)]) && (_0x8c20b5 = _0x103ecf); } } return _0x8c20b5; } } _0x40321a[_0x40bf21(0x14c)][_0x40bf21(0x1fb)]({ 'id': _0x40bf21(0x187) + Date[_0x40bf21(0x6bb)](), 'description': _0xff64e1, 'amount': _0x837486, 'timestamp': Date[_0x40bf21(0x6bb)]() }), _0x544cbe(), _0xf6f3(), _0x3cf3a0[_0x40bf21(0x815)] = '', _0x46f788['value'] = '', _0x3cf3a0['focus'](); } function _0x74f9a4(_0x25cf5a) { const _0x37e92b = _0x311e9d, _0x539801 = _0x40321a[_0x37e92b(0x14c)][_0x37e92b(0xcd)](_0x438b2a => _0x438b2a['id'] === _0x25cf5a); _0x539801 > -0x1 && (_0x37e92b(0x3e5) !== _0x37e92b(0x36a) ? (_0x40321a[_0x37e92b(0x14c)][_0x37e92b(0x855)](_0x539801, 0x1), _0x544cbe(), _0xf6f3()) : _0x298309 += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'); } function _0xf6f3() { const _0xc7f96d = _0x311e9d; if ('uXKLi' === _0xc7f96d(0x755)) _0x1112dc(), _0x47f80d[_0xc7f96d(0x301)] = 0x64; else { const _0x2c107a = document[_0xc7f96d(0x3a7)](_0xc7f96d(0x7c3)), _0x5b44a6 = document[_0xc7f96d(0x3a7)](_0xc7f96d(0x502)), _0x6b712a = new Date(), _0xe011e6 = _0x40321a['accountingData'][_0xc7f96d(0x16f)](_0x22682a => new Date(_0x22682a[_0xc7f96d(0x375)])['toDateString']() === _0x6b712a['toDateString']()); if (_0xe011e6[_0xc7f96d(0x286)] === 0x0) { if (_0xc7f96d(0x507) !== 'dJQeU') _0x2739a8[_0xc7f96d(0x7f8)](), _0x5743c5[_0xc7f96d(0x889)](_0xc7f96d(0x5e4))[_0xc7f96d(0x26b)] = '▶'; else { _0x2c107a[_0xc7f96d(0x49f)] = _0xc7f96d(0x846), _0x5b44a6[_0xc7f96d(0x49f)] = ''; return; } } _0x2c107a['innerHTML'] = '', _0xe011e6[_0xc7f96d(0x783)]((_0x51fe4b, _0x3f9901) => _0x3f9901[_0xc7f96d(0x375)] - _0x51fe4b[_0xc7f96d(0x375)])[_0xc7f96d(0x436)](_0x3f5f49 => { const _0x55eece = _0xc7f96d, _0x282f28 = document[_0x55eece(0x3e8)](_0x55eece(0x8cf)); _0x282f28[_0x55eece(0x8d8)] = _0x55eece(0x8e1), _0x282f28[_0x55eece(0x49f)] = _0x55eece(0x8bf) + _0x3f5f49[_0x55eece(0x67f)] + _0x55eece(0x50b) + _0x3f5f49[_0x55eece(0x376)][_0x55eece(0x524)](0x2) + _0x55eece(0x4b5) + _0x3f5f49['id'] + _0x55eece(0x5a1), _0x2c107a[_0x55eece(0x7d)](_0x282f28); }), _0x5b44a6 && (_0x5b44a6[_0xc7f96d(0x49f)] = _0xc7f96d(0x10c), document[_0xc7f96d(0x3a7)]('organize-bill-button')[_0xc7f96d(0x215)]('click', _0x2b8909)); } } async function _0x2b8909() { const _0x19c31f = _0x311e9d; if (_0x19c31f(0x33d) !== 'xQihj') { const _0x25c526 = new Date(), _0x2b9d00 = _0x25c526[_0x19c31f(0x1b2)]() + '-' + String(_0x25c526[_0x19c31f(0x1a1)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x25c526[_0x19c31f(0xec)]())['padStart'](0x2, '0'); if (_0x40321a[_0x19c31f(0x41b)][_0x2b9d00]) { _0x1bbd68(_0x19c31f(0x1b4)); return; } const _0x325bee = _0x40321a['accountingData'][_0x19c31f(0x16f)](_0x16cfad => new Date(_0x16cfad[_0x19c31f(0x375)])[_0x19c31f(0x2d3)]() === _0x25c526[_0x19c31f(0x2d3)]()); if (_0x325bee[_0x19c31f(0x286)] === 0x0) { _0x1bbd68('今天一笔账都没有，我整理什么？'); return; } _0x3396e7(!![], '正在整理…'); try { const _0x18d610 = [_0x19c31f(0x48f), '交通出行', _0x19c31f(0x44a), _0x19c31f(0x4ac), '休闲娱乐', '医疗健康', _0x19c31f(0x663), _0x19c31f(0x74a)], _0x1fdc42 = _0x325bee[_0x19c31f(0x7cc)](_0x19b423 => '-\x20' + _0x19b423[_0x19c31f(0x67f)] + ':\x20' + _0x19b423[_0x19c31f(0x376)])['join']('\x0a'), _0x34a425 = _0x40321a[_0x19c31f(0x382)][_0x19c31f(0x7cc)](_0x4c3039 => { const _0x98851b = _0x19c31f; if (_0x98851b(0x6c8) !== _0x98851b(0x6c8)) _0x2f5a3b += _0x98851b(0x66d); else { const _0x24b6d8 = _0x40321a[_0x98851b(0x478)][_0x98851b(0x226)](_0x4d9931 => _0x4d9931[_0x98851b(0x78c)] === _0x98851b(0x64f) && _0x4d9931['participantIds'][_0x98851b(0x4fe)](_0x4c3039['id'])), _0xc35b49 = _0x40321a[_0x98851b(0x7c0)][_0x98851b(0x226)](_0x8adda3 => _0x8adda3['id'] === (_0x24b6d8?.[_0x98851b(0x87f)] || _0x40321a['activeUserProfileId'])) || { 'id': 'default', 'name': '你' }; let _0x23abc9 = ''; return _0x4c3039[_0x98851b(0x3d5)] && _0x4c3039[_0x98851b(0x3d5)][_0x98851b(0x286)] > 0x0 && (_0x23abc9 = _0x4c3039[_0x98851b(0x3d5)]['map'](_0x3911d2 => _0x40321a[_0x98851b(0x5e7)]['find'](_0x790ee0 => _0x790ee0['id'] === _0x3911d2))[_0x98851b(0x16f)](Boolean)[_0x98851b(0x7cc)](_0x33fa7e => _0x98851b(0x52b) + _0x33fa7e[_0x98851b(0x2e6)] + _0x98851b(0x7ef) + _0x33fa7e[_0x98851b(0x812)])[_0x98851b(0x2c1)]('')), _0x98851b(0xc5) + _0x4c3039['id'] + _0x98851b(0x267) + _0x4c3039[_0x98851b(0x2e6)] + _0x98851b(0x134) + _0x4c3039[_0x98851b(0x838)] + _0x98851b(0xa8) + _0xc35b49[_0x98851b(0x2e6)] + _0x98851b(0x6eb) + _0xc35b49['id'] + ')\x0a' + _0x23abc9; } })[_0x19c31f(0x2c1)]('\x0a'), _0x2c5f5e = _0x40321a[_0x19c31f(0x7c0)][_0x19c31f(0x7cc)](_0x52f277 => _0x19c31f(0x82f) + _0x52f277['id'] + _0x19c31f(0x267) + _0x52f277[_0x19c31f(0x2e6)] + _0x19c31f(0x134) + (_0x52f277[_0x19c31f(0x838)] || '无'))[_0x19c31f(0x2c1)]('\x0a'), _0x510410 = _0x19c31f(0x5be), _0x148715 = _0x19c31f(0x3c4) + _0x18d610[_0x19c31f(0x2c1)](',\x20') + _0x19c31f(0x141) + _0x34a425 + _0x19c31f(0x547) + _0x2c5f5e + _0x19c31f(0x788) + _0x1fdc42, _0x55f229 = [{ 'role': _0x19c31f(0x70d), 'content': _0x510410 }, { 'role': _0x19c31f(0x447), 'content': _0x148715 }], _0x23f9ab = await _0x56cc62(_0x55f229, { 'json': !![] }), _0x5907c0 = _0x1cc7fc(_0x23f9ab); if (!_0x5907c0) throw new Error('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x23f9ab); const _0x5c89a6 = JSON[_0x19c31f(0x5b1)](_0x5907c0); _0x40321a[_0x19c31f(0x41b)][_0x2b9d00] = { 'categorizedExpenses': _0x5c89a6, 'timestamp': Date['now']() }, _0x544cbe(), _0x2be66c(_0x40321a[_0x19c31f(0x41b)][_0x2b9d00], _0x2b9d00); } catch (_0xce84f0) { _0x1bbd68('AI整理失败了，哼:\x20' + _0xce84f0[_0x19c31f(0x15a)]); } finally { _0x3396e7(![]); } } else _0x4db299[_0x19c31f(0x313)] = ![], _0x338878[_0x19c31f(0x26b)] = '获取'; } async function _0x7f467e() { const _0x4bfbce = _0x311e9d, _0x31807c = [..._0x52db3a]; try { const _0x42435b = localStorage[_0x4bfbce(0x8b4)]('customStickers'); if (_0x42435b) { const _0x238460 = JSON['parse'](_0x42435b); Array[_0x4bfbce(0x1d4)](_0x238460) ? _0x42bed1 = [..._0x31807c, ..._0x238460] : _0x4bfbce(0x83c) === _0x4bfbce(0x184) ? _0x220af9[_0x4bfbce(0x8ca)] = ![] : _0x42bed1 = _0x31807c; } else _0x42bed1 = _0x31807c; } catch (_0x12561b) { console[_0x4bfbce(0x159)](_0x4bfbce(0xe1), _0x12561b), _0x42bed1 = _0x31807c; } if (!localStorage[_0x4bfbce(0x8b4)](_0x4bfbce(0x7f4))) { _0x4849f2(_0x4bfbce(0x67))[_0x4bfbce(0x3fa)](async _0x4d17ad => { const _0x5e4992 = _0x4bfbce; _0x4d17ad ? (_0x3396e7(!![], _0x5e4992(0x481)), await _0x648798(), localStorage['setItem'](_0x5e4992(0x7f4), _0x5e4992(0x7ca)), _0x3396e7(![]), _0x1bbd68(_0x5e4992(0x6a4)), setTimeout(() => location['reload'](), 0x5dc)) : _0x1bbd68(_0x5e4992(0x2fc)); }); return; } if (!localStorage[_0x4bfbce(0x8b4)](_0x4bfbce(0x294))) { console['log'](_0x4bfbce(0x4e1)), _0x3396e7(!![], _0x4bfbce(0x553)); const _0x478b11 = await _0xf52059(); localStorage[_0x4bfbce(0x7aa)](_0x4bfbce(0x294), _0x4bfbce(0x7ca)), _0x3396e7(![]); if (_0x478b11 > 0x0) { _0x1bbd68(_0x4bfbce(0x523) + _0x478b11 + _0x4bfbce(0x369)), setTimeout(() => location[_0x4bfbce(0x15f)](), 0x5dc); return; } } if (!localStorage[_0x4bfbce(0x8b4)]('noir_migration_fc_v1_complete')) { } if (!localStorage[_0x4bfbce(0x8b4)](_0x4bfbce(0x68b))) { if ('AgjCI' !== 'PdmZM') { console['log'](_0x4bfbce(0x763)), _0x3396e7(!![], _0x4bfbce(0x592)); const _0x30d808 = await _0x317fbc(); localStorage[_0x4bfbce(0x7aa)]('noir_migration_music_v1_complete', _0x4bfbce(0x7ca)), _0x3396e7(![]); if (_0x30d808 > 0x0) { _0x1bbd68(_0x4bfbce(0x509) + _0x30d808 + '\x20张旧封面。应用即将刷新。'), setTimeout(() => location['reload'](), 0x5dc); return; } } else { const _0x218c53 = _0x4d85c[_0x4bfbce(0xf2)](_0x281c0b / 0x3c); if (_0x218c53 < 0x30) _0x18e136 += _0x4bfbce(0x597) + _0x218c53 + _0x4bfbce(0x348); else _0x2094bf += _0x4bfbce(0x227) + _0x58c3f4[_0x4bfbce(0xf2)](_0x218c53 / 0x18) + _0x4bfbce(0x261); } } const _0x660960 = _0x4cad55(); _0x4af89f(), _0x2792eb(), _0x588b9b(), _0x19ab60(), _0x2ac542(), _0x58c36a(), _0x51f633(), _0x584808(), _0x286ef5(), _0x3d6fe9(), _0x3df337(), _0x5d1f29(), _0x185058(), setInterval(_0x185058, 0x7530), _0x190622(), _0x5af13e(), _0x4b5ee5(); const _0x3732e7 = document['getElementById'](_0x4bfbce(0x2aa)); document[_0x4bfbce(0x3a7)](_0x4bfbce(0x5cc))[_0x4bfbce(0x215)]('click', function (_0xe32617) { const _0x1b59df = _0x4bfbce; if (_0xe32617[_0x1b59df(0x94)][_0x1b59df(0x64c)](_0x1b59df(0x895))) { if (_0x1b59df(0x808) !== _0x1b59df(0x61c)) return; else _0xb7adb8(![]), _0x272a2e['target']['value'] = ''; } const _0x2e5570 = document['getElementById'](_0x1b59df(0x6e8)); _0x2e5570 && _0x2e5570[_0x1b59df(0x236)](); }), _0x6564ff(_0x4bfbce(0x519), _0x4bfbce(0x100)); (_0x660960 || _0x40321a[_0x4bfbce(0x382)][_0x4bfbce(0x286)] === 0x0) && (_0x1bbd68(_0x4bfbce(0x78b)), setTimeout(() => { const _0x34009b = _0x4bfbce; _0x6564ff(_0x34009b(0x8da), 'home'), setTimeout(() => _0x59deff(), 0x64); }, 0x6a4)); const _0xd0c943 = document[_0x4bfbce(0x3a7)](_0x4bfbce(0x2ba)); document[_0x4bfbce(0x3a7)](_0x4bfbce(0x669))['addEventListener'](_0x4bfbce(0x236), () => _0xd0c943[_0x4bfbce(0x236)]()), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x55d))['addEventListener'](_0x4bfbce(0x236), () => { const _0x34da1b = _0x4bfbce; _0x34da1b(0x69e) !== _0x34da1b(0x69e) ? _0x231c82[_0x34da1b(0x1fb)](_0x4113a3) : (_0x40321a[_0x34da1b(0x42f)][_0x34da1b(0x113)] = null, _0x544cbe(), _0x190622(), _0x1bbd68(_0x34da1b(0x7a7))); }), _0xd0c943[_0x4bfbce(0x215)](_0x4bfbce(0x66a), async _0x35cd9b => { const _0x35f64c = _0x4bfbce, _0x344756 = _0x35cd9b[_0x35f64c(0x94)][_0x35f64c(0x83b)][0x0]; if (!_0x344756) return; try { const _0x49806d = await _0x53aefa(_0x344756); _0x40321a[_0x35f64c(0x42f)][_0x35f64c(0x113)] = _0x49806d, _0x544cbe(), _0x190622(), _0x1bbd68(_0x35f64c(0x33e)); } catch (_0xf66ff1) { if (_0x35f64c(0x681) !== _0x35f64c(0x68)) _0x1bbd68(_0x35f64c(0x218) + _0xf66ff1[_0x35f64c(0x15a)]); else { _0x3843d1(); const _0x498067 = _0x36344d(_0x35f64c(0x757), _0x5b9050['name']); _0x498067 && _0x498067[_0x35f64c(0x3e3)]() && _0x498067 !== _0x5ddfe8['name'] && (_0x218fc4[_0x35f64c(0x2e6)] = _0x498067[_0x35f64c(0x3e3)](), _0x371a9c(), _0x4f0c61(), _0x431896(), _0x121adf(_0x35f64c(0x18f) + _0x433cf9[_0x35f64c(0x2e6)] + '\x22。')); } } }), _0x417fb9(), document['getElementById'](_0x4bfbce(0x6b3))[_0x4bfbce(0x215)](_0x4bfbce(0x236), () => document[_0x4bfbce(0x3a7)](_0x4bfbce(0x802))[_0x4bfbce(0x236)]()), document[_0x4bfbce(0x3a7)]('reset-badge-button')[_0x4bfbce(0x215)]('click', async () => { const _0xb7bae0 = _0x4bfbce; if (_0xb7bae0(0x713) !== 'IDXpl') { const _0x131197 = _0x562179['open'](_0x4806b0, 0x2); _0x131197[_0xb7bae0(0x3bd)] = () => _0x247abf('IndexedDB\x20failed\x20to\x20open'), _0x131197[_0xb7bae0(0x61f)] = () => _0x247d47(_0x131197[_0xb7bae0(0x7ba)]), _0x131197[_0xb7bae0(0x557)] = _0x3c99dc => { const _0x45a53b = _0xb7bae0, _0x17516e = _0x3c99dc['target'][_0x45a53b(0x7ba)]; !_0x17516e[_0x45a53b(0x3e1)][_0x45a53b(0xa1)](_0xf42664) && _0x17516e[_0x45a53b(0x29d)](_0x3b8a37, { 'keyPath': 'id' }), !_0x17516e['objectStoreNames']['contains'](_0x45a53b(0x55b)) && _0x17516e[_0x45a53b(0x29d)]('music_library', { 'keyPath': 'id' }); }; } else await _0x2a396c('widget_badge'), localStorage['removeItem'](_0xb7bae0(0x6bf)), _0x417fb9(), _0x1bbd68(_0xb7bae0(0x401)); }), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x802))[_0x4bfbce(0x215)]('change', async _0xe75704 => { const _0x576c04 = _0x4bfbce; if ('OzzaX' !== _0x576c04(0x4e4)) { if (_0x18dc45) _0x137f15[_0x576c04(0x26b)] = '▶'; } else { const _0x57e6bb = _0xe75704[_0x576c04(0x94)][_0x576c04(0x83b)][0x0]; if (!_0x57e6bb) return; try { await _0x5c7ad7(_0x576c04(0x337), _0x57e6bb), await _0x417fb9(), _0x1bbd68(_0x576c04(0x1bf)); } catch (_0x37c007) { _0x1bbd68(_0x576c04(0x218) + _0x37c007['message']); } } }), _0x1c82fe(), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x3a4))[_0x4bfbce(0x215)](_0x4bfbce(0x395), _0x35da82), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x3a4))[_0x4bfbce(0x215)](_0x4bfbce(0xd0), _0x35da82, { 'passive': ![] }), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x816))[_0x4bfbce(0x215)]('click', () => document[_0x4bfbce(0x3a7)](_0x4bfbce(0x163))[_0x4bfbce(0x236)]()), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x53e))[_0x4bfbce(0x215)](_0x4bfbce(0x236), async () => { const _0x3ca033 = _0x4bfbce; await _0x2a396c(_0x3ca033(0x1f9)), localStorage[_0x3ca033(0x73)](_0x3ca033(0x74e)), _0x1c82fe(), _0x1bbd68(_0x3ca033(0x84f)); }), document[_0x4bfbce(0x3a7)]('card-input')[_0x4bfbce(0x215)]('change', async _0x4c753f => { const _0x211800 = _0x4bfbce, _0xa9272 = _0x4c753f[_0x211800(0x94)][_0x211800(0x83b)][0x0]; if (!_0xa9272) return; try { await _0x5c7ad7(_0x211800(0x1f9), _0xa9272), await _0x1c82fe(), _0x1bbd68(_0x211800(0x38f)); } catch (_0x4b66d4) { 'blHDf' !== _0x211800(0x893) ? _0x1bbd68(_0x211800(0x218) + _0x4b66d4[_0x211800(0x15a)]) : (_0x4c4299[_0x211800(0x1cc)] = _0x146081[_0x211800(0x478)][0x0]?.['id'] || null, _0x4ef654(_0x30388d[_0x211800(0x1cc)])); } }), document[_0x4bfbce(0x3a7)]('reset-widgets-position-button')[_0x4bfbce(0x215)](_0x4bfbce(0x236), async () => { const _0x3ecc69 = _0x4bfbce, _0x55e22e = await _0x4849f2(_0x3ecc69(0x398)); if (_0x55e22e) { if (_0x3ecc69(0x869) !== _0x3ecc69(0x869)) { _0x38c883[_0x3ecc69(0x336)](_0x3ecc69(0xf6)); const _0x19340d = { 'id': _0x3ecc69(0x411) + _0x1923ea[_0x3ecc69(0x6bb)](), 'name': '我的动态', 'boundUserProfileId': _0x1245a5[_0x3ecc69(0x17e)], 'memberCharacterIds': _0x97511f[_0x3ecc69(0x382)]['map'](_0x27bcf9 => _0x27bcf9['id']), 'posts': _0x3e25af[_0x3ecc69(0x1c8)] }; _0x6b41d[_0x3ecc69(0x7ab)] = [_0x19340d], _0x23ceff[_0x3ecc69(0x57c)] = _0x19340d['id']; } else localStorage[_0x3ecc69(0x73)](_0x3ecc69(0x6bf)), localStorage[_0x3ecc69(0x73)]('cardWidgetState'), _0x1bbd68(_0x3ecc69(0x2ea)), setTimeout(() => location[_0x3ecc69(0x15f)](), 0x3e8); } }); const _0x24a1c4 = document[_0x4bfbce(0x3a7)]('app-diary'); _0x24a1c4[_0x4bfbce(0x215)]('click', () => { const _0x63a910 = _0x4bfbce; _0x63a910(0x8b9) === _0x63a910(0x8b9) ? (_0x264b16(), _0x6564ff(_0x63a910(0x679), _0x63a910(0x519))) : (_0x4b81dc[_0x63a910(0x888)] = _0x2e9c71, _0x3723f5 = !![]); }); const _0x12104d = document[_0x4bfbce(0x3a7)]('app-music-library'); _0x12104d[_0x4bfbce(0x215)](_0x4bfbce(0x236), () => { const _0x33ca6d = _0x4bfbce; _0x100420(), _0x6564ff('musicLibrary', _0x33ca6d(0x519)); }), document['getElementById'](_0x4bfbce(0x8a1))['addEventListener']('click', () => _0x6564ff(_0x4bfbce(0x519), 'musicLibrary')), document[_0x4bfbce(0x3a7)]('back-to-home-from-diary-list')['addEventListener'](_0x4bfbce(0x236), () => _0x6564ff(_0x4bfbce(0x519), _0x4bfbce(0x679))), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x207))[_0x4bfbce(0x215)](_0x4bfbce(0x236), () => { const _0x33c9bc = _0x4bfbce; _0x40321a[_0x33c9bc(0x23e)] = null, _0x6564ff('diaryList', _0x33c9bc(0x16a)); }), document[_0x4bfbce(0x3a7)]('diary-send-button')[_0x4bfbce(0x215)](_0x4bfbce(0x236), _0x4a9ce5), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x7ac))[_0x4bfbce(0x215)](_0x4bfbce(0x236), _0x11adbb), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x381))[_0x4bfbce(0x215)](_0x4bfbce(0x1ac), _0x3f5eb4 => { const _0x3fc63f = _0x4bfbce; if (_0x3fc63f(0xc8) !== 'gIUDq') { const _0xc41023 = _0x78a5bf[_0x3fc63f(0x812)]['match'](/：(.*?)]$/); _0x4a15a2[_0x3fc63f(0x812)] = _0x3fc63f(0x22d) + (_0xc41023 ? _0xc41023[0x1] : '未知表情') + ']', _0x59f31['push'](_0x479eff); } else _0x3f5eb4[_0x3fc63f(0x11c)] === _0x3fc63f(0x1ad) && !_0x3f5eb4[_0x3fc63f(0x28e)] && (_0x3fc63f(0x53f) === _0x3fc63f(0x53f) ? (_0x3f5eb4[_0x3fc63f(0x425)](), _0x4a9ce5()) : _0x44889a(_0x27c3e4, _0x16ad87[_0x3fc63f(0x81b)])); }); const _0x55e564 = ['normal', _0x4bfbce(0x6f7), _0x4bfbce(0x1eb), _0x4bfbce(0x1a5), _0x4bfbce(0x5e3)]; _0x55e564[_0x4bfbce(0x436)](_0x1032a2 => { const _0x5e79b9 = _0x4bfbce, _0x2933e4 = document[_0x5e79b9(0x3a7)]('char-edit-sprite-' + _0x1032a2 + '-preview'), _0x3eb949 = document[_0x5e79b9(0x3a7)](_0x5e79b9(0x5bd) + _0x1032a2 + _0x5e79b9(0x528)); if (_0x2933e4 && _0x3eb949) { if (_0x5e79b9(0x625) === _0x5e79b9(0x625)) _0x2933e4[_0x5e79b9(0x215)](_0x5e79b9(0x236), () => _0x3eb949[_0x5e79b9(0x236)]()), _0x3eb949[_0x5e79b9(0x215)]('change', async _0xbc23f8 => { const _0x73772e = _0x5e79b9, _0x5a5b66 = _0xbc23f8[_0x73772e(0x94)][_0x73772e(0x83b)][0x0]; if (!_0x5a5b66) return; try { _0x73772e(0x5d4) !== _0x73772e(0x5d4) ? _0x1d13d9[_0x73772e(0x1c1)][_0x73772e(0x47e)]('show') : _0x2933e4[_0x73772e(0x8c7)] = URL['createObjectURL'](_0x5a5b66); } catch (_0x58cf5a) { _0x1bbd68('图片预览失败:\x20' + _0x58cf5a[_0x73772e(0x15a)]); } }); else return; } }), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x9a))[_0x4bfbce(0x215)](_0x4bfbce(0x236), _0x104d57), document['getElementById'](_0x4bfbce(0x346))[_0x4bfbce(0x215)](_0x4bfbce(0x236), () => { const _0x310fd1 = _0x4bfbce; _0x40321a[_0x310fd1(0x2fb)] = _0x40321a[_0x310fd1(0x2fb)] === _0x310fd1(0x1c0) ? _0x310fd1(0x293) : 'novel', _0x46828b(); }), document[_0x4bfbce(0x3a7)]('meeting-scene-view')['addEventListener'](_0x4bfbce(0x395), _0x59c322), document['getElementById'](_0x4bfbce(0x7b3))[_0x4bfbce(0x215)]('touchstart', _0x59c322, { 'passive': ![] }); let _0x3509a3 = null; function _0x59c322(_0x33e778) { const _0x40181f = _0x4bfbce; if (_0x3509a3) clearTimeout(_0x3509a3); const _0x2a1213 = _0x33e778[_0x40181f(0x94)][_0x40181f(0x64c)](_0x40181f(0x40a)); if (!_0x2a1213) return; const _0x4e917f = parseInt(_0x2a1213[_0x40181f(0x58e)][_0x40181f(0x736)], 0xa); if (isNaN(_0x4e917f)) return; const _0x580e10 = () => { const _0x46c718 = _0x40181f; if (_0x46c718(0x8be) === _0x46c718(0x8be)) _0x3509a3 = setTimeout(() => { const _0x493dd5 = _0x46c718; if (_0x33e778[_0x493dd5(0x78c)] === _0x493dd5(0xd0)) _0x33e778[_0x493dd5(0x425)](); _0x235508(_0x4e917f); }, 0x320); else { _0x25af9c[_0x46c718(0x26b)] = _0x46c718(0x257); return; } }, _0x11e1ab = () => { if (_0x3509a3) clearTimeout(_0x3509a3); }; document[_0x40181f(0x215)](_0x40181f(0xa3), _0x11e1ab, { 'once': !![] }), document[_0x40181f(0x215)]('mouseleave', _0x11e1ab, { 'once': !![] }), document[_0x40181f(0x215)](_0x40181f(0x494), _0x11e1ab, { 'once': !![] }), document[_0x40181f(0x215)]('touchcancel', _0x11e1ab, { 'once': !![] }), _0x580e10(); } document[_0x4bfbce(0x7ee)][_0x4bfbce(0x215)](_0x4bfbce(0x236), _0x2587d0 => { const _0x50dfe3 = _0x4bfbce; if (_0x50dfe3(0x82e) === 'hSstx') { const _0x323a35 = _0x2587d0[_0x50dfe3(0x94)]['closest'](_0x50dfe3(0x6dc)); if (_0x323a35) { const _0x313e61 = _0x2587d0[_0x50dfe3(0x94)][_0x50dfe3(0x64c)]('.lt-end-session-btn'), _0x46bb35 = _0x2587d0[_0x50dfe3(0x94)]['closest']('.listen-together-accept-btn'); if (_0x313e61) _0xae7e03(); else { if (_0x46bb35) { const _0x1dd6f1 = _0x46bb35[_0x50dfe3(0x64c)](_0x50dfe3(0x798)), _0x165487 = _0x46bb35[_0x50dfe3(0x58e)]['songId'], _0x3e060c = parseInt(_0x1dd6f1[_0x50dfe3(0x58e)][_0x50dfe3(0x736)], 0xa); _0x58fca2(_0x165487, _0x3e060c, _0x323a35); } else { const _0x42b69d = _0x4db4a7(); _0x42b69d && _0x42b69d[_0x50dfe3(0x4c5)] && _0x42b69d[_0x50dfe3(0x4c5)][_0x50dfe3(0x219)] && (_0xa8d7f7['style']['display'] = _0x50dfe3(0x564), setTimeout(() => _0xa8d7f7[_0x50dfe3(0x1c1)]['add'](_0x50dfe3(0x7de)), 0xa)); } } return; } if (window[_0x50dfe3(0x759)]()[_0x50dfe3(0x8e4)]()) return; const _0x4566c0 = _0x2587d0[_0x50dfe3(0x94)][_0x50dfe3(0x64c)]('.message-container'); if (_0x4566c0 && !_0x2587d0[_0x50dfe3(0x94)][_0x50dfe3(0x64c)](_0x50dfe3(0x1b3))) { const _0x13ac29 = parseInt(_0x4566c0['dataset'][_0x50dfe3(0x736)], 0xa); !isNaN(_0x13ac29) && _0x235508(_0x13ac29); } } else { const _0x4ebaf3 = _0x61bde9[_0x50dfe3(0x3e8)]('p'); _0x4ebaf3[_0x50dfe3(0x26b)] = _0x36e714[_0x50dfe3(0x44f)], _0x4ebaf3['id'] = 'lyric-line-' + _0x45eed6, _0x951403[_0x50dfe3(0x7d)](_0x4ebaf3); } }); const _0x2d6e24 = document['getElementById'](_0x4bfbce(0x3cd)); _0x2d6e24 && _0x2d6e24[_0x4bfbce(0x215)]('click', () => { const _0x1dbe20 = _0x4bfbce; if (_0x1dbe20(0x82c) === _0x1dbe20(0x1f3)) { const _0x1efa03 = _0x4a7a20[_0x1dbe20(0x7c0)]['find'](_0x59aa59 => _0x59aa59['id'] === _0x436455[_0x1dbe20(0x87f)]) || { 'name': _0x1dbe20(0x7f0) }, _0x5575d7 = _0x1ec0c1['createElement']('div'); _0x5575d7['className'] = _0x1dbe20(0x341), _0x5575d7[_0x1dbe20(0x58e)]['id'] = _0x1dfcaf['id'], _0x5575d7[_0x1dbe20(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x565851[_0x1dbe20(0x2e6)] + _0x1dbe20(0x370) + _0x1efa03[_0x1dbe20(0x2e6)] + _0x1dbe20(0x82a) + _0x3ab2b8['memberCharacterIds'][_0x1dbe20(0x286)] + _0x1dbe20(0x683), _0x5575d7[_0x1dbe20(0x215)]('click', () => _0x4c612b(_0x407069['id'])), _0x17d08a['appendChild'](_0x5575d7); } else _0x1bbd68(_0x1dbe20(0x868)); }); const _0x4b9b0e = document[_0x4bfbce(0x3a7)](_0x4bfbce(0x3c9)), _0x33c0ad = localStorage[_0x4bfbce(0x8b4)](_0x4bfbce(0x590)); if (_0x33c0ad) try { const _0x2b1ad7 = JSON[_0x4bfbce(0x5b1)](_0x33c0ad); Array[_0x4bfbce(0x1d4)](_0x2b1ad7) && (_0x4b9b0e['value'] = _0x2b1ad7['map'](_0x7d9a06 => _0x7d9a06[_0x4bfbce(0x2e6)] + '--' + _0x7d9a06['url'])[_0x4bfbce(0x2c1)]('\x0a')); } catch (_0x2dcc03) { } document[_0x4bfbce(0x3a7)](_0x4bfbce(0x584))['addEventListener']('click', () => { const _0xbb30cc = _0x4bfbce; if (_0xbb30cc(0x3f2) === 'lLaJV') _0x1e9064['removeItem']('chatHistory_' + _0x435a1e); else { const _0x18d5a8 = _0x4b9b0e['value'], _0x597469 = _0x18d5a8[_0xbb30cc(0x480)]('\x0a')[_0xbb30cc(0x16f)](_0x3f84fc => _0x3f84fc['trim']() !== ''), _0x117e1c = []; let _0x1bf87f = 0x0; for (const _0x4d1ead of _0x597469) { const _0x3779ef = _0x4d1ead[_0xbb30cc(0x480)]('--'); _0x3779ef['length'] === 0x2 && _0x3779ef[0x0][_0xbb30cc(0x3e3)]() && _0x3779ef[0x1][_0xbb30cc(0x3e3)]()[_0xbb30cc(0x279)](_0xbb30cc(0x68f)) ? _0x117e1c[_0xbb30cc(0x1fb)]({ 'name': _0x3779ef[0x0][_0xbb30cc(0x3e3)](), 'url': _0x3779ef[0x1]['trim']() }) : _0x1bf87f++; } _0x1bf87f > 0x0 && (_0xbb30cc(0x10e) !== 'OFfrw' ? _0x1bbd68('有\x20' + _0x1bf87f + _0xbb30cc(0x6f2)) : _0x1dd19c(_0xbb30cc(0x612) + _0xcd6248[_0xbb30cc(0x15a)])); try { if (_0xbb30cc(0x5d8) !== _0xbb30cc(0x11a)) localStorage['setItem'](_0xbb30cc(0x590), JSON['stringify'](_0x117e1c)), _0x1bbd68(_0xbb30cc(0x4cb)), setTimeout(() => location['reload'](), 0x5dc); else { const { omniText: _0x4b988f } = _0x5c3707(_0x1b7faf['id'], null), _0x171899 = _0x386881(_0x1c4283['id']), _0x11c7a7 = _0x2e14a2[_0xbb30cc(0x3d5)] && _0x8d186f[_0xbb30cc(0x3d5)][_0xbb30cc(0x286)] > 0x0 ? '\x0a\x0a#\x20' + _0x194f29['name'] + _0xbb30cc(0x166) + _0x8f5290[_0xbb30cc(0x3d5)][_0xbb30cc(0x7cc)](_0x564612 => _0xcda347[_0xbb30cc(0x5e7)][_0xbb30cc(0x226)](_0x1c16cd => _0x1c16cd['id'] === _0x564612))[_0xbb30cc(0x16f)](_0x3fb831)[_0xbb30cc(0x7cc)](_0x4c7141 => _0xbb30cc(0x482) + _0x4c7141['name'] + '\x0a' + _0x4c7141[_0xbb30cc(0x812)])['join']('') : ''; return _0xbb30cc(0x42b) + _0x36d4c1['name'] + _0xbb30cc(0x4d2) + _0x459bdb['id'] + _0xbb30cc(0x8ac) + _0x4e8da6[_0xbb30cc(0x838)] + _0xbb30cc(0x312) + _0x4b988f + '\x0a' + _0x171899 + '\x0a' + _0x11c7a7; } } catch (_0x2106d1) { _0x1bbd68('保存失败，你的表情包是不是太多了？'); } } }), _0x1d8433(), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x62b))['addEventListener'](_0x4bfbce(0x236), () => { const _0x26fea3 = _0x4bfbce; _0x26fea3(0x2a8) === _0x26fea3(0x20c) ? _0x12302f = _0x242542[_0x26fea3(0x7c0)]['find'](_0x4a59a2 => _0x4a59a2['id'] === _0x162460[_0x26fea3(0x17e)]) : document[_0x26fea3(0x3a7)](_0x26fea3(0x1c2))['click'](); }), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x434))[_0x4bfbce(0x215)](_0x4bfbce(0x236), async () => { const _0x16db8b = _0x4bfbce; await _0x2a396c(_0x16db8b(0x6e5)), localStorage[_0x16db8b(0x73)](_0x16db8b(0x8e)), _0x1c82fe(), _0x1bbd68(_0x16db8b(0x5b5)); }), document[_0x4bfbce(0x3a7)](_0x4bfbce(0x1c2))[_0x4bfbce(0x215)]('change', async _0x4d77ab => { const _0x368afa = _0x4bfbce, _0x13c8bf = _0x4d77ab[_0x368afa(0x94)][_0x368afa(0x83b)][0x0]; if (!_0x13c8bf) return; try { if ('mMpSW' !== _0x368afa(0x1fc)) { const _0x5116ce = _0x3ce558[_0x368afa(0x33f)](_0x362cec); if (_0x5116ce) { const _0x582c7e = _0x121bec(_0x5116ce[0x1], 0xa), _0x12d57d = _0x1622fa(_0x5116ce[0x2], 0xa), _0x367418 = _0x4e5a24(_0x5116ce[0x3], 0xa) * (_0x5116ce[0x3][_0x368afa(0x286)] === 0x2 ? 0xa : 0x1), _0x592474 = _0x582c7e * 0x3c + _0x12d57d + _0x367418 / 0x3e8, _0x2ff507 = _0x5e7899[_0x368afa(0x3d9)](_0x97fc44, '')[_0x368afa(0x3e3)](); _0x2ff507 && _0x54e2d8[_0x368afa(0x1fb)]({ 'time': _0x592474, 'text': _0x2ff507 }); } } else await _0x5c7ad7(_0x368afa(0x6e5), _0x13c8bf), await _0x1c82fe(), _0x1bbd68(_0x368afa(0xc2)); } catch (_0x57ae1b) { _0x1bbd68(_0x368afa(0x218) + _0x57ae1b[_0x368afa(0x15a)]); } }); } const _0x1afc56 = new Promise((_0x4337c1, _0x259e19) => { const _0x2e3a8a = _0x311e9d; if (_0x2e3a8a(0x7b7) === _0x2e3a8a(0x37c)) { const _0xae3985 = _0x329557(_0x498799[_0x2e3a8a(0x499)]())[_0x2e3a8a(0x26e)](0x2, '0'), _0x544744 = _0x4ad909(_0x1f5d1d[_0x2e3a8a(0x46a)]())['padStart'](0x2, '0'); _0x204db4[_0x2e3a8a(0x26b)] = _0xae3985 + ':' + _0x544744; const _0x15f302 = _0x10e9d9['getMonth']() + 0x1, _0x57a64e = _0x30b80d[_0x2e3a8a(0xec)](), _0x62d487 = [_0x2e3a8a(0x5cf), _0x2e3a8a(0x3d4), _0x2e3a8a(0x14e), _0x2e3a8a(0x2cd), '星期四', _0x2e3a8a(0x7d8), _0x2e3a8a(0x6a3)][_0x2360bf[_0x2e3a8a(0x385)]()]; _0x251e6e[_0x2e3a8a(0x26b)] = _0x15f302 + '月' + _0x57a64e + '日\x20' + _0x62d487; } else { const _0x15ab81 = indexedDB[_0x2e3a8a(0x1bc)](_0x51df2b, 0x2); _0x15ab81['onerror'] = () => _0x259e19('IndexedDB\x20failed\x20to\x20open'), _0x15ab81[_0x2e3a8a(0x61f)] = () => _0x4337c1(_0x15ab81[_0x2e3a8a(0x7ba)]); } }), _0x27f8d9 = _0x311e9d(0x55b); async function _0x344a0a(_0x456c9d) { const _0x2e66ae = _0x311e9d; if (_0x2e66ae(0x2e3) === _0x2e66ae(0x586)) { const _0xda632f = _0x59a81[_0x2e66ae(0x3e8)](_0x2e66ae(0x8cf)); _0xda632f[_0x2e66ae(0x8d8)] = _0x2e66ae(0x7fe), _0xda632f['id'] = _0x2e66ae(0x36d) + _0x2e2e36, _0x1a6d3c === _0x40c061[_0x2e66ae(0x8d9)] && _0xda632f[_0x2e66ae(0x1c1)]['add'](_0x2e66ae(0xa9)), _0x57bf3c[_0x2e66ae(0x436)](_0x553a6b => { const _0x8d13e6 = _0x2e66ae, _0xdecc6 = _0x553a6b[_0x8d13e6(0x563)] === _0x8d13e6(0x447) ? _0x8d13e6(0x447) : 'ai', _0x56de21 = _0x553a6b[_0x8d13e6(0x563)] === _0x8d13e6(0x447) ? _0x4f3820[_0x8d13e6(0x2e6)] : _0x4e26cd(_0x553a6b[_0x8d13e6(0x563)])['name'], _0x2107f4 = _0x39404a['createElement'](_0x8d13e6(0x8cf)); _0x2107f4[_0x8d13e6(0x8d8)] = _0x8d13e6(0x879) + _0xdecc6, _0x2107f4[_0x8d13e6(0x58e)][_0x8d13e6(0x375)] = _0x553a6b['timestamp'], _0x2107f4['style'][_0x8d13e6(0x6a6)] = 'none', _0x2107f4[_0x8d13e6(0x27d)][_0x8d13e6(0x46f)] = '0', _0x2107f4[_0x8d13e6(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x56de21 + _0x8d13e6(0xe8) + new _0x5c5ce5(_0x553a6b[_0x8d13e6(0x375)])['toLocaleString'](_0x8d13e6(0x7a0)) + _0x8d13e6(0x629) + _0x553a6b[_0x8d13e6(0x812)][_0x8d13e6(0x3d9)](/\n/g, _0x8d13e6(0x491)) + _0x8d13e6(0x54b), _0xda632f[_0x8d13e6(0x7d)](_0x2107f4); }), _0x5e624b[_0x2e66ae(0x7d)](_0xda632f); } else { const _0x3d0be4 = await _0x1afc56; return new Promise((_0x3c37a8, _0x219854) => { const _0x46da66 = _0x2e66ae, _0x5a43b5 = _0x3d0be4[_0x46da66(0x822)](_0x27f8d9, 'readonly'), _0x168ebf = _0x5a43b5[_0x46da66(0x16c)](_0x27f8d9), _0xbe685f = _0x168ebf[_0x46da66(0xab)](_0x456c9d); _0xbe685f[_0x46da66(0x61f)] = () => _0x3c37a8(_0xbe685f[_0x46da66(0x7ba)]), _0xbe685f[_0x46da66(0x3bd)] = () => _0x219854(_0xbe685f[_0x46da66(0x159)]); }); } } async function _0x2ed83b() { const _0x31ee94 = await _0x1afc56; return new Promise((_0x4a3bf1, _0x2b8c80) => { const _0x4055cd = _0x4fd4; if (_0x4055cd(0x148) === _0x4055cd(0x148)) { const _0x3943b9 = _0x31ee94[_0x4055cd(0x822)](_0x27f8d9, _0x4055cd(0x228)), _0x152c5b = _0x3943b9[_0x4055cd(0x16c)](_0x27f8d9), _0x4d1f6d = _0x152c5b[_0x4055cd(0x36f)](); _0x4d1f6d[_0x4055cd(0x61f)] = () => _0x4a3bf1(_0x4d1f6d[_0x4055cd(0x7ba)]), _0x4d1f6d[_0x4055cd(0x3bd)] = () => _0x2b8c80(_0x4d1f6d[_0x4055cd(0x159)]); } else { const _0x2b915f = _0x1fe5e1[_0x4055cd(0x3d5)]?.[_0x4055cd(0x4fe)](_0x50d23d['id']), _0xd5fe2b = _0x1129e2['createElement'](_0x4055cd(0x2de)); _0xd5fe2b[_0x4055cd(0x49f)] = _0x4055cd(0x324) + _0x1585e0['id'] + '\x22\x20' + (_0x2b915f ? _0x4055cd(0x238) : '') + '>\x20' + _0x21dc0d[_0x4055cd(0x2e6)], _0x324347[_0x4055cd(0x7d)](_0xd5fe2b); } }); } async function _0x5de7b5(_0x204d30) { const _0x135994 = await _0x1afc56; return new Promise((_0x40f6a9, _0x3c40e8) => { const _0x5345fd = _0x4fd4, _0xa0a122 = _0x135994['transaction'](_0x27f8d9, _0x5345fd(0x4ad)), _0x43ae82 = _0xa0a122[_0x5345fd(0x16c)](_0x27f8d9), _0x7873fc = _0x43ae82[_0x5345fd(0x9f)](_0x204d30); _0x7873fc[_0x5345fd(0x61f)] = () => _0x40f6a9(_0x7873fc[_0x5345fd(0x7ba)]), _0x7873fc[_0x5345fd(0x3bd)] = () => _0x3c40e8(_0x7873fc[_0x5345fd(0x159)]); }); } async function _0x3e8f9c(_0x5b642e) { const _0x5c2f70 = await _0x1afc56; return new Promise((_0xa5e71b, _0x471828) => { const _0x5e505d = _0x4fd4, _0xaf1c4c = _0x5c2f70['transaction'](_0x27f8d9, 'readwrite'), _0x10c782 = _0xaf1c4c[_0x5e505d(0x16c)](_0x27f8d9), _0x251451 = _0x10c782['delete'](_0x5b642e); _0x251451[_0x5e505d(0x61f)] = () => _0xa5e71b(), _0x251451[_0x5e505d(0x3bd)] = () => _0x471828(_0x251451[_0x5e505d(0x159)]); }); } let _0x5773c0 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x4b3f63 = { 'audio': document['getElementById'](_0x311e9d(0x3ed)), 'cover': document[_0x311e9d(0x3a7)](_0x311e9d(0x5d5)), 'info': document[_0x311e9d(0x3a7)](_0x311e9d(0x147)), 'lyrics': document[_0x311e9d(0x3a7)](_0x311e9d(0x275)) }, _0x9513d4 = { 'audio': document[_0x311e9d(0x3a7)]('audio-file-input'), 'cover': document['getElementById']('cover-file-input'), 'info': document['getElementById'](_0x311e9d(0x533)), 'lyrics': document[_0x311e9d(0x3a7)](_0x311e9d(0x52e)) }; for (const _0x5c0694 in _0x4b3f63) { _0x4b3f63[_0x5c0694]['addEventListener'](_0x311e9d(0x236), () => _0x9513d4[_0x5c0694][_0x311e9d(0x236)]()), _0x9513d4[_0x5c0694][_0x311e9d(0x215)](_0x311e9d(0x66a), _0x51176a => { const _0x55c667 = _0x311e9d; _0x55c667(0x62a) === _0x55c667(0x7cb) ? (_0x205122[_0x55c667(0x159)](_0x55c667(0x75d), _0x72dd4c), _0x4936b7(_0x55c667(0x3d1) + _0x4641b5[_0x55c667(0x15a)])) : _0x1075a3(_0x5c0694, _0x51176a[_0x55c667(0x94)]['files'][0x0]); }); } function _0x1075a3(_0x59b331, _0x51986d) { const _0x5a8072 = _0x311e9d; if (_0x5a8072(0x57b) !== _0x5a8072(0x57b)) _0x1e8038[_0x5a8072(0x159)](_0x5a8072(0x4a1), _0x47313b), _0x18741d = _0xcf1c39; else { if (!_0x51986d) return; _0x5773c0[_0x59b331] = _0x51986d, _0x4b3f63[_0x59b331][_0x5a8072(0x889)](_0x5a8072(0x6dd))[_0x5a8072(0x26b)] = _0x51986d[_0x5a8072(0x2e6)], _0x4b3f63[_0x59b331]['classList']['add'](_0x5a8072(0x2ff)), _0x182b06(); } } function _0x182b06() { const _0x22d286 = _0x311e9d, _0x71cead = document[_0x22d286(0x3a7)]('confirm-altar-upload-button'); _0x5773c0[_0x22d286(0x48c)] && _0x5773c0[_0x22d286(0x8df)] ? _0x71cead['disabled'] = ![] : _0x71cead[_0x22d286(0x313)] = !![]; } function _0x44748d() { const _0x3f4ecf = _0x311e9d; _0x5773c0 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x14a438 in _0x4b3f63) { _0x4b3f63[_0x14a438][_0x3f4ecf(0x1c1)][_0x3f4ecf(0x47e)](_0x3f4ecf(0x2ff)), _0x9513d4[_0x14a438][_0x3f4ecf(0x815)] = ''; } _0x4b3f63[_0x3f4ecf(0x48c)][_0x3f4ecf(0x889)](_0x3f4ecf(0x6dd))[_0x3f4ecf(0x26b)] = _0x3f4ecf(0x72f), _0x4b3f63[_0x3f4ecf(0x59e)][_0x3f4ecf(0x889)](_0x3f4ecf(0x6dd))[_0x3f4ecf(0x26b)] = '点击选择\x20.jpg\x20或\x20.png', _0x4b3f63[_0x3f4ecf(0x8df)]['querySelector']('.slot-filename')[_0x3f4ecf(0x26b)] = _0x3f4ecf(0x338), _0x4b3f63[_0x3f4ecf(0x3a5)][_0x3f4ecf(0x889)](_0x3f4ecf(0x6dd))[_0x3f4ecf(0x26b)] = _0x3f4ecf(0x658), _0x182b06(); } document[_0x311e9d(0x3a7)](_0x311e9d(0x644))['addEventListener'](_0x311e9d(0x236), async () => { const _0xc16927 = _0x311e9d; if (_0xc16927(0x6ab) === _0xc16927(0x6ab)) { if (!_0x5773c0[_0xc16927(0x48c)] || !_0x5773c0['info']) { _0x1bbd68('真是的，必需的祭品都还没准备好！'); return; } await _0x1b1a6e(); } else { _0x28c4e4 = _0x2ce74f(); const _0x2ef534 = _0x38e2d9[_0xc16927(0x3a7)](_0xc16927(0x11b))[_0xc16927(0x26b)]; _0x56399e = _0x2ef534 || _0xc16927(0x591); } }), document[_0x311e9d(0x3a7)]('upload-music-button')[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x2dc36c = _0x311e9d; _0x44748d(), _0x6564ff(_0x2dc36c(0x735), _0x2dc36c(0x1a2)); }), document[_0x311e9d(0x3a7)](_0x311e9d(0x174))[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0x14f381 = _0x311e9d; if (_0x14f381(0x5fb) !== 'wWJRP') _0x6564ff('musicLibrary', _0x14f381(0x735)); else { if (_0x3889d4 < 0x0 || _0x3b559e >= _0x3b6bc8[_0x14f381(0x286)]) return; _0x48ff6c = _0x567adb; const _0x3e247e = _0x32e7af[_0x23eb83]; _0x16305a[_0x14f381(0x8c7)] = _0x3e247e['playableUrl'] || _0x3e247e[_0x14f381(0x5cb)], _0x23fc41['play'](), _0x53c1f8(), _0x11a4e5(); } }); async function _0x1b1a6e() { const _0x1d0c29 = _0x311e9d; _0x3396e7(!![], _0x1d0c29(0x696)); try { if ('GLLkO' !== 'YWVxb') { const _0xb9fdd0 = await _0x5773c0[_0x1d0c29(0x8df)][_0x1d0c29(0x44f)](); let _0x431ce9; if (_0xb9fdd0[_0x1d0c29(0x3e3)]()[_0x1d0c29(0x279)]('{')) { if (_0x1d0c29(0x7b0) === _0x1d0c29(0x51a)) { _0x5623ad(_0x1d0c29(0x844)); return; } else _0x431ce9 = JSON['parse'](_0xb9fdd0); } else { if ('QZLNL' === _0x1d0c29(0x4aa)) { _0x431ce9 = {}; const _0x3327e = _0xb9fdd0['split']('\x0a'); _0x3327e[_0x1d0c29(0x436)](_0x4168d0 => { const _0x1acbc4 = _0x1d0c29; if (_0x1acbc4(0x16e) !== _0x1acbc4(0x8cd)) { const _0x36330f = _0x4168d0[_0x1acbc4(0x480)](/:\s|：\s/); if (_0x36330f['length'] === 0x2) { if ('CJVod' !== 'YrOLh') { const _0xfd2414 = _0x36330f[0x0][_0x1acbc4(0x3e3)](), _0x2f7689 = _0x36330f[0x1][_0x1acbc4(0x3e3)](), _0x38dd88 = { '歌名': _0x1acbc4(0x722), '艺术家': '歌手', '专辑': '专辑' }; _0x38dd88[_0xfd2414] && ('hZHgl' === _0x1acbc4(0x620) ? _0x480bb8[_0x1acbc4(0x215)](_0x1acbc4(0x236), () => { const _0x46eb62 = _0x1acbc4; if (_0x3c4d49[_0x46eb62(0x286)] === 0x0) return; _0x19eaa8 = (_0x48db58 - 0x1 + _0x42826f[_0x46eb62(0x286)]) % _0x538d7c[_0x46eb62(0x286)], _0x41032b(_0x55ceec[_0x107bea], _0x5e971e); }) : _0x431ce9[_0x38dd88[_0xfd2414]] = _0x2f7689); } else _0x2623eb[_0x1acbc4(0x8c7)] && _0x3590df['style']['opacity'] !== '0' ? (_0x5eec47[_0x1acbc4(0x27d)]['opacity'] = 0x0, _0x134073(() => { const _0x5773b6 = _0x1acbc4; _0x1636a4[_0x5773b6(0x8c7)] = _0x451d16[_0x5773b6(0x99)](_0x5e1b05), _0x2ff104[_0x5773b6(0x27d)][_0x5773b6(0x3ab)] = 0x1; }, 0x96)) : (_0x158e5f[_0x1acbc4(0x8c7)] = _0x3ecf53[_0x1acbc4(0x99)](_0x12e71d), _0x2b56a7[_0x1acbc4(0x27d)][_0x1acbc4(0x3ab)] = 0x1); } } else _0x302750[_0x1acbc4(0x1c1)][_0x1acbc4(0x676)]('show'), _0x3fd2ca[_0x1acbc4(0x1c1)][_0x1acbc4(0xa1)]('show') && (_0x1e33b3[_0x1acbc4(0x19c)] = _0x5d68ae[_0x1acbc4(0x602)]); }); if (!_0x431ce9[_0x1d0c29(0x722)]) throw new Error(_0x1d0c29(0x897)); _0x431ce9[_0x1d0c29(0xbd)] = 'song_' + Date['now'](); } else { _0x832c1d['innerHTML'] = _0x1d0c29(0x723); return; } } const _0x45ad71 = _0x1d0c29(0x70f) + (_0x431ce9[_0x1d0c29(0xbd)] || Date[_0x1d0c29(0x6bb)]()), _0x1d5aad = { 'id': _0x45ad71, 'info': _0x431ce9, 'audio': _0x5773c0[_0x1d0c29(0x48c)], 'cover': _0x5773c0[_0x1d0c29(0x59e)], 'lyrics': _0x5773c0['lyrics'] ? await _0x5773c0[_0x1d0c29(0x3a5)]['text']() : '' }; await _0x5de7b5(_0x1d5aad), await _0x100420(), _0x3396e7(![]), _0x1bbd68(_0x1d0c29(0x5e6) + _0x431ce9[_0x1d0c29(0x722)] + _0x1d0c29(0x2fa)), _0x6564ff(_0x1d0c29(0x1a2), _0x1d0c29(0x735)); } else _0x1c9345('图标处理失败:\x20' + _0x443b6c[_0x1d0c29(0x15a)]); } catch (_0xa06017) { _0x3396e7(![]), console[_0x1d0c29(0x159)]('解析音乐文件失败:', _0xa06017), _0x1bbd68(_0x1d0c29(0xc6) + _0xa06017['message']); } } async function _0x100420() { const _0xf30b7f = _0x311e9d, _0x13cbf9 = document[_0xf30b7f(0x3a7)](_0xf30b7f(0x34c)); _0x13cbf9[_0xf30b7f(0x49f)] = ''; const _0x396457 = await _0x2ed83b(); if (_0x396457[_0xf30b7f(0x286)] === 0x0) { if (_0xf30b7f(0x24d) !== _0xf30b7f(0x24d)) { _0x58e68f[_0xf30b7f(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } else { _0x13cbf9['innerHTML'] = _0xf30b7f(0x603); return; } } _0x396457['sort']((_0x5616df, _0x318939) => (_0x5616df['info'][_0xf30b7f(0x722)] || '')[_0xf30b7f(0x351)](_0x318939[_0xf30b7f(0x8df)]['歌曲名称'] || '')); for (const _0x22db09 of _0x396457) { if (_0xf30b7f(0x4f9) !== 'sYrrG') { const _0x4d9f93 = document[_0xf30b7f(0x3e8)](_0xf30b7f(0x8cf)); _0x4d9f93[_0xf30b7f(0x8d8)] = 'music-library-item', _0x4d9f93[_0xf30b7f(0x58e)]['songId'] = _0x22db09['id']; const _0x346125 = _0x22db09[_0xf30b7f(0x59e)] ? URL[_0xf30b7f(0x99)](_0x22db09[_0xf30b7f(0x59e)]) : _0x4716b3; _0x4d9f93[_0xf30b7f(0x49f)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x346125 + _0xf30b7f(0x15e) + (_0x22db09[_0xf30b7f(0x8df)][_0xf30b7f(0x722)] || _0xf30b7f(0x1b1)) + _0xf30b7f(0x306) + (_0x22db09['info']['歌手'] || _0xf30b7f(0x41c)) + _0xf30b7f(0x79b); let _0x34d18a = null; const _0x31a3f1 = _0x1dce04 => { const _0x531052 = _0xf30b7f; if (_0x1dce04[_0x531052(0x895)] === 0x2) return; _0x34d18a = setTimeout(async () => { const _0x4b1e80 = _0x531052; if (_0x1dce04[_0x4b1e80(0x78c)] === _0x4b1e80(0xd0)) _0x1dce04[_0x4b1e80(0x425)](); const _0x3be047 = await _0x4849f2(_0x4b1e80(0x40e) + _0x22db09[_0x4b1e80(0x8df)][_0x4b1e80(0x722)] + _0x4b1e80(0x6cd)); if (_0x3be047) { if (_0x4b1e80(0x2a5) === _0x4b1e80(0x31c)) return _0x2be438(_0x2ab779)[_0x4b1e80(0x3fa)](_0x22cc15 => _0x22cc15[_0x4b1e80(0x5c0)]()); else await _0x3e8f9c(_0x22db09['id']), await _0x100420(), _0x1bbd68(_0x4b1e80(0x5fe)); } }, 0x320); }, _0x27e7bc = () => { clearTimeout(_0x34d18a); }; _0x4d9f93['addEventListener'](_0xf30b7f(0x395), _0x31a3f1), _0x4d9f93[_0xf30b7f(0x215)](_0xf30b7f(0xa3), _0x27e7bc), _0x4d9f93['addEventListener'](_0xf30b7f(0x7e2), _0x27e7bc), _0x4d9f93[_0xf30b7f(0x215)](_0xf30b7f(0xd0), _0x31a3f1, { 'passive': ![] }), _0x4d9f93[_0xf30b7f(0x215)](_0xf30b7f(0x494), _0x27e7bc), _0x4d9f93[_0xf30b7f(0x215)]('touchcancel', _0x27e7bc), _0x4d9f93[_0xf30b7f(0x215)](_0xf30b7f(0x236), _0x1f7c91 => { const _0x1f79ab = _0xf30b7f; if (_0x1f79ab(0x5f1) === 'hoDUd') _0x5c60d0[_0x1f79ab(0x215)](_0x1f79ab(0x236), function () { const _0x58ac29 = _0x1f79ab, _0x233e0b = { 'id': 'msg_' + _0x3e3b52[_0x58ac29(0x375)], 'url': _0x467a06[_0x58ac29(0x89c)] }; _0x350e37(this, _0x233e0b); }); else { if (_0x34d18a) clearTimeout(_0x34d18a); if (_0x1f7c91[_0x1f79ab(0x650)]) return; setTimeout(() => { const _0xd884f5 = _0x1f79ab; _0x34d18a && _0x3eea24(_0x22db09['id'], _0x396457[_0xd884f5(0x7cc)](_0x4a325c => _0x4a325c['id'])); }, 0x32); } }), _0x13cbf9[_0xf30b7f(0x7d)](_0x4d9f93); } else _0x2a9019['src'] = _0x5f5b0e[_0xf30b7f(0x99)](_0x31afe9); } } _0x4393b0[_0x311e9d(0x215)]('click', () => { const _0x3db4b0 = _0x311e9d; _0x3db4b0(0x7bd) === _0x3db4b0(0x213) ? (_0x79db6b(), _0x15cfe5(_0x3db4b0(0x8cc), _0x3db4b0(0x519))) : _0x1bbd68(_0x3db4b0(0x413)); }), _0x4be690['addEventListener'](_0x311e9d(0x236), () => { const _0x10ca06 = _0x311e9d; _0x1bbd68(_0x10ca06(0x647)); }); let _0x50a5a7 = [], _0x1960b7 = -0x1; async function _0x3eea24(_0xd74c2f, _0x1b21c5) { const _0x4296d0 = _0x311e9d, _0x4c5c2 = await _0x344a0a(_0xd74c2f); if (!_0x4c5c2) return; _0x415b4f = { 'title': _0x4c5c2[_0x4296d0(0x8df)][_0x4296d0(0x722)] || _0x4296d0(0x1b1), 'artist': _0x4c5c2[_0x4296d0(0x8df)]['歌手'] || _0x4296d0(0x41c), 'cover': _0x4c5c2['cover'] ? URL[_0x4296d0(0x99)](_0x4c5c2[_0x4296d0(0x59e)]) : _0x4716b3, 'isFromLibrary': !![] }; const _0x1edd9c = URL['createObjectURL'](_0x4c5c2[_0x4296d0(0x48c)]); _0x77bdcd[_0x4296d0(0x8c7)] = _0x1edd9c, _0x77bdcd['play'](), _0x5d1f29(); } async function _0x5d1f29() { const _0xa985a2 = _0x311e9d, _0x35b63b = document['getElementById']('music-widget-card'), _0x84d9ff = document['getElementById']('widget-title'), _0x3f0411 = document[_0xa985a2(0x3a7)](_0xa985a2(0x701)), _0x101718 = document[_0xa985a2(0x3a7)](_0xa985a2(0x80e)), _0x42480c = _0x415b4f; _0x42480c && _0x42480c[_0xa985a2(0x737)] ? (_0x84d9ff['textContent'] = _0x42480c[_0xa985a2(0x373)], _0x3f0411['textContent'] = _0x42480c[_0xa985a2(0x45d)], _0x35b63b[_0xa985a2(0x1c1)][_0xa985a2(0x65b)]('is-playing'), _0x35b63b['style'][_0xa985a2(0x31d)](_0xa985a2(0x65e), _0xa985a2(0x462) + _0x42480c[_0xa985a2(0x59e)] + ')')) : 'ynofn' === _0xa985a2(0x65d) ? (_0x84d9ff[_0xa985a2(0x26b)] = '暂无音乐', _0x3f0411[_0xa985a2(0x26b)] = _0xa985a2(0x3df), _0x35b63b[_0xa985a2(0x1c1)]['remove'](_0xa985a2(0x9d)), _0x101718['style'][_0xa985a2(0x31d)](_0xa985a2(0x65e), _0xa985a2(0x87b))) : _0x17224c[_0xa985a2(0x535)][_0xa985a2(0x87d)](_0xa985a2(0x181)); } _0x4393b0 && (_0x311e9d(0x588) !== 'xGXQV' ? _0x4393b0[_0x311e9d(0x215)](_0x311e9d(0x236), () => { const _0xa23efa = _0x311e9d; if (_0xa23efa(0x50c) === _0xa23efa(0x50c)) { if (_0x50a5a7['length'] === 0x0) return; _0x1960b7 = (_0x1960b7 + 0x1) % _0x50a5a7[_0xa23efa(0x286)], _0x3eea24(_0x50a5a7[_0x1960b7], _0x50a5a7); } else { const _0x5025f9 = _0xb72431(_0x2350ee['participantIds'][0x0]); return _0x5025f9?.['name'] || 'AI'; } }) : _0x4bd752[_0x311e9d(0x3d5)] = _0x2bfe4f[_0x311e9d(0x3d5)][_0x311e9d(0x16f)](_0x540b30 => _0x540b30 !== _0xb06407)); _0x4be690 && _0x4be690[_0x311e9d(0x215)]('click', () => { const _0x47418d = _0x311e9d; if (_0x50a5a7[_0x47418d(0x286)] === 0x0) return; _0x1960b7 = (_0x1960b7 - 0x1 + _0x50a5a7['length']) % _0x50a5a7[_0x47418d(0x286)], _0x3eea24(_0x50a5a7[_0x1960b7], _0x50a5a7); }); _0x77bdcd[_0x311e9d(0x215)](_0x311e9d(0x2ed), () => { const _0x4e8ed5 = _0x311e9d; if (_0x36107) _0x36107[_0x4e8ed5(0x26b)] = '❚❚'; }), _0x77bdcd[_0x311e9d(0x215)](_0x311e9d(0x7f8), () => { const _0x1488bf = _0x311e9d; if (_0x36107) _0x36107[_0x1488bf(0x26b)] = '▶'; }), _0x77bdcd['addEventListener'](_0x311e9d(0x330), () => { const _0x5575c2 = _0x311e9d; if ('guIqQ' === 'KlNpZ') { _0x5d1062(_0x5575c2(0x1d7)); return; } else { if (_0x4393b0) _0x4393b0['click'](); } }); function _0x58de46() { const _0x29e1e2 = _0x311e9d, _0x4a5c9b = _0x4db4a7(); if (!_0x4a5c9b) return; _0x238a70['innerHTML'] = '', _0x56fcf1[_0x29e1e2(0x815)] = '', _0x4a5c9b[_0x29e1e2(0x78c)] === _0x29e1e2(0x3bc) ? (_0x4a5c9b['participantIds']['forEach'](_0xf1977e => { const _0x31eb59 = _0x29e1e2, _0x2f7948 = _0x3f1cb7(_0xf1977e); if (_0x2f7948) { if ('bpSjq' === _0x31eb59(0x885)) { if (_0x47a9a7 < 0x0 || _0x2b22bc >= _0xfcfa99) return; _0xdca30f[_0x31eb59(0x27d)][_0x31eb59(0x290)] = _0x31eb59(0x872) + _0x580f66 * (0x64 / _0x133065) + '%)', _0x1a8c75['forEach'](_0xbfd5bd => _0xbfd5bd[_0x31eb59(0x1c1)][_0x31eb59(0x47e)](_0x31eb59(0x21b))), _0x54379e[_0x5396a6][_0x31eb59(0x1c1)][_0x31eb59(0x65b)](_0x31eb59(0x21b)), _0x453527 = _0x3ec1a3; } else { const _0x3eea44 = document[_0x31eb59(0x3e8)](_0x31eb59(0x829)); _0x3eea44[_0x31eb59(0x815)] = _0x2f7948['id'], _0x3eea44[_0x31eb59(0x26b)] = _0x2f7948[_0x31eb59(0x2e6)], _0x238a70['appendChild'](_0x3eea44); } } }), _0xaae5ca[_0x29e1e2(0x27d)][_0x29e1e2(0x5a4)] = _0x29e1e2(0x7dc)) : _0x29e1e2(0x3ff) !== 'SDvCl' ? _0xaae5ca[_0x29e1e2(0x27d)]['display'] = 'none' : _0x214008('错误:\x20' + _0x1785fa[_0x29e1e2(0x15a)]), _0x44797b[_0x29e1e2(0x1c1)][_0x29e1e2(0x65b)](_0x29e1e2(0x7de)), _0x56fcf1[_0x29e1e2(0x7c9)](); } function _0xce3bd5() { const _0x32e49d = _0x311e9d; if ('NIxCP' !== _0x32e49d(0x277)) { const _0x4a7b0f = parseFloat(_0x56fcf1['value']); if (isNaN(_0x4a7b0f) || _0x4a7b0f <= 0x0) { if (_0x32e49d(0x268) !== _0x32e49d(0x268)) { _0x28678d[_0x32e49d(0x49f)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } else { _0x1bbd68(_0x32e49d(0x4ae)); return; } } const _0x37baef = _0x4db4a7(); let _0x2bf238 = null; _0x37baef[_0x32e49d(0x78c)] === 'group' ? _0x2bf238 = _0x238a70['value'] : _0x2bf238 = _0x37baef[_0x32e49d(0x239)][0x0]; const _0x2b8eeb = _0x9333e5(_0x37baef['id']), _0x1377d1 = { 'role': _0x32e49d(0x447), 'type': 'transfer', 'content': _0x32e49d(0x216) + (_0x3f1cb7(_0x2bf238)?.['name'] || '未知') + _0x32e49d(0x442) + _0x4a7b0f + ']', 'amount': _0x4a7b0f, 'recipientId': _0x2bf238, 'senderId': _0x2b8eeb['id'], 'timestamp': Date['now']() }; _0x40321a[_0x32e49d(0x393)][_0x32e49d(0x1fb)](_0x1377d1), _0x174e50(), _0x259a7d(), _0x44797b[_0x32e49d(0x1c1)]['remove'](_0x32e49d(0x7de)); } else { if (_0x382777[_0x32e49d(0x286)] === 0x0) return; _0x1f6660 = (_0x1376fc + 0x1) % _0x49fb69['length'], _0x17e7bf(_0x53206a[_0x31cee8], _0x2d8d3e); } } async function _0x31c172(_0x523b5e) { const _0x5de053 = _0x311e9d; if ('ooyUA' !== _0x5de053(0x6a2)) _0x4c0c25[_0x5de053(0x2e6)] !== _0x5de053(0x75c) && (_0x4d0137['error']('获取AI响应失败:', _0x1facbd), _0x4945cf({ 'role': _0x5de053(0x18d), 'content': '错误:\x20' + _0xf8359e[_0x5de053(0x15a)] }, _0x1bf9f3[_0x5de053(0x393)][_0x5de053(0x286)] - 0x1)); else { const _0x8fba91 = _0x3f1cb7(_0x523b5e); if (!_0x8fba91) return; const _0x4a448a = await _0x4849f2(_0x5de053(0x439) + _0x8fba91['name'] + '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。'); if (!_0x4a448a) return; const _0x236a8b = _0x40321a[_0x5de053(0x7e5)][_0x5de053(0xcd)](_0xea6009 => _0xea6009['characterId'] === _0x523b5e); _0x236a8b > -0x1 ? (_0x40321a[_0x5de053(0x7e5)][_0x5de053(0x855)](_0x236a8b, 0x1), _0x544cbe(), _0x264b16(), _0x1bbd68('【' + _0x8fba91['name'] + _0x5de053(0x463))) : _0x1bbd68(_0x5de053(0x1f6)); } } _0x7f467e(); }); async function _0x648798() { const _0x40a3df = _0x5b93b5; console[_0x40a3df(0x336)]('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x40a3df(0x336)](_0x40a3df(0x8db)); const _0x52a2e3 = _0x40a3df(0x33a), _0x48bec4 = 'images', _0x412948 = new Promise((_0x5a6ac9, _0x17b393) => { const _0xf3844c = _0x40a3df, _0x17ece4 = indexedDB[_0xf3844c(0x1bc)](_0x52a2e3, 0x2); _0x17ece4[_0xf3844c(0x3bd)] = () => _0x17b393('IndexedDB\x20failed\x20to\x20open'), _0x17ece4[_0xf3844c(0x61f)] = () => _0x5a6ac9(_0x17ece4[_0xf3844c(0x7ba)]), _0x17ece4[_0xf3844c(0x557)] = _0x4e4c8b => { const _0x2e28cb = _0xf3844c; if (_0x2e28cb(0x851) === _0x2e28cb(0x851)) { const _0x570cff = _0x4e4c8b['target'][_0x2e28cb(0x7ba)]; !_0x570cff[_0x2e28cb(0x3e1)][_0x2e28cb(0xa1)](_0x48bec4) && ('fHcYt' === 'fHcYt' ? _0x570cff[_0x2e28cb(0x29d)](_0x48bec4, { 'keyPath': 'id' }) : _0x3f6fbb = _0x2faa07(_0x3c0d21[_0x2e28cb(0x239)][0x0])), !_0x570cff['objectStoreNames']['contains'](_0x2e28cb(0x55b)) && _0x570cff[_0x2e28cb(0x29d)](_0x2e28cb(0x55b), { 'keyPath': 'id' }); } else { const _0x15607a = _0x17ddbe[_0x2e28cb(0x21e)]('p'); _0x15607a[_0x2e28cb(0x436)](_0x2df8db => _0x2df8db['classList'][_0x2e28cb(0x47e)]('active')); const _0x3779a3 = _0xbfbe75['getElementById'](_0x2e28cb(0x90) + _0x4eec5f); _0x3779a3 && (_0x3779a3['classList'][_0x2e28cb(0x65b)]('active'), _0x3779a3[_0x2e28cb(0xfb)]({ 'behavior': 'smooth', 'block': _0x2e28cb(0x50d) })); } }; }); async function _0x97399d(_0xac34c, _0x50d591) { const _0x2cf3a8 = await _0x412948; return new Promise((_0x532a4c, _0xfa52e5) => { const _0x292089 = _0x4fd4, _0x387035 = _0x2cf3a8[_0x292089(0x822)](_0x48bec4, 'readwrite'), _0x56f14a = _0x387035[_0x292089(0x16c)](_0x48bec4), _0x2504da = _0x56f14a[_0x292089(0x9f)]({ 'id': _0xac34c, 'blob': _0x50d591 }); _0x2504da['onsuccess'] = () => _0x532a4c(_0x2504da[_0x292089(0x7ba)]), _0x2504da[_0x292089(0x3bd)] = () => _0xfa52e5(_0x2504da['error']); }); } function _0x21fb5d(_0x265864) { const _0x4002fe = _0x40a3df; return fetch(_0x265864)[_0x4002fe(0x3fa)](_0x59a78b => _0x59a78b['blob']()); } let _0xd6fcd4 = 0x0; for (let _0x64bc1e = 0x0; _0x64bc1e < localStorage['length']; _0x64bc1e++) { const _0x15edad = localStorage['key'](_0x64bc1e); if (_0x15edad && _0x15edad['startsWith']('chatHistory_')) { let _0x47c7fe, _0x37eb26 = ![]; try { if (_0x40a3df(0x5aa) !== _0x40a3df(0x5aa)) _0x550d92[_0x40a3df(0x1fb)](_0x5974b0[_0x229b95]['trim']()), _0x3dd1c0++; else { _0x47c7fe = JSON[_0x40a3df(0x5b1)](localStorage[_0x40a3df(0x8b4)](_0x15edad)); if (!Array[_0x40a3df(0x1d4)](_0x47c7fe)) continue; for (const _0x2187f1 of _0x47c7fe) { if (_0x40a3df(0x785) !== _0x40a3df(0x785)) _0x508e1c['content'] = _0x1ed3fc, _0x5f3db7(), _0x47b96a(); else { if (_0x2187f1 && _0x2187f1[_0x40a3df(0x888)] && _0x2187f1['image'][_0x40a3df(0x279)](_0x40a3df(0x7f3))) { if ('MHTYm' !== _0x40a3df(0x2f0)) _0x2e782e[_0x40a3df(0x8c7)] = _0x44c154[_0x40a3df(0x888)]; else { const _0x2b5c95 = await _0x21fb5d(_0x2187f1[_0x40a3df(0x888)]), _0xb630a5 = 'chat_image_migrated_' + Date[_0x40a3df(0x6bb)]() + '_' + Math['random'](); await _0x97399d(_0xb630a5, _0x2b5c95), _0x2187f1[_0x40a3df(0x3a0)] = _0xb630a5, delete _0x2187f1[_0x40a3df(0x888)], _0x37eb26 = !![], _0xd6fcd4++; } } } } _0x37eb26 && localStorage[_0x40a3df(0x7aa)](_0x15edad, JSON[_0x40a3df(0x504)](_0x47c7fe)); } } catch (_0x29fb8a) { if ('IarGz' === _0x40a3df(0x880)) { const _0x5dc427 = _0x2ce989[_0x40a3df(0x1bc)](_0x83024, 0x2); _0x5dc427[_0x40a3df(0x3bd)] = () => _0x3db976(_0x40a3df(0x22c)), _0x5dc427[_0x40a3df(0x61f)] = () => _0x520798(_0x5dc427[_0x40a3df(0x7ba)]); } else { console[_0x40a3df(0x159)](_0x40a3df(0x32c) + _0x15edad + _0x40a3df(0x711), _0x29fb8a); continue; } } } } console['log'](_0x40a3df(0x4be) + _0xd6fcd4 + _0x40a3df(0x193)); } async function _0xf52059() { const _0x2b36b9 = _0x5b93b5; console[_0x2b36b9(0x336)](_0x2b36b9(0x867)), console[_0x2b36b9(0x336)](_0x2b36b9(0xcc)); async function _0x8b8a25(_0x21c4ba, _0x298550) { const _0x36f93d = await _0x4aa0e5; return new Promise((_0x421d5c, _0x12e31e) => { const _0x2b2ce5 = _0x4fd4, _0x476037 = _0x36f93d[_0x2b2ce5(0x822)](_0x2b2ce5(0x237), _0x2b2ce5(0x4ad)), _0x49224d = _0x476037[_0x2b2ce5(0x16c)](_0x2b2ce5(0x237)), _0x138872 = _0x49224d[_0x2b2ce5(0x9f)]({ 'id': _0x21c4ba, 'blob': _0x298550 }); _0x138872[_0x2b2ce5(0x61f)] = () => _0x421d5c(_0x138872[_0x2b2ce5(0x7ba)]), _0x138872['onerror'] = () => _0x12e31e(_0x138872[_0x2b2ce5(0x159)]); }); } function _0x232b42(_0x595a1e) { const _0x4c8ee6 = _0x2b36b9; return fetch(_0x595a1e)['then'](_0x4a293d => _0x4a293d[_0x4c8ee6(0x5c0)]()); } let _0x507a5a = 0x0, _0x3a784d = ![]; try { const _0x40ea99 = localStorage[_0x2b36b9(0x8b4)](_0x2b36b9(0x764)); if (!_0x40ea99) { if (_0x2b36b9(0x4eb) !== 'cyCFu') { console[_0x2b36b9(0x336)](_0x2b36b9(0x305)); return; } else { const _0x133619 = _0x949a83['transaction'](_0x5e2c67, _0x2b36b9(0x228)), _0x1f2557 = _0x133619[_0x2b36b9(0x16c)](_0x3764c4), _0x11904a = _0x1f2557[_0x2b36b9(0x36f)](); _0x11904a[_0x2b36b9(0x61f)] = () => _0x4bf5d6(_0x11904a[_0x2b36b9(0x7ba)]), _0x11904a[_0x2b36b9(0x3bd)] = () => _0x27340c(_0x11904a[_0x2b36b9(0x159)]); } } const _0x4f6093 = JSON[_0x2b36b9(0x5b1)](_0x40ea99); if (!_0x4f6093[_0x2b36b9(0x7ab)] || !Array[_0x2b36b9(0x1d4)](_0x4f6093[_0x2b36b9(0x7ab)])) return; for (const _0x385f28 of _0x4f6093[_0x2b36b9(0x7ab)]) { if (_0x2b36b9(0x4df) === 'usvYc') _0x57bdb1[_0x2b36b9(0x19c)] = _0x556f9b[_0x2b36b9(0x602)]; else { if (_0x385f28[_0x2b36b9(0x188)] && Array[_0x2b36b9(0x1d4)](_0x385f28[_0x2b36b9(0x188)])) for (const _0x5d33c3 of _0x385f28[_0x2b36b9(0x188)]) { if (_0x5d33c3 && _0x5d33c3[_0x2b36b9(0x888)] && _0x5d33c3['image']['startsWith'](_0x2b36b9(0x7f3))) { console[_0x2b36b9(0x336)](_0x2b36b9(0x208) + _0x385f28[_0x2b36b9(0x2e6)] + _0x2b36b9(0xee)); const _0x3e13aa = await _0x232b42(_0x5d33c3['image']), _0x2a25f8 = _0x2b36b9(0x4a8) + Date[_0x2b36b9(0x6bb)]() + '_' + Math[_0x2b36b9(0x775)](); await _0x8b8a25(_0x2a25f8, _0x3e13aa), _0x5d33c3[_0x2b36b9(0x3a0)] = _0x2a25f8, delete _0x5d33c3[_0x2b36b9(0x888)], _0x3a784d = !![], _0x507a5a++; } } } } _0x3a784d && (console[_0x2b36b9(0x336)](_0x2b36b9(0x819)), localStorage['setItem'](_0x2b36b9(0x764), JSON[_0x2b36b9(0x504)](_0x4f6093))); } catch (_0x3ce237) { console[_0x2b36b9(0x159)](_0x2b36b9(0x6af), _0x3ce237); } return console['log'](_0x2b36b9(0x656)), console[_0x2b36b9(0x336)]('成功净化并迁移了\x20' + _0x507a5a + _0x2b36b9(0xce)), _0x507a5a; } async function _0x317fbc() { const _0x240173 = _0x5b93b5; console[_0x240173(0x336)]('---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---'), console[_0x240173(0x336)]('哼，正在净化你那些超重的音乐分享记录...'); let _0x1e5672 = 0x0, _0x42ca29 = ![]; try { const _0x225504 = localStorage['getItem'](_0x240173(0x764)); if (!_0x225504) return console[_0x240173(0x336)](_0x240173(0x85e)), 0x0; for (let _0x1b947f = 0x0; _0x1b947f < localStorage[_0x240173(0x286)]; _0x1b947f++) { const _0x4ba7fe = localStorage[_0x240173(0x11c)](_0x1b947f); if (_0x4ba7fe && _0x4ba7fe[_0x240173(0x279)](_0x240173(0x4a7))) { let _0x2ee9ae, _0x31227e = ![]; try { _0x2ee9ae = JSON[_0x240173(0x5b1)](localStorage[_0x240173(0x8b4)](_0x4ba7fe)); if (!Array[_0x240173(0x1d4)](_0x2ee9ae)) continue; for (const _0x56ba2d of _0x2ee9ae) { if (_0x56ba2d && (_0x56ba2d['type'] === _0x240173(0x242) || _0x56ba2d['type'] === _0x240173(0x368)) && _0x56ba2d[_0x240173(0x102)] && _0x56ba2d[_0x240173(0x102)][_0x240173(0x279)](_0x240173(0x7f3))) { const _0x8b22e = await _0x3cb589(_0x56ba2d[_0x240173(0x102)]), _0x430b12 = _0x240173(0x71d) + Date[_0x240173(0x6bb)]() + '_' + Math[_0x240173(0x775)](); await _0x5c7ad7(_0x430b12, _0x8b22e), _0x56ba2d[_0x240173(0x3c0)] = _0x430b12, delete _0x56ba2d[_0x240173(0x102)], _0x31227e = !![], _0x1e5672++; } } _0x31227e && localStorage[_0x240173(0x7aa)](_0x4ba7fe, JSON[_0x240173(0x504)](_0x2ee9ae)); } catch (_0x46a038) { console[_0x240173(0x159)](_0x240173(0x32c) + _0x4ba7fe + _0x240173(0x4ab), _0x46a038); continue; } } } } catch (_0x28d9ff) { if ('SFwEO' !== _0x240173(0x1ab)) { let _0x285004 = _0x239c31[_0x240173(0x3e3)](); const _0x4988eb = _0x285004[_0x240173(0x33f)](/(\[[\s\S]*\])/); _0x4988eb && (_0x285004 = _0x4988eb[0x1]); const _0x5223eb = _0x156f35[_0x240173(0x5b1)](_0x285004); if (_0x13c4b3[_0x240173(0x1d4)](_0x5223eb)) { _0x549d6c[_0x240173(0x38b)] = _0x5223eb, _0x45b983['characterLastScripts'][_0x7f8ab8['id']] = [..._0x5223eb], _0x15e1a4(); const _0x1c5d7e = _0x5223eb['map'](_0x3221f9 => _0x3221f9['speaker'] === 'narrator' ? _0x3221f9[_0x240173(0x175)] : _0x3221f9[_0x240173(0x244)] + ':\x20' + _0x3221f9[_0x240173(0x175)])['join']('\x0a\x0a'); _0x2be5ac[_0x240173(0x393)][_0x240173(0x1fb)]({ 'role': _0x240173(0x18d), 'senderId': _0x38985d['id'], 'timestamp': _0x4bb581['now'](), 'isOffline': !![], 'content': _0x1c5d7e }); } } else console['error'](_0x240173(0x326), _0x28d9ff); } return console['log'](_0x240173(0xf4)), console[_0x240173(0x336)](_0x240173(0x675) + _0x1e5672 + '\x20张旧的音乐封面。'), _0x1e5672; } function _0x4b78c8() { const _0x6a997c = _0x5b93b5; if (!_0x40321a[_0x6a997c(0x23e)]) { if ('gkhaO' === _0x6a997c(0x1cd)) return _0x40321a[_0x6a997c(0x7c0)][_0x6a997c(0x226)](_0x158ab4 => _0x158ab4['id'] === _0x40321a[_0x6a997c(0x17e)]) || _0x40321a['userProfiles'][0x0]; else _0x25a55b[_0x6a997c(0x26b)] = _0x6a997c(0x6ee), _0x53db57[_0x6a997c(0x815)] = '', _0x48d4bb[_0x6a997c(0x815)] = _0x6a997c(0x292) + (_0x17cefb['friendCircles']['length'] + 0x1), _0x55332a['value'] = _0x449726[_0x6a997c(0x17e)], _0x5087ad[_0x6a997c(0x27d)][_0x6a997c(0x5a4)] = _0x6a997c(0x87b); } const _0x1beb0d = _0x40321a[_0x6a997c(0x478)][_0x6a997c(0x226)](_0x341bf8 => _0x341bf8[_0x6a997c(0x78c)] === _0x6a997c(0x64f) && _0x341bf8[_0x6a997c(0x239)][_0x6a997c(0x4fe)](_0x40321a[_0x6a997c(0x23e)])), _0x4919fe = _0x1beb0d?.['boundUserProfileId'] || _0x40321a['activeUserProfileId']; return _0x40321a[_0x6a997c(0x7c0)]['find'](_0x1d1568 => _0x1d1568['id'] === _0x4919fe) || _0x40321a[_0x6a997c(0x7c0)][0x0]; } function _0x5ea1f0(_0x75747c) { const _0x371c1d = _0x5b93b5, _0x1b32ea = new Date(), _0xf03e74 = _0x1b32ea - _0x75747c, _0xcfa5a6 = Math[_0x371c1d(0x824)](_0xf03e74 / 0x3e8), _0x1e7a9b = Math[_0x371c1d(0x824)](_0xcfa5a6 / 0x3c), _0x1d5a7f = Math[_0x371c1d(0x824)](_0x1e7a9b / 0x3c), _0x616dd6 = Math[_0x371c1d(0x824)](_0x1d5a7f / 0x18), _0x40942c = _0x75747c[_0x371c1d(0x25c)](_0x371c1d(0x7a0), { 'hour': _0x371c1d(0x58c), 'minute': _0x371c1d(0x58c) }); if (_0xcfa5a6 < 0x3c) return '刚才'; if (_0x1e7a9b < 0x3c) { if (_0x371c1d(0x72d) === 'Evijw') { _0x5b33a4(_0x371c1d(0x770)); return; } else return _0x1e7a9b + _0x371c1d(0x17d); } const _0x239697 = _0x1b32ea[_0x371c1d(0x2d3)]() === _0x75747c[_0x371c1d(0x2d3)](); if (_0x239697) return _0x371c1d(0x114) + _0x40942c; const _0x274d17 = new Date(); _0x274d17['setDate'](_0x1b32ea[_0x371c1d(0xec)]() - 0x1); const _0xd5ecc0 = _0x274d17['toDateString']() === _0x75747c['toDateString'](); if (_0xd5ecc0) return _0x371c1d(0x86c) + _0x40942c; if (_0x616dd6 <= 0x7) { if (_0x371c1d(0x123) !== _0x371c1d(0x123)) _0x3635bb['error'](_0x371c1d(0x5c1), _0x287102), _0x1e2ed1[_0x371c1d(0x2af)] = _0x371c1d(0x4f5); else { const _0x3249bc = [_0x371c1d(0x5cf), '星期一', _0x371c1d(0x14e), _0x371c1d(0x2cd), _0x371c1d(0x128), _0x371c1d(0x7d8), _0x371c1d(0x6a3)]; return _0x3249bc[_0x75747c['getDay']()] + '\x20' + _0x40942c; } } return _0x75747c['getFullYear']() + '年' + (_0x75747c[_0x371c1d(0x1a1)]() + 0x1) + '月' + _0x75747c[_0x371c1d(0xec)]() + '日'; } function _0x774f7f(_0x1c8e2e, _0x23d391 = 0x320, _0x50f97f = 0.8, _0x2560ec = ![]) { return new Promise((_0x4dc93c, _0x41fe74) => { const _0x6ea08a = _0x4fd4; if (_0x6ea08a(0x715) === _0x6ea08a(0x715)) { if (!_0x1c8e2e || !_0x1c8e2e[_0x6ea08a(0x78c)][_0x6ea08a(0x279)](_0x6ea08a(0x177))) return _0x41fe74(new Error('哼，这不是图片，你想让我压缩什么？')); const _0x5971bc = new FileReader(); _0x5971bc[_0x6ea08a(0x35d)](_0x1c8e2e), _0x5971bc[_0x6ea08a(0x5bc)] = _0x2c6842 => { const _0x5b92ff = _0x6ea08a; if ('cgEfr' !== _0x5b92ff(0x2d9)) { const _0x5a4099 = new Image(); _0x5a4099['src'] = _0x2c6842[_0x5b92ff(0x94)]['result'], _0x5a4099['onload'] = () => { const _0x4ba466 = _0x5b92ff, _0x3856b6 = document['createElement'](_0x4ba466(0x155)); let _0x2e1639 = _0x5a4099[_0x4ba466(0x3bb)], _0x515513 = _0x5a4099[_0x4ba466(0x2df)]; _0x2e1639 > _0x515513 ? _0x4ba466(0x12a) !== _0x4ba466(0x2e7) ? _0x2e1639 > _0x23d391 && (_0x515513 *= _0x23d391 / _0x2e1639, _0x2e1639 = _0x23d391) : (_0x57a8af['style'][_0x4ba466(0xb3)] = 'url(\x27' + _0x2acc19[_0x4ba466(0x99)](_0x3f8396) + '\x27)', _0x2d7c33[_0x4ba466(0x27d)][_0x4ba466(0x4b0)] = _0x4ba466(0x59e), _0x3550a3[_0x4ba466(0x27d)][_0x4ba466(0x424)] = _0x4ba466(0x50d)) : _0x515513 > _0x23d391 && (_0x2e1639 *= _0x23d391 / _0x515513, _0x515513 = _0x23d391); _0x3856b6[_0x4ba466(0x3bb)] = _0x2e1639, _0x3856b6[_0x4ba466(0x2df)] = _0x515513; const _0x49a32d = _0x3856b6[_0x4ba466(0x31a)]('2d'); _0x49a32d[_0x4ba466(0x518)](_0x5a4099, 0x0, 0x0, _0x2e1639, _0x515513); const _0x54383d = _0x1c8e2e['type'] === _0x4ba466(0x76c) ? 'image/png' : _0x4ba466(0x4fb); _0x2560ec ? _0x4ba466(0x3f8) === _0x4ba466(0x70) ? (_0x24c868['style'][_0x4ba466(0xb3)] = 'url(\x27' + _0x2f18a6[_0x4ba466(0x459)] + '\x27)', _0x5b239f[_0x4ba466(0x27d)][_0x4ba466(0x4b0)] = _0x4ba466(0x59e), _0x18c943[_0x4ba466(0x27d)][_0x4ba466(0x424)] = 'center') : _0x3856b6[_0x4ba466(0x5e9)](_0x294999 => { const _0x439065 = _0x4ba466; if (_0x439065(0x703) !== _0x439065(0x703)) return _0x439065(0x86c) + _0x166c9e; else { if (_0x294999) { if (_0x439065(0x46d) === _0x439065(0x4b4)) return _0x43d6e1['error'](_0x439065(0xa0), _0x11c1f1), _0x5cf16d['error'](_0x439065(0x8a7), _0x2e6d26[_0x439065(0x8a9)] || _0x439065(0x63f)), null; else _0x4dc93c(_0x294999); } else _0x41fe74(new Error(_0x439065(0x45a))); } }, _0x54383d, _0x50f97f) : _0x4ba466(0x6b1) === _0x4ba466(0x5c2) ? _0x2016c8['textContent'] = '▶' : _0x4dc93c(_0x3856b6['toDataURL'](_0x54383d, _0x50f97f)); }, _0x5a4099[_0x5b92ff(0x3bd)] = _0x51ffa7 => _0x41fe74(_0x51ffa7); } else { const _0x2b13ec = _0x87a289[_0x5b92ff(0x3e8)](_0x5b92ff(0x2de)); _0x2b13ec[_0x5b92ff(0x49f)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x52f0a2['id'] + _0x5b92ff(0x734) + _0x7426f0[_0x5b92ff(0x2e6)], _0x1b51ab[_0x5b92ff(0x7d)](_0x2b13ec); } }, _0x5971bc[_0x6ea08a(0x3bd)] = _0x2b3348 => _0x41fe74(_0x2b3348); } else { const _0x205184 = _0x8f18f0['createElement'](_0x6ea08a(0x8cf)); _0x205184['className'] = 'expense-item', _0x205184[_0x6ea08a(0x49f)] = _0x6ea08a(0x8bf) + _0x13b101['description'] + _0x6ea08a(0x50b) + _0x46a3b0[_0x6ea08a(0x376)][_0x6ea08a(0x524)](0x2) + _0x6ea08a(0x4b5) + _0x51de6d['id'] + _0x6ea08a(0x5a1), _0x558abe[_0x6ea08a(0x7d)](_0x205184); } }); } function _0x5cb5e3(_0x40aa93) { return new Promise((_0x5ad9fc, _0x2d9c10) => { const _0x3dc283 = _0x4fd4, _0x371171 = new FileReader(); _0x371171[_0x3dc283(0x4e6)] = () => _0x5ad9fc(_0x371171['result']), _0x371171[_0x3dc283(0x3bd)] = _0x2d9c10, _0x371171['readAsDataURL'](_0x40aa93); }); } function _0x5cb5e3(_0xb8a1c8) { return new Promise((_0x69fcef, _0x4f0932) => { const _0x55ee51 = _0x4fd4, _0x37de71 = new FileReader(); _0x37de71['onloadend'] = () => _0x69fcef(_0x37de71[_0x55ee51(0x7ba)]), _0x37de71[_0x55ee51(0x3bd)] = _0x4f0932, _0x37de71[_0x55ee51(0x35d)](_0xb8a1c8); }); } function _0xde47e5(_0x18abf9, _0x165eee, _0xe19da5) { const _0x3821f8 = _0x5b93b5, _0x17e10a = _0x4816c8 => { const _0x4a9da9 = _0x4fd4; if (_0x4816c8[_0x4a9da9(0x837)] === 'user') return _0x40321a[_0x4a9da9(0x92)]?.[_0x4a9da9(0x2e6)] || _0x4a9da9(0x766); if (_0x18abf9[_0x4a9da9(0x78c)] === _0x4a9da9(0x3bc)) { const _0x425091 = _0x4816c8['senderId'] ? _0x4eb861(_0x4816c8[_0x4a9da9(0x2b9)]) : null; return _0x425091?.[_0x4a9da9(0x2e6)] || _0x4a9da9(0x85b); } else { if (_0x4a9da9(0x8d3) === 'dWtHX') { _0x4ab23f(_0x4a9da9(0x600)); return; } else { const _0x3a1518 = _0x4eb861(_0x18abf9[_0x4a9da9(0x239)][0x0]); return _0x3a1518?.['name'] || 'AI'; } } }, _0x1004b2 = _0x165eee[_0x3821f8(0xb5)](-_0xe19da5), _0x2bb815 = []; for (const _0x3182ef of _0x1004b2) { const _0x341692 = new Date(_0x3182ef[_0x3821f8(0x375)])['toLocaleTimeString'](_0x3821f8(0x7a0), { 'hour': _0x3821f8(0x58c), 'minute': '2-digit' }); _0x3182ef[_0x3821f8(0x812)] && _0x2bb815[_0x3821f8(0x1fb)]('[' + _0x341692 + _0x3821f8(0xb9) + _0x17e10a(_0x3182ef) + ']\x20' + String(_0x3182ef['content'])[_0x3821f8(0x3e3)]()); } return _0x2bb815; } function _0x33d9cb(_0xaba406) { const _0x3e0865 = _0x5b93b5; if (_0xaba406[_0x3e0865(0x78c)] === _0x3e0865(0x3bc)) return _0x3e0865(0x513) + (_0xaba406['name'] || _0x3e0865(0x810)) + '」'; const _0x262bc6 = _0x4eb861(_0xaba406[_0x3e0865(0x239)][0x0]); return '与\x20' + (_0x262bc6?.[_0x3e0865(0x2e6)] || _0x3e0865(0x864)) + _0x3e0865(0x29a); } function _0x4f7cd6(_0x57b3fa) { const _0x15a3cf = _0x5b93b5; try { const _0x123542 = localStorage[_0x15a3cf(0x8b4)](_0x15a3cf(0x4a7) + _0x57b3fa), _0x2ec254 = JSON[_0x15a3cf(0x5b1)](_0x123542 || '[]'); return Array[_0x15a3cf(0x1d4)](_0x2ec254) ? _0x2ec254 : []; } catch { return []; } } function _0x4fa46e(_0x5d4897, _0x3d0e96) { const _0x279cfe = _0x5b93b5, _0x480a2e = Math['max'](0x1, Number(_0x40321a['preferences']?.[_0x279cfe(0x543)] ?? 0x64)), _0x283fa8 = _0x40321a[_0x279cfe(0x478)][_0x279cfe(0x16f)](_0x3558ee => _0x3558ee[_0x279cfe(0x239)][_0x279cfe(0x4fe)](_0x5d4897))['sort']((_0x52a1d7, _0x3252bf) => _0x52a1d7['id'] === _0x3d0e96 ? -0x1 : _0x3252bf['id'] === _0x3d0e96 ? 0x1 : 0x0), _0x17c4a9 = [], _0x19bb26 = {}; for (const _0x26dc59 of _0x283fa8) { const _0x582293 = _0x3d0e96 && _0x26dc59['id'] === _0x3d0e96 ? _0x40321a[_0x279cfe(0x393)] : _0x4f7cd6(_0x26dc59['id']); if (!_0x582293?.['length']) continue; const _0x30b309 = _0xde47e5(_0x26dc59, _0x582293, _0x480a2e); if (!_0x30b309[_0x279cfe(0x286)]) continue; _0x17c4a9['push'](_0x279cfe(0x333) + _0x33d9cb(_0x26dc59) + '\x0a' + _0x30b309[_0x279cfe(0x2c1)]('\x0a')), _0x19bb26[_0x26dc59['id']] = _0x30b309[_0x279cfe(0x286)]; } return { 'omniText': _0x17c4a9[_0x279cfe(0x2c1)]('\x0a\x0a'), 'usedCounts': _0x19bb26 }; } function _0x112c3b(_0x5e78ec) { const _0x10f28b = _0x5b93b5; let _0x591ce9 = null; const _0x5a44e9 = _0x40321a[_0x10f28b(0x478)][_0x10f28b(0x16f)](_0x147432 => _0x147432[_0x10f28b(0x239)][_0x10f28b(0x4fe)](_0x5e78ec)); for (const _0x23966d of _0x5a44e9) { const _0x3de1f2 = _0x4f7cd6(_0x23966d['id']); if (_0x3de1f2 && _0x3de1f2[_0x10f28b(0x286)] > 0x0) { const _0xa43994 = _0x3de1f2[_0x3de1f2['length'] - 0x1]; if (!_0x591ce9 || _0xa43994[_0x10f28b(0x375)] > _0x591ce9[_0x10f28b(0x375)]) { if ('UMwZA' !== _0x10f28b(0x11f)) _0x591ce9 = _0xa43994; else { const _0x74502c = _0x339454(_0x495804['authorId']) || { 'name': '未知' }; let _0x3008cc = _0x10f28b(0x161) + _0x74502c[_0x10f28b(0x2e6)] + _0x10f28b(0x25b) + (_0x1efbef['thought'] || _0x51745d[_0x10f28b(0x812)]) + '”'; return _0x35da58['type'] === 'music' && (_0x3008cc += _0x10f28b(0x251) + _0x12ecae[_0x10f28b(0x4de)] + _0x10f28b(0x604) + _0xb2af40['artist'] + ')'), _0x3008cc; } } } } return _0x591ce9; } function _0x57f5b7(_0x2f8d7c) { const _0x5c67dc = _0x5b93b5; if (!_0x2f8d7c || !_0x2f8d7c[_0x5c67dc(0x4fe)](',')) return _0x2f8d7c; const _0x1f96ed = _0x2f8d7c['split'](',')[_0x5c67dc(0x7cc)](_0x3b4f4d => _0x3b4f4d['trim']()); return _0x1f96ed[Math[_0x5c67dc(0xf2)](Math[_0x5c67dc(0x775)]() * _0x1f96ed['length'])]; } function _0x4849f2(_0x3e007e) { return new Promise(_0x3822b3 => { const _0x464ed9 = _0x4fd4; if ('qlqNT' === _0x464ed9(0xa7)) return _0x3107f7[_0x464ed9(0x7c0)][_0x464ed9(0x226)](_0x23c074 => _0x23c074['id'] === _0x2539b9[_0x464ed9(0x17e)]) || _0x111cc5[_0x464ed9(0x7c0)][0x0]; else { const _0x10bc48 = document[_0x464ed9(0x3a7)](_0x464ed9(0x4f8)), _0x180f71 = document['getElementById'](_0x464ed9(0x587)), _0x159b18 = document[_0x464ed9(0x3a7)]('modal-ok'), _0x3385a3 = document[_0x464ed9(0x3a7)]('modal-cancel'), _0x14144c = document[_0x464ed9(0x3a7)](_0x464ed9(0x21c)); _0x180f71['textContent'] = _0x3e007e, _0x10bc48['style']['display'] = _0x464ed9(0x564); const _0x51d67d = _0x422d14 => { const _0x5472ab = _0x464ed9; _0x10bc48[_0x5472ab(0x27d)][_0x5472ab(0x5a4)] = 'none', _0x159b18[_0x5472ab(0x6fe)] = _0x3385a3[_0x5472ab(0x6fe)] = _0x14144c[_0x5472ab(0x6fe)] = null, document[_0x5472ab(0x34a)]('keydown', _0xa67416), _0x3822b3(_0x422d14); }, _0xa67416 = _0x7b0296 => { const _0x2ee081 = _0x464ed9; if (_0x2ee081(0x4b8) === _0x2ee081(0x4b8)) { if (_0x7b0296[_0x2ee081(0x11c)] === _0x2ee081(0x7ed)) _0x51d67d(![]); if (_0x7b0296[_0x2ee081(0x11c)] === _0x2ee081(0x1ad)) _0x51d67d(!![]); } else !_0x34d19b && (_0x5c559c = _0x546ee1[_0x2ee081(0x3e8)](_0x2ee081(0x8cf)), _0x5691ae['id'] = 'feed-loader', _0x1caa51[_0x2ee081(0x7d)](_0x3aa45a)), _0x38b523[_0x2ee081(0x49f)] = _0x2ee081(0x44d) + _0x23ad02 + _0x2ee081(0x477), _0x5990ee[_0x2ee081(0x27d)][_0x2ee081(0x5a4)] = 'flex'; }; _0x159b18[_0x464ed9(0x6fe)] = () => _0x51d67d(!![]), _0x3385a3[_0x464ed9(0x6fe)] = () => _0x51d67d(![]), _0x14144c[_0x464ed9(0x6fe)] = () => _0x51d67d(![]), document[_0x464ed9(0x215)](_0x464ed9(0x1ac), _0xa67416); } }); } function _0x1bbd68(_0x412b6c) { const _0x4b1732 = _0x5b93b5, _0x8113ff = document['getElementById'](_0x4b1732(0x4d4)); _0x8113ff[_0x4b1732(0x26b)] = _0x412b6c, _0x8113ff[_0x4b1732(0x27d)][_0x4b1732(0x5a4)] = 'block'; if (_0x1bbd68['_t']) clearTimeout(_0x1bbd68['_t']); _0x1bbd68['_t'] = setTimeout(() => { const _0x4895af = _0x4b1732; 'DwKNJ' !== 'DwKNJ' ? _0x3e0bd2(_0x45a6b4['id']) : _0x8113ff[_0x4895af(0x27d)][_0x4895af(0x5a4)] = 'none'; }, 0x640); } function _0x1d8433() { const _0x39a57e = _0x5b93b5, _0x250883 = document['getElementById']('app-pages-container'), _0x22d23d = document[_0x39a57e(0x3a7)](_0x39a57e(0x75b)), _0x15e858 = document[_0x39a57e(0x21e)](_0x39a57e(0x48a)); if (!_0x250883 || !_0x22d23d || _0x15e858[_0x39a57e(0x286)] === 0x0) return; let _0x28d428 = 0x0; const _0x4dbec7 = _0x15e858['length']; function _0x3cbe66(_0x46d845) { const _0x5befa0 = _0x39a57e; if (_0x5befa0(0x1b9) === _0x5befa0(0x1b9)) { if (_0x46d845 < 0x0 || _0x46d845 >= _0x4dbec7) return; _0x22d23d[_0x5befa0(0x27d)][_0x5befa0(0x290)] = 'translateX(-' + _0x46d845 * (0x64 / _0x4dbec7) + '%)', _0x15e858[_0x5befa0(0x436)](_0x40218b => _0x40218b[_0x5befa0(0x1c1)][_0x5befa0(0x47e)](_0x5befa0(0x21b))), _0x15e858[_0x46d845][_0x5befa0(0x1c1)][_0x5befa0(0x65b)](_0x5befa0(0x21b)), _0x28d428 = _0x46d845; } else _0x3c20fd(![]), _0x286981[_0x5befa0(0x160)] = ![]; } _0x15e858[_0x39a57e(0x436)](_0x45e990 => { const _0x2c77d2 = _0x39a57e; if (_0x2c77d2(0x641) !== _0x2c77d2(0x641)) { if (_0x421799[_0x2c77d2(0x837)] === _0x2c77d2(0x447)) return _0x3db30a[_0x2c77d2(0x92)]?.[_0x2c77d2(0x2e6)] || _0x2c77d2(0x766); if (_0x55705e[_0x2c77d2(0x2b9)]) { const _0x5869ba = _0x568575(_0x1ade84[_0x2c77d2(0x2b9)]); return _0x5869ba?.[_0x2c77d2(0x2e6)] || _0x2c77d2(0x85b); } if (_0x424d0e?.['type'] === 'private') { const _0x238507 = _0x288f4f(_0x8204da[_0x2c77d2(0x239)][0x0]); return _0x238507?.['name'] || 'AI'; } return _0x2c77d2(0x37e); } else _0x45e990['addEventListener'](_0x2c77d2(0x236), () => { const _0x4a078b = _0x2c77d2; if ('fIXey' !== _0x4a078b(0x3f6)) { const _0x234745 = parseInt(_0x45e990[_0x4a078b(0x58e)]['page'], 0xa); _0x3cbe66(_0x234745); } else _0x46d76b[_0x4a078b(0x42f)][_0x4a078b(0x43f)] = _0x5c09a2[_0x4a078b(0x238)], _0xbc7054(), _0x5a68a4(); }); }); let _0x4d534a = 0x0, _0x335e20 = 0x0, _0x2b9b20 = 0x0, _0x540332 = ![], _0x36dc3d = ''; _0x250883['addEventListener']('touchstart', _0x2aa78c => { const _0x4bbead = _0x39a57e; _0x4d534a = _0x2aa78c[_0x4bbead(0x5ec)][0x0][_0x4bbead(0x732)], _0x335e20 = _0x2aa78c[_0x4bbead(0x5ec)][0x0][_0x4bbead(0x42a)], _0x540332 = !![], _0x36dc3d = ''; }, { 'passive': !![] }), _0x250883[_0x39a57e(0x215)](_0x39a57e(0x530), _0x467caa => { const _0x55768b = _0x39a57e; if (_0x55768b(0xb8) !== _0x55768b(0xb8)) { _0x43e1ec(_0x55768b(0x18a)); return; } else { if (!_0x540332) return; if (_0x36dc3d === '') { if (_0x55768b(0x6a9) === _0x55768b(0x6a9)) { const _0x5ccb31 = _0x467caa[_0x55768b(0x5ec)][0x0][_0x55768b(0x732)] - _0x4d534a, _0x1b660e = _0x467caa[_0x55768b(0x5ec)][0x0]['clientY'] - _0x335e20; if (Math[_0x55768b(0x784)](_0x5ccb31) > Math['abs'](_0x1b660e)) { if ('vXsen' === _0x55768b(0x5ba)) { const _0xc5007d = _0x1b1518[_0x55768b(0x8b4)](_0x55768b(0x493)); if (_0xc5007d) { const { playlist: _0x3f6faf, currentIndex: _0x152153 } = _0x124cbd[_0x55768b(0x5b1)](_0xc5007d); _0x125834[_0x55768b(0x1d4)](_0x3f6faf) && _0x3f6faf[_0x55768b(0x286)] > 0x0 && _0x152153 > -0x1 && (_0x34a3d1[_0x55768b(0x2cc)] = _0x3f6faf, _0x320616[_0x55768b(0x4bc)] = _0x152153, _0x2fb544[_0x55768b(0x1b5)] = ![], _0x481988()); } } else _0x36dc3d = _0x55768b(0xcf); } else _0x36dc3d = _0x55768b(0xd6); } else _0x3fe189[_0x55768b(0x159)](_0x55768b(0x13f), _0x20515e), _0x210581('加载聊天失败:\x20' + _0x5214ce['message']); } _0x36dc3d === 'horizontal' && (_0x55768b(0x5f4) !== _0x55768b(0x5f4) ? (_0x15ea0e['participantIds']['forEach'](_0x236beb => { const _0x54e61f = _0x55768b, _0x34e634 = _0x255779(_0x236beb); if (_0x34e634) { const _0x5ce903 = _0x323c96[_0x54e61f(0x3e8)](_0x54e61f(0x829)); _0x5ce903[_0x54e61f(0x815)] = _0x34e634['id'], _0x5ce903[_0x54e61f(0x26b)] = _0x34e634[_0x54e61f(0x2e6)], _0x7850eb[_0x54e61f(0x7d)](_0x5ce903); } }), _0xa4b471[_0x55768b(0x27d)][_0x55768b(0x5a4)] = _0x55768b(0x7dc)) : _0x467caa[_0x55768b(0x425)]()); } }, { 'passive': ![] }), _0x250883[_0x39a57e(0x215)]('touchend', _0x3f37b8 => { const _0x561527 = _0x39a57e; if (!_0x540332) return; _0x2b9b20 = _0x3f37b8[_0x561527(0x82)][0x0]['screenX'], _0x36dc3d === 'horizontal' && (_0x561527(0x3eb) !== _0x561527(0x85a) ? _0x1d6b5f() : _0x418603('错误:\x20' + _0x1dadd0['message'])), _0x540332 = ![]; }); function _0x1d6b5f() { const _0x16fe35 = _0x39a57e; if ('JppLh' !== _0x16fe35(0x7d3)) _0x17d058(_0x16fe35(0x218) + _0x2964f1['message']); else { const _0x2cf142 = 0x32; if (_0x2b9b20 < _0x4d534a - _0x2cf142) _0x3cbe66(_0x28d428 + 0x1); else { if (_0x2b9b20 > _0x4d534a + _0x2cf142) { if ('DbIvg' === _0x16fe35(0x12d)) { const _0x4124a4 = _0x16fe35(0x4c9); _0xb7ae1e = _0x16fe35(0x706) + _0x479fe4[_0x16fe35(0x2e6)] + _0x16fe35(0x414) + _0x4124a4 + _0x16fe35(0x5df) + _0x53555a[_0x16fe35(0x2e6)] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x4124a4 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x4124a4 + _0x16fe35(0x372); } else _0x3cbe66(_0x28d428 - 0x1); } } } } } function _0x123f8a() { return new Promise(_0x10f207 => { const _0x288471 = _0x4fd4, _0x11a232 = document[_0x288471(0x3a7)](_0x288471(0x34f)), _0x202339 = document[_0x288471(0x3a7)](_0x288471(0x2b0)), _0x8309cd = document[_0x288471(0x3a7)](_0x288471(0x35b)), _0x2ae421 = document[_0x288471(0x3a7)](_0x288471(0x7db)), _0x36c02d = document[_0x288471(0x3a7)](_0x288471(0x108)), _0x31218b = document['getElementById'](_0x288471(0x2ac)); _0x202339[_0x288471(0x815)] = '', _0x8309cd['value'] = '', _0x11a232[_0x288471(0x1c1)][_0x288471(0x65b)](_0x288471(0x7de)), _0x202339[_0x288471(0x7c9)](); const _0x28e356 = _0x47dfc4 => { const _0x36b622 = _0x288471; if (_0x36b622(0x42c) !== _0x36b622(0x406)) _0x11a232[_0x36b622(0x1c1)][_0x36b622(0x47e)](_0x36b622(0x7de)), _0x2ae421[_0x36b622(0x6fe)] = null, _0x36c02d[_0x36b622(0x6fe)] = null, _0x31218b[_0x36b622(0x6fe)] = null, document['removeEventListener'](_0x36b622(0x1ac), _0x4f4feb), _0x10f207(_0x47dfc4); else throw new _0x8d5f38(_0x36b622(0x897)); }, _0x37e6fa = () => { const _0x3da7e5 = _0x288471, _0x492bf3 = _0x202339[_0x3da7e5(0x815)][_0x3da7e5(0x3e3)](), _0x26c575 = _0x8309cd[_0x3da7e5(0x815)][_0x3da7e5(0x3e3)](); if (!_0x492bf3 || !_0x26c575) { if (_0x3da7e5(0x17a) !== _0x3da7e5(0x3b0)) { _0x1bbd68(_0x3da7e5(0x18a)); return; } else _0xf7d701[_0x3da7e5(0x535)] && _0x16d42f['currentAbortController']['signal'] === _0x3c7b1b && (_0x5d2063[_0x3da7e5(0x535)] = null); } _0x28e356({ 'songName': _0x492bf3, 'artist': _0x26c575 }); }, _0x4f4feb = _0x4760f1 => { const _0x457447 = _0x288471; if (_0x4760f1[_0x457447(0x11c)] === _0x457447(0x7ed)) _0x28e356(null); _0x4760f1[_0x457447(0x11c)] === _0x457447(0x1ad) && (_0x457447(0x91) !== _0x457447(0x91) ? (_0x43058b = _0x2f6b0f[_0x457447(0x3e8)]('style'), _0x576aec['id'] = _0x457447(0x5d0) + _0x46fdb5['id'], _0x483b4c['head'][_0x457447(0x7d)](_0x41fce4)) : (_0x4760f1[_0x457447(0x425)](), _0x37e6fa())); }; _0x2ae421[_0x288471(0x6fe)] = _0x37e6fa, _0x36c02d['onclick'] = () => _0x28e356(null), _0x31218b['onclick'] = () => _0x28e356(null), document[_0x288471(0x215)](_0x288471(0x1ac), _0x4f4feb); }); } function _0x4fd4(_0x2bb419, _0x14e7c1) { const _0x17aee5 = _0x17ae(); return _0x4fd4 = function (_0x4fd4bb, _0x2832cb) { _0x4fd4bb = _0x4fd4bb - 0x67; let _0x21a9fd = _0x17aee5[_0x4fd4bb]; return _0x21a9fd; }, _0x4fd4(_0x2bb419, _0x14e7c1); } function _0x536f38(_0x28580f) { const _0x595435 = _0x5b93b5; if (!_0x28580f) return []; const _0x560db2 = _0x28580f[_0x595435(0x3e3)](); if (_0x560db2[_0x595435(0x279)](_0x595435(0x449)) && _0x560db2[_0x595435(0x1d2)](_0x595435(0x4d9))) return [_0x560db2]; const _0x5da2e6 = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x4de4f5 = '|||CMD|||', _0x252a81 = [], _0x1c871a = _0x28580f['replace'](_0x5da2e6, _0x517deb => { const _0x167d68 = _0x595435; return _0x252a81[_0x167d68(0x1fb)](_0x517deb), _0x4de4f5; }), _0xd9b4b0 = _0x1c871a[_0x595435(0x480)](_0x4de4f5), _0x219dbe = []; let _0x2e6ee9 = 0x0; return _0xd9b4b0[_0x595435(0x436)]((_0x269667, _0x3332c2) => { const _0x15632e = _0x595435; if (_0x15632e(0x3a9) !== _0x15632e(0x3a9)) _0xf9f6ed(_0x15632e(0x35f) + _0x25e944[_0x15632e(0x15a)]); else { const _0x1718d9 = _0x269667['trim'](); _0x1718d9 && _0x219dbe[_0x15632e(0x1fb)](..._0x3ce0fa(_0x1718d9)), _0x2e6ee9 < _0x252a81[_0x15632e(0x286)] && (_0x219dbe[_0x15632e(0x1fb)](_0x252a81[_0x2e6ee9][_0x15632e(0x3e3)]()), _0x2e6ee9++); } }), _0x219dbe; } function _0x10e02f(_0x3ba8c4) { const _0x2d3bb0 = _0x5b93b5; if (!_0x3ba8c4) return []; let _0x50cb2c = String(_0x3ba8c4)[_0x2d3bb0(0x3e3)](); const _0x5f29da = _0x50cb2c[_0x2d3bb0(0x33f)](/```(?:json)?([\s\S]*?)```/i); if (_0x5f29da) _0x50cb2c = _0x5f29da[0x1][_0x2d3bb0(0x3e3)](); try { if (_0x2d3bb0(0x3f7) !== _0x2d3bb0(0x169)) { const _0x4f80c0 = JSON['parse'](_0x50cb2c); if (_0x4f80c0 && Array[_0x2d3bb0(0x1d4)](_0x4f80c0[_0x2d3bb0(0x20a)])) { if (_0x2d3bb0(0x388) !== _0x2d3bb0(0x388)) { const _0x5d86d4 = _0x5dd8b1[_0x2d3bb0(0x3e8)](_0x2d3bb0(0x8cf)); _0x5d86d4[_0x2d3bb0(0x8d8)] = _0x2d3bb0(0x8e1), _0x5d86d4[_0x2d3bb0(0x27d)][_0x2d3bb0(0x384)] = _0x2d3bb0(0x818), _0x5d86d4[_0x2d3bb0(0x27d)][_0x2d3bb0(0x767)] = 'stretch', _0x5d86d4[_0x2d3bb0(0x27d)][_0x2d3bb0(0x5d1)] = _0x2d3bb0(0x10d), _0x5d86d4[_0x2d3bb0(0x27d)][_0x2d3bb0(0x667)] = '0'; const _0x5bdcc4 = _0x14b044[_0x49fbc7[_0x2d3bb0(0x86d)]] || _0x36aba2['默认'], _0xe00ea8 = _0x2d3bb0(0x752) + _0x5bdcc4 + '</svg>', _0x3e08d0 = _0x2d3bb0(0x5ac) + _0xe00ea8 + _0x2d3bb0(0x47a) + _0x18de7e[_0x2d3bb0(0x67f)] + '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>' + (_0x1aad57['category'] || _0x2d3bb0(0x2e2)) + '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20' + (_0x5411c2[_0x2d3bb0(0x376)] || 0x0)[_0x2d3bb0(0x524)](0x2) + '</span></div>'; let _0x4848dc = ''; if (_0x1200db['review'] && _0x55832e[_0x2d3bb0(0x58f)][_0x2d3bb0(0x742)]) { const _0x137d72 = _0x2348ce(_0x56e2ec[_0x2d3bb0(0x58f)][_0x2d3bb0(0x742)]); _0x137d72 && (_0x4848dc = _0x2d3bb0(0x8d) + _0x137d72[_0x2d3bb0(0xe7)] + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>' + _0x137d72[_0x2d3bb0(0x2e6)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x375427[_0x2d3bb0(0x58f)][_0x2d3bb0(0x44f)] + _0x2d3bb0(0x3e4)); } _0x5d86d4['innerHTML'] = _0x3e08d0 + _0x4848dc, _0x408af0[_0x2d3bb0(0x7d)](_0x5d86d4); } else return _0x4f80c0[_0x2d3bb0(0x20a)][_0x2d3bb0(0x7cc)](_0xdf70fb => typeof _0xdf70fb === _0x2d3bb0(0xac) ? _0xdf70fb : _0xdf70fb?.[_0x2d3bb0(0x812)])[_0x2d3bb0(0x16f)](Boolean)[_0x2d3bb0(0x21f)](_0x3ce0fa); } const _0x48a6f1 = [_0x2d3bb0(0x84b), _0x2d3bb0(0x178), _0x2d3bb0(0x15a), _0x2d3bb0(0x44f), _0x2d3bb0(0x812), _0x2d3bb0(0x175), _0x2d3bb0(0x192)]; if (_0x4f80c0 && typeof _0x4f80c0 === _0x2d3bb0(0x645)) { const _0xac2c8a = []; for (const _0x5c7083 of Object['keys'](_0x4f80c0)) { if (_0x2d3bb0(0x49e) !== _0x2d3bb0(0x354)) { const _0x1c57bb = _0x5c7083[_0x2d3bb0(0x2f9)](); if (_0x48a6f1['some'](_0x5c59f9 => _0x1c57bb[_0x2d3bb0(0x279)](_0x5c59f9))) { if (_0x2d3bb0(0x5f9) !== _0x2d3bb0(0x28f)) { const _0x18226d = _0x4f80c0[_0x5c7083]; if (typeof _0x18226d === _0x2d3bb0(0xac)) _0xac2c8a['push'](_0x18226d); if (Array[_0x2d3bb0(0x1d4)](_0x18226d)) _0x18226d[_0x2d3bb0(0x436)](_0x5a6827 => { const _0x1d2762 = _0x2d3bb0; if (typeof _0x5a6827 === _0x1d2762(0xac)) _0xac2c8a['push'](_0x5a6827); }); } else _0x5dbf31[_0x2d3bb0(0x27d)]['textShadow'] = '0\x201px\x203px\x20rgba(0,0,0,0.6)'; } } else { const _0x4f5cbf = _0x1daa3e[_0x2d3bb0(0x822)](_0x1de138, _0x2d3bb0(0x4ad)), _0x5a6355 = _0x4f5cbf['objectStore'](_0x508c38), _0x1a4c15 = _0x5a6355['delete'](_0x3ba465); _0x1a4c15[_0x2d3bb0(0x61f)] = () => _0x278e17(), _0x1a4c15[_0x2d3bb0(0x3bd)] = () => _0x1a3331(_0x1a4c15['error']); } } if (_0xac2c8a['length']) return _0xac2c8a[_0x2d3bb0(0x21f)](_0x3ce0fa)['slice'](0x0, 0x9); } } else _0x9c2c8[_0x2d3bb0(0x27d)][_0x2d3bb0(0x5a4)] = _0x2d3bb0(0x87b); } catch { } if (/[{\[]/[_0x2d3bb0(0x8c6)](_0x50cb2c) && /":/['test'](_0x50cb2c)) { if (_0x2d3bb0(0x57f) !== _0x2d3bb0(0x57f)) return _0x53d70c(new _0x507501(_0x2d3bb0(0x36e))); else { const _0x2d1dcf = [], _0x17404d = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x1cc5bf; while ((_0x1cc5bf = _0x17404d[_0x2d3bb0(0xf1)](_0x50cb2c)) !== null) { const _0x3e2c31 = _0x1cc5bf[0x1]['replace'](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')['trim'](); if (_0x3e2c31) _0x2d1dcf[_0x2d3bb0(0x1fb)](_0x3e2c31); } if (_0x2d1dcf[_0x2d3bb0(0x286)]) return _0x2d1dcf[_0x2d3bb0(0x21f)](_0x3ce0fa)[_0x2d3bb0(0xb5)](0x0, 0x9); } } return _0x3ce0fa(_0x50cb2c); } function _0x3ce0fa(_0x3c21e5) { const _0x1171f3 = _0x5b93b5; if (!_0x3c21e5) return []; const _0x38b05f = String(_0x3c21e5)[_0x1171f3(0x3e3)](), _0x1ecba3 = _0x38b05f[_0x1171f3(0x480)](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x4e7bfa => _0x4e7bfa[_0x1171f3(0x3e3)]())[_0x1171f3(0x16f)](Boolean); if (_0x1ecba3[_0x1171f3(0x286)] > 0x0) { if (_0x1171f3(0x2e1) !== _0x1171f3(0x49d)) return _0x1ecba3[_0x1171f3(0xb5)](0x0, 0x9); else _0x227a21 ? _0x42f7b1(_0x1d06fa) : _0x2a32c0(new _0x1ba24e(_0x1171f3(0x45a))); } return [_0x38b05f]['filter'](Boolean); } const _0x51df2b = _0x5b93b5(0x33a), _0x24051d = _0x5b93b5(0x237), _0x4aa0e5 = new Promise((_0x1742ad, _0x5341b7) => { const _0x2f49bc = _0x5b93b5, _0x4c5be0 = indexedDB[_0x2f49bc(0x1bc)](_0x51df2b, 0x2); _0x4c5be0[_0x2f49bc(0x3bd)] = () => _0x5341b7(_0x2f49bc(0x22c)), _0x4c5be0['onsuccess'] = () => _0x1742ad(_0x4c5be0['result']), _0x4c5be0[_0x2f49bc(0x557)] = _0xa05f24 => { const _0x5094e8 = _0x2f49bc; if (_0x5094e8(0x569) === 'wVuAP') { const _0x1db625 = _0xa05f24['target']['result']; !_0x1db625[_0x5094e8(0x3e1)][_0x5094e8(0xa1)](_0x24051d) && _0x1db625[_0x5094e8(0x29d)](_0x24051d, { 'keyPath': 'id' }); const _0x28a968 = _0x5094e8(0x55b); !_0x1db625[_0x5094e8(0x3e1)][_0x5094e8(0xa1)](_0x28a968) && _0x1db625[_0x5094e8(0x29d)](_0x28a968, { 'keyPath': 'id' }); } else _0x258078[_0x5094e8(0x1fb)](_0x1f7928); }; }); async function _0x500f4d(_0x5526d8) { const _0x26c73b = await _0x4aa0e5; return new Promise((_0x3f29da, _0x41ba8f) => { const _0x221d38 = _0x4fd4; if ('oFEwj' === _0x221d38(0x801)) { const _0x511e95 = _0x26c73b[_0x221d38(0x822)](_0x24051d, _0x221d38(0x228)), _0x1f5be6 = _0x511e95[_0x221d38(0x16c)](_0x24051d), _0x1c0102 = _0x1f5be6[_0x221d38(0xab)](_0x5526d8); _0x1c0102[_0x221d38(0x61f)] = () => _0x3f29da(_0x1c0102['result'] ? _0x1c0102[_0x221d38(0x7ba)][_0x221d38(0x5c0)] : null), _0x1c0102[_0x221d38(0x3bd)] = () => _0x41ba8f(_0x1c0102[_0x221d38(0x159)]); } else { const _0x37aa01 = _0x2b171f[_0x221d38(0x7ab)][_0x221d38(0x226)](_0x2ff04b => _0x2ff04b['id'] === _0x3e2922); if (!_0x37aa01) return; _0x169cac[_0x221d38(0x26b)] = _0x221d38(0x634), _0x35ffe5['value'] = _0x37aa01['id'], _0x115d3a[_0x221d38(0x815)] = _0x37aa01[_0x221d38(0x2e6)], _0x40318a[_0x221d38(0x815)] = _0x37aa01[_0x221d38(0x87f)], _0x516968[_0x221d38(0x27d)][_0x221d38(0x5a4)] = _0x221d38(0x7dc), _0x37aa01[_0x221d38(0x726)]['forEach'](_0x107bfe => { const _0x2563ca = _0x221d38, _0x501827 = _0x339273[_0x2563ca(0x889)](_0x2563ca(0x3ec) + _0x107bfe); if (_0x501827) _0x501827['checked'] = !![]; }); } }); } async function _0x5c7ad7(_0x3fce12, _0x1e625f) { const _0x55a10f = await _0x4aa0e5; return new Promise((_0x5d72d9, _0x421937) => { const _0x2e1cdb = _0x4fd4, _0x468dd3 = _0x55a10f[_0x2e1cdb(0x822)](_0x24051d, _0x2e1cdb(0x4ad)), _0x40a689 = _0x468dd3['objectStore'](_0x24051d), _0x12c229 = _0x40a689[_0x2e1cdb(0x9f)]({ 'id': _0x3fce12, 'blob': _0x1e625f }); _0x12c229['onsuccess'] = () => _0x5d72d9(_0x12c229[_0x2e1cdb(0x7ba)]), _0x12c229[_0x2e1cdb(0x3bd)] = () => _0x421937(_0x12c229[_0x2e1cdb(0x159)]); }); } async function _0x2a396c(_0xcc6979) { const _0x725374 = await _0x4aa0e5; return new Promise((_0x1d9905, _0x4b2f80) => { const _0x39fe55 = _0x4fd4, _0x157f9c = _0x725374[_0x39fe55(0x822)](_0x24051d, _0x39fe55(0x4ad)), _0x1bf407 = _0x157f9c['objectStore'](_0x24051d), _0x427c97 = _0x1bf407[_0x39fe55(0x21d)](_0xcc6979); _0x427c97[_0x39fe55(0x61f)] = () => _0x1d9905(), _0x427c97['onerror'] = () => _0x4b2f80(_0x427c97[_0x39fe55(0x159)]); }); } function _0x3cb589(_0xdb63a6) { const _0x166a2d = _0x5b93b5; return fetch(_0xdb63a6)[_0x166a2d(0x3fa)](_0x43a11d => _0x43a11d[_0x166a2d(0x5c0)]()); } function _0x17ae() { const _0x206eec = ['firstChild', 'response', 'SPyrQ', '咱俩天下第一好', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', '卡片已移除。', 'xGJEB', 'ZuZHD', 'status', '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', 'splice', 'export-char-button', 'msg_', 'bMwwT', 'XTLEd', 'eDJxr', 'Unknown', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'anthropic', '聊天档案柜是空的，无需净化。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'stopPropagation', '8px', 'appIconPosition_app-diary', 'TMQxQ', '未知角色', 'char_wallpaper_', 'ZgoVH', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'BFRZN', 'zcTPB', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', '昨天\x20', 'category', 'color', '（正在构思中...）', 'diOcT', '\x0a#\x20你的个性（节选）\x0a', 'translateX(-', '设置已保存！', 'card-widget', 'theme-lightness-slider', 'friend-circle-list-screen', '一拳打爆', 'save-world-book-button', 'diary-entry\x20', '成功向好友圈\x20\x22', 'none', 'sYBtz', 'abort', 'HAOEy', 'boundUserProfileId', 'uZdRH', 'char-edit-avatar-preview', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'wEXTK', 'hCTfe', 'FdSqS', 'viewBox', 'image', 'querySelector', 'cancel-edit-button', 'Tcpnt', 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg', 'summarize-backdrop', 'diary-action-modal-', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'var(--text-color)', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'Ovgtm', 'qdeDr', 'listen-together-backdrop', 'button', '28%', '在你那乱七八糟的文本里没找到“歌名”！', 'accounting-title', 'sDTBB', 'KfWYk', 'feed', 'playableUrl', 'choice-create-character', 'YzEqx', 'glFkf', 'appIconPosition_app-accounting', 'back-to-home-from-music-library', 'snpEF', '”的补充信息\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'HODHy', 'MnikB', 'AI返回的原始文本:', 'tzzGt', 'rawResponse', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x20\x20人设:\x20', 'AI未能返回有效的JSON数组格式。', '生成失败:\x20', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'vvQml', '.music-post-song-card', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'RbAjf', 'getItem', 'group-edit-name', 'meeting-main-content', 'VVGdY', 'iNrcA', 'WrnOJ', 'qpQDl', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'activeQuote', 'sin', 'iEiEg', '<span\x20class=\x22description\x22>', 'GnNzz', 'lYfGk', '群聊已解散。', '#diary-action-reroll', 'MMwGj', 'tGokD', 'test', 'src', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'cfSNq', 'isAnimatingDiary', 'EFVcf', 'worldBook', 'NyWsE', 'character-list', 'div', '字体保存失败了，哼:\x20', 'sender_id', 'yBkjm', 'CQHvR', '在准备群聊API数据时，读取图片失败:', 'delete-friend-circle-button', '创建新角色', 'is-exiting-left', 'className', 'diaryCurrentPage', 'chat', '哼，正在开始净化你那被污染的聊天记录...', 'world-book-edit-name', 're-record-button', '<img\x20src=\x22', 'info', 'upload-font-button', 'expense-item', 'localStorageData', 'postType', 'toString', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', 'PCjvI', 'LIxJb', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', 'galgame-sprite-container', ';\x22>', 'comments', 'WGrdV', 'ZTAJK', 'PSLVa', 'speaker-ai', 'chat-view-pane', 'removeItem', 'piDCp', 'VEwKj', '加载徽章图片失败', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ZoqDx', 'DOMContentLoaded', '#bubble-preview-user', 'phone-container', '{charName}', 'appendChild', 'cRYCe', 'decode', '我来搞定', 'HJfAN', 'changedTouches', 'bottom', '\x20/\x20', 'EToPr', 'iLkwQ', 'bdbLj', 'choice-import-character', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'message-action-modal', '正在处理图片...', 'full', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', 'cardState2', 'galgame-date', 'lyric-line-', 'noQEm', 'userProfile', 'pAHpA', 'target', '名字不能为空！', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'world-book-edit-content', '\x20写道:\x20', 'createObjectURL', 'galgame-textbox-container', 'shift', '#ffcc66', 'is-playing', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', 'put', '批量生成动态失败:\x20', 'contains', '\x20之间的私密内容)\x0a', 'mouseup', 'message-image-content', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', '35%', 'DBGNm', '\x0a\x20\x20\x20\x20绑定用户:\x20', 'is-visible', 'isqtO', 'get', 'string', 'vVrID', 'YJgji', 'APSRD', '总得说点什么吧？', '0\x201px\x203px\x20rgba(0,0,0,0.6)', '刚刚发布了一条动态，内容是：“', 'backgroundImage', 'application/json', 'slice', 'cursor', '.diary-delete-btn', 'anhxr', ']\x20[', 'gtNOZ', 'insertBefore', 'AnZFv', '歌曲ID', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', '<p\x20class=\x22music-post-thought\x22>', 'CmnPI', '卡片\x202\x20已更换！', 'QsszU', '被你撩到', '\x20\x20-\x20角色ID:\x20', '上传失败了，笨蛋！\x20', 'DNLDa', 'gIUDq', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'HZaqp', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', '哼，正在净化你那些被污染的好友圈动态...', 'findIndex', '\x20张旧的动态图片。', 'horizontal', 'touchstart', 'tMQzV', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'char_sprite_normal_', 'CEBOS', 'chat-sticker-panel', 'vertical', 'spRNr', '确定要清空群聊\x22', 'yLLnW', 'sprite-cancel-button', 'ofyJh', 'PjGed', 'JSON\x20解析失败!\x20错误原因:', 'ThfNe', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'download', '加载自定义表情包失败，真是没用。', 'FCvgP', 'user-avatar-input', 'likes', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'user-post-attachment-preview', 'avatar', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', ':\x22\x20或\x22[', 'EkIDI', 'getDate', '快点哄我', '\x22\x20中发现一张需要净化的图片...', '记一笔', 'eAHqC', 'exec', 'floor', 'WQnLe', '---\x20音乐净化仪式完成\x20---', 'uDPsk', '正在迁移旧的动态数据到新的好友圈系统...', 'oyRmc', 'galgame-sprite-adjust-ui', '桌面已重置，即将刷新...', '图片预览失败:\x20', 'scrollIntoView', 'typing-indicator', 'chat-get-reply-button', 'edit-current-circle-button', '#f2b7c6', 'init', 'quoted-message-in-bubble', 'coverUrl', 'NkAGq', '\x20到\x20', 'DStiH', '未知表情', 'createElementNS', 'cancel-music-input', '弱小委屈但凶恶', 'friend-circle-edit-title', '事情好多', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', '15px', 'QKczQ', 'replaceAll', 'add-expense-button', '我是女仆', 'CbwmW', 'widgetBgImage', '今天\x20', 'friendCircleList', 'krKvz', '\x20avatar', 'widget-title', '\x20条新动态。', 'bxpMo', 'char-name-header', 'key', 'editing-user-id', 'mnSoF', 'jOJtk', 'QTynL', 'DUxbd', 'appIconPosition_', 'vuqhg', 'vGUgn', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '确定要清空好友圈“', 'aRPFS', '星期四', 'qyWzv', 'knpNu', 'YkBYq', '#99ff99', 'tLhkA', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'music-post', 'SRkjJ', 'absolute', 'listenTogetherSession', '保存卡片状态失败', '\x0a\x20\x20\x20\x20人设:\x20', 'TlgjN', '生成动态失败:', 'pendingPostAttachments', '加载见面背景失败\x20for\x20', 'UrRQp', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'MGnOK', 'generativelace.googleapis.com', 'textShadow', 'delete-user-profile-button', '切换聊天时发生异步错误:', 'ujEXd', ']\x0a\x0a#\x20角色资料库\x0a', 'widget-prev-btn', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'afuMT', 'XAnor', 'white', 'altar-slot-info', 'NtBNv', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'DvpWi', 'accountingData', 'has', '星期二', '\x22\x20已删除。', 'ijtCQ', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'summary-textarea', 'back-to-home-from-chat', 'canvas', 'meeting-list-container', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'oSgsG', 'error', 'message', 'fkiPp', 'transfer-modal', '\x0a\x0a#\x20关于读者“', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'reload', 'isGenerating', '-\x20[动态]\x20', 'llpsx', 'card-input', 'QrOFa', 'revokeObjectURL', '的个人专属世界观设定\x0a', 'HubJA', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', 'BaIOa', 'diaryView', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'objectStore', 'app-world-book', 'MkBTt', 'filter', 'hkFbV', 'input[type=\x22checkbox\x22]', 'keAiA', 'vaijW', 'back-to-library-from-altar', 'line', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'image/', 'dialogue', 'user-profile-screen', 'NnMcD', '320915iTfhNc', 'app-chat', '分钟前', 'activeUserProfileId', 'meetingView', 'XWQCF', 'New\x20request\x20started', 'diary-write-button', 'netease', 'FQZeS', '不高兴撒娇', 'wb_', 'exp_', 'posts', 'NTakv', '歌名和歌手都不能为空！', '/v1/chat/completions', 'reverse', 'assistant', 'removeChild', '群名称已更改为\x22', 'home-screen', 'YJDni', 'utterance', '\x20张旧图片。', 'EXeSR', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'VXDdH', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', '总结失败:', 'user_', 'setDate', 'provider', 'scrollTop', '\x0a-\x20你正在为一个名为“', 'EuwkR', '吃薯条', 'mVrWD', 'getMonth', 'musicLibrary', 'gBmJG', 'expense-description', 'sad', 'iTvve', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', 'data', 'message-container', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'SFwEO', 'keydown', 'Enter', 'dbNTb', 'nEFCr', 'backgroundColor', '未知歌曲', 'getFullYear', '.no-action-modal', '已经生成了今日账单！想看就去“看账本”标签页。', 'isPlaying', 'cancel-transfer-button', 'character-settings-button', '你是一个乐于助人的助手。', 'pQVln', '正在打包“', 'vpOcY', 'open', 'chat_', '复制失败了，哼。', '徽章已更换！', 'novel', 'classList', 'card-input-2', '正在生成中，请稍候...', 'feed-bg-input', 'children', 'OWiPh', 'group-chat-create-screen', 'musicFeed', '”已成功导入！', '原始文本:', 'group-chat-member-list', 'activeChatId', 'gkhaO', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'OeBAh', 'MykAU', 'music-upload-altar-screen', 'endsWith', '服务器错误:\x20', 'isArray', '动态中的音乐搜索失败:', '日记已删除。', '你还没保存这个角色呢，导什么导？', 'Tyruw', 'editing-friend-circle-id', 'themeWidget1State', '[AI分享了音乐：', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', '正在为你切换新的歌曲...', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'oJkRL', '正在解析角色卡...', '</span>:\x20', '加载已保存字体失败:', '获取模型失败:\x20', 'asXBH', 'jjNPB', 'lCvKf', 'MNXhG', 'data:', 'vJXYx', 'angry', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'bVhMR', 'FHgEX', 'GEZrE', 'font-input', 'character-edit-screen', '生成动态时发生错误:\x20', 'VAAIt', 'readAsText', 'mVwuM', '这本日记本来就是空的，你还想清空什么？', 'aAfKM', 'export-all-data-button', 'widget_card', 'KaULM', 'push', 'mMpSW', 'gSJKp', '未找到可用模型。', '同步已断开。', '刷新了\x20', 'QmJCN', '-preview', 'sDJXV', 'some', 'GLhcw', 'pop', 'back-to-diary-list', '在好友圈\x20\x22', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'reply', 'themeHue', 'KJMIR', 'SrSuv', '好的，我记住了这些人设和历史。现在我们开始对话。', 'wuXrB', '\x0a\x0a#\x20关于群聊参与者“', 'user-avatar-preview', 'tag', 'fBHeX', 'code', 'addEventListener', '[用户向\x20', 'ITVdn', '错误:\x20', 'isActive', 'char-edit-name', 'active', 'modal-mask', 'delete', 'querySelectorAll', 'flatMap', 'displayUrl', 'ACUXs', 'Fetch\x20request\x20was\x20aborted.', 'neLko', 'xeHCm', 'rYgaF', 'find', '\x0a-\x20**对话状态**:\x20群里已经有', 'readonly', 'oncomplete', '”...', '一起听歌', 'IndexedDB\x20failed\x20to\x20open', '[sticker:', '最近没有动态记录。', 'TldoJ', 'AkZVv', '100%', 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg', 'WAnzd', '动态已清空。', 'getReader', 'click', 'images', 'checked', 'participantIds', 'jtqqQ', 'UterP', 'substring', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'activeDiaryCharacterId', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'NzYha', '#ffb366', 'music', '加载第二个卡片图片失败', 'speaker', 'azsmK', 'SwxVb', '正在写入新数据...', 'NrIFv', 'emoji', 'reduce', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '\x20[并附上了一张图片]', 'cBGbL', 'spriteTransform', '.widget-info\x20>\x20div', '(想转账给“', '\x20(分享了歌曲:\x20', 'tab-record-expense', 'EwKSH', 'api-endpoint', '.ttf', 'cancel', '选择聊天', 'post_', 'EOcPD', 'tUwDa', '\x20说：“', 'toLocaleTimeString', 'back-to-world-book-list', 'diaryPressTimer', 'load-more-btn', '我是小丑呜呜', '天没动静了。你的角色们应该发起新的问候或话题。', 'anthropic.com', 'TA正在提笔写日记...', '#app-dock-bottom-left\x20#', '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', 'diary-prev-button', '\x0a\x20\x20\x20\x20姓名:\x20', 'eBBUh', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'textContent', 'Ufmed', 'bfoxr', 'padStart', '.diary-entry', '</svg>', 'themeLightness', 'sticker', 'pPGLS', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'altar-slot-lyrics', 'DCwWq', 'wArmy', '</div>\x0a\x20\x20\x20\x20', 'startsWith', 'zdilh', 'lkQpj', 'app-diary', 'style', 'group-delete', 'entries', '[用户发送了表情：', 'pPPdt', '好像有动态了...', 'isFinite', 'italic', 'mrqmA', 'length', '50%', '29%', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'nOMzv', 'SoPAr', '已恢复默认。', '\x0a-\x20**当前时间**:\x20', 'shiftKey', 'UEgsI', 'transform', 'user-profile-list-container', '好友圈\x20', 'galgame', 'noir_migration_fc_v1_complete', '404115MnIxpR', 'NoirCustomFont', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', '71%', '动态页背景已移除。', '\x20的私聊', 'Spuqh', 'agffv', 'createObjectStore', 'cDzyq', 'lPBKX', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'meeting-view-screen', 'pointer', 'wyhFm', 'chat_image_', 'WhaGS', 'eNljL', 'dVKQX', 'GJukP', 'meeting-message-input', 'audio-player', '”已创建！', 'music-input-backdrop', 'iJXsj', 'cGBGV', 'alt', 'music-input-song', 'onViU', 'JeYIm', '解析AI剧本JSON失败:', 'tKNlj', '\x22\x20吗？所有聊天记录将被永久删除。', '.load-more-btn', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', '加载卡片图片失败', 'senderId', 'widget-bg-input', 'home-date', 'back-to-settings-from-user-profile', '用户分享音乐失败:', 'WevFl', 'irYUP', 'settings', 'join', '#group-settings-screen\x20.select-box', '保存壁纸失败:\x20', '（开始一段新的对话...）', 'cjixD', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'JxPye', 'bubbleCss', 'end', 'accounting-screen', 'ucHAT', 'musicPlaylist', '星期三', 'cjXsZ', 'user-profile-list-screen', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'HTcXb', 'hGRPe', 'toDateString', 'krGuY', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'afRxe', 'from', '60%', 'YkIwd', 'TUXBi', 'quote-message-button', 'qZmMO', 'group-bg-preview', 'label', 'height', '#group-world-book-checkboxes\x20input:checked', 'AWgCw', '未分类', 'TEMXP', '壁纸已更换！', 'listen-together-card', 'name', 'GhaLm', '错误：找不到这首作为“信物”的歌。', '正在解析备份文件...', '位置已重置，正在刷新...', 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', '\x0a你只扮演【', 'play', 'user-post-music-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'MHTYm', 'zYecH', 'DxqSV', 'dRaOu', 'indexOf', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'kFNPQ', '\x0a-\x20**日记本的上一笔记录是在**:\x20', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'toLowerCase', '”已存入圣殿。', 'meetingViewMode', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'card-image-2', '我是垃圾', 'filled', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'displayedMessageCount', 'yUrXF', 'RnLnt', '对方正在输入...', '好友圈档案柜是空的，无需净化。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', 'marginBottom', 'char-edit-css', '用户操作中断了\x20AI\x20响应。', 'indexedDBData', 'CGoTv', 'char_avatar_', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', '字体应用失败:', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', 'TavOm', 'categorizedExpenses', '\x0a\x20\x20相关记忆:\x0a', 'disabled', '</span><span\x20class=\x22amount\x22>总计:\x20', '确定要删除这个条目吗？此操作不可撤销。', 'group-chat-name', 'bmQEi', 'meetingList', 'FljcQ', 'getContext', 'ioVfB', 'IlmHn', 'setProperty', 'uhwfa', '勉强但是好吧', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', 'oxvQb', 'doxYY', 'TYxnr', '<input\x20type=\x22checkbox\x22\x20value=\x22', '0\x202px\x208px\x20rgba(0,0,0,0.4)', '净化音乐封面时出错，真是的。', 'ZgfLX', 'accounting', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', 'NqyjT', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', '处理\x20', 'VofVR', 'cKcbO', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'ended', 'vpNsZ', 'close-summary-button', '##\x20来源：', 'yHJqM', 'group-settings-name', 'log', 'widget_badge', '点击选择\x20info.txt', 'import-data-input', 'Noir_FileSystem', '[AI返回了无法解析的剧本:\x20', 'back-to-chat-list', 'DtmOd', '小组件背景已更换！', 'match', '暗夜紫晶', 'world-book-item', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'sYbKx', 'ofwUY', 'toggle-meeting-view-button', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'back-to-home-from-settings', 'removeEventListener', 'custom_font_ttf', 'music-library-container', '未命名角色', 'values', 'music-input-modal', 'rZXzA', 'localeCompare', '<div\x20class=\x22post-body\x22>', 'sender', 'NSUur', 'eonGI', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '回复\x20', '至少要选择一个圈内成员！', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'TvJIv', 'music-input-artist', 'loading', 'readAsDataURL', 'wkafs', '音乐搜索失败:\x20', 'removeProperty', 'IVKwi', 'editing-world-book-id', 'galgame-sprite', 'pXHyG', 'input_', 'reset-feed-bg-button', 'https://api.vkeys.cn/v2/music/', 'listen-together-invite', '\x20张旧图片。应用即将刷新。', 'CPCQj', 'remark', '请看是我', 'diary-page-', '哼，这不是图片，你想让我压缩什么？', 'getAll', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'listen-together-ui', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'title', 'RZrEO', 'timestamp', 'amount', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', 'IndAq', 'quoted-sender', 'character', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'ygoSb', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'Assistant', 'narrator', 'STWJD', 'diary-entry-input', 'characters', 'zZWiw', 'flexDirection', 'getDay', 'aPOgx', 'fKxns', 'NHTbm', '转给\x20', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'activeMeetingScriptQueue', 'qUjRj', 'image_url', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', '卡片已更换！', 'YqUMs', '我不想工作', 'hsYBw', 'conversationHistory', 'XFHSn', 'mousedown', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', 'BkRJm', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'diary-char-name-header', '加载角色\x20', '在“一起听”邀请中，净化封面失败:', 'tIRsM', 'lazy', 'OeFOg', '”，但没找到人)', 'imageId', 'appIconPosition_app-settings', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'global-player-play-pause-btn', 'diary-entries-container', 'lyrics', 'theme-hue-slider', 'getElementById', 'feed-loader', 'HWvrM', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'opacity', 'save-char-button', 'AI似乎没有想出任何新动态。', 'gRQlc', 'live-preview-style', 'braJd', 'DqFoh', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'xQYdZ', '很好哦', '\x20(当前)', 'user-post-avatar', 'ihsKi', 'DTNYe', 'position', 'GsOPk', 'width', 'group', 'onerror', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', 'customIcon_', 'coverId', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '正在迁移旧的用户数据...', '0\x200\x20', '#\x20固定分类列表\x0a[', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'world-book-checkboxes-container', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'cAyNa', 'custom-stickers-input', 'NoirCharacterCard', '赞同！渲染效果一级棒！', 'char_sprite_', 'noir-author-mark', 'group-avatar-input', 'iDWdb', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', '导入失败了，笨蛋:\x20', 'back-to-home-from-wallpaper', 'card-widget-2', '星期一', 'linkedWorldBookIds', '</label>\x0a\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'RYOEy', 'replace', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '群聊至少需要2名成员。', 'BjMIs', 'url(\x27', 'gBjVT', '请在动态或聊天中播放', '清空聊天记录失败。', 'objectStoreNames', 'igHSN', 'trim', '</div></div></div>', 'jaumo', '编辑用户', 'musicId', 'createElement', 'expanded', 'expense-amount', 'HnFdD', '#member-select-', 'altar-slot-audio', '获取中…', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'fKKSY', 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', 'RsVTt', 'Bearer\x20', '59%', '的转账', 'AkpRB', 'ZxQwD', 'NhpzV', 'hNvCD', 'then', '--primary-lightness', 'cxbVz', '你是一个乐于助人的AI助手。', 'OmGgp', 'tfzvv', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '徽章已移除。', 'uDlwj', 'CTpdG', '--custom-font-family', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'xHGxM', 'sxKhF', '.app-icon-img', '保存失败:\x20', 'p[data-history-index]', 'eQusb', '确定要删除这笔记录吗？', 'left', '确定要从圣殿中永久删除《', 'YiRZL', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'circle_', 'catch', '说了是摆设啦，笨蛋。', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'chat-summarize-button', 'rRsYI', '全量导出失败:', 'QLzUR', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'accountingLedger', '未知艺术家', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', 'ajCFa', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', '#a4c2f4', '正在打包数据，请稍候...', '无法读取状态，浏览器可能禁用了存储功能。', '.selected-options-text', 'backgroundPosition', 'preventDefault', '\x0a\x0a#\x20', 'MCrSZ', 'songId', 'daUXi', 'clientY', '-\x20姓名:\x20', 'OyhFD', 'meeting-send-button', 'quGdO', 'preferences', 'JTQgm', 'currentTime', 'fetch-models-button', 'widget-next-btn', 'reset-card-button-2', 'ciQwq', 'forEach', '导出失败了，哼:\x20', '--feed-bg-image', '确定要永久清空【', 'sprite-slider-scale', 'EtMLi', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '\x20账单', 'vFBiF', 'forceWhiteClock', '34%', 'OQxuj', '\x20转账\x20', 'RLdNB', 'UTjBR', 'ecFNd', '新角色\x20', 'user', 'hiQKv', '<div', '购物消费', 'sPBxN', '---\x20开始AI回复流程\x20---', '<div\x20class=\x22loader-spinner\x22></div><span>', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'text', 'PmLWK', 'CCECd', 'YuuEH', 'hkWEq', 'MpLxB', 'FvRON', 'group-options-modal', '在准备动态回复时，读取图片失败:', '加载更多聊天记录', 'chatWallpaper', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', '角色“', 'artist', 'rvdqh', 'xGote', 'Cbsja', 'beforeend', 'url(', '】的日记本已被清空。', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'MlbaQ', 'yRgqN', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', '确定要恢复这个角色的默认立绘位置吗？', 'gemini', 'getMinutes', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'fkLPU', '.listen-together-song', 'paddingBottom', 'Lppzl', 'events', 'tdSbE', 'TIEPa', 'diary-modal-save', 'input[type=\x22checkbox\x22]:checked', 'NNmUa', '</span>', 'chats', 'OSsJo', '</span><div><div\x20class=\x22description\x22>', 'import-char-input', 'xUheM', 'number', 'remove', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'split', '正在升级聊天数据结构...', '\x0a##\x20条目:\x20', 'tsHsr', 'JivJv', 'group-delete-button', 'xvmhh', '干劲满满', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', '1328058DgZzBP', '.page-dot', '字体更换成功！', 'audio', 'gTLhu', '群聊“', '餐饮美食', 'JFKgk', '<br>', '[AI向\x20', 'musicPlayerState', 'touchend', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', '9608mWBaXU', 'fJlio', 'JgkLp', 'getHours', '[图片]', 'sMKDN', 'FAEIj', 'QFfhl', 'LlYKA', 'innerHTML', '\x22\x20data-id=\x22', '下载并转换网络封面失败:', '确定要删除群聊\x22', 'POST', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', '.screen.active', 'chatHistory_', 'post_image_migrated_', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'QZLNL', '\x20时出错，跳过。', '生活服务', 'readwrite', '请输入有效的转账金额！', 'music-library-item', 'backgroundSize', 'rdzse', 'PXGyc', 'User\x20cancelled', 'datgX', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', 'diary-write-modal', 'tIMQX', 'ihpsH', 'header-actions', 'rMRze', 'characterEdit', 'currentlyPlayingIndex', 'VLjiw', '净化完成！总共迁移了\x20', '\x22\x20class=\x22char-name\x22>', 'UvHXk', '出去玩', 'array', 'SZcLq', 'jqTfF', 'activeListenSession', 'qUAJq', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'wallpaper-screen', '表情包已保存！正在刷新应用...', 'VHCsa', '正在翻阅全部历史记录...', 'SvWhb', 'transfer-recipient-select', 'listen-together-song-list', '被萌到', ',\x20ID:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'toast', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'normal', 'LxOQl', 'ZSMVs', '</div>', 'qbVPY', '买新衣服', 'user-post-image-input', 'char_offline_bg_', 'songName', 'PMIdR', 'api-provider', '执行好友圈数据净化...', 'ZBJzD', 'summarize-modal', 'OzzaX', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'onloadend', 'model', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'upload-wallpaper-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'gBZje', 'zQvVC', 'diary-list-screen', 'groupChatCreate', 'group-world-book-checkboxes', 'OHuSW', 'post_user_', 'group-options-cancel', '\x20的《', '错误：找不到角色', '图片加载失败', '准备调用\x20generateAs...', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'modal-root', 'DgroQ', 'openai', 'image/jpeg', '#ff9999', 'is-entering-from-left', 'includes', 'json', '还没有我的回复可以重新生成哦。', 'diary-modal-cancel', 'organize-button-container', 'OScMc', 'stringify', 'offline-scene-view', 'DELLd', 'dJQeU', '我错了', '音乐数据升级完成，迁移了\x20', 'remove-font-button', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', 'ToTTc', 'center', '-\x20**你们最后一次互动是在**:\x20', 'groupSettings', ':</span>\x20', 'add-choice-backdrop', 'MEemB', '群聊「', '<div\x20class=\x22post-likes\x22>', 'kMwWG', 'KuLrq', '确定要重新记录吗？当前的账单会被删除。', 'drawImage', 'home', 'vHMbC', 'KSQGN', '错误：第一个好友圈\x20\x22', '超激动我来了', 'user-post-textarea', 'member-selection-item', 'wBxAQ', 'world-book-list-container', '\x20个成员', '好友圈数据升级完成，迁移了\x20', 'toFixed', 'AkLpe', 'sprite-slider-y', 'group_bg_', '-input', 'dFbhg', 'friendCircleEdit', '\x0a\x20\x20\x20\x20-\x20世界书[', 'user-name', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'lyrics-file-input', 'emote', 'touchmove', '收到的原始、有问题的文本:', 'cVCMf', 'info-file-input', 'categorized-expenses-list', 'currentAbortController', 'ZKFWB', 'user-send-post-button', 'hMRrz', 'FSVpm', 'delete-message-button', '哼，就按你说的办好了。', '\x0a#\x20当前情景\x0a', 'wallpaper_main', 'reset-card-button', 'RgCsc', '小时前），可以简单问候一下对方现在的状态。\x0a', 'test_post_', '用户已删除。', 'perChatContextLines', 'oGrnO', 'RryhG', '全量导入失败:', '\x0a\x0a#\x20用户资料库\x0a', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'UqEog', '已自动断开与其他人的听歌同步。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'input', 'LeQfn', 'auto', '#FFFFFF', 'jSGCt', 'worldBookEditor', 'scale', '正在检查好友圈数据...', '\x20个模型。', 'short', '.app-icon', 'onupgradeneeded', 'sprite-slider-x', 'WeDhB', 'character-item', 'music_library', 'signal', 'reset-widget-bg-button', '导出角色卡失败:', 'clockPosition', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '正在准备图片数据...', 'lt-ui-song-title', 'author', 'flex', '保存角色失败:', 'kind', 'FzXIN', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'wVuAP', '#diary-action-delete', '.remove-attachment-btn', 'edit-message-textarea', 'home-time', '有点破防', 'ZboYj', 'undefined', '群聊\x20(', 'GBatX', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'activeMeetingCharId', 'diary-modal-textarea', '请根据以上所有规则，生成\x20', 'QGRuM', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '</p>', 'chat-send-button', 'oyjAv', 'activeFriendCircleId', 'UwWGF', '你好，世界\x20(Hello,\x20World)', 'gLvWV', 'iKIeC', 'quotedMessage', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'back-to-home-from-circle-list', 'save-custom-stickers-button', 'img', 'LAYuc', 'modal-text', 'RvgUb', 'ruhuR', 'app-meeting', 'RCIUH', '2-digit', 'moIBB', 'dataset', 'review', 'customStickers', '当前聊天', '正在升级音乐卡片数据...', '暂无音乐', '错误：找不到签署契约的地方。', 'xNqBT', '谁啊我吗', '\x0a-\x20**对话状态**:\x20群里在', 'group-settings-bind-user', '\x20的图片失败:', 'noir-custom-font-style', 'char-edit-offline-bg-preview', 'music-library-screen', 'href', 'cover', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27', '\x22>&times;</button></div>', '\x22\x20的聊天记录吗？此操作不可撤销。', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'display', '正在搬运旧卡片...', 'kQQOO', 'dXqoI', 'chat_group_', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', 'kEcJZ', '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'sticker-content', '正在为你搬运旧壁纸到新仓库...', 'zEUmF', 'rAIcp', 'parse', '#meeting-view-screen\x20.chat-input-area', '的日记本', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', '卡片\x202\x20已移除。', 'toLocaleString', 'qdUyc', 'recipientId', 'GqlWT', 'rkWKR', '乐于助人的助手', 'onload', 'char-edit-sprite-', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', 'user-profile-edit-title', 'blob', '无法从\x20IndexedDB\x20加载聊天图片:', 'HBADa', 'theme-widget-1', '20%', '<div\x20class=\x22post-comments-container\x22>', 'choice-create-group', 'friend-circle-title', '710bZPwif', 'roUUT', 'ygFVv', 'url', 'music-widget-card', ']\x20[image]', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', '星期日', 'style-', 'padding', 'Claude\x20API\x20错误:\x20', 'delete-expense-btn', 'DcrGQ', 'altar-slot-cover', '保存徽章状态失败', 'indexedDBMusicData', 'TpEiH', 'tHbFp', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '#bubble-preview-ai', '用户资料已保存！', 'all', 'NcCUY', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'reset-desktop-button', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', '#66b3ff', 'shy', '.music-post-play-icon,\x20.music-share-play-icon', 'quote-preview-text', '歌曲“', 'worldBooks', 'input:checked', 'toBlob', 'group-bg-input', 'tMuIn', 'touches', 'XhckW', 'apiSettings', 'YlsmY', '无法保存状态，浏览器可能禁用了存储功能。', 'UkfbG', 'SIFJx', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'ndAvC', 'back-to-circle-list-from-edit', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '[用户发起了听歌邀请:\x20', 'OiIef', 'iPLoX', 'SLETq', 'KGMaw', '\x20张旧封面。应用即将刷新。', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', '已删除。', 'data:\x20', '找不到要清空的聊天记录。', 'time', 'scrollHeight', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', '\x20-\x20', 'qDUmX', '薄荷水色', 'lastIndexOf', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'IwyrW', 'back-to-meeting-list', 'SPpaQ', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'is-exiting-right', '<div\x20class=\x22post-timestamp\x22>', 'bwYfu', '<span\x20class=\x22', '很期待', '图片处理失败:\x20', 'quHXn', 'preview_', 'oehsc', 'assign', 'UqGYQ', 'clCyq', 'nJBvH', 'char-edit-wallpaper-preview', 'ahfhr', 'hbMkf', 'claude', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'onsuccess', 'vclOr', '保存播放器状态失败，真是没用。', 'iOpOV', 'sprite-confirm-button', '加载壁纸失败:', 'GLkOr', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'galgame-speaker', 'arGhy', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', 'gMBxl', 'upload-card-button-2', 'qByaQ', 'music_cover_', '对不起', 'ZsrsE', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'path', 'CeVzy', '\x22\x20id=\x22', '编辑好友圈', '.choice-modal-backdrop', 'save-user-profile-button', 'gWGRc', 'http://www.w3.org/2000/svg', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', 'user-post-image-button', 'MpyAO', 'wcCGx', '.message.ai', '世界书条目已保存！', 'AI返回了无法解析的文本', 'back-to-home-from-user-list', 'FmvGt', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'confirm-altar-upload-button', 'object', 'TNWTp', '这个也是摆设，别点了。', 'wStPy', 'keys', 'LTckJ', 'music-screen', 'closest', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', '1075464GLstWZ', 'private', 'defaultPrevented', 'wgWqp', 'translate(-50%,\x20-100%)', 'OZfei', 'chat-message-input', 'app-settings', '---\x20好友圈净化仪式完成\x20---', 'friend-circle-edit-bind-user', '点击选择\x20.lrc', '#world-book-checkboxes-container\x20input:checked', 'activeCharacterId', 'add', 'oZLRx', 'ynofn', '--widget-cover-image', 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', 'naNfW', 'twxPL', ':streamGenerateContent?key=', '人情红包', 'clock-color-toggle', '好友圈已删除。', 'ulGIX', 'gap', '\x20条动态...', 'upload-widget-bg-button', 'change', 'group_avatar_', 'giLxA', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', 'speaker-user', '）最新写下的日记内容。Ta写的是：\x0a\x20“', 'UoUMb', 'delete-world-book-button', 'accounting-content-area', '群聊名称不能为空！', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', '成功净化并迁移了\x20', 'toggle', '<img\x20id=\x22', '群聊\x22', 'diaryList', 'pxxaF', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'add-world-book-button', '确定要删除这个好友圈吗？此操作不可撤销。', '#diary-action-cancel', 'description', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'EskKk', 'customWallpaper', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'choice-cancel', 'char_', '包含所有图片和音乐的全量数据已成功导出！', '检测到已保存的字体，正在应用...', 'api-key', 'choices', 'noir_migration_music_v1_complete', 'group-clear-history-button', '需要至少2个角色才能创建群聊。', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'http', 'touchcancel', '?id=', '15%', 'group-avatar-preview', 'quote-preview-sender', '字体已应用！(Font\x20Applied!)', '正在解析音乐灵魂...', '默认米白', 'setAttribute', 'txeIK', 'edit-message-backdrop', 'euIpZ', '#\x20记录是空的，没什么好总结的。', 'ZwtRy', 'xkZxq', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'post-img-', 'ooyUA', '星期六', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'chat-image-input', 'borderBottom', 'LFcVZ', 'XEvKq', 'TBpgl', 'sprites', 'nBgLw', 'user-persona', 'ONgGD', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '净化好友圈时出错，真是的。', 'WjGZR', 'VuWCG', '15px\x2020px', 'upload-badge-button', ',\x20resetting.', 'FEoqj', 'api-model', 'chat-screen', 'Jlzbo', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', 'PJQkW', 'now', 'dmOwi', 'kHcZs', '编辑条目', 'badgeState', 'diary-next-button', 'edit-message-button', 'gfXjR', 'sticker-item', 'lRKVw', '动态页背景已更换！', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'rgba(0,\x200,\x200,\x200.4)', 'PnfoN', 'group-edit-members', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', 'insertAdjacentHTML', '--primary-hue', '》吗？', 'xviSo', 'unified-audio-player', '.custom-multiselect', 'INERH', 'borderRadius', 'translateX(-50%)', 'show-chat-view', 'rDvIC', '群聊设置已保存！', '图标处理失败:\x20', '?word=', '生成动态回复失败:', 'BFIvh', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', '.listen-together-card', '.slot-filename', '[表情]', 'pPuqs', ']\x20[sticker:', 'high', 'Aunio', '-\x20**当前精确时间**:\x20', 'KnRcv', 'widget_card_2', 'IwGOo', 'CfnqP', 'widget-play-pause-btn', 'CRoaf', 'app-wallpaper', '\x20(ID:\x20', 'QndsF', '委屈哭', '新建好友圈', 'ayyep', 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg', 'wallpaper', '\x20行格式不对，被我无视了。', 'music-widget', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'JvAVu', '逗你开心', 'happy', 'lnChy', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'UOocD', 'svg', 'quoted-content', 'onclick', '--\x20点击选择\x20--', 'paused', 'widget-artist', 'visible', 'UvsFH', 'crCpC', 'select', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'OnQle', 'music-player-bar', 'hgjoH', 'transfer-backdrop', '[发送了图片]', 'customFeedWallpaper', 'system', 'chat-sticker-button', 'song_', '恢复失败了:\x20', '\x20时出错:', 'canplaythrough', 'IDXpl', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', 'PkKaJ', '273564rtZjnk', '分钟前聊过，请注意衔接。', 'font-preview-text', '好了，请基于以上所有信息，开始写今天的日记吧。', 'top', 'tencent', 'back-to-home-from-accounting', 'music_cover_migrated_', 'postContent', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', '确定要删除群聊“', 'WfFGb', '歌曲名称', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', '正在搬运旧徽章...', 'musicWidgetPosition', 'memberCharacterIds', '解析音乐文件失败:', '这不是一张有效的Noir角色卡。', '刷我的卡', 'chat-messages', '.bubble-', '...', 'HDwDi', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', '点击选择\x20.mp3\x20或\x20.flac', 'cAiVE', 'muzEK', 'clientX', '\x22\x20的聊天记录已清空。', '\x22>\x20', 'musicUploadAltar', 'historyIndex', 'isFromLibrary', 'app-user-profiles', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', 'inline-block', 'hMnEG', '[发送了表情]', 'hKnHy', '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a', 'diary-input-wrapper', '请先在\x22设置\x22中配置你的\x20API\x20信息。', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', 'charId', '导出过程中发生严重错误:\x20', 'gScTo', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '\x0a\x0a##\x20世界书条目:\x20', 'save-group-settings-button', 'preview-item', 'LYsPf', '其他杂项', 'JdbJP', 'clear-feed-button', 'iDZAk', 'cardState', 'margin', 'fgsTR', 'sprite-reset-button', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', '保存壁纸失败:', 'accepted', 'EMUtM', '已复制到剪贴板！', '请输入新的群名称：', '\x20.app-icon-img', 'getSelection', 'Failed\x20to\x20plan\x20group\x20replies:', 'app-pages-slider', 'AbortError', '导入角色卡失败:', '#a7c7e7', 'BeEnw', '至少要保留一个用户。', '\x0a\x0a#\x20用户的动态\x0a', 'right', '执行音乐封面数据净化...', 'appState', 'read', 'User', 'alignItems', 'TkapS', 'characterId', 'jrgcK', '新建条目', 'image/png', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', 'galgame-text', 'VVXxm', '好友圈名称不能为空！', 'cdDJD', 'NCphq', 'char-edit-persona', 'VYkyE', 'random', 'chat-music-button', 'wNrpT', 'music-feed-container', 'characterLastScripts', 'SNIYH', 'nqqGQ', 'world-book-editor-screen', '加载立绘失败:', 'lt-ui-close-btn', 'userProfileList', 'jlPIW', 'is-entering-from-right', 'ILfEq', 'sort', 'abs', 'VJOQb', '正在搜索音乐...', 'editing-char-id', '\x0a\x0a#\x20今日消费流水\x0a', 'cImQg', '/v1beta/models/', '欢迎！请先创建一个角色开始聊天。', 'type', 'html-module-container', '有点生气', 'addTestPost', 'bKWdx', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '.message.user', '新用户\x20', 'character-edit-title', '该角色', 'meeting-char-name-header', '已选择\x20', '.message-container', '个人资料已保存！', '[AI发送了表情：', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'tmAas', '一个人可怜吃饭', 'appIconPosition_app-world-book', '[DONE]', 'zh-CN', 'fqbju', '951386ZwKNzi', 'ZdOTz', '哼，你这字体文件有问题，用不了。', 'hbGoT', '别这样嘛我哭哭', '小组件背景已恢复默认。', 'char-edit-bind-user', 'xoGRH', 'setItem', 'friendCircles', 'diary-get-reply-button', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'head', 'MPFPN', 'qblbf', 'hSula', 'AQDpw', 'meeting-scene-view', 'guoUO', 'xYdWS', 'nhpVS', 'OpUIO', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '我很脆弱', 'result', 'organize-bill-button', 'AI未能返回有效的JSON对象。', 'UkMrq', 'Invalid\x20saved\x20state\x20format', 'Djooh', 'userProfiles', 'diary-view-screen', '导入失败:\x20', 'daily-expenses-list', '加载聊天失败:\x20', 'bcaiu', 'page', '委屈那我歇了', 'DHaAY', 'focus', 'true', 'taxdQ', 'map', '切，加载播放器状态的时候出错了。', '编辑群成员功能正在开发中...', 'fAuTU', 'group-settings-screen', 'add-choice-modal', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'JppLh', 'max', 'qWWgP', 'itBot', 'transfer', '星期五', 'authorId', '.char-info-wrapper', 'confirm-music-input', 'block', 'jzfRr', 'show', 'KQZsI', 'gDzcH', 'chat-listen-together-button', 'mouseleave', 'timeupdate', '#\x20发生错误：\x0a', 'diaries', 'endpoint', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', '.typing-indicator', 'parentElement', 'clear', 'isOffline', 'Escape', 'body', ']:\x20', '未知用户', 'char-edit-avatar-input', '喝多了', 'data:image', 'noir_data_migration_v1_complete', 'smooth', '#friend-circle-member-selection\x20input:checked', 'UFKPN', 'pause', 'documentElement', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'BDDyw', 'ZxCgZ', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'diary-page', 'decorative-badge', '无语但是随便吧', 'oFEwj', 'badge-input', 'app-accounting', 'wPpkw', '正在连接同步频道...', '正在清空旧数据...', 'VSBjQ', 'JecNA', ']。严禁使用列表之外的任何表情名。\x0a', 'Gemini\x20stream\x20reading\x20aborted.', '正在处理...', 'no-action-modal', 'upload-feed-bg-button', 'widget-cover-art', 'lHDWE', '未命名', 'OpFZb', 'content', 'Dszrt', 'vRuTF', 'value', 'upload-card-button', 'xMdtF', 'column', '好友圈净化完成，正在重新存档...', 'OhUMF', 'emotion', 'pending-post-image-preview', '成功获取\x20', '无法保存聊天记录。', 'pCcrJ', 'KqhXt', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', 'transaction', '已恢复默认字体。', 'round', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'ceil', '\x22\x20class=\x22music-share-cover\x22>', 'VOtjW', 'option', '\x20|\x20', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'hdsrA', 'vViwc', 'hSstx', '\x20\x20-\x20用户ID:\x20', '/v1/models', '\x0a-\x20人设:\x20', '30OWKxiC', '2023-06-01', 'hhYds', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', 'toLocaleDateString', 'role', 'persona', 'fOzBV', 'lt-ui-song-artist', 'files', 'GZoLe', 'cardWidgetState', 'thought', 'tab-view-ledger', 'ItqEQ', 'facKO', '\x0a\x20\x20近期记忆:\x0a', '\x0a##\x20世界书条目:\x20', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'cover_placeholder_', '哼，不好好写清楚花在哪、花了多少，我怎么记？', '这是一条由控制台添加的测试动态！样式看起来非常完美。']; _0x17ae = function () { return _0x206eec; }; return _0x17ae(); }

  </script>



  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>